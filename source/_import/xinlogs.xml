<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
<channel>
<title><![CDATA[鑫的方向]]></title> 
<description><![CDATA[美好的生活需要用心记录]]></description>
<link>http://xinlogs.com/</link>
<language>zh-cn</language>
<generator>www.emlog.net</generator>
<item>
	<title>cloudstack on vmware</title>
	<link>http://xinlogs.com/cloudstack-on-vmware</link>
	<description><![CDATA[<p>很久没写博客了，总是犯懒。。。。</p>
<p>最近在玩cloudstack和python、django啥的。</p>
<p>上周参加了北京举行的cloudstack技术沙龙，收获很大。这两天在自己笔记本上开始折腾cloudstack玩，写下自己的方法和大家分享下。</p>
<p>我主要是分享下如何通过vmware的嵌套虚拟化，在一台自己的笔记本上跑起来cloudstack。这样手边没有服务器的朋友也可以先看看cloudstack到底什么样子了。</p>
<p>&nbsp;</p>
<p>因为cloudstack还是很吃资源的，我先说下我的硬件吧。</p>
<p>我的笔记本 CPU i7-3520M &nbsp;内存4G &nbsp;装的64位 win7</p>
<p><b><span style="color:#e53333;">主要是cpu支持虚拟化技术，并且内存越大越好</span></b></p>
<p><span style="color:#e53333;"><br />
</span></p>
<p>本来我是用的virtualBOX的，因为devcloud2需要virtualbox来跑。但是virtualbox不支持嵌套虚拟化，所以无法胜任cloudstack的运行环境。我换了vmware workstation 9.</p>
<p>&nbsp;</p>
<p>本来cloudstack文档里的最小配置是2台机器，一台跑管理程序和NFS存储，一台跑虚拟化。但是社区里发布了一个一键安装版本，将这些都整合到一个CentOS 6.3的系统下了，用的kvm的虚拟化技术。</p>
<p>&nbsp;</p>
<p>下面说说我的步骤：</p>
<p>首先在vmware里创建一个虚拟机，Guest operating system选择Linux下的Red Hat Enterprise Linux 6 64-bit。</p>
<p>虚拟机的内存我给分配了2936M，这个数值是vmware建议的最大分配内存了（宿主4G内存情况下）。</p>
<p>cpu我分配了2个core</p>
<p>注意：Processors设置的时候，已经要勾选下面的Virtualize Intel VT-x/EPT or AMD-V/RVI选项。</p>
<p><a target="_blank" href="/content/uploadfile/201302/551ddf6c4c81911782d77b19904f993820130202154739.png" id="ematt:83"><img src="/content/uploadfile/201302/thum-551ddf6c4c81911782d77b19904f993820130202154739.png" alt="点击查看原图" border="0" /></a></p>
<p>通过上面截图可以看到Device里面没用的设备也全部删掉，只保留必要的设备。</p>
<p>网卡配置为Host-only模式</p>
<p><a target="_blank" href="/content/uploadfile/201302/7fda662296e64d81cfcf046f2d4b3c7520130202154946.png" id="ematt:84"><img src="/content/uploadfile/201302/thum-7fda662296e64d81cfcf046f2d4b3c7520130202154946.png" alt="点击查看原图" border="0" /></a></p>
<p>然后我们还要修改下win7下面vmnet1的网卡IP设置，因为一键安装的cloudstack默认使用192.168.16.10这个IP。而这个IP关联到很多配置不能随意修改，所以我们只能修改本机的IP来访问192.168.16这个网段了。</p>
<p><a target="_blank" href="/content/uploadfile/201302/d1102bc485d7cd75563589177ad2129120130202155209.png" id="ematt:85"><img src="/content/uploadfile/201302/d1102bc485d7cd75563589177ad2129120130202155209.png" alt="点击查看原图" border="0" /></a></p>
<p>这样基本环境就配置好。</p>
<p>然后放入一键安装光盘或者加载ISO来安装cloudstack就可以了。光盘启动后只要选择默认的第一项就可以等待了，全部自动安装，大约20-30分钟就完成了。</p>
<p>系统自动重启后，再次进入系统。我们就可以通过win7下的浏览器访问http://192.168.16.10:8080/client这个管理界面了。默认的用户名密码为admin/password</p>
<p><a target="_blank" href="/content/uploadfile/201302/082ff4faf6c50e9a1205e8dd4b347af420130202155701.png" id="ematt:86"><img src="/content/uploadfile/201302/thum-082ff4faf6c50e9a1205e8dd4b347af420130202155701.png" alt="点击查看原图" border="0" /></a></p>
<p>进入后会见到如下界面</p>
<p><a target="_blank" href="/content/uploadfile/201302/d3dd13e89e43747a64442db622b74a1e20130202160055.png" id="ematt:87"><img src="/content/uploadfile/201302/thum-d3dd13e89e43747a64442db622b74a1e20130202160055.png" alt="点击查看原图" border="0" /></a></p>
<p>&nbsp;</p>
<p>主机警报里会出现一个关于nfs的警报，常规警报里也会出现一些。我这个截图已经跑了一个实例了，所以默认安装的可能和这个截图不太一样。</p>
<p>什么都不需要设置，包括cidr也不需要设置了。</p>
<p>全局设置就保持默认的就可以了</p>
<p><a target="_blank" href="/content/uploadfile/201302/b123b12819b166c56188cdbdcf191cc920130202160251.png" id="ematt:88"><img src="/content/uploadfile/201302/thum-b123b12819b166c56188cdbdcf191cc920130202160251.png" alt="点击查看原图" border="0" /></a></p>
<p>去基础架构界面看下，两台系统VM启动正常就可以了</p>
<p><a target="_blank" href="/content/uploadfile/201302/ab4009e8e76a12b3949dc62d8e70535020130202160434.png" id="ematt:89"><img src="/content/uploadfile/201302/thum-ab4009e8e76a12b3949dc62d8e70535020130202160434.png" alt="点击查看原图" border="0" /></a></p>
<p><span style="color:#e53333;"><b>注意：如果没有启动实例的时候，虚拟路由器是0.</b></span></p>
<p><span style="color:#e53333;"><span style="color:#000000;">接下来我们就可以部署一个自己的虚拟机实例了，这个一键安装里自带了一个centos的模版。</span></span></p>
<p><span style="color:#e53333;"><span style="color:#000000;">通过实例界面一步一步创建就可以。不要分配太大的内存，要不会因为资源不足导致创建失败，毕竟我们是在vmware嵌套的虚拟环境下弄的。</span></span></p>
<p><span style="color:#e53333;"><span style="color:#000000;"><a target="_blank" href="/content/uploadfile/201302/2a7501861773785cf0a6ef27a412472920130202160822.png" id="ematt:90"><img src="/content/uploadfile/201302/thum-2a7501861773785cf0a6ef27a412472920130202160822.png" alt="点击查看原图" border="0" /></a><br />
</span></span></p>
<p><span style="color:#e53333;"><span style="color:#000000;">创建后，如果一切正常就会看到新创建的实例已经启动了。如果有错误，可以查看/var/log/cloud/management/management-server.log日志文件。</span></span></p>
<p>状态会有Creating-&gt;Starting-&gt;Running</p>
<p><a target="_blank" href="/content/uploadfile/201302/04b91acda0a968ff2a09a2195f703b2d20130202161715.png" id="ematt:91"><img src="/content/uploadfile/201302/thum-04b91acda0a968ff2a09a2195f703b2d20130202161715.png" alt="点击查看原图" border="0" /></a></p>
<p><span style="color:#e53333;"><span style="color:#000000;">我也只是刚刚弄好一个最最简单的环境，cloudstack很强大涉及的知识也很广。如果要在实际生产中使用，还要熟悉很多方面的内容。慢慢学习了。。。。</span></span></p>
<p>大家如果对cloudstack感兴趣，可以加入www.cloudstack-china.org获取更多资料和帮助。</p>
<p>也可以加入cloudstack-china的qq群（<span class="lname" style="font-size:10pt;line-height:1.5;">群   号:</span><span id="qid" class="value text-cursor" style="font-size:10pt;line-height:1.5;">236581725）</span></p>
<p><span class="value text-cursor" style="font-size:10pt;line-height:1.5;">最后感谢qq群和邮件列表内回答我问题的朋友，是他们帮我解决了实例无法启动的问题和告诉我如何查看日志等。</span></p>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/13">CentOS 5.3 安装虚拟化后的内存识别问题.</a></p><p><a href="http://xinlogs.com/post/2">CentOS虚拟化服务的配置</a></p><p><a href="http://xinlogs.com/post/11">CentOS里的Xen配置pygrub</a></p><p><a href="http://xinlogs.com/post/10">怎么mount一个xen的img映像。转载</a></p><p><a href="http://xinlogs.com/post/4">安装和使用xen-shell</a></p></div>]]></description>
	<pubDate>Sat, 02 Feb 2013 15:33:49 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/cloudstack-on-vmware</guid>

</item>
<item>
	<title>批量部署系统方案</title>
	<link>http://xinlogs.com/post/170</link>
	<description><![CDATA[<p>最近单位一直弄刀片服务器，7个笼子，112片。安装系统是个麻烦的事情，如果单机安装，太痛苦了。</p>
<p>所以就尝试了批量部署系统。</p>
<p>&nbsp;</p>
<p>主要是分Linux和Windows两种方案</p>
<p>我这里Linux是CentOS。 采用了cobbler来做批量部署。</p>
<p>Windows采用的是win 2008的部署服务，就是WDS来做批量部署。</p>
<p>这样Linux做一台分发服务器，Windows做一台WDS服务器，需要部署那种系统就开那台服务器就可以了。</p>
<p>所有刀片全部采用pxe来引导就可以了。</p>
<p>&nbsp;</p>
<p>具体方法就先不写了，以后再补上吧</p>
<p>&nbsp;</p>]]></description>
	<pubDate>Tue, 22 Jan 2013 02:12:34 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/170</guid>

</item>
<item>
	<title>mac下配置php调试环境</title>
	<link>http://xinlogs.com/mac-xdebug-netbeans-config</link>
	<description><![CDATA[<p><span style="font-size:18px;">已经用了mac有2个月了，基本网络管理和开发工作都在mac下面了。</span></p>
<p><span style="font-size:18px;">下面说下如何配置mac下面的php调试环境</span></p>
<p><span style="font-size:18px;">我的环境：macbook air 2012款 &nbsp; Mac OS X 10.8 系统</span></p>
<p><span style="font-size:18px;">php环境：XAMPP 1.7.3</span></p>
<p><span style="font-size:medium;"><span style="line-height:27px;">开发工具：一般用sublime text 2，调试或者项目开发用netbeans</span></span></p>
<p>转载请注明：来源http://xinlogs.com</p>
<p>&nbsp;</p>
<p><span style="font-size:medium;"><span style="line-height:27px;">下面说说如何安装调试环境，主要就是xdebug的安装和配置</span></span></p>
<p><span style="font-size:medium;"><span style="line-height:27px;">这里需要提下mac下面的安装包管理工具homebrew</span></span></p>
<p><span style="font-size:medium;"><span style="line-height:27px;">我就是用brew来安装xdebug的。homebrew是一个用ruby开发的，类似macport的工具。可以在线安装软件，就像linux下的apt-get或者yum一样。</span></span></p>
<p><span style="font-size:medium;"><span style="line-height:27px;"><br />
</span></span></p>
<p><span style="font-size:medium;"><span style="line-height:27px;">安装homebrew</span></span></p>
<p><span style="font-size:medium;"><span style="line-height:27px;">需要系统可以支持ruby，通过ruby -v命令可以查看ruby版本。mac os 自带ruby</span></span></p>
<p><span style="font-size:medium;"><span style="line-height:27px;">直接在终端里输入</span></span></p>
<p>







<p class="p1"><span class="s1" style="background-color:#000000;color:#ffffff;">ruby &lt;(curl -fsSk <a href="https://raw.github.com/mxcl/homebrew/go"><span class="s2" style="background-color:#000000;color:#ffffff;">https://raw.github.com/mxcl/homebrew/go</span></a>)</span></p>
<p class="p1"></p>
<p class="p1"><span style="font-size:18px;">上面命令执行完，brew命令就可以执行了。</span></p>
<p class="p1"><span style="font-size:18px;">先运行brew doctor测试下环境是否完整，如果需要，还要添加Command Line Tools。</span></p>
<p class="p1"></p>
<p class="p1"><span style="font-size:18px;">添加Command Line Tools</span></p>
<p class="p1"><span style="font-size:18px;">打开Xcode，在preferences-&gt;downloads里面下载并安装Command Line Tools</span></p>
<p class="p1"><a target="_blank" href="/content/uploadfile/201208/b7bd19d4120ebf0aeec8e81f597afd4820120810025014.png" id="ematt:78"><img src="/content/uploadfile/201208/thum-b7bd19d4120ebf0aeec8e81f597afd4820120810025014.png" width="420" height="296" title="Command Line Tools安装" alt="Command Line Tools安装" border="0" /></a></p>
<p class="p1"></p>
<p class="p1"><span style="font-size:18px;">一切正确的话，执行brew doctor显示如下</span></p>
<p class="p1"><p class="p1"><span style="background-color:#000000;color:#ffffff;font-size:18px;">babomatoMacBook-Air:~ babo$ brew doctor</span></p>
<p class="p1"><span style="background-color:#000000;color:#ffffff;font-size:18px;">Your system is raring to brew.</span></p>
<div><br />
</div>
<div>安装好brew后，先执行brew update更新下软件包的源，然后再加载两个formula的资源</div>
<div><span style="font-size:18px;background-color:#000000;color:#ffffff;">brew update</span></div>
<div><span style="font-size:18px;background-color:#000000;color:#ffffff;"> </span><span style="font-size:18px;background-color:#000000;color:#ffffff;"> </span><span style="font-size:18px;background-color:#000000;color:#ffffff;"> </span><span style="font-size:18px;background-color:#000000;color:#ffffff;"> </span><span style="font-size:18px;background-color:#000000;color:#ffffff;"> </span><span style="font-size:18px;background-color:#000000;color:#ffffff;"> </span><p class="p1"><span style="font-size:18px;background-color:#000000;color:#ffffff;">brew tap josegonzalez/homebrew-php</span></p>
<span style="font-size:18px;background-color:#000000;color:#ffffff;"> </span><p class="p1"><span style="font-size:18px;background-color:#000000;color:#ffffff;">brew tap homebrew/dupes</span></p>
<p class="p1"><span style="font-size:medium;"><span style="line-height:27px;">完成后，就可以通过brew search和brew install来查找并安装软件了</span></span></p>
<p class="p1"><span style="font-size:medium;"><span style="line-height:27px;background-color:#000000;color:#ffffff;">brew install php53-xdebug</span></span></p>
<p class="p1"><span style="color:#ffffff;font-size:medium;"><span style="line-height:27px;color:#000000;">安装好xdebug后，还需要配置php.ini才可以正常使用。</span></span></p>
<p class="p1"><span style="font-size:medium;"><span style="line-height:27px;">先用brew info查看xdebug相关信息</span></span></p>
<p class="p1"><span style="font-size:medium;"><span style="line-height:27px;"><pre class="brush:shell; toolbar: false;gutter: false;auto-links: false;">babomatoMacBook-Air:~ babo$ brew info php53-xdebug
php53-xdebug: stable 2.2.1, HEAD
http://xdebug.org
Depends on: autoconf
/usr/local/Cellar/php53-xdebug/2.2.1 (4 files, 360K) *
https://github.com/josegonzalez/homebrew-php/commits/master/Formula/php53-xdebug.rb
==&gt; Options
--without-config-file
	Do not add ext-xdebug.ini to /usr/local/etc/php/5.3/conf.d
==&gt; Caveats
To finish installing xdebug for PHP 5.3:
  * /usr/local/etc/php/5.3/conf.d/ext-xdebug.ini was created,
    do not forget to remove it upon extension removal.
  * Restart your webserver.
  * Write a PHP page that calls "phpinfo();"
  * Load it in a browser and look for the info on the xdebug module.
  * If you see it, you have been successful!</pre></span></span><p><span style="font-size:medium;"><span style="line-height:27px;">通过信息我们知道xdebug版本是 stable 2.2.1</span></span></p>
<p><span style="font-size:medium;"><span style="line-height:27px;">配置文件在</span></span><span style="line-height:27px;">/usr/local/etc/php/5.3/conf.d/ext-xdebug.ini</span></p>
<p><span style="line-height:27px;background-color:#ffffff;font-size:18px;">我们xampp的配置文件在</span><span style="background-color:#ffffff;font-family:sans-serif;font-size:18px;line-height:normal;">/Applications/XAMPP/xamppfiles/etc/php.ini</span></p>
<p><span style="font-family:sans-serif;font-size:medium;"><span style="line-height:normal;">将xdebug的配置加入到</span></span><span style="font-family:sans-serif;font-size:18px;line-height:normal;">/Applications/XAMPP/xamppfiles/etc/php.ini</span></p>
<p><span style="font-family:sans-serif;font-size:medium;"><span style="line-height:normal;">在文件最下面加入如下信息</span></span></p>
<p><span style="font-family:sans-serif;font-size:medium;"><span style="line-height:normal;"><pre class="brush:shell; toolbar: false;gutter: false;auto-links: false;">[xdebug]
zend_extension="/usr/local/Cellar/php53-xdebug/2.2.1/xdebug.so"
        xdebug.remote_enable=1 
        xdebug.remote_host=localhost 
        xdebug.remote_port=9000 
        xdebug.remote_handler=dbgp </pre></span></span><p><span style="font-family:sans-serif;font-size:medium;"><span style="line-height:normal;">重启xampp的apache，然后访问phpinfo查看是否成功加载xdebug</span></span></p>
<p><span style="font-family:sans-serif;font-size:medium;"><span style="line-height:normal;"><a target="_blank" href="/content/uploadfile/201208/fa1135a0a91f2b16a940677ba17e5ee420120810030534.png" id="ematt:79"><img src="/content/uploadfile/201208/thum-fa1135a0a91f2b16a940677ba17e5ee420120810030534.png" width="420" height="226" title="xdebug配置信息" alt="xdebug配置信息" border="0" /></a><br />
</span></span></p>
</p>
</p>
<p class="p1"><span style="font-size:18px;background-color:#000000;color:#ffffff;"><br />
</span></p>
<p class="p1"><span style="font-size:18px;color:#000000;">配置netbeans可以调用xdebug</span></p>
<p class="p1"><span style="font-size:18px;color:#000000;">首先将netbeans的偏好设置里的php5解释器设置为xampp的php。不要用系统自带的</span></p>
<p class="p1"><span style="font-size:18px;color:#000000;"><a target="_blank" href="/content/uploadfile/201208/a7bf682822d31105489112d2407faad120120810030918.png" id="ematt:80"><img src="/content/uploadfile/201208/thum-a7bf682822d31105489112d2407faad120120810030918.png" width="420" height="128" title="netbeans设置php解释器" alt="netbeans设置php解释器" border="0" /></a><br />
</span></p>
<p class="p1"><span style="font-size:18px;">再设置调试的端口</span></p>
<p class="p1"><span style="font-size:18px;"><a target="_blank" href="/content/uploadfile/201208/b72398a82969d697e91341de4795ea9a20120810031012.png" id="ematt:81"><img src="/content/uploadfile/201208/thum-b72398a82969d697e91341de4795ea9a20120810031012.png" width="420" height="361" title="netbeans设置xdebug端口" alt="netbeans设置xdebug端口" border="0" /></a><br />
</span></p>
<p class="p1"><span style="font-size:18px;">这些都设置好，就可以调试php代码了</span></p>
<p class="p1"><span style="font-size:medium;"><span style="line-height:27px;">最后放一张我调试的截图</span></span></p>
<p class="p1"><span style="font-size:medium;"><span style="line-height:27px;"><a target="_blank" href="/content/uploadfile/201208/252bb5eba38b1183421ad606648254a920120810031405.png" id="ematt:82"><img src="/content/uploadfile/201208/thum-252bb5eba38b1183421ad606648254a920120810031405.png" alt="点击查看原图" border="0" /></a><br />
</span></span></p>
</div>
</p>
</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/mac-vnc-rdp-over-ssh">mac下用ssh转发端口</a></p><p><a href="http://xinlogs.com/update-115disk-urls">批量更换115网盘链接</a></p><p><a href="http://xinlogs.com/php-performance-debugging-tools">php性能调试工具</a></p><p><a href="http://xinlogs.com/squid-cache-php-script">squid缓存php页面</a></p><p><a href="http://xinlogs.com/find-php-slow-code">php-fpm查找php慢速代码</a></p></div>]]></description>
	<pubDate>Fri, 10 Aug 2012 02:32:05 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/mac-xdebug-netbeans-config</guid>

</item>
<item>
	<title>批量更换115网盘链接</title>
	<link>http://xinlogs.com/update-115disk-urls</link>
	<description><![CDATA[<p><span style="font-size:18px;">今天115网盘关闭了对外分享链接的功能。我的客户有人是用115网盘作为服务器资源存储用的，网站上下载资源都是采用115网盘地址来发布的。这样直接造成全部资源都无法下载了，我临时写了个php脚本来更新全部的115网盘链接到本地服务器地址。</span></p>
<p>&nbsp;</p>
<p><b><span style="font-size:24px;">主要思路：</span></b></p>
<p><span style="font-size:18px;">首先将网盘里的资源全部下载到服务器，然后导出一个网盘地址和文件实际名字的列表</span></p>
<p><span style="font-size:18px;">如下所示：</span></p>
<p><div id="kindeditor" class="quote">http://115.com/file/e78cpfjd#Dark_Room.rar<br />
http://115.com/file/e78cpwkh#Dark_Energy.rar</div>
<span style="font-size:18px;">可以看到前面是网盘下载的url，＃号后面是实际的文件名。</span></p>
<p><span style="font-size:18px;">我将这个列表保存在一个文件里，便于php脚本获取。</span></p>
<p><span style="font-size:18px;">然后编写一个php脚本，把文件里每行的url取出来，到数据库里把这个下载链接替换为我们服务器上的地址。主要是采用mysql的replace函数实现</span></p>
<p>&nbsp;</p>
<p>脚本如下：</p>
<p><pre class="brush:php; toolbar: false;gutter: false;auto-links: false;">#!/usr/bin/php
&lt;?php
print("=======fix_url v1=========\n");
print("=======write by babodx@gmail.com=======\n");


function update_url($url) {
    list($url_115,$url_tv1926)=explode("#",$url);
    $url_tv1926="http://xiazai.tv1926.com/".$url_tv1926;
    print("update:");
    print($url_115);
    print("&gt;&gt;");
    $link = mysql_connect('localhost', 'username', 'passwd');
    if (!$link) {
        die('Could not connect: ' . mysql_error());
    }

    mysql_select_db('my_database', $link) or die ('Can\'t use my_database : ' .         mysql_error());

    $sql="update p8_article_content_101 set     my_801=replace(my_801,'".$url_115."','".$url_tv1926."')";
    mysql_query("set names gbk");
    $result = mysql_query($sql)
    or die("Invalid query: " . mysql_error());

    mysql_close($link);
    print($url_tv1926);
    print("\n");
}

if (is_null($argv[1])) {
    print("argv1 is null\n");
    exit();
}
$file_name=$argv[1];
print("get files name...\n");
$file_names=array();
$handle = @fopen($file_name, "r");
if ($handle) {
    while (!feof($handle)) {
        $buffer = fgets($handle);
        $tmp_file_name=trim($buffer);
        array_push($file_names,$tmp_file_name);

    }
    fclose($handle);
}

foreach ($file_names as $file_url) {
    update_url($file_url);
}
print("over!");



?&gt;</pre></p>
<p><span style="font-size:18px;">如果觉得这个脚本有用，可以从网盘下载（网盘的脚本添加了注释）</span></p>
<p>http://babo.qjwm.com/down_4261688.html</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/24">Mysql设置my.cnf来记录下全部sql请求</a></p><p><a href="http://xinlogs.com/check-slow-php-script">如何找到执行慢的php程序</a></p><p><a href="http://xinlogs.com/post/23">如何建立两个表间的外键</a></p><p><a href="http://xinlogs.com/disable-mysql-query-log">开启或者关闭MYSQL的query log(查询日志)</a></p><p><a href="http://xinlogs.com/post/22">一个在windows下很好用的MySQL工具Navicat</a></p></div>]]></description>
	<pubDate>Wed, 08 Aug 2012 14:37:24 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/update-115disk-urls</guid>

</item>
<item>
	<title>debian6.0.5(squeeze)安装配置xen-4.0虚拟化</title>
	<link>http://xinlogs.com/debian-xen-install</link>
	<description><![CDATA[<p><b><span style="font-size:24px;">系统安装</span></b></p>
<p><span style="font-size:18px;">我是通过http://mirrors.163.com下载的</span><span style="font-family:Arial;font-size:18px;line-height:normal;">&nbsp; &nbsp; &nbsp;debian-6.0.5-amd64-CD-1.iso</span></p>
<div><span style="font-family:Arial;font-size:18px;line-height:normal;">最小安装有一张CD就可以了，安装的是</span><span style="font-size:18px;">debian6.0.5(squeeze) 64位版本</span></div>
<div><br />
</div>
<div><span style="font-size:18px;">安装没啥好说的，最小化安装，除了基本系统就多选择了一个ssh server。</span></div>
<div><br />
</div>
<div><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><span style="font-size:18px;"> </span><div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">安装好系统后，进入系统首先设置网卡，不要用dhcp选择static模式</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">编辑/etc/network/interfaces文件如下</span></div>
</div>
<div><pre class="brush:shell; toolbar: false;gutter: false;auto-links: false;"># The loopback network interfaceauto lo

iface lo inet loopback



# The primary network interface

#allow-hotplug eth0

auto eth0

iface eth0 inet static

  address 192.168.1.10

  netmask 255.255.255.0

  broadcast 192.168.1.255

  network 192.168.1.0

  gateway 192.168.1.1</pre><br />
</div>
<div><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">我这里只有一个eth0网卡，采用192.168.1.10的IP地址</span></div>
</div>
<div><br />
</div>
<div><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><span style="font-size:18px;"> </span><div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">接下来修改apt的源，采用mirrors.163.com提供的服务器，这样速度比较快</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">修改/etc/apt/sources.list</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">内容如下</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><div id="kindeditor" class="quote"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><div style="font-size:medium;"><span style="background-color:#f7f7f7;font-size:13px;line-height:19px;">deb&nbsp;</span><a href="http://mirrors.163.com/debian/" style="font-size:13px;line-height:19px;">http://mirrors.163.com/debian/</a><span style="background-color:#f7f7f7;font-size:13px;line-height:19px;">&nbsp;squeeze main non-free contrib</span><br />
</div>
<div style="font-size:medium;"><span style="background-color:#f7f7f7;font-size:13px;line-height:19px;">deb&nbsp;</span><a href="http://mirrors.163.com/debian/" style="font-size:13px;line-height:19px;">http://mirrors.163.com/debian/</a><span style="background-color:#f7f7f7;font-size:13px;line-height:19px;">&nbsp;squeeze-proposed-updates main non-free contrib</span><span style="background-color:#f7f7f7;font-size:13px;line-height:19px;"><br />
</span></div>
<div style="font-size:medium;"><span style="background-color:#f7f7f7;font-size:13px;line-height:19px;">deb-src&nbsp;</span><a href="http://mirrors.163.com/debian/" style="font-size:13px;line-height:19px;">http://mirrors.163.com/debian/</a><span style="background-color:#f7f7f7;font-size:13px;line-height:19px;">&nbsp;squeeze main non-free contrib&nbsp;</span><span style="background-color:#f7f7f7;font-size:13px;line-height:19px;"><br />
</span></div>
<div style="font-size:medium;"><span style="font-size:13px;background-color:#f7f7f7;line-height:19px;">deb-src&nbsp;</span><a href="http://mirrors.163.com/debian/" style="font-size:13px;line-height:19px;">http://mirrors.163.com/debian/</a><span style="font-size:13px;background-color:#f7f7f7;line-height:19px;">&nbsp;squeeze-proposed-updates main non-free contrib</span></div>
<div><span style="font-size:13px;background-color:#f7f7f7;line-height:19px;"><br />
</span></div>
</div>
&nbsp;<span style="line-height:19px;font-size:18px;">执行apt-get update更新源</span></div>
<p><span style="line-height:19px;font-size:18px;">经过这些设置，系统基本就是一个干净的最小系统。并且采用163的服务器作为软件源。</span></p>
<p><span style="line-height:19px;"><br />
</span></p>
<p><span style="line-height:19px;font-size:24px;"><b>安装XEN-4.0</b></span></p>
<p><span style="font-size:medium;"><span style="line-height:27px;font-size:18px;">下面开始安装xen-4.0的相关软件包和配置</span></span></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><span style="font-family:simsun;font-size:18px;line-height:21px;text-align:left;background-color:#000000;color:#ffffff;">apt-get install xen-hypervisor-4.0-amd64 xen-linux-system-2.6.32-5-xen-amd64 xen-utils* xenwatch xen-tools</span></p>
<p style="text-align:left;"><span style="font-family:simsun;"><span style="font-size:18px;line-height:21px;">需要下66.2M的软件包</span></span></p>
<p style="text-align:left;"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><span style="font-size:18px;"> </span><p><span style="font-family:simsun;"><span style="font-size:18px;line-height:21px;">安装后，再次启动选择带XEN 4.0 amd64的内核启动项</span></span></p>
<p><span style="font-family:simsun;"><span style="font-size:18px;line-height:21px;color:#e53333;">注意：（默认的启动项虽然带xen但是不带4.0选项，启动后不能正确启动xend）</span></span></p>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-family:simsun;"><span style="font-size:18px;line-height:21px;color:#000000;">也可以修改/etc/default/grub里面的选项，默认从这个内核启动</span></span></div>
<p><span style="font-family:simsun;"><span style="font-size:18px;line-height:21px;color:#000000;">修改GRBU_DEFAULT=4</span></span></p>
<p><span style="font-family:simsun;"><span style="font-size:14px;line-height:21px;color:#000000;"><br />
</span></span></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-family:simsun;"><span style="font-size:18px;line-height:21px;">配置xen的网络</span></span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-family:simsun;"><span style="font-size:18px;line-height:21px;">修改/etc/xen/xend-config.sxp文件</span></span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-family:simsun;"><span style="font-size:14px;line-height:21px;"><br />
</span></span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-family:simsun;"><span style="font-size:18px;line-height:21px;">打开</span></span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">(network-script network-bridge)</span><span style="font-family:simsun;"><span style="font-size:14px;line-height:21px;"><br />
</span></span><span style="font-size:18px;"> </span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">采用桥接方式&nbsp;</span></div>
</p>
</p>
<p style="text-align:left;"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">重启后，系统会将物理网卡修改为peth0，而eth0为桥接的网卡</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><br />
</div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">brctl show 显示如下</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">root@node1:~# brctl show</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;text-align:-webkit-auto;"><span style="font-size:18px;">bridge name&nbsp;&nbsp;&nbsp;&nbsp; bridge id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STP enabled&nbsp;&nbsp;&nbsp;&nbsp; interfaces</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;text-align:-webkit-auto;"><span style="font-size:18px;">eth0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8000.001c42d8fe43&nbsp;&nbsp;&nbsp;&nbsp; no &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;peth0</span></div>
<div><br />
</div>
</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><span style="font-family:Arial;font-size:medium;line-height:19px;"><b><span style="font-size:24px;">通过xen-create-image安装debian虚拟系统</span></b></span></p>
<p><span style="font-family:Arial;font-size:18px;line-height:19px;background-color:#000000;color:#ffffff;">xen-create-image</span><span style="font-family:Arial;font-size:18px;line-height:19px;background-color:#000000;color:#ffffff;">&nbsp;--hostname=vm01 --size=2G --swap=128M --ide \&nbsp;</span></p>
<p><span style="font-family:Arial;font-size:18px;line-height:19px;background-color:#000000;color:#ffffff;">--ip=192.168.1.21 --netmask=255.255.255.0 --gateway=192.168.1.1 \</span></p>
<p><span style="font-family:Arial;font-size:18px;line-height:19px;background-color:#000000;color:#ffffff;">--force --dir=/vm --memory=128M -arch=i386 \</span></p>
<p><span style="font-family:Arial;font-size:18px;line-height:19px;background-color:#000000;color:#ffffff;">--kernel=/boot/vmlinuz-2.6.32-5-xen-amd64 \</span></p>
<p><span style="font-family:Arial;font-size:18px;line-height:19px;background-color:#000000;color:#ffffff;">--dist=squeeze --mirror=http://mirrors.163.com/debian/ --passwd \</span></p>
<p><span style="font-family:Arial;font-size:18px;line-height:19px;background-color:#000000;color:#ffffff;">--install-method=debootstrap</span></p>
<p><span style="font-family:Arial;font-size:18px;line-height:19px;background-color:#000000;color:#ffffff;"><br />
</span></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="line-height:19px;font-size:18px;">安装以后，需要调整vm01.cfg文件，否则无法启动</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="line-height:19px;font-size:18px;">首先调整磁盘的相关配置</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = '/dev/xvda2 ro'</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">disk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = [</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'file:/vm/domains/vm01/disk.img,xvda2,w',</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'file:/vm/domains/vm01/swap.img,xvda1,w',</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><br />
</div>
<p><span style="font-size:18px;">将原来的hda2修改为xvda2&nbsp;</span></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">然后是调整网卡的相关配置</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">vif&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = [ 'ip=192.168.1.21,mac=00:16:3E:9B:1A:90,bridge=eth0' ]</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">主要是加上bridge=eth0</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><br />
</div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">这样就可以通过xm create vm01.cfg启动虚拟系统了</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><br />
</div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;background-color:#000000;color:#ffffff;">root@node1:~# xm list</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;background-color:#000000;color:#ffffff;">Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ID&nbsp;&nbsp; Mem VCPUs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp; Time(s)</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;background-color:#000000;color:#ffffff;">Domain-0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp;&nbsp; 879&nbsp;&nbsp;&nbsp;&nbsp; 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r-----&nbsp;&nbsp;&nbsp;&nbsp; 26.6</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;background-color:#000000;color:#ffffff;">vm01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp; 128&nbsp;&nbsp;&nbsp;&nbsp; 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-b----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.7</span></div>
<p><span style="font-size:18px;background-color:#000000;color:#ffffff;">root@node1:~# &nbsp;</span></p>
<p><span style="font-size:18px;"><br />
</span></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><div style="font-family:Arial;font-size:medium;line-height:normal;">启动后，dom0下面会出现一个vif的虚拟网卡</div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="background-color:#000000;color:#ffffff;">root@node1:~# brctl show</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="background-color:#000000;color:#ffffff;">bridge name&nbsp;&nbsp;&nbsp;&nbsp; bridge id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STP enabled&nbsp;&nbsp;&nbsp;&nbsp; interfaces</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="background-color:#000000;color:#ffffff;">eth0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8000.001c42d8fe43 &nbsp; &nbsp; &nbsp; &nbsp; no &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;peth0</span></div>
<p><span style="background-color:#000000;color:#ffffff;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vif1.0&nbsp;</span></p>
<p><span style="background-color:#000000;color:#ffffff;"><br />
</span></p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">如果在guest系统只能ping到dom0的eth0，而不能ping到外网</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">可以检查下</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;background-color:#000000;color:#ffffff;">root@node1:~# sysctl net.ipv4.ip_forward</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><br />
</div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;"><span style="background-color:#000000;color:#ffffff;">net.ipv4.ip_forward = 0</span> </span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><br />
</div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">只要打开这个ip_forward就可以了</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><br />
</div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">修改/etc/sysctl.conf里面的net.ipv4.ip_forward=1</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">或者</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;background-color:#000000;color:#ffffff;">echo 1&gt;/proc/sys/net/ipv4/ip_forward</span></div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><br />
</div>
<div style="font-family:Arial;font-size:medium;line-height:normal;"><span style="font-size:18px;">也可以用命令临时生效</span></div>
<p><span style="font-size:18px;background-color:#000000;color:#ffffff;">sysctl -w net.ipv4.ip_forward=1&nbsp;</span></p>
<p><span style="font-size:18px;background-color:#000000;color:#ffffff;"><br />
</span></p>
<p><b><span style="font-size:18px;">如果您的系统是CentOS，请参考我以前的文章。</span></b></p>
<p><h3 class="t" style="margin:0px;padding:0px;list-style:none;font-weight:normal;font-size:medium;font-family:arial;line-height:18px;"><a href="/post/2" target="_blank"><em style="font-style:normal;color:#cc0000;">CentOS虚拟化</em>服务的配置</a></h3>
</p>
</p>
</p>
</p>
</p>
<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--></div>
<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/13">CentOS 5.3 安装虚拟化后的内存识别问题.</a></p><p><a href="http://xinlogs.com/post/5">ubuntu 9.04安装xen</a></p><p><a href="http://xinlogs.com/post/10">怎么mount一个xen的img映像。转载</a></p><p><a href="http://xinlogs.com/post/11">CentOS里的Xen配置pygrub</a></p><p><a href="http://xinlogs.com/post/8">ubuntu 9.04 server 安装VMware Tools解决share folders问题</a></p></div>]]></description>
	<pubDate>Mon, 06 Aug 2012 06:56:59 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/debian-xen-install</guid>

</item>
<item>
	<title>nginx通过轮询避免php-fpm引起的502错误</title>
	<link>http://xinlogs.com/Solve-nginx-502-mistakes</link>
	<description><![CDATA[<p><span style="font-size:24px;"><b>【问题背景】</b></span></p>
<p>最近客户的一个网站总是偶尔出现502错误</p>
<p>网站架构采用的就是nginx 1.0.10+php 5.3.8+php-fpm模式</p>
<p><span style="font-size:24px;">【问题分析】</span></p>
<p><span style="color:#e53333;">首先要检查下php-fpm的进程数使用情况</span></p>
<p></p>
<div id="kindeditor" class="quote">netstat -napo |grep "php-fpm" | wc -l</div>
如果这个查询出来的数量接近了你在php-fpm.conf里设置的数量，说明是进程数量不过用了。果断增加<p></p>
<p>而我这次碰到的不是这个。继续分析</p>
<p><span style="color:#e53333;">会不会是php程序执行时间过长造成超时？</span></p>
<p>这个可以通过我的另外一篇文章来查看</p>
<p><span style="font-size:18px;"><a href="/find-php-slow-code" target="_blank">php-fpm查找php慢速代码</a></span></p>
<p>如果是这个问题，我们可以通过修改nginx.conf和php-fpm.conf里面相关的超时设置来解决</p>
<p></p>
<div id="kindeditor" class="note">nginx.conf里面主要是如下<br />
<span style="color:#333333;font-family:arial;font-size:14px;line-height:25px;">fastcgi_connect_timeout 300;</span><br style="color:#333333;font-family:arial;font-size:14px;line-height:25px;background-color:#ffffff;padding:0px;margin:0px;word-break:break-all;" />
<span style="color:#333333;font-family:arial;font-size:14px;line-height:25px;">fastcgi_send_timeout 300;</span><br style="color:#333333;font-family:arial;font-size:14px;line-height:25px;background-color:#ffffff;padding:0px;margin:0px;word-break:break-all;" />
<span style="color:#333333;font-family:arial;font-size:14px;line-height:25px;">fastcgi_read_timeout 300;</span><span style="color:#333333;font-family:arial;font-size:14px;line-height:25px;background-color:#ffffff;"><br />
<br />
</span><p><span style="color:#333333;font-family:arial;font-size:14px;line-height:25px;">php-fpm.conf里如要是如下</span></p>
<p>request_terminate_timeout = 10s</p>
</div>
很不幸，我碰到的也不是这个问题<p></p>
<p><span style="color:#e53333;">接着我开始分析是不是fastcgi缓存不够？</span></p>
<p>主要是在nginx.conf配置里修改如下参数</p>
<p></p>
<p></p>
<div id="kindeditor" class="note"><br />
fastcgi_buffer_size 64k;<br />
fastcgi_buffers 4 64k;<br />
fastcgi_busy_buffers_size 128k</div>
这个我还真不清楚要设置多大合适，网站说这个配置小了，有可能引发502.<p></p>
<p><span style="font-size:24px;"><b>【终极解决办法】</b></span></p>
<p>既然上面的常规办法不能解决，那我就想其他办法了。可以肯定的是502引起肯定是因为php-fpm引发的，也就是nginx将正确的客户端请求发给了后端的php-fpm进程，但是因为php-fpm进程的问题导致不能正确解析php代码。最终返回给了客户端502错误。</p>
<p>我觉得nginx既然upstream可以支持多组后端服务器轮询实现简单的负责均衡，并且可以做简单的健康检查。那我就用这个办法开多组php-fpm服务来实现一个php-fpm池，让nginx在这个php-fpm资源里通过stream轮询。</p>
<p>因为有了健康检查机制，这样就可以在错误到达客户端前换另外一个php-fpm进程重新解析了。</p>
<p>&nbsp;</p>
<p><span style="font-size:18px;">主要配置方法</span></p>
<p></p>
<p>先修改php-fpm.conf来开启多组php-fpm进程</p>
<p>我这里开启了php-cgi_www1和php-cgi_www2两组</p>
<p></p>
<pre class="brush:shell; toolbar: false;gutter: false;auto-links: false;">[www1]
listen = /tmp/php-cgi_www1.sock
user = www
group = www
pm = dynamic
pm.max_children = 128
pm.start_servers = 32
pm.min_spare_servers = 32
pm.max_spare_servers = 96
pm.max_requests= 10240
request_terminate_timeout = 10s

[www2]
listen = /tmp/php-cgi_www2.sock
user = www
group = www
pm = dynamic
pm.max_children = 128
pm.start_servers = 32
pm.min_spare_servers = 32
pm.max_spare_servers = 96
pm.max_requests= 10240
request_terminate_timeout = 10s</pre>然后重启php-fpm进程，并查看/tmp目录是否已经出现了php-cgi_www1.sock和php-cgi_www2.sock的文件<p></p>
<p>如果存在这两个文件，说明php-fpm配置ok了。我们继续修改nginx.conf配置</p>
<p>主要在http {} 的配置块内，加入我们要使用的轮询配置</p>
<p></p>
<pre class="brush:shell; toolbar: false;gutter: false;auto-links: false;">upstream php_servers{
  server unix:/tmp/php-cgi_www1.sock;
  server unix:/tmp/php-cgi_www2.sock;
}
fastcgi_next_upstream error timeout invalid_header http_500 http_503;</pre>接着修改我们原来处理php代码的fastcgi配置<p></p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;"> location ~ .*\.(php|php5)?$
    {
      fastcgi_pass  unix:/tmp/php-cgi_www.sock;
      fastcgi_index index.php;
      include fastcgi.conf;
    }</pre>将其中的fastcgi_pass由原来的php-cgi_www.sock单独的php-fpm进程修改为我们创建的php_servers轮询池<p></p>
<p></p>
<pre class="brush:shell; toolbar: false;gutter: false;auto-links: false;"> location ~ .*\.(php|php5)?$
    {
      fastcgi_pass php_servers;
      fastcgi_index index.php;
      include fastcgi.conf;
    }</pre>通过这样的配置，可以肯定的是php-fpm因为采用两组来轮询工作，并且有fastcgi_next_upstream进程简单的健康检查，可以最大限度的避免502错误发生了。<p></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/nginx-epool-events">nginx采用epoll的事件模型，为何效率高。</a></p><p><a href="http://xinlogs.com/druapl-url-nginx-rewrite">drupal在nginx 0.8.15下的简洁URL配置</a></p><p><a href="http://xinlogs.com/nginx-301-rewrite">nginx通过301统一入口域名</a></p><p><a href="http://xinlogs.com/howto-open-rewrite-log">伪静态规则调试技巧</a></p></div>]]></description>
	<pubDate>Wed, 01 Aug 2012 15:12:58 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Solve-nginx-502-mistakes</guid>

</item>
<item>
	<title>【电影发布】超凡蜘蛛侠2012</title>
	<link>http://xinlogs.com/chaofanzhizhuxia</link>
	<description><![CDATA[<p><a href="http://babo.qjwm.com/down_4151339.html" target="_blank">清晰TS-RMVB.中字 2012最新上映美国科幻动作大片【BT下载】</a></p>
<p><a href="http://movie.mtime.com/movie/56928/posters_and_images/1782362/" style="margin:0px;padding:0px;color:#2f688c;cursor:pointer;vertical-align:baseline;font-family:verdana, lucida, arial, helvetica, 宋体, sans-serif;font-size:12px;line-height:18px;"><img class="block mauto" alt="超凡蜘蛛侠The Amazing Spider-Man(2012)海报(法国) #01" src="http://img31.mtime.cn/pi/2012/07/23/102855.42362017.jpg" style="margin:0px auto;padding:0px;border:0px;display:block;" /></a></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/bianfuxia-3-heianqishi">【电影发布】蝙蝠侠前传3：黑暗骑士崛起</a></p><p><a href="http://xinlogs.com/Bodyguards-and-Assassins">平安夜观看十月围城</a></p></div>]]></description>
	<pubDate>Wed, 01 Aug 2012 14:54:17 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/chaofanzhizhuxia</guid>

</item>
<item>
	<title>【电影发布】蝙蝠侠前传3：黑暗骑士崛起</title>
	<link>http://xinlogs.com/bianfuxia-3-heianqishi</link>
	<description><![CDATA[<p>下载方式为网盘下载</p>
<p><a href="http://babo.qjwm.com/down_4151841.html" target="_blank">【蝙蝠侠前传3：黑暗骑士崛起TS清晰原创中字版】下载</a></p>
<p><a href="http://movie.mtime.com/movie/125424/posters_and_images/2028771/" style="margin:0px;padding:0px;color:#2f688c;cursor:pointer;vertical-align:baseline;font-family:verdana, lucida, arial, helvetica, 宋体, sans-serif;font-size:12px;line-height:18px;"><img class="block mauto" alt="蝙蝠侠前传3：黑暗骑士崛起The Dark Knight Rises(2012)预告海报(中国台湾) #03" src="http://img31.mtime.cn/pi/2012/07/28/141939.23587809.jpg" style="margin:0px auto;padding:0px;border:0px;display:block;" /></a></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/chaofanzhizhuxia">【电影发布】超凡蜘蛛侠2012</a></p><p><a href="http://xinlogs.com/Bodyguards-and-Assassins">平安夜观看十月围城</a></p></div>]]></description>
	<pubDate>Wed, 01 Aug 2012 14:45:11 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/bianfuxia-3-heianqishi</guid>

</item>
<item>
	<title>快速提升app store下载速度</title>
	<link>http://xinlogs.com/accelerate-app-store-download</link>
	<description><![CDATA[<p>前两天开始更新MAC OS Mountain Lion。</p>
<p>为了下载这个4.5G的内容，可是郁闷坏了。计算出来的剩余时间7天。</p>
<p>于是开始找加速下载的办法，看来一些帖子以后基本知道了下载速度主要取决与dns将你的请求解析到哪台服务器。</p>
<p>网上一般是都是基于自己找到一台快速的下载服务器IP，然后手动修改/etc/hosts文件的办法。</p>
<p>&nbsp;</p>
<p>但是其实看原来就知道，如果我们设置的DNS得当，就能起到从最快服务器下载的目的。</p>
<p>于是我查到了<a href="http://dns.v2ex.com/">http://dns.v2ex.com/</a>这个网站，但是使用这个dns后，速度依然很慢。</p>
<p>后来又在www.weiphone.com找到了一个台湾的DNS。设置后速度大幅提升。</p>
<p>&nbsp;</p>
<p>如果你也在北京、也用歌华有线。</p>
<p>试试下面这个台湾的DNS吧</p>
<p>&nbsp;</p>
<p style="text-align:center;"><b><span style="font-size:32px;color:#e53333;">168.95.1.1</span></b></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/eMule-VPN-HighID">通过VPN获取eMule的HighID</a></p><p><a href="http://xinlogs.com/find-php-slow-code">php-fpm查找php慢速代码</a></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p><p><a href="http://xinlogs.com/check-slow-php-script">如何找到执行慢的php程序</a></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p></div>]]></description>
	<pubDate>Sun, 29 Jul 2012 06:04:23 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/accelerate-app-store-download</guid>

</item>
<item>
	<title>2012 macbook Air 使用华为E1750 3g上网卡</title>
	<link>http://xinlogs.com/macbook-air-use-e1750-3g-mobilecard</link>
	<description><![CDATA[<p class="p1"><span style="font-size:14px;">最近一直在摸索macbook air的使用方法，目前大部分工作都已经可以放弃windows了。</span></p>
<span style="font-size:14px;"> </span><p class="p1"><span style="font-size:14px;">今天又将华为的E1750上网卡在macbook air上正确安装了。</span></p>
<span style="font-size:14px;"> </span><p class="p1"><span style="font-size:14px;">我的3g上网卡如下</span></p>
<p class="p2"><a target="_blank" href="/content/uploadfile/201207/9fc395a2167b68ac63cb1ee2005fe3af20120723053002.png" id="ematt:76"><img src="/content/uploadfile/201207/9fc395a2167b68ac63cb1ee2005fe3af20120723053002.png" alt="点击查看原图" border="0" /></a></p>
<p class="p1"><span style="font-size:14px;">这个上网卡是09年的，现在直接插入usb后，macbook air没有任何反应。</span></p>
<p class="p1"></p>
<p class="p1">







</p>
<p class="p1"><b><span style="font-size:18px;">安装方法：</span></b></p>
<p class="p1"><span style="font-size:14px;"><b>1、首先要在Windows机器上更新固件</b></span></p>
<span style="font-size:14px;"><b> </b></span><p class="p2"><span class="s1" style="font-size:14px;">先在windows机器</span><span class="s2" style="font-size:14px;">安装mobile_card_driver驱动。</span></p>
<span style="font-size:14px;"> </span><p class="p3"><span class="s2" style="font-size:14px;">然后再到华为主页下载固件更新程序</span></p>
<span style="font-size:14px;"> </span><p class="p4"><span class="s3"><a href="http://www.huaweidevice.com/cn/downloadCenter.do?method=toDownloadFile&amp;flay=software&amp;softid=MzgwNjI="><span style="font-size:14px;">E1750 WINMACB300D00SP05C112(UTPS11.301.08.30.112_MAC11.301.06.13.112)(China Unicom)(05019744)</span></a></span></p>
<span style="font-size:14px;"> </span><p class="p5"></p>
<span style="font-size:14px;"> </span><p class="p1"><span style="font-size:14px;">将上网卡插入windows的usb接口，可以被驱动正确识别以后，运行固件更新程序开始更新固件。</span></p>
<span style="font-size:14px;"> </span><p class="p5"></p>
<span style="font-size:14px;"> </span><p class="p1"><span style="font-size:14px;"><b>2、macbook下安装</b></span></p>
<span style="font-size:14px;"><b> </b></span><p class="p1"><span style="font-size:14px;">更新好固件以后，我们就可以插入macbook的笔记本。这个时候会识别出来一个mobile card的光驱。</span></p>
<span style="font-size:14px;"> </span><p class="p1"><span style="font-size:14px;">我们从finder进入这个光驱，就会发现“无线上网卡.app“程序</span></p>
<span style="font-size:14px;"> </span><p class="p1"><span style="font-size:14px;">直接安装这个程序就可以了</span></p>
<span style="font-size:14px;"> </span><p class="p5"></p>
<span style="font-size:14px;"> </span><p class="p1"><span style="font-size:14px;"><b>3、安装好后的程序界面</b></span></p>
<p class="p1"><span style="font-size:14px;"><b><a target="_blank" href="/content/uploadfile/201207/25531e0c28dd5ba5704b5556c061bcf020120723053229.png" id="ematt:77"><img src="/content/uploadfile/201207/thum-25531e0c28dd5ba5704b5556c061bcf020120723053229.png" alt="点击查看原图" border="0" /></a><br />
</b></span></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/HUAWEI-E1750-on-Win7">win7下使用联通无线上网卡HUAWEI E1750</a></p></div>]]></description>
	<pubDate>Mon, 23 Jul 2012 05:28:00 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/macbook-air-use-e1750-3g-mobilecard</guid>

</item>
<item>
	<title>配置ecshop通过本地esmtp发信</title>
	<link>http://xinlogs.com/config-esmtp-via-gmail-sendmail</link>
	<description><![CDATA[<p><b><span style="font-size:24px;">问题：</span></b></p>
<p><span style="font-size:14px;">最近有个客户的ecshop总是卡在下订单的地方。查询了下日志。发现如下</span></p>
<p></p>
<pre class="brush:shell; toolbar: false;gutter: false;auto-links: false;">script_filename = /public_html/quick_buy.php
[0x0a29511c] fgets() /public_html/includes/cls_smtp.php:314
[0x0a295074] get_data() /public_html/includes/cls_smtp.php:230
[0x0a294f5c] auth() /public_html/includes/cls_smtp.php:146
[0x0a294da8] send() ~:299
[0x0a293e80] send_mail() ~:2161</pre><p></p>
<p><span style="font-size:14px;">发现问题主要是因为在ecshop里的邮件服务器设置了采用其他smtp服务器方式。我估计是到达smtp服务器验证的时间有时候太长，导致这个订单流程失败。</span></p>
<p><span style="font-size:14px;">看到ecshop推荐采用本地邮件服务来发信，于是开始考虑采用这个方式。</span></p>
<p><span style="font-size:14px;">客户的服务器采用centos的linux服务器，php 5.3.8。</span></p>
<p><span style="font-size:14px;">首先说说php的mail函数的条件，需要在php.ini里面指定sendmail_path.</span></p>
<p><span style="font-size:14px;">先说下最简单的方式，就是服务器上安装sendmail，然后调用sendmail发送邮件。</span></p>
<p><span style="font-size:14px;">如果怕服务器sendmail不正常，最好卸载下再重新安装。</span></p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;">卸载：
yum remove sendmail
安装
yum install sendmail</pre><span style="font-size:14px;">再设置下php.ini里的sendmail_path=/usr/sbin/sendmail -t -i</span><p></p>
<p><span style="font-size:14px;">这样后，就可以通过ecshop里面的本地邮件服务发信了。不过这种方式有个致命缺点，因为一般我们的服务器都不被大的邮件服务商认可，所以这样发过去的邮件基本都是被拦截后者放入垃圾邮件里。</span></p>
<p>&nbsp;</p>
<p><span style="font-size:24px;"><b>解决方法：</b></span></p>
<p><span style="font-size:14px;">还是采用本地邮件服务，不过本地只是一个代理的作用，由本地的代理程序调用gmail的stmp功能发送邮件。</span></p>
<p><span style="font-size:14px;">本地安装esmtp程序，用来将我们的邮件通过gmail的帐号发送。这样就可以避免邮件被拦截或者认为是垃圾邮件了。</span></p>
<p>&nbsp;</p>
<p><span style="font-size:14px;">为了一会测试方便，我们先安装一个linux下的邮件客户程序</span></p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;">yum install mailx</pre><span style="font-size:14px;">安装后，我们就有了mail命令。可以通过下面的命令来发信到babodx@qq.com的邮箱</span><p></p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;">echo "测试"|mail -s "ceshi" babodx@qq.com</pre><p><span style="font-size:24px;">安装esmtp：</span></p>
<p><span style="font-size:14px;">为了安装esmtp，我们必须先安装它依赖的一个库文件libesmtp-1.0.6</span></p>
<p><span style="font-size:16px;"><b>安装libesmtp-1.0.6</b></span></p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;">tar zxvf libesmtp-1.0.6.tar.gz
cd libesmtp-1.0.6
./configure
make
make install</pre><p><span style="font-size:16px;"><b>安装esmtp 1.2</b></span></p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;">tar jxvf esmtp-1.2.tar.bz2
cd esmtp-1.2
./configure --prefix=/usr/local/webserver/esmtp
make
make install</pre><p><span style="font-size:small;"><span style="line-height:24px;font-size:14px;">配置esmtp通过gmail帐号发信</span></span></p>
<p><span style="font-size:14px;line-height:24px;">vi /usr/local/webserver/esmtp/etc/esmtprc</span></p>
<p><span style="font-size:14px;line-height:24px;">内容如下</span></p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;">identity yourname@gmail.com        
        hostname smtp.gmail.com:587
        username "yourname@gmail.com"
        password "yourpasswd"
        starttls enabled
        default

mda "/usr/bin/procmail -d %T"</pre><p><span style="font-size:14px;line-height:24px;"><b>mail测试</b></span></p>
<p><span style="font-size:14px;line-height:24px;">echo "测试邮件"|mail -s "ceshi" babodx@qq.com</span></p>
<p><span style="font-size:14px;line-height:24px;">如果测试通过，我们就再将/usr/sbin/sendmail链接到/usr/local/webserver/esmtp/bin/esmtp。</span></p>
<p><span style="font-size:14px;line-height:24px;">ln -s /usr/local/webserver/esmtp/bin/esmtp /usr/sbin/sendmail</span></p>
<p><span style="font-size:14px;line-height:24px;">以后就可以在ecshop里面通过本地邮件服务发信了。并且收件人显示的发件人是你设定的gmail帐号。</span></p>
<p><span style="font-size:14px;line-height:24px;"><br />
</span></p>
<p><span style="font-size:14px;line-height:24px;"><br />
</span></p>
<p><span style="font-size:14px;line-height:24px;"><br />
</span></p>
<p></p>
<p></p>
<p></p>
<p></p>]]></description>
	<pubDate>Sun, 22 Jul 2012 13:12:15 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/config-esmtp-via-gmail-sendmail</guid>

</item>
<item>
	<title>mac下用ssh转发端口</title>
	<link>http://xinlogs.com/mac-vnc-rdp-over-ssh</link>
	<description><![CDATA[<p>起因是这样的，我在服务器上安装了个虚拟winxp。但是想要在外网远程控制却不行，因为这个虚拟系统没有公网IP。</p>
<p>我的服务器是有公网IP的，例如：210.1.1.1</p>
<p>服务器所在内网全部是10.0.1.x 网段，外网IP是通过路由器映射给服务器的，也就是说服务器上查看IP，只有10.0.1.1这个</p>
<p>&nbsp;</p>
<p>虚拟机我是用的xen，然后采用nat方式将一个192.168.122.x的ip分配给虚拟winxp使用。这个192.168.122.x段ip只有虚拟服务器和虚拟机可以访问到，就连同一个内网的10.0.1.x段其他机器都不能访问</p>
<p>我要想远程控制winxp，只有两个办法，一个是通过xen提供的vnc来访问。也就是访问10.0.1.1:5901或者外网210.1.1.1:5901</p>
<p>但是vnc的速度确实比winxp的远程桌面慢，有时候刷屏都很卡。但是winxp的ip又不能从外面访问，只能虚拟服务器自己用。</p>
<p>&nbsp;</p>
<p>后来我就想到了用ssh来做跳转，将192.168.122.1（winxp的ip）下3389端口转发过来，这样不是就可以远程通过3389访问了？</p>
<p>&nbsp;</p>
<p>因为mac下面的命令行直接支持ssh，确实比windows方面。linux下的常用命令和工具都支持！</p>
<p>我就直接在外网通过下面命令建立了ssh隧道</p>
<p></p>
<p>ssh -N -L3389:192.168.122.1:3389 root@114.251.211.103</p>
<div>其中－N表示不用显示提示符，这个选项也可以不要</div>
<div>－L表示建立一个隧道，格式：[-L [bind_address:]port:host:hostport]</div>
<div>我的这条命令就是将本地的3389端口通过ssh转发到192.168.122.1的3389端口，注意：这里的192.168.122.1必须是远程ssh服务器可以访问的。</div>
<div>这样你访问本地127.0.0.1:3389就相当于直接访问192.168.122.1:3389了</div>
<div>当然，通过调整端口也可以实现vnc的转发</div>
<div><br />
</div>
<div>其实通过ssh －D等选项，还可以建立ssh通道，让浏览器翻墙使用。这个网上资料很多，就不多说了。</div>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/mac-xdebug-netbeans-config">mac下配置php调试环境</a></p><p><a href="http://xinlogs.com/buy-macbook-air">2012 macbook Air 使用感受</a></p></div>]]></description>
	<pubDate>Fri, 13 Jul 2012 05:24:17 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/mac-vnc-rdp-over-ssh</guid>

</item>
<item>
	<title>2012 macbook Air 使用感受</title>
	<link>http://xinlogs.com/buy-macbook-air</link>
	<description><![CDATA[<p>6月底，我购买了一台2012新款macbook air笔记本。将近一个月的使用，记录下心得。</p>
<p>以前从来没有用过mac os系统，不过对于linux还是很熟悉的。</p>
<p>早就打算买一台玩玩，一个是没钱，一个是总觉得单位配的也够用。后来又打算学习下ios开发，就下决心购买一台了。</p>
<p>正好赶上6月新款发布，北京正规零售店都没有上市呢，于是在macx.cn上面看到大家都在福利社购买，于是我也去了。</p>
<p>&nbsp;</p>
<p>购买心得</p>
<p>福利社的价格还算不错，和北京官方公布的教育优化价格相当。而且是香港过来的本，一旦大陆上市还有保修。</p>
<p>我购买的是macbook air 低配版本，128G硬盘，4G内存 13'显示 价格：8500</p>
<p>购买的时候需要什么软件还可以帮助安装。我就安装了常用的虚拟机和xcode</p>
<p>&nbsp;</p>
<p>使用心得</p>
<p>用来一个月下来，感觉mac os的系统确实不错。不愧是基于unix的。稳定！</p>
<p>首先对于我经常需要服务器运维工作来说，mac os下面的软件完全可以满足</p>
<p>自带的“终端” 可以支持大部分linux下的命令，要连接远程服务器直接ssh就可以，</p>
<p>为了管理方便，我还是安装了secureCRT for mac</p>
<p>输入法用IMKQIM（搜狗的词库）</p>
<p>像office、qq、股票、远程桌面等常用软件都存在mac版本</p>
<p>使用下来，没有任何的不适应。而且手势操作也很大的提高了效率。</p>
<p>&nbsp;</p>
<p>感受最大的是电池可以使用7小时，而且不用关机。在不用的时候，直接合上笔记本就休眠了。下次打开直接就是桌面感觉和用Ipad似的。</p>
<p>&nbsp;</p>
<p>因为我需要作一些php开发，在mac下面也可以使用XAMPP for mac版本</p>
<p>编辑器我采用的是sublime text 2</p>
<p>&nbsp;</p>
<p>一个月下来，主要工作全部可以用mac系统替代了，感觉很好</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/mac-xdebug-netbeans-config">mac下配置php调试环境</a></p><p><a href="http://xinlogs.com/mac-vnc-rdp-over-ssh">mac下用ssh转发端口</a></p></div>]]></description>
	<pubDate>Fri, 13 Jul 2012 05:09:56 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/buy-macbook-air</guid>

</item>
<item>
	<title>winxp的远程桌面设置</title>
	<link>http://xinlogs.com/config-winxp-remote-desktop</link>
	<description><![CDATA[<p>最近换了mac的笔记本，由于一些程序需要跑在winxp上面，比如zmud等。。。</p>
<p>于是就在服务器上安装了xen，开了个winxp的虚拟机。本来xen支持vnc远程访问的，但是vnc感觉真心不给里，比windows自带的远程桌面慢了很多。</p>
<p>于是开始考虑使用远程桌面，可是winxp不是服务器版本，所以远程桌面有一些限制。</p>
<p>一个是解决多用户登陆问题</p>
<p>下面是网上找到的解决办法，测试好用</p>
<p></p>
<p><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;">Windows XP不支持多个用户同时登录远程桌面，当其他用户远程登录Windows XP时，</span><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;">主机上当前已登录的用户</span></p>
<p><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;">即会自动退出。不过在Windows XP SP2中提供了允许连接会话并发功能，可通过远程桌面进行多用户的同时登录，</span></p>
<p><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;">但其在默认状态下关闭了该项特性，需要通过修改注册表开启该功能。 </span></p>
<p><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;">打开注册表编辑器，依次展开</span></p>
<p><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;">“HKEY_LOCAL_MACHINE\System </span><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;">\CurrentControlSet\Control\Terminal Server\Licensing Core”分支，</span></p>
<p><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;">转到右侧窗口，在其中新建一个类型为DWORD的子键，将该键命名为“EnableConcurrentSessions”，</span></p>
<p><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;">并将键值设置为“1”，即可开启多用户登录功能。 </span></p>
<p><span style="font-family:Verdana;font-size:small;line-height:23px;text-align:left;white-space:pre;"><br />
</span></p>
<p style="text-align:left;"><span style="font-family:Verdana;font-size:x-small;"><span style="line-height:23px;white-space:pre;">还有就是空密码登陆问题，因为winxp就是平时随便用用，每次输入密码太麻烦。但是远程桌面默认空密码不让登陆</span></span></p>
<p style="text-align:left;"><span style="font-family:Verdana;font-size:x-small;"><span style="line-height:23px;white-space:pre;">解决办法如下</span></span></p>
<p style="text-align:left;"><span style="font-family:Verdana;font-size:x-small;"><span style="line-height:23px;white-space:pre;">在运行里，输入gpedit.msc调出组策略界面</span></span></p>
<p style="text-align:left;"><span style="font-family:Verdana;font-size:x-small;"><span style="line-height:23px;white-space:pre;">依次找到“计算机配置”－》“windows设置”－》“安全设置”－》“本地策略”－》“安全选项”</span></span></p>
<p style="text-align:left;"><span style="font-family:Verdana;font-size:x-small;"><span style="line-height:23px;white-space:pre;">将其中的“帐户：使用空白密码的本地帐户只运行使用控制台登陆”禁用掉。</span></span></p>
<p style="text-align:left;"></p>
<p style="text-align:left;"><span style="font-family:Verdana;font-size:x-small;"><span style="line-height:23px;white-space:pre;">通过上面的设置就ok了</span></span></p>
<p></p>]]></description>
	<pubDate>Fri, 13 Jul 2012 03:25:32 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/config-winxp-remote-desktop</guid>

</item>
<item>
	<title>Linux防御DDOS攻击</title>
	<link>http://xinlogs.com/linux-ddos-defender</link>
	<description><![CDATA[<p>这两天一个以前客户在万网购买的云主机一直被SYN Flood 攻击。</p>
<p>其实SYN Flood到是只能拖慢系统，没到死机的地步。问题是万网发现了DDOS攻击后，直接给云主机断网24小时。</p>
<p>这个处理太恶心了。不说想办法切断攻击的IP，而是直接断掉客户的网络。。。有点说不过去呀</p>
<p>电话咨询了下，他们是系统自动处理的，发现了直接断网。</p>
<p>&nbsp;</p>
<p>一般应付DDOS攻击主要是调整SYN相关的内核参数，这个可以从/etc/sysctl.conf入手调整。</p>
<p>再有就是添加iptables规则，来限制syn和连接数量</p>
<p>最后就是通过脚本检查netstat状态，自动将连接数多的ip封掉。</p>
<p>一般linux系统能做到的就这些了，那些可以防ddos的硬防火墙老百姓搞不起。</p>
<p>&nbsp;</p>
<p>调整syn相关参数和iptables网上资料很多，我就不说了。</p>
<p>整段封IP的话，可以用</p>
<p>iptables -I INPUT -s 192.0.0.0/8 -j DROP #来封掉192开头的全部ip</p>
<p>&nbsp;</p>
<p>我是通过查看messages日志文件，发现了一些大量连接的IP。然后先手动封掉这些IP。下面是部分日志信息，当然这个是靠配置iptables来实现的日志</p>
<p></p>
<p>Mar 20 21:51:21 uhz001737 kernel: HTTP_ATTACK:IN=eth1 OUT= MAC=00:16:3e:00:5d:d3:c0:62:6b:ac:ea:c1:08:00 SRC=157.55.16.56 DST=223.4.118.120 LEN=48 TOS=0x1C PREC=0x20 TTL=112 ID=16250 DF PROTO=TCP SPT=61923 DPT=80 WINDOW=8192 RES=0x00 SYN URGP=0&nbsp;</p>
<p>Mar 20 21:51:27 uhz001737 kernel: HTTP_ATTACK:IN=eth1 OUT= MAC=00:16:3e:00:5d:d3:c0:62:6b:ac:ea:c1:08:00 SRC=157.55.16.56 DST=223.4.118.120 LEN=48 TOS=0x1C PREC=0x20 TTL=112 ID=21741 DF PROTO=TCP SPT=61923 DPT=80 WINDOW=8192 RES=0x00 SYN URGP=0&nbsp;</p>
<p>Mar 20 21:51:29 uhz001737 kernel: HTTP_ATTACK:IN=eth1 OUT= MAC=00:16:3e:00:5d:d3:c0:62:6b:ac:ed:c1:08:00 SRC=157.55.16.178 DST=223.4.118.120 LEN=48 TOS=0x1C PREC=0x20 TTL=112 ID=28201 DF PROTO=TCP SPT=14521 DPT=80 WINDOW=8192 RES=0x00 SYN URGP=0&nbsp;</p>
<p>Mar 20 21:51:29 uhz001737 kernel: HTTP_ATTACK:IN=eth1 OUT= MAC=00:16:3e:00:5d:d3:c0:62:6b:ac:ed:c1:08:00 SRC=157.55.16.178 DST=223.4.118.120 LEN=48 TOS=0x1C PREC=0x20 TTL=112 ID=29875 DF PROTO=TCP SPT=14588 DPT=80 WINDOW=8192 RES=0x00 SYN URGP=0&nbsp;</p>
<div><br />
</div>
<div>最后在介绍一款linux下防止DDOS的软件：DDoS-Defender-v2.1.0.tar.gz</div>
<div>其实DDOS也是通过分析netstat状态来判断大量连接的IP，然后采取封掉的策略。并可以设置封掉多久后自动解除。</div>
<div><br />
</div>
<div>基本经过上面的配置，现在万网没有再因为DDOS问题断网24小时了。</div>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/17">如何快速统计服务器访问量</a></p><p><a href="http://xinlogs.com/Centos-install-mudos">CENTOS下安装MUDOS跑侠客行</a></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/centos-linux-sshclient-unreadable-code">Centos Linux 远程终端ssh乱码问题</a></p><p><a href="http://xinlogs.com/tomcat-memory-check">监控tomcat内存占用</a></p></div>]]></description>
	<pubDate>Wed, 21 Mar 2012 15:01:22 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/linux-ddos-defender</guid>

</item>
<item>
	<title>monit监控linux服务</title>
	<link>http://xinlogs.com/monit-to-monitor-services</link>
	<description><![CDATA[<p>最近负责的两台服务器需要监控nginx和memcached服务，防止网站访问异常。</p>
<p>我用monit来解决这个需求。</p>
<p>monit是一款linux下的开源软件，可以负责监控系统的服务、进程、文件等内容，并设置一定的条件下执行特定的action。</p>
<p>我们可以通过配置，让monit来检查网站的状态和memcached的状态，发现异常的时候，自动重启服务并邮件通知我们。</p>
<p>我配置了30s检查一次，出现问题发送邮件到我的gmail邮箱。我手机马上就能收到邮件提醒，非常效率。</p>
<p>&nbsp;</p>
<p>安装配置步骤：</p>
<p>下载monit</p>
<p></p>
<div id="kindeditor" class="quote">wget&nbsp;http://mmonit.com/monit/dist/monit-5.3.2.tar.gz</div>
<p></p>
<p>&nbsp;</p>
<p>解压并安装</p>
<p></p>
<div id="kindeditor" class="quote"><p><span style="color:#000000;">tar zxvf&nbsp;</span><span class="Apple-style-span" style="font-size:12px;line-height:18px;color:#000000;">monit-5.3.2.tar.gz</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;color:#000000;">cd&nbsp;</span><span class="Apple-style-span" style="font-size:12px;line-height:18px;color:#000000;">monit-5.3.2</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">./configure --prefix=/usr/local/monit</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">make</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">make install</span></p>
</div>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">配置</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">先将默认的配置文件拷贝到/etc目录下，然后编辑monitrc文件</span></p>
<p></p>
<div id="kindeditor" class="quote">cp monitrc /etc/</div>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">下面是我的一些配置：</span></p>
<p></p>
<div id="kindeditor" class="quote"><p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">set daemon &nbsp;30 &nbsp; #设置30s检查一次</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">set logfile /var/log/monit.log &nbsp; #设定日志文件</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">#设定邮件</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">set mailserver smtp.gmail.com PORT 587 USERNAME "yourname@gmail.com" PASSWORD "yourpassword" USING tlsv1&nbsp;</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">#设定邮件格式</span></p>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">set mail-format {</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; from: monit@huaximall.com</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; subject: monit alert -- &nbsp;$EVENT $SERVICE</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; message: $EVENT Service $SERVICE</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Date: &nbsp; &nbsp; &nbsp; &nbsp;$DATE</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Action: &nbsp; &nbsp; &nbsp;$ACTION</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Host: &nbsp; &nbsp; &nbsp; &nbsp;xinlogs.com</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Description: $DESCRIPTION</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Your faithful employee,</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Monit</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">}</span></p>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">#设定提醒超时</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">set alert babodx@gmail.com with reminder on 3 cycles</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">#设定检查nginx服务</span></p>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">check process nginx with pidfile /usr/local/webserver/nginx-1.0.11/nginx.pid</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; start program = "/usr/local/webserver/nginx-1.0.11/sbin/nginx"</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; stop program = "/usr/bin/killall nginx"</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; if failed host xinlogs.com port 80 protocol http</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp;and request "/t.html"</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp;then restart</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; if 2 restarts within 3 cycles then timeout</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">#设定检查memcached服务</span></p>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">check process memcached with pidfile /var/run/memcache.pid</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; start program = "/usr/local/memcached/bin/memcached -d -m 1024 -u root -p 11211 -c 1024 -P /var/run/memcache.pid"</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; stop program = "/bin/kill -9 `cat /var/run/memcache.pid`; rm /var/run/memcached.pid"</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; if failed host 127.0.0.1 port 11211 protocol MEMCACHE then restart</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; if cpu &gt; 60% for 2 cycles then alert</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; if cpu &gt; 98% for 5 cycles then restart</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; if 2 restarts within 3 cycles then timeout</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; &nbsp; &nbsp; group cache</span></p>
<p></p>
<p></p>
<p></p>
</div>
<p></p>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">下面再贴出来提醒的邮件样子给大家看看</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">这个是检查到nginx被终止后的提醒邮件</span></p>
<p></p>
<div id="kindeditor" class="quote"><span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">Does not exist Service nginx</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Date: &nbsp; &nbsp; &nbsp; &nbsp;Thu, 02 Feb 2012 11:31:50</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Action: &nbsp; &nbsp; &nbsp;restart</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Host: &nbsp; &nbsp; &nbsp; &nbsp;xinlogs.com</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Description: process is not running</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Your faithful employee,</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Monit</span></div>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">下面是自动恢复nginx服务后的提醒邮件</span></p>
<p></p>
<div id="kindeditor" class="quote"><span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">Exists Service nginx</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Date: &nbsp; &nbsp; &nbsp; &nbsp;Thu, 02 Feb 2012 11:32:28</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Action: &nbsp; &nbsp; &nbsp;alert</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Host: &nbsp; &nbsp; &nbsp; &nbsp;xinlogs.com</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Description: process is running with pid 6894</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Your faithful employee,</span><br style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);" />
<span class="Apple-style-span" style="color:#222222;font-family:arial, sans-serif;font-size:14px;line-height:normal;background-color:rgba(255, 255, 255, 0.917969);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Monit</span></div>
<p></p>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">有了这些就可以安心了，万一网站访问异常了。monit会尝试自动恢复的，而且第一时间通知我们。因为我的vps在美国，所以发送到gmail很及时。手机再设置个邮件提醒功能，基本就ok了。</span></p>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/linux-ddos-defender">Linux防御DDOS攻击</a></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p><p><a href="http://xinlogs.com/vps-dropbox-install">一款Linux下同步备份文件的好软件DROPBOX</a></p><p><a href="http://xinlogs.com/OpenVPN-Install">CentOS 5.3下OpenVPN安装和Win7下OpenVPN GUI安装</a></p><p><a href="http://xinlogs.com/Centos-install-mudos">CENTOS下安装MUDOS跑侠客行</a></p></div>]]></description>
	<pubDate>Thu, 02 Feb 2012 13:33:45 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/monit-to-monitor-services</guid>

</item>
<item>
	<title>php eaccelerator vs fastcgi_cache性能比较</title>
	<link>http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache</link>
	<description><![CDATA[<div>【原创】转载请注明出处 http://xinlogs.com</div>
<div>最近放假一直在家里测试php如何优化性能。</div>
<div>今天比较了下默认php、eaccelerator和fastcgi_cache的性能。</div>
<div><br />
</div>
<div>先介绍下我的测试环境：</div>
<div>这次是在我VPS上做的测试：cpu 为1颗Intel(R) Core(TM) i7-2600 CPU @ 3.40GHz，内存256M</div>
<div>系统为centos 5.6 32bit</div>
<div>php版本 5.3.8</div>
<div>web服务采用Tengine/1.2.1，其实就是nginx</div>
<div><br />
</div>
<div>测试文件一个采用phpinfo.php，这个就是phpinfo()函数输出页面。另外一个就是采用我博客首页http://xinlogs.com</div>
<div>注：我的博客采用emlog 4.1</div>
<div>下面进入我的测试。。。。</div>
<div><br />
</div>
<div>php先用默认状态，不加载eaccelerator模块。</div>
<div>测试phpinfo.php,连续访问3000次，采用10个并发请求。</div>
<div></div>
<div id="kindeditor" class="quote"><div>ab -n 3000 -c 10 http://xinlogs.com/phpinfo.php</div>
<div>Server Software: &nbsp; &nbsp; &nbsp; &nbsp;Tengine/1.2.1</div>
<div>Server Hostname: &nbsp; &nbsp; &nbsp; &nbsp;xinlogs.com</div>
<div>Server Port: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;80</div>
<div><br />
</div>
<div>Document Path: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/phpinfo.php</div>
<div>Document Length: &nbsp; &nbsp; &nbsp; &nbsp;54365 bytes</div>
<div><br />
</div>
<div>Concurrency Level: &nbsp; &nbsp; &nbsp;10</div>
<div>Time taken for tests: &nbsp; 7.557223 seconds</div>
<div>Complete requests: &nbsp; &nbsp; &nbsp;3000</div>
<div>Failed requests: &nbsp; &nbsp; &nbsp; &nbsp;0</div>
<div>Write errors: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</div>
<div>Total transferred: &nbsp; &nbsp; &nbsp;163608000 bytes</div>
<div>HTML transferred: &nbsp; &nbsp; &nbsp; 163095000 bytes</div>
<div>Requests per second: &nbsp; &nbsp;396.97 [#/sec] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 25.191 [ms] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 2.519 [ms] (mean, across all concurrent requests)</div>
<div>Transfer rate: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;21141.76 [Kbytes/sec] received</div>
<div><br />
</div>
<div>Connection Times (ms)</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; min &nbsp;mean[+/-sd] median &nbsp; max</div>
<div>Connect: &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;0 &nbsp; 0.0 &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; 2</div>
<div>Processing: &nbsp; &nbsp; 9 &nbsp; 24 &nbsp;52.3 &nbsp; &nbsp; 25 &nbsp; &nbsp;2432</div>
<div>Waiting: &nbsp; &nbsp; &nbsp; &nbsp;9 &nbsp; 24 &nbsp;52.2 &nbsp; &nbsp; 25 &nbsp; &nbsp;2431</div>
<div>Total: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9 &nbsp; 24 &nbsp;52.3 &nbsp; &nbsp; 25 &nbsp; &nbsp;2432</div>
<div><br />
</div>
<div>Percentage of the requests served within a certain time (ms)</div>
<div>&nbsp; 50% &nbsp; &nbsp; 25</div>
<div>&nbsp; 66% &nbsp; &nbsp; 28</div>
<div>&nbsp; 75% &nbsp; &nbsp; 29</div>
<div>&nbsp; 80% &nbsp; &nbsp; 29</div>
<div>&nbsp; 90% &nbsp; &nbsp; 31</div>
<div>&nbsp; 95% &nbsp; &nbsp; 32</div>
<div>&nbsp; 98% &nbsp; &nbsp; 34</div>
<div>&nbsp; 99% &nbsp; &nbsp; 36</div>
<div>&nbsp;100% &nbsp; 2432 (longest request)</div>
</div>
<div></div>
<div><br />
</div>
<div>可以看到每秒大约处理396.97 [#/sec] (mean)。99%响应时间在36ms以内</div>
<div>我又测试了几次，基本每秒处理在390到450浮动，响应时间在45ms以内吧。</div>
<div><br />
</div>
<div>再来看看我博客首页的测试情况</div>
<div></div>
<div id="kindeditor" class="quote"><div>ab -n 3000 -c 10 http://xinlogs.com/</div>
<div>Server Software: &nbsp; &nbsp; &nbsp; &nbsp;Tengine/1.2.1</div>
<div>Server Hostname: &nbsp; &nbsp; &nbsp; &nbsp;xinlogs.com</div>
<div>Server Port: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;80</div>
<div><br />
</div>
<div>Document Path: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/</div>
<div>Document Length: &nbsp; &nbsp; &nbsp; &nbsp;21494 bytes</div>
<div><br />
</div>
<div>Concurrency Level: &nbsp; &nbsp; &nbsp;10</div>
<div>Time taken for tests: &nbsp; 52.787368 seconds</div>
<div>Complete requests: &nbsp; &nbsp; &nbsp;3000</div>
<div>Failed requests: &nbsp; &nbsp; &nbsp; &nbsp;2970</div>
<div>&nbsp; &nbsp;(Connect: 0, Length: 2970, Exceptions: 0)</div>
<div>Write errors: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</div>
<div>Total transferred: &nbsp; &nbsp; &nbsp;64990449 bytes</div>
<div>HTML transferred: &nbsp; &nbsp; &nbsp; 64432449 bytes</div>
<div>Requests per second: &nbsp; &nbsp;56.83 [#/sec] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 175.958 [ms] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 17.596 [ms] (mean, across all concurrent requests)</div>
<div>Transfer rate: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1202.31 [Kbytes/sec] received</div>
<div><br />
</div>
<div>Connection Times (ms)</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; min &nbsp;mean[+/-sd] median &nbsp; max</div>
<div>Connect: &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;0 &nbsp; 0.0 &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; 0</div>
<div>Processing: &nbsp; &nbsp; 9 &nbsp;175 661.8 &nbsp; &nbsp;127 &nbsp; 18091</div>
<div>Waiting: &nbsp; &nbsp; &nbsp; &nbsp;9 &nbsp;174 661.9 &nbsp; &nbsp;126 &nbsp; 18091</div>
<div>Total: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9 &nbsp;175 661.8 &nbsp; &nbsp;127 &nbsp; 18091</div>
<div><br />
</div>
<div>Percentage of the requests served within a certain time (ms)</div>
<div>&nbsp; 50% &nbsp; &nbsp;127</div>
<div>&nbsp; 66% &nbsp; &nbsp;149</div>
<div>&nbsp; 75% &nbsp; &nbsp;166</div>
<div>&nbsp; 80% &nbsp; &nbsp;178</div>
<div>&nbsp; 90% &nbsp; &nbsp;199</div>
<div>&nbsp; 95% &nbsp; &nbsp;210</div>
<div>&nbsp; 98% &nbsp; &nbsp;226</div>
<div>&nbsp; 99% &nbsp; &nbsp;348</div>
<div>&nbsp;100% &nbsp;18091 (longest request)</div>
</div>
<div></div>
<div>可以看到每秒处理56.83 [#/sec] (mean)请求，99%的响应时间在348ms内</div>
<div>多次测试后，基本保持在每秒处理55-60个请求，响应时间基本在350ms内。</div>
<div><br />
</div>
<div>接着我开启php的eaccelerator模块,开启后的phpinfo信息如下：</div>
<div></div>
<div id="kindeditor" class="quote"><div>This program makes use of the Zend Scripting Language Engine:</div>
<div>Zend Engine v2.3.0, Copyright (c) 1998-2011 Zend Technologies</div>
<div>&nbsp; &nbsp; with eAccelerator v0.9.6.1, Copyright (c) 2004-2010 eAccelerator, by eAccelerator</div>
</div>
<div></div>
<div><br />
</div>
<div>我们再次测试phpinfo.php文件</div>
<div></div>
<div id="kindeditor" class="quote"><div>ab -n 3000 -c 10 http://xinlogs.com/phpinfo.php</div>
<div><br />
</div>
<div>Server Software: &nbsp; &nbsp; &nbsp; &nbsp;Tengine/1.2.1</div>
<div>Server Hostname: &nbsp; &nbsp; &nbsp; &nbsp;xinlogs.com</div>
<div>Server Port: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;80</div>
<div><br />
</div>
<div>Document Path: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/phpinfo.php</div>
<div>Document Length: &nbsp; &nbsp; &nbsp; &nbsp;56845 bytes</div>
<div><br />
</div>
<div>Concurrency Level: &nbsp; &nbsp; &nbsp;10</div>
<div>Time taken for tests: &nbsp; 7.128081 seconds</div>
<div>Complete requests: &nbsp; &nbsp; &nbsp;3000</div>
<div>Failed requests: &nbsp; &nbsp; &nbsp; &nbsp;0</div>
<div>Write errors: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</div>
<div>Total transferred: &nbsp; &nbsp; &nbsp;171333080 bytes</div>
<div>HTML transferred: &nbsp; &nbsp; &nbsp; 170819225 bytes</div>
<div>Requests per second: &nbsp; &nbsp;420.87 [#/sec] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 23.760 [ms] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 2.376 [ms] (mean, across all concurrent requests)</div>
<div>Transfer rate: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;23472.94 [Kbytes/sec] received</div>
<div><br />
</div>
<div>Connection Times (ms)</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; min &nbsp;mean[+/-sd] median &nbsp; max</div>
<div>Connect: &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;9 &nbsp; 7.9 &nbsp; &nbsp; &nbsp;9 &nbsp; &nbsp; &nbsp;40</div>
<div>Processing: &nbsp; &nbsp; 2 &nbsp; 13 &nbsp;13.6 &nbsp; &nbsp; 12 &nbsp; &nbsp; 620</div>
<div>Waiting: &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;9 &nbsp;13.2 &nbsp; &nbsp; &nbsp;8 &nbsp; &nbsp; 603</div>
<div>Total: &nbsp; &nbsp; &nbsp; &nbsp; 12 &nbsp; 23 &nbsp;13.6 &nbsp; &nbsp; 23 &nbsp; &nbsp; 623</div>
<div><br />
</div>
<div>Percentage of the requests served within a certain time (ms)</div>
<div>&nbsp; 50% &nbsp; &nbsp; 23</div>
<div>&nbsp; 66% &nbsp; &nbsp; 29</div>
<div>&nbsp; 75% &nbsp; &nbsp; 31</div>
<div>&nbsp; 80% &nbsp; &nbsp; 31</div>
<div>&nbsp; 90% &nbsp; &nbsp; 32</div>
<div>&nbsp; 95% &nbsp; &nbsp; 34</div>
<div>&nbsp; 98% &nbsp; &nbsp; 37</div>
<div>&nbsp; 99% &nbsp; &nbsp; 39</div>
<div>&nbsp;100% &nbsp; &nbsp;623 (longest request)</div>
</div>
<div></div>
<div>从结果来看，加了eAccelerator后，phpinfo.php的测试结果并不是很快。每秒处理420.87请求，偶尔还会在380左右。并没有明显变化。</div>
<div><br />
</div>
<div>再来看看博客首页的测试。</div>
<div></div>
<div id="kindeditor" class="quote"><div>ab -n 3000 -c 10 http://xinlogs.com/</div>
<div>Server Software: &nbsp; &nbsp; &nbsp; &nbsp;Tengine/1.2.1</div>
<div>Server Hostname: &nbsp; &nbsp; &nbsp; &nbsp;xinlogs.com</div>
<div>Server Port: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;80</div>
<div><br />
</div>
<div>Document Path: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/</div>
<div>Document Length: &nbsp; &nbsp; &nbsp; &nbsp;21488 bytes</div>
<div><br />
</div>
<div>Concurrency Level: &nbsp; &nbsp; &nbsp;10</div>
<div>Time taken for tests: &nbsp; 23.177888 seconds</div>
<div>Complete requests: &nbsp; &nbsp; &nbsp;3000</div>
<div>Failed requests: &nbsp; &nbsp; &nbsp; &nbsp;2970</div>
<div>&nbsp; &nbsp;(Connect: 0, Length: 2970, Exceptions: 0)</div>
<div>Write errors: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</div>
<div>Total transferred: &nbsp; &nbsp; &nbsp;64929588 bytes</div>
<div>HTML transferred: &nbsp; &nbsp; &nbsp; 64371588 bytes</div>
<div>Requests per second: &nbsp; &nbsp;129.43 [#/sec] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 77.260 [ms] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 7.726 [ms] (mean, across all concurrent requests)</div>
<div>Transfer rate: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2735.67 [Kbytes/sec] received</div>
<div><br />
</div>
<div>Connection Times (ms)</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; min &nbsp;mean[+/-sd] median &nbsp; max</div>
<div>Connect: &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;0 &nbsp; 1.0 &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;23</div>
<div>Processing: &nbsp; &nbsp; 4 &nbsp; 76 582.2 &nbsp; &nbsp; 31 &nbsp; 13655</div>
<div>Waiting: &nbsp; &nbsp; &nbsp; &nbsp;4 &nbsp; 76 582.2 &nbsp; &nbsp; 31 &nbsp; 13655</div>
<div>Total: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 &nbsp; 76 582.2 &nbsp; &nbsp; 31 &nbsp; 13655</div>
<div><br />
</div>
<div>Percentage of the requests served within a certain time (ms)</div>
<div>&nbsp; 50% &nbsp; &nbsp; 31</div>
<div>&nbsp; 66% &nbsp; &nbsp; 46</div>
<div>&nbsp; 75% &nbsp; &nbsp; 55</div>
<div>&nbsp; 80% &nbsp; &nbsp; 58</div>
<div>&nbsp; 90% &nbsp; &nbsp; 69</div>
<div>&nbsp; 95% &nbsp; &nbsp; 80</div>
<div>&nbsp; 98% &nbsp; &nbsp;100</div>
<div>&nbsp; 99% &nbsp; &nbsp;129</div>
<div>&nbsp;100% &nbsp;13655 (longest request)</div>
</div>
<div></div>
<div>从博客首页的测试可以发现，用了eAccelerator的效果还是很明显的。每秒处理请求129.43 [#/sec] (mean)，99%的响应时间在129ms内完成。</div>
<div>这个结果比不用eaccelerator的情况下，高了1倍多。</div>
<div><br />
</div>
<div>个人认为eAccelerator因为减少了php每次编译时间，所以当php程序需要调用很多类，或者调用其他php文件的时候。这个优化就体现出来了。就想我上面的测试，博客首页的加载确实快了，每秒处理的请求也多了。但是想phpinfo.php这样只有一个文件，并且只是简单的输出phpinfo信息的页面，eaccelerator起到的优化就很少了。</div>
<div><br />
</div>
<div>下面我们再来测试下fastcgi_cache有多快，这个就是缓存，完全不是优化php执行速度了，而是直接缓存上结果，下次直接调用缓存。</div>
<div><br />
</div>
<div>我们先用curl请求2次phpinfo.php 确定已经缓存上，再来测试。</div>
<div></div>
<div id="kindeditor" class="quote"><div>-bash-3.2# curl -I http://xinlogs.com/phpinfo.php</div>
<div>HTTP/1.1 200 OK</div>
<div>Server: Tengine/1.2.1</div>
<div>Date: Thu, 19 Jan 2012 07:09:23 GMT</div>
<div>Content-Type: text/html</div>
<div>Connection: keep-alive</div>
<div>Vary: Accept-Encoding</div>
<div>X-Powered-By: PHP/5.3.8</div>
<div>X-Cache: HIT</div>
<div><br />
</div>
<div>ab -n 3000 -c 10 http://xinlogs.com/phpinfo.php</div>
<div>Server Software: &nbsp; &nbsp; &nbsp; &nbsp;Tengine/1.2.1</div>
<div>Server Hostname: &nbsp; &nbsp; &nbsp; &nbsp;xinlogs.com</div>
<div>Server Port: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;80</div>
<div><br />
</div>
<div>Document Path: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/phpinfo.php</div>
<div>Document Length: &nbsp; &nbsp; &nbsp; &nbsp;58255 bytes</div>
<div><br />
</div>
<div>Concurrency Level: &nbsp; &nbsp; &nbsp;10</div>
<div>Time taken for tests: &nbsp; 0.656969 seconds</div>
<div>Complete requests: &nbsp; &nbsp; &nbsp;3000</div>
<div>Failed requests: &nbsp; &nbsp; &nbsp; &nbsp;0</div>
<div>Write errors: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</div>
<div>Total transferred: &nbsp; &nbsp; &nbsp;175320000 bytes</div>
<div>HTML transferred: &nbsp; &nbsp; &nbsp; 174765000 bytes</div>
<div>Requests per second: &nbsp; &nbsp;4566.43 [#/sec] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 2.190 [ms] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 0.219 [ms] (mean, across all concurrent requests)</div>
<div>Transfer rate: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;260605.90 [Kbytes/sec] received</div>
<div><br />
</div>
<div>Connection Times (ms)</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; min &nbsp;mean[+/-sd] median &nbsp; max</div>
<div>Connect: &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;0 &nbsp; 0.0 &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; 0</div>
<div>Processing: &nbsp; &nbsp; 0 &nbsp; &nbsp;1 &nbsp; 1.1 &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; 4</div>
<div>Waiting: &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;1 &nbsp; 0.9 &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; 4</div>
<div>Total: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;1 &nbsp; 1.1 &nbsp; &nbsp; &nbsp;1 &nbsp; &nbsp; &nbsp; 4</div>
<div><br />
</div>
<div>Percentage of the requests served within a certain time (ms)</div>
<div>&nbsp; 50% &nbsp; &nbsp; &nbsp;1</div>
<div>&nbsp; 66% &nbsp; &nbsp; &nbsp;2</div>
<div>&nbsp; 75% &nbsp; &nbsp; &nbsp;2</div>
<div>&nbsp; 80% &nbsp; &nbsp; &nbsp;3</div>
<div>&nbsp; 90% &nbsp; &nbsp; &nbsp;3</div>
<div>&nbsp; 95% &nbsp; &nbsp; &nbsp;3</div>
<div>&nbsp; 98% &nbsp; &nbsp; &nbsp;4</div>
<div>&nbsp; 99% &nbsp; &nbsp; &nbsp;4</div>
<div>&nbsp;100% &nbsp; &nbsp; &nbsp;4 (longest request)</div>
</div>
<div></div>
<div><br />
</div>
<div><br />
</div>
<div>看到什么是速度了吧。。。每秒处理请求 4566.43 [#/sec] (mean)，响应时间4ms以内完成。</div>
<div>这个就是fastcgi_cache的速度了.</div>
<div><br />
</div>
<div>也许一个phpinfo.php页面不能说明问题，我们再来看看博客首页的情况</div>
<div><br />
</div>
<div></div>
<div id="kindeditor" class="quote"><div>ab -n 3000 -c 10 http://xinlogs.com/</div>
<div><br />
</div>
<div>Server Software: &nbsp; &nbsp; &nbsp; &nbsp;Tengine/1.2.1</div>
<div>Server Hostname: &nbsp; &nbsp; &nbsp; &nbsp;xinlogs.com</div>
<div>Server Port: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;80</div>
<div><br />
</div>
<div>Document Path: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/</div>
<div>Document Length: &nbsp; &nbsp; &nbsp; &nbsp;21485 bytes</div>
<div><br />
</div>
<div>Concurrency Level: &nbsp; &nbsp; &nbsp;10</div>
<div>Time taken for tests: &nbsp; 0.578070 seconds</div>
<div>Complete requests: &nbsp; &nbsp; &nbsp;3000</div>
<div>Failed requests: &nbsp; &nbsp; &nbsp; &nbsp;0</div>
<div>Write errors: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</div>
<div>Total transferred: &nbsp; &nbsp; &nbsp;65055000 bytes</div>
<div>HTML transferred: &nbsp; &nbsp; &nbsp; 64455000 bytes</div>
<div>Requests per second: &nbsp; &nbsp;5189.68 [#/sec] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 1.927 [ms] (mean)</div>
<div>Time per request: &nbsp; &nbsp; &nbsp; 0.193 [ms] (mean, across all concurrent requests)</div>
<div>Transfer rate: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;109900.19 [Kbytes/sec] received</div>
<div><br />
</div>
<div>Connection Times (ms)</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; min &nbsp;mean[+/-sd] median &nbsp; max</div>
<div>Connect: &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;0 &nbsp; 0.0 &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; 0</div>
<div>Processing: &nbsp; &nbsp; 0 &nbsp; &nbsp;1 &nbsp; 0.8 &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; 3</div>
<div>Waiting: &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;1 &nbsp; 0.8 &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; 3</div>
<div>Total: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp;1 &nbsp; 0.8 &nbsp; &nbsp; &nbsp;2 &nbsp; &nbsp; &nbsp; 3</div>
<div>WARNING: The median and mean for the processing time are not within a normal deviation</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; These results are probably not that reliable.</div>
<div>WARNING: The median and mean for the waiting time are not within a normal deviation</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; These results are probably not that reliable.</div>
<div>WARNING: The median and mean for the total time are not within a normal deviation</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; These results are probably not that reliable.</div>
<div><br />
</div>
<div>Percentage of the requests served within a certain time (ms)</div>
<div>&nbsp; 50% &nbsp; &nbsp; &nbsp;2</div>
<div>&nbsp; 66% &nbsp; &nbsp; &nbsp;2</div>
<div>&nbsp; 75% &nbsp; &nbsp; &nbsp;2</div>
<div>&nbsp; 80% &nbsp; &nbsp; &nbsp;2</div>
<div>&nbsp; 90% &nbsp; &nbsp; &nbsp;2</div>
<div>&nbsp; 95% &nbsp; &nbsp; &nbsp;2</div>
<div>&nbsp; 98% &nbsp; &nbsp; &nbsp;2</div>
<div>&nbsp; 99% &nbsp; &nbsp; &nbsp;3</div>
<div>&nbsp;100% &nbsp; &nbsp; &nbsp;3 (longest request)</div>
</div>
<div></div>
<div>再看看首页，因为采用了fastcgi_cache，每秒处理请求5189.68 [#/sec] (mean)，响应时间3ms内完成。</div>
<div><br />
</div>
<div>性能比较表格(主要提供每秒处理数做比较)</div>
<div><br />
</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 请求文件长度 &nbsp; &nbsp;php默认 &nbsp; &nbsp; eAccelerator加速模式 &nbsp; &nbsp; &nbsp;fastcgi_cache模式</div>
<div>phpinfo.php &nbsp; &nbsp; 58255 bytes &nbsp; &nbsp; 396.97 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;420.87 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4566.43&nbsp;</div>
<div>博客首页 &nbsp; &nbsp; &nbsp; &nbsp;21485 bytes &nbsp; &nbsp; &nbsp;56.83 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 129.43 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5189.68&nbsp;</div>
<div><br />
</div>
<div><b><span style="font-size:18px;">总结：</span></b></div>
<div>上面的测试虽然不是很严谨，但是通过这些已经可以发现fastcgi_cache的优势了，通过缓存php结果，大幅提升请求处理能力。</div>
<div>一般程序再通过eaccelerator模式加速后，可以提升2-3倍性能，而fastcgi_cache缓存的性能提升大约在10倍。</div>
<div><br />
</div>
<div>不过fastcgi_cache的应用也有它的弊端，就是要通过程序控制好刷新和不缓存内容。不然登陆后的用户都显示一个界面，或者发布的消息迟迟不能显示在首页都是它要解决的问题。</div>
<div><br />
</div>
<div>一般用户还是建议采用eaccelerator模块加速，因为这样基本无需修改代码，最容易实现。fastcgi_cache很难在不调整代码的情况下使用，因为他会缓存全部php文件，至少我的博客在启用了fastcgi_cache后，后台不正常。</div>
<div><br />
</div>
<div><br />
</div>
<div><br />
</div><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/check-slow-php-script">如何找到执行慢的php程序</a></p><p><a href="http://xinlogs.com/linux-ddos-defender">Linux防御DDOS攻击</a></p><p><a href="http://xinlogs.com/accelerate-app-store-download">快速提升app store下载速度</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/find-php-slow-code">php-fpm查找php慢速代码</a></p></div>]]></description>
	<pubDate>Thu, 19 Jan 2012 07:36:26 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache</guid>

</item>
<item>
	<title>centos 单独安装apachebench</title>
	<link>http://xinlogs.com/install-ApacheBench-on-CentOS-without-Apache</link>
	<description><![CDATA[<p>这两天在测试php性能优化方法。</p>
<p>为了做压力测试可观察效果，就选择了ApacheBench来作为压力测试工具。其实就是大家常说的ab。</p>
<p>但是这个工具是安装apache web server的时候自带的，现在我服务器上都是跑nginx。也不想为了用这个工具就再装个apache。所以在用下面方法单独安装ab工具，这里记录下步骤。</p>
<p>&nbsp;</p>
<p>首先安装ab运行需要的软件包apr-util</p>
<p></p>
<div id="kindeditor" class="quote">yum install apr-util</div>
<p></p>
<p><span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;background-color:#efefef;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-family:'Arial, Helvetica, Tahoma, Verdana, sans-serif';"><span class="Apple-style-span" style="line-height:18px;">然后安装一个yum的工具包，为了可以单独弄出来ab。</span></span></p>
<p></p>
<div id="kindeditor" class="quote">yum install yum-utils</div>
<p></p>
<p><span class="Apple-style-span" style="font-family:'Arial, Helvetica, Tahoma, Verdana, sans-serif';"><span class="Apple-style-span" style="line-height:18px;"><br />
</span></span></p>
<p><span class="Apple-style-span" style="font-family:'Arial, Helvetica, Tahoma, Verdana, sans-serif';"><span class="Apple-style-span" style="line-height:18px;">上面两个安装好以后，我们开始单独安装ab，其实就是下载到apache的rpm包，然后解压后，cp出来ab工具。</span></span></p>
<p><span class="Apple-style-span" style="font-family:'Arial, Helvetica, Tahoma, Verdana, sans-serif';"><span class="Apple-style-span" style="line-height:18px;">下载apache的rpm包就交给yumdownloader完成了，下载前我们建立一个临时目录用来存放。</span></span></p>
<p></p>
<div id="kindeditor" class="quote"><p><span class="Apple-style-span" style="font-family:'Arial, Helvetica, Tahoma, Verdana, sans-serif';"><span class="Apple-style-span" style="line-height:18px;">mkdir httpd</span></span></p>
<p><span class="Apple-style-span" style="font-family:'Arial, Helvetica, Tahoma, Verdana, sans-serif';"><span class="Apple-style-span" style="line-height:18px;">cd httpd</span></span></p>
<p><span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;color:#000000;">yumdownloader httpd</span></p>
</div>
<p></p>
<p><span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;background-color:#efefef;">下载后，我们对rpm进行解包</span></p>
<p></p>
<div id="kindeditor" class="quote">rpm2cpio httpd-2.2.3-43.el5.centos.3.i386.rpm | cpio -idmv</div>
<p></p>
<p><span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;color:#000000;">最后将我们用到的ab拷贝到系统的/usr/bin目录下就可以了。最后再删除临时目录就全部ok了。</span></p>
<p></p>
<div id="kindeditor" class="quote"><span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;color:#000000;">mv usr/bin/ab /usr/bin/ab</span><br style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;text-align:left;background-color:#efefef;" />
<span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;text-align:left;color:#000000;">cd ..</span><br style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;text-align:left;background-color:#efefef;" />
<span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;text-align:left;color:#000000;">rm -rf httpd</span></div>
<p></p>
<p><span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;background-color:#efefef;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;background-color:#efefef;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-family:Arial, Helvetica, Tahoma, Verdana, sans-serif;line-height:18px;background-color:#efefef;"><br />
</span></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/108">CentOS下的Tomcat停止脚本</a></p><p><a href="http://xinlogs.com/post/16">一个很好的开源企业内部IM解决方案</a></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p><p><a href="http://xinlogs.com/Centos-install-mudos">CENTOS下安装MUDOS跑侠客行</a></p></div>]]></description>
	<pubDate>Thu, 19 Jan 2012 06:07:27 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/install-ApacheBench-on-CentOS-without-Apache</guid>

</item>
<item>
	<title>squid缓存php页面</title>
	<link>http://xinlogs.com/squid-cache-php-script</link>
	<description><![CDATA[<p>这两天在看squid反向代理加速web应用方面的内容。</p>
<p>总体来看squid的cache都是缓存一些静态内容，例如图片、css、js等文件。而动态内容是不能缓存的。那有没有办法让squid缓存php文件呢？答案是肯定的。</p>
<p>首先用squid反向代理后，我们访问一个test.html的静态页面。</p>
<p></p>
<p></p>
<div id="kindeditor" class="annotate"><p>[root@localhost ~]# curl -I http://xinlogs.com:3128/test.html</p>
<p>HTTP/1.0 200 OK</p>
<p>Content-Type: text/html</p>
<p>Content-Length: 77</p>
<p>Accept-Ranges: bytes</p>
<p>Server: Tengine/1.2.1</p>
<p>Date: Tue, 17 Jan 2012 12:38:36 GMT</p>
<p>Last-Modified: Tue, 17 Jan 2012 01:29:47 GMT</p>
<p>X-Cache: HIT from squid.xinlogs.com</p>
<p>Via: 1.1 squid.xinlogs.com:3128 (squid/2.7.STABLE9)</p>
<p>Connection: close</p>
</div>
<p></p>
<p>可以看到<span class="Apple-style-span" style="font-size:12px;line-height:18px;color:#000000;">X-Cache: HIT from squid.xinlogs.com，成功命中缓存。说明是被squid缓存的内容直接给我们了。</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;color:#000000;">而访问一个动态页面呢？</span></p>
<p></p>
<p></p>
<div id="kindeditor" class="annotate"><p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[root@localhost ~]# curl -I http://xinlogs.com:3128/test.php</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">HTTP/1.0 200 OK</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Server: Tengine/1.2.1</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Date: Tue, 17 Jan 2012 12:40:52 GMT</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Content-Type: text/html</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Vary: Accept-Encoding</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">X-Powered-By: PHP/5.3.8</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">X-Cache: MISS from squid.xinlogs.com</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Via: 1.1 squid.xinlogs.com:3128 (squid/2.7.STABLE9)</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Connection: close</span></p>
</div>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">通过</span><span class="Apple-style-span" style="font-size:12px;line-height:18px;color:#000000;">X-Cache: MISS from squid.xinlogs.com，可以看到是未命中，也就是从squid后端的nginx请求到的内容。</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">查了写资料，发现之所以不缓存动态脚本，主要是php文件没有输出</span><span class="Apple-style-span" style="font-size:12px;line-height:18px;color:#000000;">Last-Modified: Tue, 17 Jan 2012 01:29:47 GMT这行头信息。</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">下面我们构造一个可以输出头信息的php文件test2.php来测试下。</span></p>
<p></p>
<pre class="brush:php; toolbar: true;gutter: true;auto-links: false;">&lt;?php
$now = time();
$generatedAt = gmdate("D, d M Y H:i:s T",$now);
//print_r($generatedAt);
$lastModified = gmdate("D, d M Y 00:00:00 T",$now);
$expiresAt = gmdate("D, D M Y H:i:s T",strtotime($lastModified)+86400);
$maxAge=strtotime($expiresAt)-strtotime($generatedAt);
header('Last-modified: '.$lastModified);
header('Cache-control: max-age=' . $maxAge);
echo "Test".time();</pre><p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">这里我们通过header函数来构造了Last-Modified和Cache-control头信息。</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">再让我们通过curl -I来查看下是否可以缓存这个test2.php文件</span></p>
<p></p>
<p></p>
<div id="kindeditor" class="annotate"><p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[root@localhost ~]# curl -I http://xinlogs.com:3128/test2.php</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">HTTP/1.0 200 OK</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Server: Tengine/1.2.1</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Date: Tue, 17 Jan 2012 12:46:08 GMT</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Content-Type: text/html</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Vary: Accept-Encoding</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">X-Powered-By: PHP/5.3.8</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Last-Modified: Tue, 17 Jan 2012 00:00:00 GMT</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Cache-Control: max-age=-1169168</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Age: 60</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Content-Length: 14</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">X-Cache: HIT from squid.xinlogs.com</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Via: 1.1 squid.xinlogs.com:3128 (squid/2.7.STABLE9)</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">Connection: close</span></p>
</div>
<p></p>
<p></p>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">通过上面信息，可以看到test2.php已经被缓存了。</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">总结：通过在php脚本里输出header头信息，还是可以让squid缓存上php文件的。</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><b>但是目前还有一些问题没有解决：</b></span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><b>通过IE浏览器访问可以正常命中，通过chrome或者firefox浏览器每次访问都是如下未命中</b></span></p>
<p><span class="Apple-style-span" style="color:#444444;font-family:Tahoma, 'Microsoft Yahei', Simsun;font-size:14px;line-height:21px;">1326794201.750&nbsp; &nbsp;&nbsp; &nbsp;1 210.56.223.167 TCP_REFRESH_MISS/200 355 GET&nbsp;</span><a href="http://xinlogs.com:3128/test2.php" target="_blank" style="word-wrap:break-word;color:#336699;font-family:Tahoma, 'Microsoft Yahei', Simsun;font-size:14px;line-height:21px;">http://xinlogs.com:3128/test2.php</a><span class="Apple-style-span" style="color:#444444;font-family:Tahoma, 'Microsoft Yahei', Simsun;font-size:14px;line-height:21px;">&nbsp;- FIRST_UP_PARENT/xinlogs text/html</span></p>
<p><span class="Apple-style-span" style="color:#444444;font-family:'Tahoma, 'Microsoft Yahei', Simsun';"><span class="Apple-style-span" style="font-size:14px;line-height:21px;"><br />
</span></span></p>
<p><span class="Apple-style-span" style="color:#444444;font-family:'Tahoma, 'Microsoft Yahei', Simsun';"><span class="Apple-style-span" style="font-size:14px;line-height:21px;">而且不同访问方式的第一次访问也都是未命中，比如wget -S第一次访问未命中，如果换了curl -I再访问，还是未命中。</span></span></p>
<p><span class="Apple-style-span" style="color:#444444;font-family:'Tahoma, 'Microsoft Yahei', Simsun';"><span class="Apple-style-span" style="font-size:14px;line-height:21px;">尝试在squid.conf文件里加入了reload-into-ims on选项，但是无效。</span></span></p>
<p><span class="Apple-style-span" style="color:#444444;font-family:'Tahoma, 'Microsoft Yahei', Simsun';"><span class="Apple-style-span" style="font-size:14px;line-height:21px;">以上问题估计还需要看看是不是需要配合nginx的设置来解决，因为静态文件是不存在这些问题的。</span></span></p>
<p></p>
<p>&nbsp;</p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p><p><a href="http://xinlogs.com/check-slow-php-script">如何找到执行慢的php程序</a></p><p><a href="http://xinlogs.com/eMule-VPN-HighID">通过VPN获取eMule的HighID</a></p><p><a href="http://xinlogs.com/update-115disk-urls">批量更换115网盘链接</a></p><p><a href="http://xinlogs.com/find-php-slow-code">php-fpm查找php慢速代码</a></p></div>]]></description>
	<pubDate>Tue, 17 Jan 2012 12:34:47 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/squid-cache-php-script</guid>

</item>
<item>
	<title>Mysql错误索引比没索引还慢</title>
	<link>http://xinlogs.com/mysql-error-index-is-slower</link>
	<description><![CDATA[<p>今天一个客户反映网站某个页面很慢。初步分析是数据库查询造成的延时。</p>
<p>打开数据库的慢查询日志，监控到如下语句</p>
<p></p>
<div id="kindeditor" class="annotate"><p>&nbsp;# Time: 120115 &nbsp;1:09:37</p>
<p># User@Host: sq_ttt[sq_ttt] @ localhost []</p>
<p># Query_time: 3.895267 &nbsp;Lock_time: 0.000131 Rows_sent: 1 &nbsp;Rows_examined: 168835</p>
<p>use sq_ttt;</p>
<p>SET timestamp=1326560977;</p>
<p>SELECT A.*,A.aid AS id FROM p8_article A &nbsp;WHERE A.yz=1 &nbsp;AND A.fid IN (31) &nbsp;AND A.ispic=1 ORDER BY A.list DESC LIMIT 0,1;</p>
</div>
<p></p>
<p>这个查询用了3.8s时间。</p>
<p>于是进入数据库开始了这次分析。。。</p>
<p>&nbsp;</p>
<p>首先看下表结构</p>
<p></p>
<p></p>
<div id="kindeditor" class="annotate"><p>CREATE TABLE `p8_article` (</p>
<p>&nbsp; `aid` mediumint(7) unsigned NOT NULL AUTO_INCREMENT,</p>
<p>&nbsp; `title` varchar(150) NOT NULL DEFAULT '',</p>
<p>&nbsp; `smalltitle` varchar(100) NOT NULL DEFAULT '',</p>
<p>&nbsp; `fid` mediumint(7) unsigned NOT NULL DEFAULT '0',</p>
<p>&nbsp; `mid` mediumint(5) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `fname` varchar(50) NOT NULL DEFAULT '',</p>
<p>&nbsp; `hits` mediumint(7) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `pages` smallint(4) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `comments` mediumint(7) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `posttime` int(10) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `list` int(10) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `uid` mediumint(7) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `username` varchar(30) NOT NULL DEFAULT '',</p>
<p>&nbsp; `author` varchar(30) NOT NULL DEFAULT '',</p>
<p>&nbsp; `copyfrom` varchar(100) NOT NULL DEFAULT '',</p>
<p>&nbsp; `copyfromurl` varchar(150) NOT NULL DEFAULT '',</p>
<p>&nbsp; `titlecolor` varchar(15) NOT NULL DEFAULT '',</p>
<p>&nbsp; `fonttype` tinyint(1) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `picurl` varchar(150) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `ispic` tinyint(1) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `yz` tinyint(1) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `yzer` varchar(30) NOT NULL DEFAULT '',</p>
<p>&nbsp; `yztime` int(10) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `levels` tinyint(2) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `levelstime` int(10) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `keywords` varchar(100) NOT NULL DEFAULT '',</p>
<p>&nbsp; `jumpurl` varchar(150) NOT NULL DEFAULT '',</p>
<p>&nbsp; `iframeurl` varchar(150) NOT NULL DEFAULT '',</p>
<p>&nbsp; `style` varchar(15) NOT NULL DEFAULT '',</p>
<p>&nbsp; `template` varchar(255) NOT NULL DEFAULT '',</p>
<p>&nbsp; `target` tinyint(1) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `ip` varchar(15) NOT NULL DEFAULT '',</p>
<p>&nbsp; `lastfid` mediumint(7) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `money` mediumint(7) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `buyuser` text NOT NULL,</p>
<p>&nbsp; `passwd` varchar(32) NOT NULL DEFAULT '',</p>
<p>&nbsp; `allowdown` varchar(150) NOT NULL DEFAULT '',</p>
<p>&nbsp; `allowview` varchar(150) NOT NULL DEFAULT '',</p>
<p>&nbsp; `editer` varchar(30) NOT NULL DEFAULT '',</p>
<p>&nbsp; `edittime` int(10) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `begintime` int(10) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `endtime` int(10) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `description` text NOT NULL,</p>
<p>&nbsp; `lastview` int(10) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `digg_num` mediumint(7) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `digg_time` int(10) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `forbidcomment` tinyint(1) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `ifvote` tinyint(1) NOT NULL DEFAULT '0',</p>
<p>&nbsp; `heart` varchar(255) NOT NULL DEFAULT '',</p>
<p>&nbsp; `htmlname` varchar(100) NOT NULL DEFAULT '',</p>
<p>&nbsp; PRIMARY KEY (`aid`),</p>
<p>&nbsp; KEY `list` (`list`,`fid`,`yz`,`ispic`) USING BTREE</p>
<p>) ENGINE=MyISAM AUTO_INCREMENT=176567 DEFAULT CHARSET=gbk</p>
</div>
<p></p>
<p></p>
<p>&nbsp;</p>
<p>然后我们采用explain看看是否使用了索引</p>
<p></p>
<p></p>
<div id="kindeditor" class="annotate"><p>mysql&gt; explain SELECT A.list,A.aid AS id FROM p8_article A &nbsp;WHERE A.yz=1 &nbsp;AND A.fid IN (31) &nbsp;AND A.ispic=1 ORDER BY A.list DESC LIMIT 0,1;</p>
<p>+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+</p>
<p>| id | select_type | table | type &nbsp;| possible_keys | key &nbsp;| key_len | ref &nbsp;| rows | Extra &nbsp; &nbsp; &nbsp; |</p>
<p>+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+</p>
<p>| &nbsp;1 | SIMPLE &nbsp; &nbsp; &nbsp;| A &nbsp; &nbsp; | index | NULL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| list | 9 &nbsp; &nbsp; &nbsp; | NULL | &nbsp; &nbsp;1 | Using where |</p>
<p>+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+</p>
<p>1 row in set (0.00 sec)</p>
</div>
<p>可以发现使用了list索引，这个查询类型是index</p>
<p>注意：用explain分析的时候，这个type的速度顺序如下：</p>
<p></p>
<p><span class="Apple-style-span" style="color:#6e949e;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;"><b><span style="color:#000000;">system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL</span></b></span></p>
<p><span class="Apple-style-span" style="color:#6e949e;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;"><b><span style="color:#000000;">一般我们优化，最少要到range。</span></b></span></p>
<p><span class="Apple-style-span" style="color:#6e949e;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;"><b><span style="color:#000000;"><br />
</span></b></span></p>
<p><span class="Apple-style-span" style="color:#6e949e;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;"><span style="color:#000000;">不过今天的问题没有这样简单，因为当我删除索引后，发现即使不用索引也比这个快。</span></span></p>
<p><span class="Apple-style-span" style="color:#6e949e;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;"><span style="color:#000000;">下面是我删掉全部索引的结果</span></span></p>
<p></p>
<p></p>
<div id="kindeditor" class="annotate"><p><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">mysql&gt; SELECT A.list,A.aid AS id FROM p8_article A &nbsp;WHERE A.yz=1 &nbsp;AND A.fid IN (31) &nbsp;AND A.ispic=1 ORDER BY A.list DESC LIMIT 0,1;</span></span></p>
<p><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">+------------+------+</span></span></p>
<p><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">| list &nbsp; &nbsp; &nbsp; | id &nbsp; |</span></span></p>
<p><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">+------------+------+</span></span></p>
<p><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">| 1323887041 | 1312 |</span></span></p>
<p><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">+------------+------+</span></span></p>
<p><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">1 row in set (0.31 sec)</span></span></p>
</div>
<p></p>
<div style="color:#000000;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;">用explain查看没有索引的状态如下</div>
<div><div></div>
<div id="kindeditor" class="annotate"><div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">mysql&gt; explain SELECT A.list,A.aid AS id FROM p8_article A &nbsp;WHERE A.yz=1 &nbsp;AND A.fid IN (31) &nbsp;AND A.ispic=1 ORDER BY A.list DESC LIMIT 0,1;</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">+----+-------------+-------+------+---------------+------+---------+------+--------+-----------------------------+</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">| id | select_type | table | type | possible_keys | key &nbsp;| key_len | ref &nbsp;| rows &nbsp; | Extra &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">+----+-------------+-------+------+---------------+------+---------+------+--------+-----------------------------+</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">| &nbsp;1 | SIMPLE &nbsp; &nbsp; &nbsp;| A &nbsp; &nbsp; | ALL &nbsp;| NULL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| NULL | NULL &nbsp; &nbsp;| NULL | 175175 | Using where; Using filesort |</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">+----+-------------+-------+------+---------------+------+---------+------+--------+-----------------------------+</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">1 row in set (0.00 sec)</span></span></div>
</div>
<div></div>
<p>我们可以看到type是ALL，Extra里面还用了filesort.但即使这样，查询时间才<span class="Apple-style-span" style="background-color:#e7e7e7;">0.31 sec</span></p>
<p>可以看到加了索引后，反而慢了。这也是我今天想说的一个问题：<span style="color:#e53333;"><b>错误的索引可能会更慢！</b></span></p>
<p><span style="color:#e53333;"><b><br />
</b></span></p>
<p><span style="color:#e53333;"><b><span style="color:#000000;">调整索引</span></b></span></p>
<p><span style="color:#e53333;"><span style="color:#000000;">我们删掉list索引后，尝试重新建立这个复合索引。</span></span></p>
<p></p>
<p></p>
<div id="kindeditor" class="annotate"><p>mysql&gt; create index list on p8_article(yz,fid,ispic,list);</p>
<p>Query OK, 175175 rows affected (2.80 sec)</p>
<p>Records: 175175 &nbsp;Duplicates: 0 &nbsp;Warnings: 0</p>
</div>
<p></p>
<p>这次索引的区别就在于顺序的改变，将list放在了最后。这个可以参考mysql联合索引的最左前缀。</p>
<p>这样在看看explain的状态</p>
<p></p>
<p></p>
<p></p>
<p></p>
</div>
<div id="kindeditor" class="annotate"><div><p></p>
<p></p>
<p>mysql&gt; explain SELECT SQL_NO_CACHE A.list,A.aid AS id FROM p8_article A &nbsp;WHERE A.yz=1 &nbsp;AND A.fid IN (31) &nbsp;AND A.ispic=1 ORDER BY A.list DESC LIMIT 0,1;</p>
<p>+----+-------------+-------+------+---------------+------+---------+-------------------+------+-------------+</p>
<p>| id | select_type | table | type | possible_keys | key &nbsp;| key_len | ref &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | rows | Extra &nbsp; &nbsp; &nbsp; |</p>
<p>+----+-------------+-------+------+---------------+------+---------+-------------------+------+-------------+</p>
<p>| &nbsp;1 | SIMPLE &nbsp; &nbsp; &nbsp;| A &nbsp; &nbsp; | ref &nbsp;| list &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| list | 5 &nbsp; &nbsp; &nbsp; | const,const,const | &nbsp; 37 | Using where |</p>
<p>+----+-------------+-------+------+---------------+------+---------+-------------------+------+-------------+</p>
<p>1 row in set (0.00 sec)</p>
<p></p>
<p></p>
</div>
<div style="color:#000000;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;"></div>
</div>
<div style="color:#000000;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;">type已经是ref了，Extra也不在使用filesort了。</div>
<div style="color:#000000;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;">再实际运行查询，看看时间上的变化</div>
<div><div></div>
</div>
<div id="kindeditor" class="annotate"><div><div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">mysql&gt; SELECT SQL_NO_CACHE A.list,A.aid AS id FROM p8_article A &nbsp;WHERE A.yz=1 &nbsp;AND A.fid IN (31) &nbsp;AND A.ispic=1 ORDER BY A.list DESC LIMIT 0,1;</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">+------------+------+</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">| list &nbsp; &nbsp; &nbsp; | id &nbsp; |</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">+------------+------+</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">| 1323887041 | 1312 |</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">+------------+------+</span></span></div>
<div><span class="Apple-style-span" style="font-family:Georgia;"><span class="Apple-style-span" style="font-size:12px;letter-spacing:2px;line-height:20px;">1 row in set (0.00 sec)</span></span></div>
</div>
<div style="color:#000000;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;"></div>
</div>
<div style="color:#000000;font-family:Georgia;font-size:12px;letter-spacing:2px;line-height:20px;">为了怕有query_cache的原因，所以特意加入了SQL_NO_CACHE。</div>
<p>现在显示查询时间为0.00 sec 基本可以忽略不计了。而经过索引的调整，网页的速度也确实得到了改善。</p>
<p>&nbsp;</p>
<p><b>总结：索引错误的使用反而会拖慢查询，甚至比不用还慢。一定要根据最左前缀建立合适的索引，才可以起到加速查询的作用！</b></p>
<p></p>
<p></p>
<p>&nbsp;</p>
<p></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/eMule-VPN-HighID">通过VPN获取eMule的HighID</a></p><p><a href="http://xinlogs.com/disable-mysql-query-log">开启或者关闭MYSQL的query log(查询日志)</a></p><p><a href="http://xinlogs.com/ruby_import_dbf_to_mysql">ruby将DBF文件导入MYSQL库</a></p><p><a href="http://xinlogs.com/post/22">一个在windows下很好用的MySQL工具Navicat</a></p><p><a href="http://xinlogs.com/squid-cache-php-script">squid缓存php页面</a></p></div>]]></description>
	<pubDate>Sun, 15 Jan 2012 15:24:47 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/mysql-error-index-is-slower</guid>

</item>
<item>
	<title>php性能调试工具</title>
	<link>http://xinlogs.com/php-performance-debugging-tools</link>
	<description><![CDATA[<p>最近在帮一些客户优化php性能。</p>
<p>排除掉服务器环境、memcache这些办法后，剩下的就是找php代码有没有执行过慢的因素了。</p>
<p>下面列出一些在php性能调试中可以用到的工具。</p>
<p>1、xdebug</p>
<p>&nbsp; &nbsp; &nbsp;这个工具大家都很熟悉，开始php过程中，用来调试程序用的。</p>
<p>2、webgrind</p>
<p>&nbsp; &nbsp; &nbsp;这个工具主要是配合xdebug来使用，用来监测php执行时间的。</p>
<p>3、XHProf</p>
<p>&nbsp; &nbsp; &nbsp;这个工具据说比xdebug轻量，可以考虑用于生产环境下来监测php性能。没有用过，看介绍很棒！facebook用的，肯定差不了。</p>
<p>&nbsp;</p>
<p>以上只是简单介绍下，用来记录。等以后有机会仔细用来，再发文档说明</p>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p><p><a href="http://xinlogs.com/mod-template-emidream">修改EMiDream模板</a></p><p><a href="http://xinlogs.com/accelerate-app-store-download">快速提升app store下载速度</a></p><p><a href="http://xinlogs.com/update-115disk-urls">批量更换115网盘链接</a></p><p><a href="http://xinlogs.com/check-slow-php-script">如何找到执行慢的php程序</a></p></div>]]></description>
	<pubDate>Fri, 30 Dec 2011 14:47:08 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/php-performance-debugging-tools</guid>

</item>
<item>
	<title>php-fpm查找php慢速代码</title>
	<link>http://xinlogs.com/find-php-slow-code</link>
	<description><![CDATA[<p>前两天帮助一个客户优化ecshop。</p>
<p>他的ecshop代码是找人修改过的，修改后速度已很很慢，大概打开一页需要9s吧。</p>
<p>而默认的ecshop在同样服务器上速度就很快。</p>
<p>开始走了很多弯路，因为只是速度慢，并无错误。就没有想到是代码的原因。</p>
<p>对比两个ecshop，首先发现首页加载的request数量差距很大，慢的站点105次，快的46次。</p>
<p>而且慢的站点1.66M大小，而快的只有455k。通过开启gzip和合并css、js等手段优化后，效果并不明显。</p>
<p>&nbsp;</p>
<p>后来想到可能是因为找人修改过代码，开始怀疑到代码上（也确实没啥办法了）。</p>
<p>想到php-fpm可以记录下执行过慢的php脚本，于是修改php-fpm配置，加入了记录慢速php请求的代码。</p>
<p></p>
<p>下面是在php 5.3.8下的php-fpm.conf文件添加的内容</p>
<p></p>
<div id="kindeditor" class="quote"><p>request_slowlog_timeout=5s</p>
<p>slowlog=/var/log/fpm_slow.log</p>
</div>
<p></p>
<p>这个配置会将php脚本执行超过5秒的，记录在/var/log/fpm_slow.log文件中。</p>
<p>&nbsp;</p>
<p>如果你的php还是5.2.x的版本，那么php-fpm还是以补丁的形式执行，请参考下面的配置文件</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>&nbsp; &nbsp; &nbsp; The timeout (in seconds) for serving of single request after which a php backtrace will be dumped to slow.log file</p>
<p>&nbsp; &nbsp; &nbsp; '0s' means 'off'</p>
<p>&nbsp; &nbsp; &nbsp; &lt;value name="request_slowlog_timeout"&gt;0s&lt;/value&gt;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; The log file for slow requests</p>
<p>&nbsp; &nbsp; &nbsp; &lt;value name="slowlog"&gt;logs/slow.log&lt;/value&gt;</p>
</div>
<p></p>
<p></p>
<p>&nbsp;</p>
<p><span style="color:#000000;">最终在</span><span class="Apple-style-span" style="font-size:12px;line-height:18px;color:#000000;">/var/log/fpm_slow.log文件里，发现很多如下记录</span></p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[27-Dec-2011 10:07:27] &nbsp;[pool www] pid 8524</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">script_filename = /data/huaximall/flow.php</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[0x0a0f41c0] fsockopen() !:649</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[0x0a0f4104] _connect_sock() !:937</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[0x0a0f3fdc] sock_to_host() !:693</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[0x0a0f3f08] get_sock() !:372</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[0x0a0f3e5c] get() !:952</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[0x0a0f3d4c] getAll() !:291</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[0x0a0f3c3c] get_child_tree() !:313</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[0x0a0f3b18] get_child_tree() !:251</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[0x0a0f2fa8] get_categories_tree() !:44</span></p>
</div>
<p></p>
<div style="color:#000000;font-size:12px;line-height:18px;">这里比较奇怪，人家的这个日志都可以显示出具体是哪个文件的哪行，我这里只有函数和行，而文件名的地方却是“！”号。。。。</div>
<div style="color:#000000;font-size:12px;line-height:18px;">这个问题我还没有解决，不过通过这些日志，我已经可以判断出来是flow.php的执行时间超过了5s。。。导致首页加载过慢。</div>
<div style="color:#000000;font-size:12px;line-height:18px;"><br />
</div>
<div style="color:#000000;font-size:12px;line-height:18px;">后面分析flow.php，发现又调用了init.php等相关库和初始化文件。</div>
<div style="color:#000000;font-size:12px;line-height:18px;">最后发现fsockopen() _connect_sock() sock_to_host()这些函数是在尝试连接到memcached的服务器。而这个服务器的IP不对，导致这里延时很大。。。</div>
<div style="color:#000000;font-size:12px;line-height:18px;"><br />
</div>
<div style="color:#000000;font-size:12px;line-height:18px;">还有个技巧就是在php页面里加入计算执行时间的输出，看看到底哪些行的执行时间过长。</div>
<div style="color:#000000;font-size:12px;line-height:18px;">具体时间的计算，可以参考下面代码</div>
<div style="font-size:12px;line-height:18px;"><p style="background-image:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:#f3f3f3;border-top-width:0px;border-right-width:0px;border-bottom-width:0px;border-left-width:0px;border-style:initial;border-color:initial;margin-top:0px;margin-bottom:20px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;vertical-align:baseline;font-family:Verdana, 'Trebuchet MS', Tahoma, Georgia, Helvetica;line-height:21px;"></p>
<pre class="brush:php; toolbar: true;gutter: true;auto-links: false;">$start = microtime(true);
$end = microtime(true);
$time=$end-$start;</pre><p></p>
</div>
<div style="color:#000000;font-size:12px;line-height:18px;"><br />
</div>
<p></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/eMule-VPN-HighID">通过VPN获取eMule的HighID</a></p><p><a href="http://xinlogs.com/mac-xdebug-netbeans-config">mac下配置php调试环境</a></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p><p><a href="http://xinlogs.com/accelerate-app-store-download">快速提升app store下载速度</a></p><p><a href="http://xinlogs.com/php-performance-debugging-tools">php性能调试工具</a></p></div>]]></description>
	<pubDate>Thu, 29 Dec 2011 01:58:49 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/find-php-slow-code</guid>

</item>
<item>
	<title>通过denyhosts保护ssh登陆</title>
	<link>http://xinlogs.com/ssh-login-protection-by-denyhosts</link>
	<description><![CDATA[<p>今天查看服务器的/var/log/secure日志，发现很多类似下面的信息</p>
<p>&nbsp;PAM 6 more authentication failures; logname= uid=0 euid=0 tty=ssh ruser= rhost=121.176.35.192 &nbsp;user=root</p>
<p>说明经常有人通过ssh尝试登陆，并不断尝试猜测root的密码。</p>
<p>&nbsp;</p>
<p>这样总让人尝试我的密码也不是个事儿呀....于是通过denyhosts软件，开启了保护。</p>
<p>通过denyhosts我们可以设置登陆失败几次，就禁止这个IP再次登陆。并可以设置多少分钟后，放开保护。</p>
<p>&nbsp;</p>
<p><b>denyhosts介绍</b></p>
<p><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;">DenyHosts是Python语言写的一个程序，</span><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;">用</span><b style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;">DenyHosts</b><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;">可以阻止试图猜测SSH登录口令，它会分析/var/log/secure等日志文件，当发现同一IP在进行多次SSH密码尝试时就会记录IP到/etc/hosts.deny文件，从而达到自动屏蔽该IP的目的。</span></p>
<p><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;"><b>安装需求</b></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">首要要求有python环境，并版本在2.3以上</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">CentOS 默认安装了2.4.3版本，我们可以通过下面命令查看</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;"><br />
</span></span></p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>[root@localhost ~]# python -V</p>
<p>Python 2.4.3</p>
</div>
<p></p>
<p></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">注意大小写。</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;"><br />
</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">其次是sshd需要支持tcp_wrappers。这个一般都支持。可以用下面命令判断</span></span></p>
<p></p>
<div id="kindeditor" class="quote">ldd /usr/sbin/sshd |grep wrap</div>
<p></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">如果显示：libwrap.so.0 =&gt; /lib/libwrap.so.0 (0x00db7000)表示支持</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;"><br />
</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;"><b>安装</b></span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">当前最新的版本是2.6</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">下载</span></span></p>
<p></p>
<div id="kindeditor" class="quote">wget&nbsp;http://downloads.sourceforge.net/project/denyhosts/denyhosts/2.6/DenyHosts-2.6.tar.gz?r=http%3A%2F%2Fsourceforge.net%2Fprojects%2Fdenyhosts%2Ffiles%2F&amp;ts=1324820171&amp;use_mirror=cdnetworks-kr-1</div>
<p></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;"><br />
</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">解压安装</span></span></p>
<p></p>
<div id="kindeditor" class="quote"><p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">tar zxvf DenyHosts-2.6.tar.gz&nbsp;</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">cd DenyHosts-2.6</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">python setup.py install</span></span></p>
</div>
<p></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">默认将程序安装在/usr/share/denyhosts</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">库文件在/usr/lib/python2.4/site-packages/DenyHosts/</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">denyhosts.py安装到/usr/bin</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;"><br />
</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">设置启动脚本</span></span></p>
<p></p>
<div id="kindeditor" class="quote"><p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">cd /usr/share/denyhosts/</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">cp daemon-control-dist daemon-control</span></span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">chown root&nbsp;</span></span><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;">daemon-control</span></p>
<p><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;">chmod 700&nbsp;</span><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;">daemon-control</span></p>
<p><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;">grep -v "^#" denyhosts.cfg-dist &gt; denyhosts.cfg</span></p>
</div>
<p></p>
<p><span class="Apple-style-span" style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;">这样就生成了一个标准的配置文件denyhosts.cfg</span></p>
<p><span class="Apple-style-span" style="font-family:'arial, 宋体, sans-serif';"><span class="Apple-style-span" style="font-size:14px;line-height:24px;">我们需要按照自己的想法，配置下这个denyhosts.cfg文件</span></span></p>
<p></p>
<p style="font-size:14px;line-height:24px;"></p>
<div id="kindeditor" class="quote" style="font-size:14px;line-height:24px;"><p>SECURE_LOG = /var/log/secure</p>
<p>#表示系统中secure日志文件位置</p>
<p>HOSTS_DENY = /etc/hosts.deny</p>
<p>#表示hosts.deny配置文件在系统中位置</p>
<p>PURGE_DENY = 30m</p>
<p>#表示多久后解封IP</p>
<p>BLOCK_SERVICE &nbsp;= sshd</p>
<p>DENY_THRESHOLD_INVALID = 1</p>
<p>#表示无效用户名，登陆失败几次就封IP</p>
<p>DENY_THRESHOLD_VALID = 5<br />
#表示有效果的普通用户登陆几次就封IP</p>
<p>DENY_THRESHOLD_ROOT = 3</p>
<p>#表示root用户登陆失败几次封IP</p>
<p>DENY_THRESHOLD_RESTRICTED = 1</p>
<p>WORK_DIR = /usr/share/denyhosts/data</p>
<p>SUSPICIOUS_LOGIN_REPORT_ALLOWED_HOSTS=YES</p>
<p>HOSTNAME_LOOKUP=NO</p>
<p>表示是否做域名反解析</p>
<p>LOCK_FILE = /var/lock/subsys/denyhosts</p>
</div>
<p style="font-size:14px;line-height:24px;"></p>
<p style="font-size:14px;line-height:24px;">启动denyhosts</p>
<p style="font-size:14px;line-height:24px;"></p>
<div id="kindeditor" class="quote">/usr/share/denyhosts/daemon-control start</div>
<p></p>
<p style="font-size:14px;line-height:24px;">配置denyhosts随系统自启动</p>
<p style="font-size:14px;line-height:24px;"></p>
<div id="kindeditor" class="quote" style="font-size:14px;line-height:24px;"><p>cd /etc/init.d</p>
<p>ln -s /usr/share/denyhosts/daemon-control denyhosts</p>
<p>chkconfig --add denyhosts</p>
<p>chkconfig --level 345 denyhosts on</p>
</div>
<p style="font-size:14px;line-height:24px;"></p>
<p style="font-size:14px;line-height:24px;"></p>
<p style="font-size:14px;line-height:24px;">查看效果</p>
<p style="font-size:14px;line-height:24px;">如果尝试登陆失败次数达到后，IP就会被记录到/etc/hosts.deny文件内，来达到阻止登陆的目的</p>
<p style="font-size:14px;line-height:24px;">我们也可以通过查看/var/log/denyhosts日志文件来判断是否有被封的IP</p>
<p style="font-size:14px;line-height:24px;">下面是我的机器部署denyhosts一段时间后封的IP</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p><span class="Apple-style-span" style="font-size:14px;line-height:24px;"># DenyHosts: Sun Dec 25 21:40:13 2011 | sshd: 112.164.231.91</span></p>
<p><span class="Apple-style-span" style="font-size:14px;line-height:24px;">sshd: 112.164.231.91</span></p>
</div>
<p></p>
<p></p>
<p style="font-size:14px;line-height:24px;"></p>
<p style="font-size:14px;line-height:24px;"></p>
<p style="font-size:14px;line-height:24px;"></p>
<p style="font-size:14px;line-height:24px;"></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/10">怎么mount一个xen的img映像。转载</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/monit-to-monitor-services">monit监控linux服务</a></p><p><a href="http://xinlogs.com/linux-ddos-defender">Linux防御DDOS攻击</a></p><p><a href="http://xinlogs.com/vps-dropbox-install">一款Linux下同步备份文件的好软件DROPBOX</a></p></div>]]></description>
	<pubDate>Sun, 25 Dec 2011 13:24:04 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/ssh-login-protection-by-denyhosts</guid>

</item>
<item>
	<title>linux网络连接数量监控</title>
	<link>http://xinlogs.com/monitor-network-connections-of-linux</link>
	<description><![CDATA[<p>今天早上一个客户的网站停止了响应，不能正常解析php内容。</p>
<p>重启php-fpm后正常，判断应该是php-fpm进程僵死。所以就先参考网上内容，写了一个监控nginx状态脚本</p>
<p>后来又想看看这个php-fpm进程挂掉和访问量是否有关系，于是打算记录下服务器每分钟的访问量。</p>
<p>其实就是用cron每分钟执行我写的这个脚本，而脚本的作用就是获取当前linux的连接数，并记录到日志文件中。</p>
<p>&nbsp;</p>
<p>监控linux网络连接数的脚本如下</p>
<p>&nbsp;</p>
<p></p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;">#!/bin/sh
#定义日志的时间格式，用来作为日志结尾的时间标记
logfile=`date +%Y%m%d`
#定义个时间，用来写入日志用
logtime=`date`
#获取当前系统的网路连接数，这里去掉了127.0.0.1的连接，因为我的php-fpm用的127.0.0.1:9000这个连接。
log=`netstat -ntu | awk '{print $5}' | cut -d: -f1 |grep [^127.0.0.1] |wc -l`
#写日志内容到日志文件
echo "$logtime | $log " &gt;&gt; /data/logs/connect_$logfile.log</pre><p></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/centos_VPN_Howto">CentOS 5.3架设VPN和619错误排除</a></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/install-ApacheBench-on-CentOS-without-Apache">centos 单独安装apachebench</a></p><p><a href="http://xinlogs.com/debian-administration-site">一个关于debian系统管理的站点</a></p><p><a href="http://xinlogs.com/post/108">CentOS下的Tomcat停止脚本</a></p></div>]]></description>
	<pubDate>Thu, 22 Dec 2011 15:18:46 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/monitor-network-connections-of-linux</guid>

</item>
<item>
	<title>bbsxp 6.0数据导入phpwind 8.7方法</title>
	<link>http://xinlogs.com/bbsxp6-to-phpwind8</link>
	<description><![CDATA[<p>今天帮助猪八戒网上的一个客户将原来的bbsxp 6.0的论坛数据迁移到phpwind 8.7下。这里主要记录下思路</p>
<p>phpwind官方论坛有各种的迁移程序，但是继续bbsxp的最早版本是2008. 而我这个客户的是bbsxp 6的access库。</p>
<p>完成这个任务，我顺利升级到猪三戒！呵呵</p>
<p>&nbsp;</p>
<p>没有现成的，只能自己分析了。</p>
<p>为了导入方便，我先将需要用到的数据从access的库导入mysql里。</p>
<p>这样bbsxp的表和新安装的phpwind表都在一个库了。</p>
<p>&nbsp;</p>
<p><b>数据分析</b></p>
<p>这个步骤主要分析用户数据、论坛的板块数据、帖子、回帖等数据的格式。找到两个表的数据关系，为后面导入数据打下基础。</p>
<p>&nbsp;</p>
<p><b>数据迁移</b></p>
<p>用户数据</p>
<p>&nbsp;</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote">INSERT INTO pw_members(uid,username,password,email,icon,gender,regdate,signature,site,bday) SELECT ID,UserName,lower(UserPass),UserMail,UserFace,UserSex,UNIX_TIMESTAMP(UserRegTime),UserSign,UserHome,Birthday From bbsxp_users;</div>
<p></p>
<div><br />
</div>
<div><div><div id="kindeditor" class="quote">INSERT INTO pw_memberdata(uid,postnum,rvrc,money) SELECT ID,PostTopic,PostRevert,UserMoney From bbsxp_users;</div>
</div>
</div>
<div><br />
</div>
<div>帖子数据</div>
<div><br />
</div>
<div><div><div id="kindeditor" class="quote">INSERT INTO pw_threads(tid,fid,author,subject,ifcheck,postdate,lastpost,lastposter,hits,replies) SELECT ID,ForumID,UserName,Topic,1,UNIX_TIMESTAMP(PostTime),UNIX_TIMESTAMP(LastTime),LastName,Views,Replies From bbsxp_threads;</div>
</div>
</div>
<div><br />
</div>
<div><div><div id="kindeditor" class="quote">INSERT INTO pw_tmsgs(tid,content) SELECT ThreadID,Content From bbsxp_posts2 where IsTopic=1;</div>
</div>
</div>
<div><br />
</div>
<div><div><div id="kindeditor" class="quote">update pw_threads set authorid = (SELECT uid from pw_members WHERE username=pw_threads.author);</div>
</div>
</div>
<div><br />
</div>
<div>回帖数据</div>
<div><br />
</div>
<div><div><div id="kindeditor" class="quote">INSERT INTO pw_posts(pid,tid,author,postdate,subject,ifcheck,content) SELECT ID,ThreadID,UserName,UNIX_TIMESTAMP(PostTime),Subject,1,Content From bbsxp_posts2 where IsTopic=0;</div>
</div>
</div>
<div><br />
</div>
<div><div id="kindeditor" class="quote">update pw_posts set authorid = (SELECT uid from pw_members WHERE username=pw_posts.author);</div>
</div>
<div><br />
</div>
<p><b>最后注意：</b></p>
<p>导入数据后，论坛进入板块后没有分页。这个需要进入后台，数据-》全部缓存-》更新各种统计数据。</p>
<p>还有就是需要看下bbsxp做没做分表处理，有可能将bbsxp_posts分表为bbsxp_posts1、bbsxp_posts2等表</p>
<div><br />
</div>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/bo-blog-to-emlog">微博从bo-blog迁移到了emlog。</a></p><p><a href="http://xinlogs.com/vps-dropbox-install">一款Linux下同步备份文件的好软件DROPBOX</a></p><p><a href="http://xinlogs.com/post/25">如何向万网的Mysql数据库导入数据</a></p><p><a href="http://xinlogs.com/ruby_import_dbf_to_mysql">ruby将DBF文件导入MYSQL库</a></p></div>]]></description>
	<pubDate>Wed, 14 Dec 2011 15:28:53 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/bbsxp6-to-phpwind8</guid>

</item>
<item>
	<title>如何找到执行慢的php程序</title>
	<link>http://xinlogs.com/check-slow-php-script</link>
	<description><![CDATA[<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">最近在帮助一个网站做性能优化。</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">从原来的windows平台切换到了linux平台。php环境也已经变为主流的Nginx+php-fpm+eAccelerator+Zend Optimization组合</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">打开了MySQL的慢连接，发现基本集中在论坛的表查询上，但是我们如何定位有哪些php程序在执行的时候过慢呢？</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;"><br />
</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">通过查看php-fpm.conf配置，可以找到如下配置信息</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">&nbsp;</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;"></div>
<div id="kindeditor" class="quote" style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;"><div>The timeout (in seconds) for serving of single request after which a php backtrace will be dumped to slow.log file</div>
<div>&nbsp; &nbsp; &nbsp; '0s' means 'off'</div>
<div>&nbsp; &nbsp; &nbsp; &lt;value name="request_slowlog_timeout"&gt;0s&lt;/value&gt;</div>
<div><br />
</div>
<div>&nbsp; &nbsp; &nbsp; The log file for slow requests</div>
<div>&nbsp; &nbsp; &nbsp; &lt;value name="slowlog"&gt;logs/slow.log&lt;/value&gt;</div>
</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;"></div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">request_slowlog_timeout 项是一个设定超过多长时间就会被记录到slow.log日志中。0s为关闭这个选项。</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;"><br />
</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">下面的slowlog为设置slow.log文件的位置。</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;"><br />
</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">打开这个以后，我们就可以看到哪些php文件用了过多的执行时间，来重点优化。</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">而且php-fpm.log也回提示出执行时间超过这个设定的信息。</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;"><br />
</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;">下面是php-fpm.log的提示</div>
<div style="color:#666666;font-family:'Arial, Helvetica, sans-serif, 宋体';font-size:12px;line-height:18px;"><br />
</div>
<p></p>
<div id="kindeditor" class="quote">Dec 09 20:19:25.170259 [WARNING] fpm_request_check_timed_out(), line 146: child 28844, script '/data/htdocs/bbs/forumdisplay.php' (pool default) executing too slow (3.110822 sec), logging</div>
<p></p>
<p></p>
<p><span class="Apple-style-span" style="color:#666666;font-family:''Arial, Helvetica, sans-serif, 宋体'';"><span class="Apple-style-span" style="font-size:12px;line-height:18px;">提示forumdisplay.php文件执行过慢，用了3.110822秒</span></span></p>
<p><span class="Apple-style-span" style="color:#666666;font-family:''Arial, Helvetica, sans-serif, 宋体'';"><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></span></p>
<p><span class="Apple-style-span" style="color:#666666;font-family:''Arial, Helvetica, sans-serif, 宋体'';"><span class="Apple-style-span" style="font-size:12px;line-height:18px;">再来看看slow.log的内容</span></span></p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>Dec 09 20:23:49.534250 pid 28865 (pool default)</p>
<p>script_filename = /data/htdocs/t/bbs/forumdisplay.php</p>
<p>[0xbff462a0] mysql_query() p:66</p>
<p>[0xbff47020] query() p:622</p>
</div>
<p></p>
<p>可以看到和上面的php-fpm.log是对应的的。</p>
<p>&nbsp;</p>
<p>有了这个办法，我们就可以随时查看网站中到底是什么程序执行速度慢，来重点优化了！</p>
<p>&nbsp;</p>
<p></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/update-115disk-urls">批量更换115网盘链接</a></p><p><a href="http://xinlogs.com/php-performance-debugging-tools">php性能调试工具</a></p><p><a href="http://xinlogs.com/find-php-slow-code">php-fpm查找php慢速代码</a></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p><p><a href="http://xinlogs.com/mac-xdebug-netbeans-config">mac下配置php调试环境</a></p></div>]]></description>
	<pubDate>Fri, 09 Dec 2011 13:27:11 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/check-slow-php-script</guid>

</item>
<item>
	<title>伪静态规则调试技巧</title>
	<link>http://xinlogs.com/howto-open-rewrite-log</link>
	<description><![CDATA[<p>最近在威客网上接了个任务，帮助调整伪静态规则。WEB服务是apache的，主要就是修改rewrite规则。</p>
<p>伪静态规则写起来比较麻烦，关键是正则表达是写完总要测试，而我们不知道这个rewrite该怎么测试。我们需要准确知道服务器是怎么匹配我们的规则的，匹配后又发生了什么。这也就是我今天要写的调试技巧。</p>
<p>目前我们采用的WEB Server主要是apache和nginx（Windows下的IIS我不用，只有基于Linux的）。</p>
<p>其实所谓技巧就是通过打开rewrite的日志功能，然后每次访问后，我们查看rewrite日志来分析我们的规则是否正确。</p>
<p>&nbsp;</p>
<p><b>APACHE开启rewrite办法</b></p>
<p>在httpd.conf文件里加入</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>RewriteLog "/xampp/apache/logs/RewriteLog.txt"&nbsp;</p>
<p>RewriteLogLevel 9</p>
</div>
<p></p>
<div>我这里没用Linux下的apache，直接在我windows下的xampp环境里测试的</div>
<div><br />
</div>
<div>访问后的rewrite日志文件如下</div>
<div><div></div>
</div>
<div id="kindeditor" class="quote"><div><div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (3) [perdir C:/xampp/htdocs/] strip per-dir prefix: C:/xampp/htdocs/q-123.html -&gt; q-123.html</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (3) [perdir C:/xampp/htdocs/] applying pattern '^.*$' to uri 'q-123.html'</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (4) [perdir C:/xampp/htdocs/] RewriteCond: input='C:/xampp/htdocs/q-123.html' pattern='!-f' =&gt; matched</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (4) [perdir C:/xampp/htdocs/] RewriteCond: input='C:/xampp/htdocs/q-123.html' pattern='!-d' =&gt; matched</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (2) [perdir C:/xampp/htdocs/] rewrite 'q-123.html' -&gt; 'index.php?q-123.html'</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (3) split uri=index.php?q-123.html -&gt; uri=index.php, args=q-123.html</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (3) [perdir C:/xampp/htdocs/] add per-dir prefix: index.php -&gt; C:/xampp/htdocs/index.php</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (2) [perdir C:/xampp/htdocs/] trying to replace prefix C:/xampp/htdocs/ with /</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (5) strip matching prefix: C:/xampp/htdocs/index.php -&gt; index.php</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (4) add subst prefix: index.php -&gt; /index.php</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6ba00d8/initial] (1) [perdir C:/xampp/htdocs/] internal redirect with /index.php [INTERNAL REDIRECT]</div>
<div>127.0.0.1 - - [01/Dec/2011:15:38:38 +0800] [localhost/sid#775148][rid#6bdc840/initial/redir#1] (3) [perdir C:/xampp/htdocs/] strip per-dir prefix: C:/xampp/htdocs/index.php -&gt; index.php</div>
</div>
<div></div>
</div>
<div>还是很详细的，用来分析我们的rewrite规则是否生效和是否有错误足够了！</div>
<div><br />
</div>
<p><b>Nginx开启rewrite日志办法</b></p>
<p>在nginx.conf的配置文件里，加入如下选项内容</p>
<p></p>
<div id="kindeditor" class="quote">rewrite_log on;</div>
<p></p>
<p><span class="Apple-style-span" style="color:#333333;font-family:tahoma, arial, 宋体, sans-serif;font-size:14px;line-height:21px;"><br />
</span></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/druapl-url-nginx-rewrite">drupal在nginx 0.8.15下的简洁URL配置</a></p><p><a href="http://xinlogs.com/Solve-nginx-502-mistakes">nginx通过轮询避免php-fpm引起的502错误</a></p><p><a href="http://xinlogs.com/apache-VirtualHost-Configure">apache下多虚拟主机的配置与管理</a></p><p><a href="http://xinlogs.com/nginx-301-rewrite">nginx通过301统一入口域名</a></p><p><a href="http://xinlogs.com/nginx-epool-events">nginx采用epoll的事件模型，为何效率高。</a></p></div>]]></description>
	<pubDate>Thu, 01 Dec 2011 12:24:48 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/howto-open-rewrite-log</guid>

</item>
<item>
	<title>Linux源码安装MySQL多版本共存</title>
	<link>http://xinlogs.com/Linux-source-install-multiple-versions-of-MySQL</link>
	<description><![CDATA[<p>&nbsp; &nbsp; &nbsp; &nbsp;原来我的服务器上是MySQL 5.5.16。本来是用的挺稳定。但是当时编译的时候由于手误将DDEFAULT_COLLATION=utf8-general_ci \弄错啦。。。应该是utf8_general_ci。导致很多程序用的时候报错，或者需要修改。</p>
<p>最近发现MySQL更新到了5.5.18了，就打算迁移到新数据库正好修正原来问题。</p>
<p>为了不影响访问，就打算在5.5.16运行的情况下，继续安装好5.5.18.等顺利转移到5.5.18后，再关闭原来MySQL5.5.16版本。</p>
<p>也就有了今天这篇文章。在Linux下从源码安装多版本或者多个MySQL数据库。</p>
<p><b>重点：多版本或者多个MySQL同时运行，主要就是多个MySQL需要运行在不同目录，不同的端口，采用不同的数据库路径。</b>&nbsp;</p>
<p><b>步骤</b></p>
<p><b>1、首先是下载需要安装的MySQL</b></p>
<p></p>
<p>下载mysql 5.5.16</p>
<p></p>
<div id="kindeditor" class="quote">wget http://dev.mysql.com/get/Downloads/MySQL-5.5/mysql-5.5.16.tar.gz/from/http://mysql.mirrors.pair.com/</div>
<p></p>
<p><span class="Apple-style-span" style="font-weight:normal;">下载mysql 5.5.18</span></p>
<p></p>
<div id="kindeditor" class="quote">wget&nbsp;<span class="Apple-style-span" style="font-size:12px;line-height:18px;background-color:#ffead4;">http://dev.mysql.com/get/Downloads/MySQL-5.5/mysql-5.5.16.tar.gz/from/http://mysql.mirrors.pair.com/</span></div>
<p></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><b>2、安装支持程序</b></span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">原来版本的MySQL源码安装都是采用./configure和make这些。但是新版本的都是用cmake来弄了。所以如果系统中没有的，需要先安装cmake</span></p>
<p></p>
<p></p>
<div id="kindeditor" class="quote">yum install cmake</div>
<p></p>
<div style="font-size:12px;line-height:18px;"><br />
</div>
<div style="font-size:12px;line-height:18px;"><b>3、创建MySQL用户和用户组</b></div>
<p></p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">/usr/sbin/groupadd mysql</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">/usr/sbin/useradd -g mysql mysql</span></p>
</div>
<p></p>
<div style="font-size:12px;line-height:18px;"><br />
</div>
<div style="font-size:12px;line-height:18px;"><b>4、解压、编译、安装MySQL</b></div>
<div style="font-size:12px;line-height:18px;">解压</div>
<div><div></div>
<div id="kindeditor" class="quote"><div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">tar zxvf mysql-5.5.16.tar.gz</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">cd mysql-5.5.16</span></div>
</div>
<div></div>
<div style="font-size:12px;line-height:18px;"><br />
</div>
</div>
<div style="font-size:12px;line-height:18px;">编译参数</div>
<div><div></div>
<div id="kindeditor" class="quote"><div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">cmake . \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DCMAKE_INSTALL_PREFIX=/usr/local/webserver/mysql5516/ \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DMYSQL_DATADIR=/data0/mysql/3306/data \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DMYSQL_UNIX_ADDR=/data0/mysql/3306/mysqld.sock \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DWITH_MYISAM_STORAGE_ENGINE=1 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DWITH_INNOBASE_STORAGE_ENGINE=1 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DWITH_BLACKHOLE_STORAGE_ENGINE=0 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DWITH_ARCHIVE_STORAGE_ENGINE=0 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DWITHOUT_PARTITION_STORAGE_ENGINE=1 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DENABLED_LOCAL_INFILE=1 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DMYSQL_TCP_PORT=3306 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DEXTRA_CHARSETS=all \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DDEFAULT_CHARSET=utf8 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DDEFAULT_COLLATION=utf8_general_ci \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DWITH_DEBUG=0 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DWITH_EMBEDDED_SERVER=1 \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DWITH_SSL=system \</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">&nbsp; -DWITH_READLINE=1</span></div>
</div>
<div></div>
<p><b>注意：编译参数里有几项需要根据自己具体情况设置。我这里将MySQL5.5.16运行于3306端口，并安装在mysql5516目录。</b></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;background-color:#ffead4;">-DCMAKE_INSTALL_PREFIX=/usr/local/webserver/mysql5516/ &nbsp; 设置mysql的安装目录</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;background-color:#ffead4;">-DMYSQL_DATADIR=/data0/mysql/3306/data 设置mysql数据库文件的位置</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;background-color:#ffead4;">-DMYSQL_UNIX_ADDR=/data0/mysql/3306/mysqld.sock 设置mysql启动后sock文件位置</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;background-color:#ffead4;">-DMYSQL_TCP_PORT=3306 设置mysql的监听端口</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><b>以上这些设置需要根据不同版本的mysql相应修改。不然多个版本同时监听3306端口，肯定冲突了。</b></span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><b><br />
</b></span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">编译</span></p>
<p></p>
<p></p>
<div id="kindeditor" class="quote">make</div>
<p></p>
<div style="font-size:12px;line-height:18px;">安装</div>
<div style="font-size:12px;line-height:18px;"><div id="kindeditor" class="quote">make install</div>
</div>
<div style="font-size:12px;line-height:18px;"><br />
</div>
<p><b>5、配置目录权限、创建目录、建立初始数据。</b></p>
<p>配置目录权限</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>chmod +w /usr/local/webserver/mysql5516</p>
<p>chown -R mysql:mysql /usr/local/webserver/mysql5516</p>
<p>cd ../</p>
</div>
<p></p>
<div>创建相关目录</div>
<div><div></div>
<div id="kindeditor" class="quote"><div>mkdir -p /data0/mysql/3306/data/</div>
<div>mkdir -p /data0/mysql/3306/binlog/</div>
<div>mkdir -p /data0/mysql/3306/relaylog/</div>
<div>chown -R mysql:mysql /data0/mysql/</div>
</div>
<div></div>
</div>
<div>建立初始数据</div>
<div><div><div id="kindeditor" class="quote">/usr/local/webserver/mysql5516/scripts/mysql_install_db --basedir=/usr/local/webserver/mysql --datadir=/data0/mysql/3306/data --user=mysql</div>
</div>
</div>
<div><br />
</div>
<p><b>6、创建My.cnf配置文件和Mysql启动脚本</b></p>
<p>创建my.cnf配置文件</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote">cp support-files/my-small.cnf /usr/local/webserver/mysql5516/my.cnf</div>
<p></p>
<p><b>注意：原来mysql默认的配置文件放在/etc/my.cnf。现在多个版本同时运行，需要每个版本都将配置文件单独放在自己的安装目录内。</b></p>
<p><b><br />
</b></p>
<p>创建MySQL启动脚本</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote">cp support-files/mysql.server /etc/init.d/mysql5516</div>
<p></p>
<p><b>注意：原来mysql默认采用mysqld脚本，现在每个mysql需要有自己的启动脚本，并通过修改启动脚本来为每个mysql指定采用的配置文件。</b></p>
<p><b><br />
</b></p>
<p>修改/etc/init.d/mysql5516，用来指定采用的配置文件位置。</p>
<p></p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;"># Try to find basedir in /etc/my.cnf&nbsp;</pre><pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;">&nbsp;conf=/etc/my.cnf</pre>&nbsp;在文件的213和214行内容如上，我们需要修改conf=/etc/my.cnf为我们指定的my.cnf文件位置。<p></p>
<p>在我们这里是</p>
<p></p>
<pre class="brush:shell; toolbar: true;gutter: true;auto-links: false;">conf=/usr/local/webserver/mysql5516/my.cnf</pre><p></p>
<p>修改mysqld5516权限为可执行</p>
<p></p>
<div id="kindeditor" class="quote">chmod +x mysqld5516</div>
<p></p>
<p></p>
<p>&nbsp;</p>
<p><b>7、启动mysql并配置为开机运行</b></p>
<p>启动</p>
<p></p>
<div id="kindeditor" class="quote">service mysqld5516 start</div>
<p></p>
<p>开机运行</p>
<p></p>
<div id="kindeditor" class="quote">chkconfig mysqld5516 on</div>
<p></p>
<p><b>以上是MySQL 5.5.16的安装。下面5.5.18版本的安装</b></p>
<p></p>
<div style="font-size:12px;line-height:18px;"><br />
</div>
<div style="font-size:12px;line-height:18px;">5.5.18版本的安装基本和MySQL 5.5.16版本一样。我们因为要两个数据库同时运行。所以再给cmake的参数时候，需要安装上面注意的内容设定5.5.18的安装目录为/usr/local/webserver/mysql5518 再调整运行端口为3307</div>
<div style="font-size:12px;line-height:18px;">具体的cmake参数如下</div>
<div style="font-size:12px;line-height:18px;"><div style="background-color:#ffead4;"></div>
</div>
<div id="kindeditor" class="quote"><div style="font-size:12px;line-height:18px;"><div style="background-color:#ffead4;">cmake . \</div>
<div style="background-color:#ffead4;">&nbsp; -DCMAKE_INSTALL_PREFIX=/usr/local/webserver/mysql5518/ \</div>
<div style="background-color:#ffead4;">&nbsp; -DMYSQL_DATADIR=/data0/mysql/3307/data \</div>
<div style="background-color:#ffead4;">&nbsp; -DMYSQL_UNIX_ADDR=/data0/mysql/3307/mysqld.sock \</div>
<div style="background-color:#ffead4;">&nbsp; -DWITH_MYISAM_STORAGE_ENGINE=1 \</div>
<div style="background-color:#ffead4;">&nbsp; -DWITH_INNOBASE_STORAGE_ENGINE=1 \</div>
<div style="background-color:#ffead4;">&nbsp; -DWITH_BLACKHOLE_STORAGE_ENGINE=0 \</div>
<div style="background-color:#ffead4;">&nbsp; -DWITH_ARCHIVE_STORAGE_ENGINE=0 \</div>
<div style="background-color:#ffead4;">&nbsp; -DWITHOUT_PARTITION_STORAGE_ENGINE=1 \</div>
<div style="background-color:#ffead4;">&nbsp; -DENABLED_LOCAL_INFILE=1 \</div>
<div style="background-color:#ffead4;">&nbsp; -DMYSQL_TCP_PORT=3307 \</div>
<div style="background-color:#ffead4;">&nbsp; -DEXTRA_CHARSETS=all \</div>
<div style="background-color:#ffead4;">&nbsp; -DDEFAULT_CHARSET=utf8 \</div>
<div style="background-color:#ffead4;">&nbsp; -DDEFAULT_COLLATION=utf8_general_ci \</div>
<div style="background-color:#ffead4;">&nbsp; -DWITH_DEBUG=0 \</div>
<div style="background-color:#ffead4;">&nbsp; -DWITH_EMBEDDED_SERVER=1 \</div>
<div style="background-color:#ffead4;">&nbsp; -DWITH_SSL=system \</div>
</div>
<div style="font-size:12px;line-height:18px;"></div>
</div>
<div style="font-size:12px;line-height:18px;"><br />
</div>
<div style="font-size:12px;line-height:18px;">还需要为mysql5518配置相应权限和建立3307端口的相关目录。因为上面已经有具体步骤，这里只是罗列下命令，不具体说明</div>
<div style="font-size:12px;line-height:18px;"><p style="padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:0px !important;background-color:#ffead4;"></p>
<div id="kindeditor" class="quote"><p style="padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:0px !important;background-color:#ffead4;">chmod +w /usr/local/webserver/mysql5518</p>
<p style="padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:0px !important;background-color:#ffead4;">chown -R mysql:mysql /usr/local/webserver/mysql5518</p>
<p style="padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:0px !important;background-color:#ffead4;">cd ../</p>
</div>
<p style="padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:0px !important;background-color:#ffead4;"></p>
<p style="padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:0px !important;background-color:#ffead4;"></p>
<p style="padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:0px !important;background-color:#ffead4;"></p>
<div></div>
<div id="kindeditor" class="quote"><div>mkdir -p /data0/mysql/3307/data/</div>
<div>mkdir -p /data0/mysql/3307/binlog/</div>
<div>mkdir -p /data0/mysql/3307/relaylog/</div>
<div>chown -R mysql:mysql /data0/mysql/</div>
</div>
<div></div>
<p></p>
</div>
<div style="font-size:12px;line-height:18px;">最后的启动脚本也要修改为调用5518目录下的my.cnf配置。 而且my.cnf的[mysqld]段也要指定运行端口为3307</div>
<div style="font-size:12px;line-height:18px;">下面是我mysql5518目录下的my.cnf中的一些需要修改的项</div>
<div style="font-size:12px;line-height:18px;"><b>注意：下面文件并不是完整的my.cnf，只是将需要修改的列出来了</b></div>
<div><div></div>
<div id="kindeditor" class="quote"><div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[client]</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">port &nbsp; &nbsp;= 3307</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">socket &nbsp;= /data0/mysql/3307/mysql.sock</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">[mysqld]</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">port &nbsp; &nbsp;= 3307</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">socket &nbsp;= /data0/mysql/3307/mysql.sock</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">basedir = /usr/local/webserver/mysql5518</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">datadir = /data0/mysql/3307/data</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">log-error = /data0/mysql/3307/mysql_error.log</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">pid-file = /data0/mysql/3307/mysql.pid</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">log-bin = /data0/mysql/3307/binlog/binlog</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">relay-log-index = /data0/mysql/3307/relaylog/relaylog</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">relay-log-info-file = /data0/mysql/3307/relaylog/relaylog</span></div>
<div><span class="Apple-style-span" style="font-size:12px;line-height:18px;">relay-log = /data0/mysql/3307/relaylog/relaylog</span></div>
</div>
<div></div>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">这样弄完后，我服务器上就可以同时运行mysql5516与mysql5518两个版本的数据库了。</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">启动、关闭、重启mysql 5.5.16全部采用service mysqld5516脚本来控制。</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;">启动、关闭、重启mysql 5.5.18全部采用service mysqld5518脚本来控制。</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><br />
</span></p>
<p><span class="Apple-style-span" style="font-size:12px;line-height:18px;"><b>总结：同时运行多个版本数据库，可以方便我们升级数据库或者对不同版本进行测试。</b></span></p>
</div>
<p></p>
</div>
<p></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/113">mysqldump解决中文乱码问题</a></p><p><a href="http://xinlogs.com/disable-mysql-query-log">开启或者关闭MYSQL的query log(查询日志)</a></p><p><a href="http://xinlogs.com/ruby_import_dbf_to_mysql">ruby将DBF文件导入MYSQL库</a></p><p><a href="http://xinlogs.com/post/24">Mysql设置my.cnf来记录下全部sql请求</a></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p></div>]]></description>
	<pubDate>Fri, 25 Nov 2011 07:21:05 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Linux-source-install-multiple-versions-of-MySQL</guid>

</item>
<item>
	<title>emlog支付插件发布</title>
	<link>http://xinlogs.com/emlog-alipay-pulgin</link>
	<description><![CDATA[<p>今天看到支付宝可以采用http://me.alipay.com/用户名的形式创建自己的收款页面。以前要想写支付宝的付款插件，需要先申请一个商家用户，拿到分配你的密钥才可以。现在可以通过创建收款主页来直接收款，对于程序开发方便了很多（不过这个方式只能简单的收款，并不能用于商品的订单，没有回调函数不能知道是否收款成功等内容）。</p>
<p>而且看到wordpress貌似已经有了这样的插件可以用来发布一个收款按钮，于是我也心血来潮写了一个。主要还是为了学习如何写一个emlog的插件。看着官方的插件开发文档，参考着公告插件的代码来写的这个支付宝收款插件。</p>
<p>&nbsp;</p>
<p><b>主要功能：</b></p>
<p>1、在博客的侧边栏显示出一个支付宝的收款按钮，基本也就是用来让人家自愿捐款用。如下图：</p>
<p><a target="_blank" href="/content/uploadfile/201111/dc52c595a54d30a8c75037440df4329320111120123853.jpg" id="ematt:74"><img src="/content/uploadfile/201111/thum-dc52c595a54d30a8c75037440df4329320111120123853.jpg" width="420" height="117" title="点击查看原图" alt="点击查看原图" border="0" /></a></p>
<p>&nbsp;</p>
<p>2、后台可以方便的设置用来收款的支付宝收款主页地址。</p>
<p><a target="_blank" href="/content/uploadfile/201111/a893fefaf93a1b8b2ed0a350417b7d6120111120124028.jpg" id="ematt:75"><img src="/content/uploadfile/201111/thum-a893fefaf93a1b8b2ed0a350417b7d6120111120124028.jpg" width="420" height="155" title="点击查看原图" alt="点击查看原图" border="0" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/bo-blog-to-emlog">微博从bo-blog迁移到了emlog。</a></p><p><a href="http://xinlogs.com/mod-template-emidream">修改EMiDream模板</a></p><p><a href="http://xinlogs.com/emlog-optimize-via-minify">emlog访问速度优化之minify整合css与js文件</a></p></div>]]></description>
	<pubDate>Sun, 20 Nov 2011 12:31:07 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/emlog-alipay-pulgin</guid>

</item>
<item>
	<title>emlog访问速度优化之minify整合css与js文件</title>
	<link>http://xinlogs.com/emlog-optimize-via-minify</link>
	<description><![CDATA[<p>我们知道网站的访问速度和很多因素相关，但是今天这里只是优化我们能力范围内的首页文件加载数量与大小。</p>
<p>如果首页文件很大，肯定加载慢。还有一个因素就是首页如果加载很多css和js文件，因为在加载过程中会建立很多次连接从而降低访问首页的速度。</p>
<p>下面是我博客默认情况下的加载css和js文件的数量</p>
<p><a target="_blank" href="/content/uploadfile/201111/608b080a399c83bbd679f8afef089cfc20111117063223.jpg" id="ematt:68"><img src="/content/uploadfile/201111/thum-608b080a399c83bbd679f8afef089cfc20111117063223.jpg" width="420" height="43" title="点击查看原图" alt="点击查看原图" border="0" /></a></p>
<p><a target="_blank" href="/content/uploadfile/201111/f6893b6f67d76ff8c173d31adb40201f20111117063249.jpg" id="ematt:69"><img src="/content/uploadfile/201111/thum-f6893b6f67d76ff8c173d31adb40201f20111117063249.jpg" alt="点击查看原图" border="0" /></a></p>
<p>从图上可以看到加载了4个css文件和5个js文件。大小分别为54.2kb和45.5kb。</p>
<p>&nbsp;</p>
<p>下面我们的主要工具出场：<b>minify</b></p>
<p>这个程序是纯php编写的开源程序，用来将我们网站的css和js文件进行整合与压缩。这样我们就可以通过整合css与js文件并压缩大小从而提高首页加载速度。</p>
<p>&nbsp;</p>
<p>首先将minify下载，我这里采用的是minify_2.1.3版本。将下载后的min目录放到网站的根目录。</p>
<p>接着我们改造我们的程序，让css与js文件通过minify程序合并压缩。</p>
<p>&nbsp;</p>
<p>我是自己写了一个类，我起名为merge.php用来调用minify整合。下面是类代码</p>
<p></p>
<pre class="brush:php; toolbar: true;gutter: true;auto-links: false;">&lt;?php
/**
 * JS和CSS文件合并类
 *
 * @copyright (c) xinlogs.com All Rights Reserved
 * $Id: merge.php 2011-11-16 09:54:58Z  xinlogs.com$
 */

class Merge {
  //定义两个数组用来存储全部css和js文件的位置
  static private $css_list=array();
  static private $js_list=array();
  static private $js_code=array();
  //定义addCssFile方法，用来添加css文件到数组
  static function addCssFile($addFilePath) {
    array_push(self::$css_list,$addFilePath);
  }
  //定义getCssList方法，用来返回css文件字符串
  static function getCssList(){
    return implode(",",self::$css_list);
  }
  //定义addJsFile方法，用来添加js文件到数组
  static function addJsFile($addFilePath) {
    array_push(self::$js_list,$addFilePath);
  }
  //定义getJsList用来返回js文件字符串
  static function getJsList(){
    return implode(",",self::$js_list);
  }
  //加入js代码
  static function addJsCode($addJsCode)
  {
    array_push(self::$js_code,$addJsCode);
  }

  static function includejscode(){
    return implode(" ",self::$js_code);
  }
  //用来返回加入CSS代码的语句
  static function includecss() {
    $css="&lt;link href=".BLOG_URL."min/?f=".Merge::getCssList()." rel=\"stylesheet\" type=\"text/css\" /&gt;";
    return $css;
  }
  //用来返回插件js代码的语句
  static function includejs() {
    $js="&lt;script src=".BLOG_URL."min/?f=".Merge::getJsList()." type=\"text/javascript\"&gt;&lt;/script&gt;";
    return $js;
  }
}</pre>将merge.php放到网站include/lib目录下，emlog就会自动加载这个类了。<p></p>
<p>&nbsp;</p>
<p>接着我们修改我们的模板与插件，让所有css与js文件通过Merge这个类来处理。</p>
<p>一般css与js文件都是在模板的header.php文件内加载的，这里以默认模板为例说明</p>
<p>我们打开header.php文件，然后修改css文件加载的语句。将原来加载css的语句，采用Merge::addcssfile方法代替</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote">Merge::addCssFile("content/templates/default/main.css");</div>
<p></p>
<div>最后在doAction后面统一输出我们合并后的css文件。</div>
<div><div></div>
<div id="kindeditor" class="quote"><div>&lt;?php doAction('index_head'); ?&gt;</div>
<div>&lt;?php echo Merge::includecss();?&gt;</div>
</div>
<div></div>
</div>
<div><br />
</div>
<p></p>
<p>我们再来处理js文件，我是将模板的js文件调整到了fooder.php里加载，下面以这个footer.php为例说明</p>
<p>首先将加载js文件的语句，替换为Merge::addJsFile方法</p>
<p></p>
<div id="kindeditor" class="quote">&lt;?php Merge::addJsFile("include/lib/js/common_tpl.js");?&gt;</div>
<p></p>
<p>然后在doAction后面再统一调用合并后的js文件</p>
<p></p>
<div id="kindeditor" class="quote"><p>&lt;?php doAction('index_footer'); ?&gt;</p>
<p></p>
<p>&lt;?php echo Merge::includejs();?&gt;</p>
<p>&lt;?php echo Merge::includejscode();?&gt;</p>
<p></p>
</div>
<p></p>
<p></p>
<p>&nbsp;</p>
<p>以上只是针对模板的修改，我的这个博客还采用了高亮代码的插件，这个插件会调用一些js与css文件。所以下面我还修改这个插件的代码，使它也通过merge类来合并输出css与js。</p>
<p>这个插件主要修改drp_highlighter.php文件，在<span class="Apple-style-span" style="font-size:12px;line-height:18px;background-color:#ffead4;">drp_highlighter_index_head方法里加入css的引入</span></p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>function drp_highlighter_index_head() {</p>
<p>&nbsp; Merge::addCssFile("content/plugins/drp_highlighter/css/editor.css");</p>
<p>}</p>
</div>
<p></p>
<p>&nbsp;</p>
<p>在<span class="Apple-style-span" style="font-size:12px;line-height:18px;background-color:#ffead4;">drp_highlighter_index_footer方法里加入对js文件与代码的引入。</span></p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>function drp_highlighter_index_footer(){</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; include(EMLOG_ROOT.'/content/plugins/drp_highlighter/config.php');</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; Merge::addJsFile("content/plugins/drp_highlighter/js/jquery.js");</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; Merge::addJsFile("content/plugins/drp_highlighter/js/jquery.highlighter.src.js");</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; $jscode="</p>
<p>&lt;script type='text/javascript'&gt;</p>
<p>$(document).ready(function(){</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; var option={</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dir:'".BLOG_URL."content/plugins/drp_highlighter/js/syntaxhighlighter/',</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name:'code',</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; showControls:true,</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skin:'".constant('highlighter')."'</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; };</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; $.SyntaxHighlighter(option);</p>
<p>});</p>
<p>&lt;/script&gt;";</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; Merge::addJsCode($jscode);</p>
<p>}</p>
</div>
<p></p>
<p>&nbsp;</p>
<p>最后在文件最后面找到注册action的代码，和上面方法名修改对应上。</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>addAction('adm_sidebar_ext', 'drp_highlighter_adm_sidebar');</p>
<p>addAction('index_head','drp_highlighter_index_head');</p>
<p>addAction('index_footer', 'drp_highlighter_index_footer');</p>
<p>addAction('adm_writelog_head','drp_highlighter_adm_head');</p>
</div>
<p></p>
<p></p>
<p></p>
<p></p>
<p>&nbsp;</p>
<p>下面是我整合css与js代码后的效果</p>
<p><a target="_blank" href="/content/uploadfile/201111/8f685fc5bfcc86915423e98a6c8132a420111117065631.jpg" id="ematt:71"><img src="/content/uploadfile/201111/thum-8f685fc5bfcc86915423e98a6c8132a420111117065631.jpg" width="420" height="42" title="点击查看原图" alt="点击查看原图" border="0" /></a></p>
<p>css文件降低为3个，其中有两个为新浪微博的代码，这个不好整合了。。。</p>
<p><a target="_blank" href="/content/uploadfile/201111/e552b0dde56885bff97f4addbf7bb34720111117065803.jpg" id="ematt:72"><img src="/content/uploadfile/201111/thum-e552b0dde56885bff97f4addbf7bb34720111117065803.jpg" width="420" height="43" title="点击查看原图" alt="点击查看原图" border="0" /></a></p>
<p>js文件数降低为3个，其中一个是微博的，一个是百度统计的。我们自己的代码已经整合到一个请求里调用了。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p></p>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/emlog-alipay-pulgin">emlog支付插件发布</a></p><p><a href="http://xinlogs.com/bo-blog-to-emlog">微博从bo-blog迁移到了emlog。</a></p><p><a href="http://xinlogs.com/mod-template-emidream">修改EMiDream模板</a></p></div>]]></description>
	<pubDate>Thu, 17 Nov 2011 06:28:49 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/emlog-optimize-via-minify</guid>

</item>
<item>
	<title>S10赛季竞技场点数计算器</title>
	<link>http://xinlogs.com/s10-Conquest-Cap</link>
	<description><![CDATA[<p>现在国服已经S10赛季了，以前我写过一篇关于<a href="/JJC" target="_blank">S9赛季计算的方法和工具</a>。现在再来更新下S10赛季的。</p>
<p>首先在网上找到了下面的这张图</p>
<p><a target="_blank" href="/content/uploadfile/201111/63dadab5da8d11cd548c2354ff05137f20111113082356.jpg" id="ematt:67"><img src="/content/uploadfile/201111/thum-63dadab5da8d11cd548c2354ff05137f20111113082356.jpg" width="420" height="234" title="点击查看原图" alt="点击查看原图" border="0" /></a></p>
<p>从图中可以看出，现在评级战场获取的征服点数每周上限已经超越了竞技场等级获取的了。</p>
<p>竞技场最低是1350起步，而评级战场最低是1650起步。</p>
<p>而且我们可以看到1700到2200分数段的分数增加最为明显，高于2200以后，逐渐邹平。</p>
<p>&nbsp;</p>
<p>再来转发个计算器的网址：<a href="http://www.whatsmycap.com/">http://www.whatsmycap.com/</a></p>
<p>不过普遍反映这个计算器存在误差，不过大家基本也就是为了知道自己大概下周可以拿多少分。存在点误差还可以忍受。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/post/26">我冲高督的心得</a></p><p><a href="http://xinlogs.com/JJC">S9赛季征服点上限计算器</a></p><p><a href="http://xinlogs.com/wow-1-70-Express-Upgrade">国服3.13 德鲁伊带小号快速升级（1-70全程带）</a></p></div>]]></description>
	<pubDate>Sun, 13 Nov 2011 08:20:34 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/s10-Conquest-Cap</guid>

</item>
<item>
	<title>nginx通过301统一入口域名</title>
	<link>http://xinlogs.com/nginx-301-rewrite</link>
	<description><![CDATA[<p>我们知道网站的入口域名一般都是www.domain.com或者domain.com。有的网站选择带www而有的网站选择不带www。</p>
<p>但是搜索引擎会将www.domian.com和domian.com 认为是两个地址从而分散我们的权重。所以通过nginx的301转向来统计入口域名，有利于我们的网站提高权重。</p>
<p>&nbsp;</p>
<p>以我的博客为例，服务器采用的就是nginx+fastcgi配合php模式。我的nginx关于博客的配置如下</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>server</p>
<p>&nbsp; {</p>
<p>&nbsp; &nbsp; listen &nbsp; &nbsp; &nbsp; 80;</p>
<p>&nbsp; &nbsp; server_name &nbsp;xinlogs.com www.xinlogs.com;</p>
</div>
<p></p>
<p></p>
<p>这样通过xinlogs.com或者www.xinlogs.com都可以访问到我的博客，但是这样做相当于我的博客首页有了两个地址，不利于搜索引擎收录和分配权重。</p>
<p>所以我采用nginx提供的rewrite来实现301转向，通过301转向的域名地址搜索引擎会将权重或者PR也一起转向过去。这样就不损失网站的PR和权重了。也就是把通过www或者不带www访问的这些流量和查询或者外链的权重整合到了一起。</p>
<p>下面是我的配置，我希望通过xinlogs.com作为我博客的统一入口域名，而带www的访问全部转向到xinlogs.com域名。</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>server</p>
<p>&nbsp; {</p>
<p>&nbsp; &nbsp; listen &nbsp; &nbsp; &nbsp; 80;</p>
<p>&nbsp; &nbsp; server_name &nbsp;xinlogs.com www.xinlogs.com;</p>
<p>&nbsp; &nbsp; if ($host != "xinlogs.com") {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; rewrite ^/(.*)$ http://xinlogs.com/$1 permanent;</p>
<p>&nbsp; &nbsp; }</p>
</div>
<p></p>
<p></p>
<p>经过上面的的配置，也就是那句if条件语句，将不是xinlogs.com的域名，全部转移到了xinlogs.com下。</p>
<p>&nbsp;</p>
<p>下面我们测试下效果，因为只有明确的看到了转向信息，才证明我的配置成功了。所以采用curl命令测试。</p>
<p>测试www.xinlogs.com是否被转向</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>-bash-3.2# curl -i www.xinlogs.com</p>
<p>HTTP/1.1 301 Moved Permanently</p>
<p>Server: nginx/1.0.8</p>
<p>Date: Sun, 13 Nov 2011 05:03:22 GMT</p>
<p>Content-Type: text/html</p>
<p>Content-Length: 184</p>
<p>Connection: keep-alive</p>
<p>Location: http://xinlogs.com/</p>
<p>&nbsp;</p>
<p>&lt;html&gt;</p>
<p>&lt;head&gt;&lt;title&gt;301 Moved Permanently&lt;/title&gt;&lt;/head&gt;</p>
<p>&lt;body bgcolor="white"&gt;</p>
<p>&lt;center&gt;&lt;h1&gt;301 Moved Permanently&lt;/h1&gt;&lt;/center&gt;</p>
<p>&lt;hr&gt;&lt;center&gt;nginx/1.0.8&lt;/center&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
</div>
<p></p>
<p></p>
<p>可以看到被成功转向到了location:http://xinlogs.com/了</p>
<p>再看看xinlogs.com是否可以正常访问。<b><span style="color:#e53333;">注意：这个很关键，因为有时候配置错了会导致循环转向让主域名入口无法访问。</span></b></p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>-bash-3.2# curl -i xinlogs.com</p>
<p>HTTP/1.1 200 OK</p>
<p>Server: nginx/1.0.8</p>
<p>Date: Sun, 13 Nov 2011 05:05:43 GMT</p>
<p>Content-Type: text/html; charset=UTF-8</p>
<p>Transfer-Encoding: chunked</p>
<p>Connection: keep-alive</p>
<p>Vary: Accept-Encoding</p>
<p>X-Powered-By: PHP/5.3.8</p>
<p style="font-weight:bold;"></p>
<p style="font-weight:bold;"></p>
<p>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</p>
<p>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;</p>
<p>后面内容省略了。。。</p>
</div>
<p></p>
<p></p>
<p><b><br />
</b></p>
<p>&nbsp;可以看到xinlogs.com域名访问正常，正确返回200 ok。而且下面的页面内容也正确返回了。</p>
<p></p>
<p></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/nginx-epool-events">nginx采用epoll的事件模型，为何效率高。</a></p><p><a href="http://xinlogs.com/howto-open-rewrite-log">伪静态规则调试技巧</a></p><p><a href="http://xinlogs.com/Solve-nginx-502-mistakes">nginx通过轮询避免php-fpm引起的502错误</a></p><p><a href="http://xinlogs.com/druapl-url-nginx-rewrite">drupal在nginx 0.8.15下的简洁URL配置</a></p></div>]]></description>
	<pubDate>Sun, 13 Nov 2011 04:53:43 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/nginx-301-rewrite</guid>

</item>
<item>
	<title>Centos Linux 远程终端ssh乱码问题</title>
	<link>http://xinlogs.com/centos-linux-sshclient-unreadable-code</link>
	<description><![CDATA[<p>我们经常碰到linux乱码问题。尤其是碰到网页上传个中文文件名的文件，ssh登陆到linux一看全乱码想删除都不行。很郁闷的。如下图所示中文文件名全都是显示问号了（这个乱码由于你的编码设置不同，显示的也不太一样）</p>
<p><a target="_blank" href="/content/uploadfile/201111/2322075ba26b81fb6c3bbe9784583ec320111110021108.jpg" id="ematt:60"><img src="/content/uploadfile/201111/thum-2322075ba26b81fb6c3bbe9784583ec320111110021108.jpg" width="420" height="20" title="点击查看原图" alt="点击查看原图" border="0" /></a></p>
<p>还有一个就是vim的乱码</p>
<p><a target="_blank" href="/content/uploadfile/201111/7599c2dd870bfaa7632dc174843a863720111110011704.jpg" id="ematt:61"><img src="/content/uploadfile/201111/7599c2dd870bfaa7632dc174843a863720111110011704.jpg" width="107" height="24" title="点击查看原图" alt="点击查看原图" border="0" /></a></p>
<p>&nbsp;</p>
<p>解决办法：</p>
<p>首先需要给linux安装中文支持。这里以centos为例，所以采用yum安装</p>
<p></p>
<div id="kindeditor" class="quote">yum groupinstall chinese-support</div>
然后再设置linux系统的i18n文件，位置在/etc/sysconfig/i18n<p></p>
<p>内容如下</p>
<p></p>
<div id="kindeditor" class="quote"><p>LANG="zh_CN.GB18030"</p>
<p>SUPPORTED="zh_CN.UTF-8:zh_CN.GBK:zh_CN.GB18030:zh_CN:zh:en_US.UTF-8:en_US:en"</p>
<p>SYSFONT="latarcyrheb-sun16"</p>
</div>
<p></p>
<p>接着设置LC_ALL环境变量，在/etc/profile文件里加入</p>
<p>export LC_ALL=zh_CN.GB18030</p>
<p>全部设置好后，重启系统。再次登陆后，用如下命令查看</p>
<p></p>
<p></p>
<div id="kindeditor" class="quote"><p>-bash-3.2# locale</p>
<p>LANG=zh_CN.GB18030</p>
<p>LC_CTYPE="zh_CN.GB18030"</p>
<p>LC_NUMERIC="zh_CN.GB18030"</p>
<p>LC_TIME="zh_CN.GB18030"</p>
<p>LC_COLLATE="zh_CN.GB18030"</p>
<p>LC_MONETARY="zh_CN.GB18030"</p>
<p>LC_MESSAGES="zh_CN.GB18030"</p>
<p>LC_PAPER="zh_CN.GB18030"</p>
<p>LC_NAME="zh_CN.GB18030"</p>
<p>LC_ADDRESS="zh_CN.GB18030"</p>
<p>LC_TELEPHONE="zh_CN.GB18030"</p>
<p>LC_MEASUREMENT="zh_CN.GB18030"</p>
<p>LC_IDENTIFICATION="zh_CN.GB18030"</p>
<p>LC_ALL=zh_CN.GB18030</p>
</div>
<p></p>
<div><br />
</div>
<div>完成以上操作，应该就可以正常显示中文文件名字了。不过这个只是linux没有问题了，我们的ssh客户端还需要支持才可以。我一般使用Putty来当做ssh客户端，下面就以putty为例子进行设置。</div>
<div>先设置使用的字体，选择windows-&gt;Appearance，弹出的字体界面里选择“新宋体”，字符集选择“CHINESE_GB2312”</div>
<div><a target="_blank" href="/content/uploadfile/201111/be82d1b2c5e6aa91698156b17933a82c20111110030323.jpg" id="ematt:62"><img src="/content/uploadfile/201111/thum-be82d1b2c5e6aa91698156b17933a82c20111110030323.jpg" alt="点击查看原图" border="0" /></a><br />
</div>
<div><br />
</div>
<div>再设置编码</div>
<p><a target="_blank" href="/content/uploadfile/201111/d0689cae77ad99c2e8592e5d82eca0e520111110030450.jpg" id="ematt:63"><img src="/content/uploadfile/201111/thum-d0689cae77ad99c2e8592e5d82eca0e520111110030450.jpg" alt="点击查看原图" border="0" /></a></p>
<p>以上设置完成后，就可以正常显示了。效果如下图所示：</p>
<p><a target="_blank" href="/content/uploadfile/201111/34cc05c5e482ce91cba812fd614308b120111110030630.jpg" id="ematt:64"><img src="/content/uploadfile/201111/thum-34cc05c5e482ce91cba812fd614308b120111110030630.jpg" alt="点击查看原图" border="0" /></a></p>
<div><br />
</div>
<div>在命令行输入中文文件名也可以正常使用了。</div>
<p><a target="_blank" href="/content/uploadfile/201111/f64f6c65c77b39de6c0f02edec0a883420111110030705.jpg" id="ematt:65"><img src="/content/uploadfile/201111/f64f6c65c77b39de6c0f02edec0a883420111110030705.jpg" alt="点击查看原图" border="0" /></a></p>
<p>到目前为止，ssh下操作中文文件名的问题就彻底解决了。可以正常输入中文文件名来操作了。</p>
<p>&nbsp;</p>
<p>下面是vim显示乱码问题，vim一般都是因为文件编码和显示编码的问题引起的乱码。</p>
<p>我们打开文件发现乱码后，采用如下命令</p>
<p></p>
<div id="kindeditor" class="quote">set encoding=utf-8 termencoding=gbk</div>
<p></p>
<p>&nbsp;</p>
<p></p>
<p>这样以后，vim也可以正常操作中文了。效果图</p>
<p><a target="_blank" href="/content/uploadfile/201111/5e0ba09c3d78f51517654564ad80598520111110031409.jpg" id="ematt:66"><img src="/content/uploadfile/201111/thum-5e0ba09c3d78f51517654564ad80598520111110031409.jpg" alt="点击查看原图" border="0" /></a></p>
<p>&nbsp;</p>
<p></p>
<div id="kindeditor" class="note"><p><b>网上看到一些资料说是将i18n的LANG设置为zh_CN.UTF-8，然后LC_ALL也是设置为zh_CN.UTF-8</b></p>
<p><b>但是我试验了下，效果并不好（也将putty调整为了utf-8）.但是文件名显示还是乱码。需要用ls --show-control-chars来正常显示，输入中文文件名也不正常。</b></p>
<p><b>以上只是在putty下使用，也许配合其他ssh客户端效果不太一样。稍后我再添加一些其他客户端效果。</b></p>
</div>
<p></p>
<p></p>
<p></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/108">CentOS下的Tomcat停止脚本</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/post/113">mysqldump解决中文乱码问题</a></p><p><a href="http://xinlogs.com/monit-to-monitor-services">monit监控linux服务</a></p><p><a href="http://xinlogs.com/post/17">如何快速统计服务器访问量</a></p></div>]]></description>
	<pubDate>Thu, 10 Nov 2011 02:03:25 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/centos-linux-sshclient-unreadable-code</guid>

</item>
<item>
	<title>解决godaddy注册域名无法解析问题</title>
	<link>http://xinlogs.com/godaddy-to-dnspod</link>
	<description><![CDATA[<p>godaddy.com是全球知名的域名注册商。国内很多站长也是使用的这个注册商。</p>
<p>但是出于各种原因，godaddy的域名服务器经常被国内封掉。导致我们注册的域名无法被解析。直接影响了网站的稳定性。</p>
<p>解决办法无非两个：一、不用godaddy了，二、换域名服务器。</p>
<p>如果不打算用godaddy了，我推荐name.com也不错，不过不支持支付宝了。需要用paypal支付</p>
<p>而我选择了第二种办法，采用国内的dns服务器来代替godaddy自己的，这样可以很好的解决问题。</p>
<p>&nbsp;</p>
<p>具体步骤：</p>
<p>到http://www.dnspod.cn去注册一个免费账号，不知道dnspod为何物的，可以参考下面介绍</p>
<p></p>
<h4 style="font-family:'Lucida Grande', Lucida, Verdana, sans-serif;font-size:12px;line-height:18px;">关于DNSPod</h4>
<p style="font-family:'Lucida Grande', Lucida, Verdana, sans-serif;font-size:12px;line-height:18px;text-indent:2em;"><a href="https://www.dnspod.cn/" style="color:black;font-weight:bold;text-decoration:none;">DNSPod</a>建立于2006年3月份，是国内最早提供免费智能DNS产品的网站，致力于为各类网站提供高质量的多线智能DNS免费解析。</p>
<p style="font-family:'Lucida Grande', Lucida, Verdana, sans-serif;font-size:12px;line-height:18px;text-indent:2em;">DNSPod以稳定性、安全性、功能强大、智能免费、高速等优 势深得广大站长和企业用户们的喜爱，以至于越来越多的企业站、地方门户站、游戏站等等都在使用DNSPod，他们喜欢的是DNSPod给他们带来的稳定性、承受能力强、访问速度快以及极高的用户体验，使用普通的DNS（像域名注册商提供的）不是不可以“用”，但是避免不了因为不稳定导致网站时常经常打不开，由于功 能限制不能实现想要实现的功能、因为用户体验不够好等丢失客户。所以选择一个好的DNS服务商可以为自己的网站带来很大的、意想不到的收益，避开不必要的损失。</p>
<p style="font-family:'Lucida Grande', Lucida, Verdana, sans-serif;font-size:12px;line-height:18px;text-indent:2em;">功能上：除了智能DNS解析，普通DNS解析也可以满足用户的稳定、高速等需求。相对竞争对手的产品，DNSPod除了实时生效，不限制用户添加的域名和记录数量外，还率先提供 了IPv6的支持和动态域名解析的功能，另外还支持DNS轮询、URL转发、API接口、批量修改管理等先进功能。并且所有功能都是免费提供。</p>
<p style="font-family:'Lucida Grande', Lucida, Verdana, sans-serif;font-size:12px;line-height:18px;text-indent:2em;">使用DNSPod的站长们知道，DNSPod不仅仅是以雄厚的技术优势，而且还是靠优质的服务赢得市场的，为几十万免费用户和几千VIP用户分别设立相应的技术支持！做到用户与DNSPod随时可以沟通，有问题及时解决！</p>
<p style="font-family:'Lucida Grande', Lucida, Verdana, sans-serif;font-size:12px;line-height:18px;text-indent:2em;">暴风影音、华军下载、魅族手机、VeryCD、4399、 霏凡下载、雨林木风、深度、手机之家、去看去看、站长之家、51啦、Discuz、cnBeta、 逐浪文学等知名网站都是DNSPod vip用户。</p>
<p></p>
<p>&nbsp;</p>
<p>将域名服务器修改到国内</p>
<p>在 dnspod的后台域名管理中，添加自己需要转到国内的解析的域名。如下图<a target="_blank" href="/content/uploadfile/201111/56af9fd5333e3f445b1cff9d2dbd9dea20111106003627.jpg" id="ematt:53"><img src="/content/uploadfile/201111/thum-56af9fd5333e3f445b1cff9d2dbd9dea20111106003627.jpg" alt="点击查看原图" border="0" /></a></p>
<p>&nbsp;</p>
<p>点开我们刚添加的域名，可以看到分配给我们的dns服务器。如下图</p>
<p><a target="_blank" href="/content/uploadfile/201111/5eb1cf9ece9a48b889b340b06138d3d620111106003830.jpg" id="ematt:54"><img src="/content/uploadfile/201111/thum-5eb1cf9ece9a48b889b340b06138d3d620111106003830.jpg" alt="点击查看原图" border="0" /></a></p>
<p>&nbsp;</p>
<p>现在我们登录到godaddy下，修改我们的DNS服务器到刚才dnspod分配给我们的dns服务器上。</p>
<p>登录后，如下图所示，点my account</p>
<p><a target="_blank" href="/content/uploadfile/201111/658f0b1ee74b632be8806fc6602b0ec820111106004049.jpg" id="ematt:55"><img src="/content/uploadfile/201111/thum-658f0b1ee74b632be8806fc6602b0ec820111106004049.jpg" alt="点击查看原图" border="0" /></a>&nbsp;</p>
<p>然后在域名管理界面，点我们要转到国内解析的域名。如图</p>
<p><a target="_blank" href="/content/uploadfile/201111/1a57bd3e00162b5d8c174238026b5c8820111106004217.jpg" id="ematt:56"><img src="/content/uploadfile/201111/thum-1a57bd3e00162b5d8c174238026b5c8820111106004217.jpg" alt="点击查看原图" border="0" /></a></p>
<p>进入域名管理后，找到NameServers项，点set name servers。如图</p>
<p><a target="_blank" href="/content/uploadfile/201111/b3c87dbfc6736532ee1edc04e0ce02a720111106004341.jpg" id="ematt:57"><img src="/content/uploadfile/201111/thum-b3c87dbfc6736532ee1edc04e0ce02a720111106004341.jpg" alt="点击查看原图" border="0" /></a></p>
<p>&nbsp;</p>
<p>上面点击“Set Nameservers”后，会弹出一个窗口让你设置DNS Server。如下图</p>
<p><a target="_blank" href="/content/uploadfile/201111/c753957e44891db644de811ca59941cc20111106004557.jpg" id="ematt:58"><img src="/content/uploadfile/201111/thum-c753957e44891db644de811ca59941cc20111106004557.jpg" alt="点击查看原图" border="0" /></a></p>
<p>将Nameserver1和Nameserver2里面的内容修改为dnspod分配给我们的dns服务器。nameserver3和nameserver4里面清空。</p>
<p>点 “OK”按钮完成设置。</p>
<p>域名服务器设置完，我们回到dnspod的后台，查看我们域名的状态。一般情况会是无法解析或者dns错误。这个说明还没有生效。最慢48小时生效。如果48小时候，还是错误就要找dnspod联系看看怎么解决了。也可以自己使用dnspod提供的域名全面诊断来判断问题。</p>
<p>下面是完全生效后的状态</p>
<p><a target="_blank" href="/content/uploadfile/201111/ef365e5ebadb5091cffc057e46cdd2dc20111106005013.jpg" id="ematt:59"><img src="/content/uploadfile/201111/thum-ef365e5ebadb5091cffc057e46cdd2dc20111106005013.jpg" alt="点击查看原图" border="0" /></a></p>
<p>&nbsp;</p>]]></description>
	<pubDate>Sun, 06 Nov 2011 00:26:24 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/godaddy-to-dnspod</guid>

</item>
<item>
	<title>Gvim配置</title>
	<link>http://xinlogs.com/givm-vimrc-file</link>
	<description><![CDATA[<p>vim是在linux下面很有名的编辑工具。而今天说到的这个gvim呢，就是vim工具在windows下的版本。</p>
<p>因为游戏、网银等种种原因，不是每个人都可以全部切换到linux下的，而linux的很多很棒的开源软件又特别好用。所以就尽量找这些软件的windows版本了。</p>
<p>&nbsp;</p>
<p>软件主页：<a href="http://www.vim.org/">http://www.vim.org/</a></p>
<p>下载地址：<a href="ftp://ftp.vim.org/pub/vim/pc/gvim73_46.exe">ftp://ftp.vim.org/pub/vim/pc/gvim73_46.exe</a></p>
<p>默认状态下的gvim是和windows软件一样，也有菜单和状态条等的。但是我个喜欢linux下的风格。下面就是我目前使用的样子</p>
<a id="ematt:51" href="/content/uploadfile/201110/fce3058a50cd9503739148285f64737520111031072549.jpg" target="_blank"><img border="0" alt="点击查看原图" src="/content/uploadfile/201110/thum-fce3058a50cd9503739148285f64737520111031072549.jpg" /></a> <p>&nbsp;</p>
<p>gvim的设置全部是基于目录下的_vimrc配置文件的。</p>
<p>这里具体的配置项内容我就不一一说明了，感兴趣的完全可以查看vim资料。我只是放出我的配置文件（基本也是网上其他高手分享出来的，自己修改下适合自己用就ok了）</p>
<p>&nbsp;</p>]]></description>
	<pubDate>Mon, 31 Oct 2011 07:18:12 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/givm-vimrc-file</guid>

</item>
<item>
	<title>修改EMiDream模板</title>
	<link>http://xinlogs.com/mod-template-emidream</link>
	<description><![CDATA[<p>今天修改了EMiDream模板。这个模板是给wordpress制作的，应用在<a href="http://www.templatesnext.org/">http://www.templatesnext.org/</a>网站</p>
<p>我是在emlog论坛找到了“通信民工”修改的过来的版本。</p>
<p>我所做的修改如下：</p>
<p>1、首页每条博客下面变为了中文的 评论 和 浏览</p>
<p>这个修改主要是在log_list.php文件中，将28、29行改为如下内容</p>
<pre class="brush:php; toolbar: true; auto-links: true;">    <span style="font-size:10px;">&lt;</span><span style="font-size:10px;">span class="postcomments"&gt;&lt;a href="&lt;?php echo $value['log_url']; ?&gt;#comments" title="查询评论"&gt;评论：&lt;?php echo $value['comnum']; ?&gt;&lt;/a&gt;&lt;/span&gt;
    &lt;span class="postmore"&gt;浏览：&lt;?php echo $value['views']; ?&gt;&lt;/span&gt;</span></pre> <p>2、友情链接只在首页的时候显示，这个有利于SEO。</p>
<p>主要是通过修改module.php实现。找到文件中关于友情链接段代码，然后在代码前后加入判断是否为首页的代码。</p>
<p>具体代码如下：</p>
<pre class="brush:php; toolbar: true; auto-links: true;">&lt;?php
  //判断是否是首页，不是首页，不显示友情链接
  if("http://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'] == BLOG_URL):?&gt;
&lt;?php
//widget：链接
function widget_link($title){
	global $CACHE; 
	$link_cache = $CACHE-&gt;readCache('link');
	?&gt;
	&lt;div class="widget-cat"&gt;
	&lt;h4&gt;&lt;?php echo $title; ?&gt;&lt;/h4&gt;
	&lt;ul id="link"&gt;
	&lt;?php foreach($link_cache as $value): ?&gt;
	&lt;li&gt;&lt;a href="&lt;?php echo $value['url']; ?&gt;" title="&lt;?php echo $value['des']; ?&gt;" target="_blank"&gt;&lt;?php echo $value['link']; ?&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;?php endforeach; ?&gt;
	&lt;/ul&gt;
	&lt;/div&gt;
&lt;?php }?&gt;
&lt;?php endif;?&gt;</pre> <p>&nbsp;</p>
<p>3、修改了下module.php的blog_comments函数。让这个函数和default模板保持一致。<br />
具体代码如下：</p>
<pre class="brush:php; toolbar: true; auto-links: true;">&lt;?php
//blog：博客评论列表
      function blog_comments($comments){
        //var_dump($comments);
    extract($comments);
    if($commentStacks): ?&gt;
	&lt;a name="comments"&gt;&lt;/a&gt;
	&lt;p class="comment-header"&gt;&lt;b&gt;评论：&lt;/b&gt;&lt;/p&gt;
	&lt;?php endif; ?&gt;
	&lt;?php
	$isGravatar = Option::get('isgravatar');
	foreach($commentStacks as $cid):
    $comment = $comments[$cid];
	$comment['poster'] = $comment['url'] ? '&lt;a href="'.$comment['url'].'" target="_blank" rel="nofollow"&gt;'.$comment['poster'].'&lt;/a&gt;' : $comment['poster'];
	?&gt;
	&lt;div class="comment" id="comment-&lt;?php echo $comment['cid']; ?&gt;"&gt;
		&lt;a name="&lt;?php echo $comment['cid']; ?&gt;"&gt;&lt;/a&gt;
		&lt;?php if($isGravatar == 'y'): ?&gt;&lt;div class="avatar"&gt;&lt;img src="&lt;?php echo getGravatar($comment['mail']); ?&gt;" /&gt;&lt;/div&gt;&lt;?php endif; ?&gt;
		&lt;div class="comment-info"&gt;
			&lt;b&gt;&lt;?php echo $comment['poster']; ?&gt; &lt;/b&gt;&lt;br /&gt;&lt;span class="comment-time"&gt;&lt;?php echo $comment['date']; ?&gt;&lt;/span&gt;
			&lt;div class="comment-content"&gt;&lt;?php echo $comment['content']; ?&gt;&lt;/div&gt;
			&lt;div class="comment-reply"&gt;&lt;a href="#comment-&lt;?php echo $comment['cid']; ?&gt;" onclick="commentReply(&lt;?php echo $comment['cid']; ?&gt;,this)"&gt;回复&lt;/a&gt;&lt;/div&gt;
		&lt;/div&gt;
		&lt;?php blog_comments_children($comments, $comment['children']); ?&gt;
	&lt;/div&gt;
	&lt;?php endforeach; ?&gt;
    &lt;div id="pagenavi"&gt;
	    &lt;?php echo $commentPageUrl;?&gt;
    &lt;/div&gt;
&lt;?php }?&gt;</pre> <p>&nbsp;</p>
<p>4、修复了置顶博客，不能正常显示“小星星”图标问题。</p>
<p>主要是将images目录下，放入import.gif文件</p>
<p>5、将评论里的对外链接加入了nofollow属性。这样有利于SEO，而且也不用担心垃圾评论来混外链了。</p>
<p>主要是修改module.php文件中blog_comments函数里面关于评论作者的那句。</p>
<p>具体代码如下</p>
<pre class="brush:php; toolbar: true;gutter: false;auto-links: false;">$comment['poster'] = $comment['url'] ? '&lt;a href="'.$comment['url'].'" target="_blank" rel="nofollow"&gt;'.$comment['poster'].'&lt;/a&gt;' : $comment['poster'];</pre><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/update-115disk-urls">批量更换115网盘链接</a></p><p><a href="http://xinlogs.com/emlog-alipay-pulgin">emlog支付插件发布</a></p><p><a href="http://xinlogs.com/emlog-optimize-via-minify">emlog访问速度优化之minify整合css与js文件</a></p><p><a href="http://xinlogs.com/check-slow-php-script">如何找到执行慢的php程序</a></p><p><a href="http://xinlogs.com/mac-xdebug-netbeans-config">mac下配置php调试环境</a></p></div>]]></description>
	<pubDate>Wed, 26 Oct 2011 13:57:18 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/mod-template-emidream</guid>

</item>
<item>
	<title>一个关于debian系统管理的站点</title>
	<link>http://xinlogs.com/debian-administration-site</link>
	<description><![CDATA[<p>这个站点有很多关于debian系统管理的信息和经验。</p>
<p>不过这个站点对于IE支持不好，页面会出现错位。建议还是采用firefox或者chrome这类的浏览器吧。</p>
<p>网址：<a href="http://www.debian-administration.org/">http://www.debian-administration.org/</a></p>
<p>简介如下，照搬的原文：</p>
<h1>Debian Administration</h1>
<p>This site was created as a simple weblog designed to contain interesting and useful information related to the System Administration of <a href="http://www.debian.org/">Debian GNU/Linux</a> systems.</p>
<p>Whilst there are several sites where users can post questions and have answers contributed by other users there are no other sites on the web which are specifically targeted at distributing articles of interest to Debian administrators.</p>
<p>This site is designed to fill that void, with content accepted from users.</p>
<p>Feel free to <a href="http://www.debian-administration.org/create/user">create your own account</a> and <a href="http://www.debian-administration.org/create/article">contribute an article, tip, or question</a> you may also <a href="http://www.debian-administration.org/create/poll">submit a poll</a>.</p>
<p>User accounts aren't necessary but they do allow you to do several additional things:</p>
<ul>
<li>See your own comment and story posting history </li>
<li>Bookmark articles, polls, or weblogs of interest to you. </li>
<li><a href="http://www.debian-administration.org/about/FAQ%20:%20Tags">Tag articles</a>. </li>
<li><a href="http://www.debian-administration.org/about/FAQ%20:%20Site%20Adverts">Disable the adverts</a> shown upon article pages. <ul>
<li>Or <a href="http://www.debian-administration.org/create/advert">Create your own advert</a> </li>
</ul>
</li>
<li>Create and post weblog entries. </li>
<li>Ensure the use of our <a href="http://www.debian-administration.org/about/SSL%20Certificate">SSL certificate</a> by always using https://. </li>
</ul>
<p>From your account page you can customize several aspects of the site - such as which sections are displayed in the sidebar, whether to receive notifications if other people reply to your comments, etc.</p>
<p>It should be noted that this site is neither an official part of the Debian project, nor endorsed by it. <a href="http://www.debian.org/">The Debian project</a> has its own official website, and the name Debian is a trademark held by <a href="http://www.spi-inc.org/">Software In the Public Interest</a>.</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/monit-to-monitor-services">monit监控linux服务</a></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p><p><a href="http://xinlogs.com/vps-dropbox-install">一款Linux下同步备份文件的好软件DROPBOX</a></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p><p><a href="http://xinlogs.com/post/108">CentOS下的Tomcat停止脚本</a></p></div>]]></description>
	<pubDate>Tue, 25 Oct 2011 15:10:27 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/debian-administration-site</guid>

</item>
<item>
	<title>离线博客工具-菊子曰</title>
	<link>http://xinlogs.com/post/127</link>
	<description><![CDATA[<p>因为迁移到了emlog，最近几天一直在鼓弄博客。</p>
<p>今天又尝试用离线工具写博客了。</p>
<p>在网站上搜索了下，发现国人开发的菊子曰不错。所以开始了这次尝试</p>
<p>功能方面日常写文章应该足够了。</p>
<p>就是如果是程序员用，代码高亮效果很一般</p>
<p>&nbsp;</p>
<div style="border-bottom:#e0e0e0 1px solid;border-left:#e0e0e0 1px solid;padding-bottom:10px;padding-left:10px;padding-right:10px;background:#ffffc0 no-repeat 4px 6px;border-top:#e0e0e0 1px solid;border-right:#e0e0e0 1px solid;padding-top:10px;"><span style="color:#ff0000;">代码高亮</span><?php phpinfo(); ?></div>
<p>&nbsp;</p>
<p>还有就是日志摘要功能，并不能符合emlog的日志摘要，基本只能全篇发上来。感觉如果文章不是很长，建议还是采用在线编辑吧。</p>
<p>再有就是采用了离线发布，将不能自动和新浪微博同步</p>]]></description>
	<pubDate>Tue, 25 Oct 2011 14:25:31 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/127</guid>

</item>
<item>
	<title>微博从bo-blog迁移到了emlog。</title>
	<link>http://xinlogs.com/bo-blog-to-emlog</link>
	<description><![CDATA[<p>今天将微博从原来的bo-blog迁移到了emlog</p>
<p>bo-blog从08年就一直开始使用。感觉还是很不错的。但是一直没怎么更新了，目前很多新功能都不支持。</p>
<p>其实我就打算让博客可以和新浪微博同步。新浪微博里也有个关联博客的功能，据说可以通过博客的rss内容来同步内容。</p>
<p>但是我参考网上文章修改了bo-blog模板，让首页里存在</p>
<p>&lt;link rel="alternate" type="application/rss+xml" href="<a href="http://www.xinlogs.com/feed">http://www.xinlogs.com/feed</a>"&nbsp; title="鑫的方向" /&gt;</p>
<p>然后又测试了<a href="http://www.xinlogs.com/feed">http://www.xinlogs.com/feed</a>，可以正常访问。</p>
<p>但是新浪微博就是不能同步到我博客的内容。</p>
<p>&nbsp;</p>
<p>最后我发现emlog目前的更新很活跃，而且还有个插件是调用新浪微博的api来将博客内容同步到微博的。就开始了我的迁移过程</p>
<p>迁移主要参考了<a href="http://bbs.bo-blog.com/thread-28348-1-1.html">http://bbs.bo-blog.com/thread-28348-1-1.html</a></p>
<p>原文如下：</p>
<p>转换过程很简单，先下载并安装emlog_4.0.1，再将原BoBlog中的attachment和data文件夹以及附件中的转换工具上传到新装emlog根目录，执行转换工具按照提示运行即可。<br />
<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;最终可以将BoBlog中的所有数据比较完美地导入emlog_4.0.1，包括原来BoBlog中的附件和自定义URL等等。对于emlog不支持UBB的问题其实应该很好解决：将UBB解析之后再导入数据库即可。由于我的777篇日志绝大部分不含UBB代码所以就没有继续折腾了……</p>
<p><strong>注意：</strong></p>
<p>我转换后，没有文章的分类了。但是查看数据库的sort表确实存在分类信息。这个时候，只要在后台建立一个分类。然后其他分类就都出现了。感觉转换效果很不错。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/mod-template-emidream">修改EMiDream模板</a></p><p><a href="http://xinlogs.com/emlog-alipay-pulgin">emlog支付插件发布</a></p><p><a href="http://xinlogs.com/vps-dropbox-install">一款Linux下同步备份文件的好软件DROPBOX</a></p><p><a href="http://xinlogs.com/emlog-optimize-via-minify">emlog访问速度优化之minify整合css与js文件</a></p><p><a href="http://xinlogs.com/post/25">如何向万网的Mysql数据库导入数据</a></p></div>]]></description>
	<pubDate>Tue, 25 Oct 2011 01:26:17 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/bo-blog-to-emlog</guid>

</item>
<item>
	<title>推荐个htc G3 hero比较不错的ROM</title>
	<link>http://xinlogs.com/htc-g3-hero-bast-rom</link>
	<description><![CDATA[<p>以前一直用ligux出的rom。因为htc G3的硬件原因，个人认为用android 2.1rom最好。刷了2.2和2.3都不是很满意。</p>
<p>原来我一直采用Dauu_SENSE_with_Compacache_BFS_v1.1-signed.zip</p>
<p>挺稳定的，就是速度一般。有时候内存不够了，会自动重启。</p>
<p>这次是在hiapk.com上找到的</p>
<p><a href="http://bbs.hiapk.com/thread-2539001-1-1.html">新加坡Artlive2.1急速优化版、添加翻页时钟、天气动画；视频为证</a></p>
<p>这个ROM是先刷上他的ROM，然后再刷一个<span style="color:#ff0000;font-size:large;">FlyKernel-13-M518-m352.zip</span><br />
&nbsp;</p>
<p>FlyKernel是一个用来只能调整CPU性能的补丁，在刷rom的时候，通过压缩包的文件名制定频率。比如上面的M518-m352就是最大和最小频率。</p>
<p>关于这个内核补丁，可以看下面的介绍</p>
<p><a href="http://www.cnrgb.com/flykernel-13">http://www.cnrgb.com/flykernel-13</a></p>
<p>&nbsp;</p>]]></description>
	<pubDate>Fri, 21 Oct 2011 03:49:43 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/htc-g3-hero-bast-rom</guid>

</item>
<item>
	<title>给bo-blog加上新浪的微博秀</title>
	<link>http://xinlogs.com/post/120</link>
	<description><![CDATA[<p>首先在新浪微博的&ldquo;微博小工具&rdquo;内找到&ldquo;微博秀&rdquo;。然后根据自己的需要设置好样式和大小。</p>
<p>从下面的</p>
<p>
<dt>&ldquo;设置完成，获得嵌入代码： &rdquo;框内粘贴出代码。</dt>
<dt></dt>
</p>
<p>
<dt>回到bo-blog后台，从&ldquo;常规管理&rdquo;-&gt;&ldquo;模块配置&rdquo;项了，添加一个&ldquo;侧边模块&rdquo;，起个名字叫新浪微博。</dt>
<dt></dt>
<dt>最后将刚才的代码贴进去。就可以了</dt>
</p>]]></description>
	<pubDate>Thu, 20 Oct 2011 10:49:03 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/120</guid>

</item>
<item>
	<title>centos 源码安装ruby和rubygems</title>
	<link>http://xinlogs.com/centos-install-ruby-rubygems</link>
	<description><![CDATA[<p><strong>获得ruby源代码</strong></p>
<p>wget <a href="http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p290.tar.gz">http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p290.tar.gz</a></p>
<p><strong>解压并编译ruby<br />
</strong>tar zxvf ruby-1.9.2-p290.tar.gz&nbsp; <br />
cd ruby-1.9.2-p290<br />
./configure --prefix=/usr/local/ruby192<br />
make<br />
make install<br />
在/etc/profile最后添加<br />
export PATH=/usr/local/ruby192/bin:$PATH<br />
保存后，执行<br />
source /etc/profile<br />
查看下ruby版本<br />
ruby -v</p>
<p><br />
<strong>下载rubygems1.8.10</strong><strong><br />
</strong>wget <a href="http://production.cf.rubygems.org/rubygems/rubygems-1.8.10.tgz">http://production.cf.rubygems.org/rubygems/rubygems-1.8.10.tgz</a></p>
<p><strong>解压并安装rubygems<br />
</strong>tar zxvf rubygems-1.8.10.tgz <br />
cd rubygems-1.8.10<br />
ruby setup.rb</p>
<p>安装后用gem -v 可以查看下版本</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/tomcat-memory-check">监控tomcat内存占用</a></p><p><a href="http://xinlogs.com/post/40">rails实现图片验证码</a></p><p><a href="http://xinlogs.com/post/17">如何快速统计服务器访问量</a></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p><p><a href="http://xinlogs.com/debian-administration-site">一个关于debian系统管理的站点</a></p></div>]]></description>
	<pubDate>Thu, 20 Oct 2011 02:59:29 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/centos-install-ruby-rubygems</guid>

</item>
<item>
	<title>关联bo-blog到新浪微博</title>
	<link>http://xinlogs.com/post/118</link>
	<description><![CDATA[<p>主要参考了<a href="http://www.cnwyw.net/post/bo-blog-guan-lian-bo-ke-xin-lang-wei-bo/">http://www.cnwyw.net/post/bo-blog-guan-lian-bo-ke-xin-lang-wei-bo/</a></p>
<p>基本就是修改模板里的elements.php文件</p>
<p>将href=&quot;feed.php&quot;修改为href=<a href="http://yourdomain/feed.php">http://yourdomain/feed.php</a></p>
<p>&nbsp;</p>]]></description>
	<pubDate>Thu, 20 Oct 2011 01:52:21 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/118</guid>

</item>
<item>
	<title>H3C路由器 tracert超时，解决办法。</title>
	<link>http://xinlogs.com/post/117</link>
	<description><![CDATA[<p>单位的H3C路由器和交换机上，tracert总是超时。但是可以正常上网或者ping到目标。</p>
<p>后来查找资料，找到了解决办法。</p>
<p>解决方法：</p>
<p>&nbsp;&nbsp;&nbsp; ip ttl-expires enable&nbsp;&nbsp;&nbsp;&nbsp; ip unreachables enable</p>
<p>（官方说法这两条命令默认开启，可能跟版本有关，有的默认未开启。）</p>
<p>官方对这两条命令解释是：</p>
<p>ip ttl-expires enable命 令用来开启设备的ICMP超时报文的发送功能。undo ip ttl-expires命令用来关闭设备的ICMP超 时报文的发送功能。（缺省情况下，ICMP超时报文发送功能处于开启状 态。）</p>
<p>需要注意的是，关闭ICMP超时报文发送 功能后，设备不会再发送“TTL超时”ICMP差 错报文，但“重组超时”ICMP差错报文仍会正常发送。</p>
<p>ip unreachables enable命 令用来开启设备的ICMP目的不可达报文的发送功能。undo ip unreachables命令用来关闭设备的ICMP目 的不可达报文的发送功能。（缺省情况下，ICMP目的不可达报文发送功 能处于关闭状态。）</p>
<p>&nbsp;</p>]]></description>
	<pubDate>Wed, 21 Sep 2011 01:45:09 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/117</guid>

</item>
<item>
	<title>S9赛季征服点上限计算器</title>
	<link>http://xinlogs.com/JJC</link>
	<description><![CDATA[<p>目前S9赛季征服点数的上限取决于每周个人获得的最高竞技场等级。</p>
<p>注意：22,33,55已经统一。也就是说你22打的成绩和33 55没有区别了，都可以获得相同的征服点上限。</p>
<p>下面是我写的一个计算征服点数的网页。</p>
<p><a href="/jjc.html">http://xinlogs.com/jjc.html</a></p>
<p>你也可以根据下面的公式自己看（这个公式来自<a href="http://bbs.ngacn.cc/read.php?tid=4510252">http://bbs.ngacn.cc/read.php?tid=4510252</a>）</p>
<p><span style="color:#dc143c;font-size:small;">y=1343, x∈[0,1500]<br />
<br />
y=-1.00844494413448e(-12)*x^5+1.2356986230482e(-8)*x^4-5.94771172066112e(-5)*x^3+0.13944365683441*x^2-156.936920229832*x+68836.3, x∈(1500,3000]</span><br />
<span style="line-height:120%;font-size:120%;"><br />
还有就是可以根据下面的曲线图估算</span></p>
<p><span style="line-height:120%;font-size:120%;"><img width="500" height="536" alt="" src="/attachment/1314409266_13848490.jpg" /></span></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/s10-Conquest-Cap">S10赛季竞技场点数计算器</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/post/26">我冲高督的心得</a></p><p><a href="http://xinlogs.com/wow-1-70-Express-Upgrade">国服3.13 德鲁伊带小号快速升级（1-70全程带）</a></p></div>]]></description>
	<pubDate>Sat, 27 Aug 2011 01:41:37 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/JJC</guid>

</item>
<item>
	<title>mysqldump备份blob类型内容</title>
	<link>http://xinlogs.com/mysqldump_blob_field</link>
	<description><![CDATA[<p>用mysqldump备份出数据库内容到SQL文件。当我们数据库表有blob类型字段的时候，这个导出的SQL再导入的时候就会因为blob字段内容乱码等原因，不能顺利导入了。</p>
<p><strong>解决办法：</strong></p>
<p>在用mysqldump备份的时候，采用--hex-blob参数，这样备份出来的sql文件，就可以顺利导入了。</p>]]></description>
	<pubDate>Wed, 30 Mar 2011 03:36:05 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/mysqldump_blob_field</guid>

</item>
<item>
	<title>ruby将DBF文件导入MYSQL库</title>
	<link>http://xinlogs.com/ruby_import_dbf_to_mysql</link>
	<description><![CDATA[<p>单位招生项目，需要向MySQL灌入一些数据测试。因为原始数据都是DBF文件，就是foxpro数据库。</p>
<p>下面是用ruby代码实现的导入功能。</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">Ruby 代码</span><span class="copyCodeText" onclick="copyIdText('code_5393');" style="cursor:pointer;">复制内容到剪贴板</span></div>
<div id="code_5393">
<ol class="dp-rb" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>require </span><span class="string">'rubygems'</span><span>  </span></span></li>
    <li><span>require </span><span class="string">'dbf'</span><span>  </span></li>
    <li class="alt"><span>require </span><span class="string">'mysql2'</span><span>  </span></li>
    <li><span>require </span><span class="string">'iconv'</span><span>  </span></li>
    <li class="alt"><span class="variable">@the_year</span><span>=</span><span class="string">"2011"</span><span>  </span></li>
    <li><span class="variable">@start_time</span><span>=</span><span class="builtin">Time</span><span>.now   </span></li>
    <li class="alt"><span class="variable">@major_list</span><span>=[]   </span></li>
    <li><span>client = Mysql2::Client.</span><span class="keyword">new</span><span>(</span><span class="symbol">:host</span><span> =&gt; </span><span class="string">"localhost"</span><span>, </span><span class="symbol">:username</span><span> =&gt; </span><span class="string">"root"</span><span>,</span><span class="symbol">:password</span><span>=&gt;</span><span class="string">"dxzddp"</span><span>,</span><span class="symbol">:database</span><span>=&gt;</span><span class="string">"enroll"</span><span>)</span><span class="comment">#创建数据库连接 </span><span>  </span></li>
    <li class="alt"><span>results = client.query(</span><span class="string">"SELECT major_id FROM major WHERE the_year='#{@the_year}'"</span><span>, </span><span class="symbol">:as</span><span> =&gt; </span><span class="symbol">:array</span><span>)   </span></li>
    <li><span>results.</span><span class="keyword">each</span><span> </span><span class="keyword">do</span><span> |row|   </span></li>
    <li class="alt"><span>  </span><span class="variable">@major_list</span><span>.push(row[0])   </span></li>
    <li><span class="keyword">end</span><span>  </span></li>
    <li class="alt"><span>p </span><span class="variable">@major_list</span><span>  </span></li>
    <li><span>table = DBF::Table.</span><span class="keyword">new</span><span>(</span><span class="string">"d:/ss.dbf"</span><span>)   </span></li>
    <li class="alt"><span>  table.</span><span class="keyword">each</span><span> </span><span class="keyword">do</span><span> |record|   </span></li>
    <li><span>      </span><span class="variable">@sfzh</span><span>=record.sfzh   </span></li>
    <li class="alt"><span>      </span><span class="variable">@name</span><span>=Iconv.iconv(</span><span class="string">"utf-8"</span><span>, </span><span class="string">"gb18030"</span><span>, record.xm)   </span></li>
    <li><span>      </span><span class="variable">@sfzh</span><span>=record.sfzh   </span></li>
    <li class="alt"><span>      </span><span class="variable">@ksh</span><span>=record.ksh   </span></li>
    <li><span>      </span><span class="variable">@major</span><span>=</span><span class="variable">@major_list</span><span>.choice   </span></li>
    <li class="alt"><span>      </span><span class="variable">@major2</span><span>=</span><span class="variable">@major_list</span><span>.choice   </span></li>
    <li><span>      </span><span class="variable">@major2</span><span>=</span><span class="variable">@major_list</span><span>.choice </span><span class="keyword">while</span><span> </span><span class="variable">@major2</span><span>==</span><span class="variable">@major</span><span>  </span></li>
    <li class="alt"><span>      </span><span class="variable">@to_student_info</span><span>=</span><span class="string">"insert into student_info (student_no,access_pwd,the_year) VALUES ('#{@sfzh}','e10adc3949ba59abbe56e057f20f883e','#{@the_year}')"</span><span>  </span></li>
    <li><span>      </span><span class="variable">@to_candidate</span><span>=</span><span class="string">"insert into candidate (candidate_name,id_card_no,candidate_no,state,has_submitted,the_year) VALUES ('#{@name}','#{@sfzh}','#{@ksh}','A','Y','#{@the_year}')"</span><span>  </span></li>
    <li class="alt"><span>      </span><span class="variable">@to_candidate_ideal</span><span>=</span><span class="string">"insert into candidate_ideal (candidate_id,first_major,second_major,allow_adjustment,is_living_in_college) VALUES (last_insert_id(),'#{@major}','#{@major2}','Y','Y')"</span><span>  </span></li>
    <li><span>      </span><span class="variable">@to_candidate_score</span><span>=</span><span class="string">"insert into candidate_score (candidate_id) VALUES (last_insert_id())"</span><span>  </span></li>
    <li class="alt"><span>      </span><span class="variable">@to_contact_info</span><span>=</span><span class="string">"insert into contact_info (candidate_id) VALUES (last_insert_id())"</span><span>  </span></li>
    <li><span>      </span><span class="variable">@to_school_info</span><span>=</span><span class="string">"insert into school_info (candidate_id) VALUES (last_insert_id())"</span><span>  </span></li>
    <li class="alt"><span>      </span><span class="keyword">begin</span><span>  </span></li>
    <li><span>      client.query(</span><span class="variable">@to_student_info</span><span>)   </span></li>
    <li class="alt"><span>      client.query(</span><span class="variable">@to_candidate</span><span>)   </span></li>
    <li><span>      client.query(</span><span class="variable">@to_candidate_ideal</span><span>)   </span></li>
    <li class="alt"><span>      client.query(</span><span class="variable">@to_candidate_score</span><span>)   </span></li>
    <li><span>      client.query(</span><span class="variable">@to_contact_info</span><span>)   </span></li>
    <li class="alt"><span>      client.query(</span><span class="variable">@to_school_info</span><span>)   </span></li>
    <li><span>      </span><span class="keyword">rescue</span><span> Mysql2::Error=&gt;e   </span></li>
    <li class="alt"><span>          puts e.to_s   </span></li>
    <li><span>  </span><span class="keyword">end</span><span>  </span></li>
    <li class="alt"><span class="keyword">end</span><span>  </span></li>
    <li><span>client=</span><span class="keyword">nil</span><span> </span><span class="keyword">if</span><span> client   </span></li>
    <li class="alt"><span>p </span><span class="builtin">Time</span><span>.now-</span><span class="variable">@start_time</span><span>  </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"> <script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>大体思路就是</p>
<p>1、建立数据库连接</p>
<p>2、查询招生专业major</p>
<p>3、打开dbf文件</p>
<p>4、每读取一行，想Mysql数据库写入一行，随机生成报考专业</p>
<p>5、关闭数据库连接</p>
<p>6、打印出用时</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/22">一个在windows下很好用的MySQL工具Navicat</a></p><p><a href="http://xinlogs.com/HeidiSQL">HeidiSQL一款开源的MySQL图形管理软件</a></p><p><a href="http://xinlogs.com/bo-blog-to-emlog">微博从bo-blog迁移到了emlog。</a></p><p><a href="http://xinlogs.com/post/112">Mysql设置不区分表名大小写</a></p><p><a href="http://xinlogs.com/bbsxp6-to-phpwind8">bbsxp 6.0数据导入phpwind 8.7方法</a></p></div>]]></description>
	<pubDate>Tue, 22 Mar 2011 00:59:39 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/ruby_import_dbf_to_mysql</guid>

</item>
<item>
	<title>mysqldump解决中文乱码问题</title>
	<link>http://xinlogs.com/post/113</link>
	<description><![CDATA[<p>我的数据库采用编码如下：</p>
<p>mysql&gt; show variables like 'coll%';<br />
+----------------------+-------------------+<br />
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
+----------------------+-------------------+<br />
| collation_connection | latin1_swedish_ci |<br />
| collation_database&nbsp;&nbsp; | latin1_swedish_ci |<br />
| collation_server&nbsp;&nbsp;&nbsp;&nbsp; | latin1_swedish_ci |<br />
+----------------------+-------------------+<br />
3 rows in set (0.00 sec)<br />
&nbsp;</p>
<p>mysql&gt; show variables like 'character_set%';<br />
+--------------------------+----------------------------+<br />
| Variable_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
+--------------------------+----------------------------+<br />
| character_set_client&nbsp;&nbsp;&nbsp;&nbsp; | latin1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
| character_set_connection | latin1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
| character_set_database&nbsp;&nbsp; | latin1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
| character_set_filesystem | binary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
| character_set_results&nbsp;&nbsp;&nbsp; | latin1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
| character_set_server&nbsp;&nbsp;&nbsp;&nbsp; | latin1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
| character_set_system&nbsp;&nbsp;&nbsp;&nbsp; | utf8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
| character_sets_dir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | /usr/share/mysql/charsets/ |<br />
+--------------------------+----------------------------+<br />
8 rows in set (0.00 sec)<br />
&nbsp;</p>
<p>数据库的编码采用utf8</p>
<p>开始用mysqldump出来的都是乱码。后来采用 --default-character-set=gbk参数，然后再用iconv转码为utf8就解决了问题。</p>
<p>下面是我的数据库备份脚本</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_8985');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_8985">
<ol class="dp-cpp" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span class="preprocessor">#!/bin/sh </span><span>&nbsp;&nbsp;</span></span></li>
    <li><span class="preprocessor">#####configurate####### </span><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>rq=`date&nbsp;+%Y%m%d%N` &nbsp;&nbsp;</span></li>
    <li><span>user=</span><span class="string">"user"</span><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>password=</span><span class="string">"password"</span><span>&nbsp;&nbsp;</span></li>
    <li><span>rm&nbsp;-rf&nbsp;/var/lib/mysql/mysql-bin.* &nbsp;&nbsp;</span></li>
    <li class="alt"><span>mysqldump&nbsp;-u$user&nbsp;-p$password&nbsp;--</span><span class="keyword">default</span><span>-character-set=gbk&nbsp;--single-transaction&nbsp;--flush-logs&nbsp;--master-data=2&nbsp;mydatabase&gt;/home/ict/mysql_backup/database$rq.sql &nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"> <script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>导出后转码</p>
<p>iconv -t utf-8 -f gbk -c database.sql&gt;databaseutf8.sql</p>
<p>这样已经可以看到正确的中文了。</p>
<p>导入</p>
<p>在windows下，如果采用HeidiSQL打开SQL文件，可以正确看到中文，但是导入后还是乱码。</p>
<p>解决办法，采用记事本打开，选择另存为，编码选择ANSI。然后再用HeidiSQL工具打开导入即可。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/9">ubuntu server 9.04 终端乱码问题</a></p><p><a href="http://xinlogs.com/ruby_import_dbf_to_mysql">ruby将DBF文件导入MYSQL库</a></p><p><a href="http://xinlogs.com/post/22">一个在windows下很好用的MySQL工具Navicat</a></p><p><a href="http://xinlogs.com/HeidiSQL">HeidiSQL一款开源的MySQL图形管理软件</a></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p></div>]]></description>
	<pubDate>Mon, 14 Mar 2011 08:38:35 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/113</guid>

</item>
<item>
	<title>Mysql设置不区分表名大小写</title>
	<link>http://xinlogs.com/post/112</link>
	<description><![CDATA[<p>今天遇到个问题，有个程序从Windows导入到Linux的时候，表格全部小写了。但程序里很多DAO全是大写调用。</p>
<p>Linux默认安装的Mysql是表名区分大小写的。</p>
<p>这个设置主要是在/etc/my.cnf里面的[mysqld]段，加入如下设置项</p>
<p>lower_case_table_names = 1<br />
&nbsp;</p>
<p>如果设置为0，就是区分大小写。设置为1就是不区分了。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/23">如何建立两个表间的外键</a></p><p><a href="http://xinlogs.com/post/22">一个在windows下很好用的MySQL工具Navicat</a></p><p><a href="http://xinlogs.com/disable-mysql-query-log">开启或者关闭MYSQL的query log(查询日志)</a></p><p><a href="http://xinlogs.com/post/24">Mysql设置my.cnf来记录下全部sql请求</a></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p></div>]]></description>
	<pubDate>Thu, 13 Jan 2011 14:47:05 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/112</guid>

</item>
<item>
	<title>病毒测试样本</title>
	<link>http://xinlogs.com/anti-virus-test-file</link>
	<description><![CDATA[<p>我们在安装好杀毒软件后，如何测试下效果呢？</p>
<p>下面的网站给我们提供了病毒测试样本：</p>
<p><a href="http://www.eicar.org/anti_virus_test_file.htm">http://www.eicar.org/anti_virus_test_file.htm</a></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/ssh-login-protection-by-denyhosts">通过denyhosts保护ssh登陆</a></p><p><a href="http://xinlogs.com/linux-ddos-defender">Linux防御DDOS攻击</a></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p></div>]]></description>
	<pubDate>Sun, 28 Nov 2010 04:21:23 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/anti-virus-test-file</guid>

</item>
<item>
	<title>监控tomcat内存占用</title>
	<link>http://xinlogs.com/tomcat-memory-check</link>
	<description><![CDATA[<p>最近单位给客户部署的一台服务器，主要跑的JAVA应用，一个物业OA系统。经常因为Tomcat内存占用过高而停止响应。</p>
<p>观察了一下，每次停止响应时候，Tomcat进程占用内存超过1.2G</p>
<p>初步怀疑是程序不够完善有内存泄露的地方，但是一时半会也找不到具体代码哪里有问题。</p>
<p>我就写了一个shell不断监控Tomcat进程内存占用，当发现内存占用大于800M，我就自动重启一次Tomcat。</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_2300');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_2300">
<ol class="dp-c" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>#!/bin/sh &nbsp;&nbsp;</span></span></li>
    <li><span>MEM=`ps&nbsp;aux|grep&nbsp;tomcat|grep&nbsp;startup|awk&nbsp;</span><span class="string">'{print&nbsp;$6}'</span><span>` &nbsp;&nbsp;</span></li>
    <li class="alt"><span>#</span><span class="func">echo</span><span>&nbsp;</span><span class="vars">$MEM</span><span>&nbsp;&nbsp;</span></li>
    <li><span class="keyword">if</span><span>&nbsp;[&nbsp;</span><span class="vars">$MEM</span><span>&nbsp;-gt&nbsp;800000&nbsp;];&nbsp;then &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;</span><span class="func">echo</span><span>&nbsp;</span><span class="string">"tomcat&nbsp;mem&nbsp;too&nbsp;large,restart&nbsp;tomcat!"</span><span>&nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;service&nbsp;tomcat&nbsp;restart &nbsp;&nbsp;</span></li>
    <li class="alt"><span>fi &nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"> <script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>注意：如果service tomcat restart不能正常重启Tomcat，可以参考我前面写的<a href="/admin/post/108">CentOS下的Tomcat停止脚本</a></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/centos_VPN_Howto">CentOS 5.3架设VPN和619错误排除</a></p><p><a href="http://xinlogs.com/post/11">CentOS里的Xen配置pygrub</a></p><p><a href="http://xinlogs.com/Tomcat-reboot-problems">解决Linux下Tomcat不能重启和停止问题</a></p><p><a href="http://xinlogs.com/Centos-install-mudos">CENTOS下安装MUDOS跑侠客行</a></p><p><a href="http://xinlogs.com/monitor-network-connections-of-linux">linux网络连接数量监控</a></p></div>]]></description>
	<pubDate>Fri, 26 Nov 2010 02:30:36 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/tomcat-memory-check</guid>

</item>
<item>
	<title>HeidiSQL一款开源的MySQL图形管理软件</title>
	<link>http://xinlogs.com/HeidiSQL</link>
	<description><![CDATA[<p>以前一直使用Navicat客户端，功能确实强大。不过这个客户端是收费的商业软件。</p>
<p>最近发现有一款HeidiSQL的开源软件，也可以很好的管理MySQL。使用后，发现很不错。这里推荐下</p>
<p>官方介绍：</p>
<h2>What's this?</h2>
<p><strong>HeidiSQL</strong> is an easy-to-use interface and a "working-horse" for web-developers using the popular <a href="http://www.mysql.com/">MySQL-Database</a>. It allows you to manage and browse your databases and tables from an intuitive Windows® interface.</p>
<p>放一张官方截图</p>
<p><input align="middle" src="/attachment/image/database.png" width="600" height="391" type="image" longdesc="undefined" /></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p><p><a href="http://xinlogs.com/update-115disk-urls">批量更换115网盘链接</a></p><p><a href="http://xinlogs.com/post/112">Mysql设置不区分表名大小写</a></p><p><a href="http://xinlogs.com/post/24">Mysql设置my.cnf来记录下全部sql请求</a></p><p><a href="http://xinlogs.com/post/113">mysqldump解决中文乱码问题</a></p></div>]]></description>
	<pubDate>Thu, 25 Nov 2010 00:38:43 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/HeidiSQL</guid>

</item>
<item>
	<title>CentOS下的Tomcat停止脚本</title>
	<link>http://xinlogs.com/post/108</link>
	<description><![CDATA[<p>我在CentOS 5.3 64bit上安装的Tomcat有个小问题，就是不能通过service tomcat stop停止或者server tomcat restart重启。</p>
<p>我看了下/etc/init.d/tomcat的文件，和以前没有什么不一样，但就是不能正常停止。</p>
<p>后来我自己修改了/etc/init.d/tomcat文件，改为直接kill进程。目前已经可以正常通过service关闭或者重启tomcat了。</p>
<p>下面是我/etc/init.d/tomcat文件内容，贴出来留着以后查看。呵呵</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_5403');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_5403">
<ol class="dp-cpp" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span class="preprocessor">#!/bin/bash </span><span>&nbsp;&nbsp;</span></span></li>
    <li><span class="preprocessor"># </span><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span class="preprocessor">#&nbsp;Startup&nbsp;script&nbsp;for&nbsp;the&nbsp;tomcat </span><span>&nbsp;&nbsp;</span></li>
    <li><span class="preprocessor"># </span><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span class="preprocessor">#&nbsp;chkconfig:&nbsp;345&nbsp;80&nbsp;15 </span><span>&nbsp;&nbsp;</span></li>
    <li><span class="preprocessor">#&nbsp;description:&nbsp;Tomcat&nbsp;is&nbsp;a&nbsp;Servlet+JSP&nbsp;Engine. </span><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;</span></li>
    <li><span class="preprocessor">#&nbsp;Source&nbsp;function&nbsp;library. </span><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>.&nbsp;/etc/rc.d/init.d/functions &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;</span></li>
    <li><span>export&nbsp;JAVA_HOME=/usr/local/jdk1.6.0_16 &nbsp;&nbsp;</span></li>
    <li class="alt"><span>export&nbsp;CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar &nbsp;&nbsp;</span></li>
    <li><span>export&nbsp;PATH=$PATH:$JAVA_HOME/bin &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;</span></li>
    <li><span>export&nbsp;CATALINA_BASE=/usr/local/tomcat &nbsp;&nbsp;</span></li>
    <li class="alt"><span>export&nbsp;CATALINA_HOME=/usr/local/tomcat &nbsp;&nbsp;</span></li>
    <li><span>export&nbsp;CATALINA_TMPDIR=/usr/local/tomcat/temp &nbsp;&nbsp;</span></li>
    <li class="alt"><span>export&nbsp;JRE_HOME=/usr/local/jdk1.6.0_16 &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>start(){ &nbsp;&nbsp;</span></li>
    <li><span class="keyword">if</span><span>&nbsp;[&nbsp;-z&nbsp;$(/sbin/pidof&nbsp;java)&nbsp;];&nbsp;then &nbsp;&nbsp;</span></li>
    <li class="alt"><span>echo&nbsp;</span><span class="string">"Starting&nbsp;tomcat"</span><span>&nbsp;&nbsp;</span></li>
    <li><span>/usr/local/tomcat/bin/startup.sh &nbsp;&nbsp;</span></li>
    <li class="alt"><span>touch&nbsp;/var/lock/subsys/tomcat &nbsp;&nbsp;</span></li>
    <li><span class="keyword">else</span><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>echo&nbsp;</span><span class="string">"tomcat&nbsp;allready&nbsp;running"</span><span>&nbsp;&nbsp;</span></li>
    <li><span>fi &nbsp;&nbsp;</span></li>
    <li class="alt"><span>} &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>stop(){ &nbsp;&nbsp;</span></li>
    <li><span class="keyword">if</span><span>&nbsp;[&nbsp;!&nbsp;-z&nbsp;$(/sbin/pidof&nbsp;java)&nbsp;];&nbsp;then &nbsp;&nbsp;</span></li>
    <li class="alt"><span>echo&nbsp;</span><span class="string">"Shutting&nbsp;down&nbsp;tomcat"</span><span>&nbsp;&nbsp;</span></li>
    <li><span>ps&nbsp;aux|grep&nbsp;tomcat|grep&nbsp;startup|awk&nbsp;</span><span class="string">'{print&nbsp;$2}'</span><span>|xargs&nbsp;kill&nbsp;-9 &nbsp;&nbsp;</span></li>
    <li class="alt"><span class="preprocessor">#/usr/local/tomcat/bin/shutdown.sh </span><span>&nbsp;&nbsp;</span></li>
    <li><span>until&nbsp;[&nbsp;-z&nbsp;$(/sbin/pidof&nbsp;java)&nbsp;];&nbsp;</span><span class="keyword">do</span><span>&nbsp;:;&nbsp;done &nbsp;&nbsp;</span></li>
    <li class="alt"><span>rm&nbsp;-f&nbsp;/var/lock/subsys/tomcat &nbsp;&nbsp;</span></li>
    <li><span class="keyword">else</span><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>echo&nbsp;</span><span class="string">"tomcat&nbsp;not&nbsp;running"</span><span>&nbsp;&nbsp;</span></li>
    <li><span>fi &nbsp;&nbsp;</span></li>
    <li class="alt"><span>} &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span class="keyword">case</span><span>&nbsp;</span><span class="string">"$1"</span><span>&nbsp;in &nbsp;&nbsp;</span></li>
    <li><span>start) &nbsp;&nbsp;</span></li>
    <li class="alt"><span>start &nbsp;&nbsp;</span></li>
    <li><span>;; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>stop) &nbsp;&nbsp;</span></li>
    <li><span>stop &nbsp;&nbsp;</span></li>
    <li class="alt"><span>;; &nbsp;&nbsp;</span></li>
    <li><span>restart) &nbsp;&nbsp;</span></li>
    <li class="alt"><span>stop &nbsp;&nbsp;</span></li>
    <li><span>start &nbsp;&nbsp;</span></li>
    <li class="alt"><span>;; &nbsp;&nbsp;</span></li>
    <li><span>status) &nbsp;&nbsp;</span></li>
    <li class="alt"><span>/usr/local/tomcat/bin/catalina.sh&nbsp;version &nbsp;&nbsp;</span></li>
    <li><span>;; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>*) &nbsp;&nbsp;</span></li>
    <li><span>echo&nbsp;</span><span class="string">"Usage:&nbsp;$0&nbsp;{start|stop|restart|status}"</span><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>esac &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>exit&nbsp;0 &nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"> <script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p><p><a href="http://xinlogs.com/monit-to-monitor-services">monit监控linux服务</a></p><p><a href="http://xinlogs.com/centos-linux-sshclient-unreadable-code">Centos Linux 远程终端ssh乱码问题</a></p><p><a href="http://xinlogs.com/post/16">一个很好的开源企业内部IM解决方案</a></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p></div>]]></description>
	<pubDate>Thu, 04 Nov 2010 06:01:33 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/108</guid>

</item>
<item>
	<title>通过VPN获取eMule的HighID</title>
	<link>http://xinlogs.com/eMule-VPN-HighID</link>
	<description><![CDATA[<p>一般单位里，我们都是通过单位网关上网。这种情况下打开eMule肯定获取到的是LowID（低ID）。那么既然我们可以通过VPN来翻墙，有没有办法通过VPN来获取到eMule的HighID（高ID）呢？</p>
<p>答案是肯定的：可以。</p>
<p>只要我们将VPN服务器的外网IP上的对应端口映射到我们VPN客户端获取到的IP端口上就可以。</p>
<p>我的VPN服务器，就是跑在我这台博客服务器上的openvpn server。笔记本采用openvpn gui客户端连接。</p>
<p>我笔记本分到的ip 10.8.0.2&nbsp;&nbsp;</p>
<p>vpn server的外网ip：204.74.212.217</p>
<p>vpn server的tap0 ip地址：10.8.0.1</p>
<p>下面是我的iptables配置：</p>
<p>加入如下两条规则</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_1143');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_1143">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>iptables&nbsp;-t&nbsp;nat&nbsp;-A&nbsp;PREROUTING&nbsp;-p&nbsp;tcp&nbsp;-d&nbsp;204.74.212.217&nbsp;--dport&nbsp;13242&nbsp;-j&nbsp;DNAT&nbsp;--to&nbsp;10.8.0.2:13242 &nbsp;&nbsp;</span></span></li>
    <li><span>iptables&nbsp;-t&nbsp;nat&nbsp;-A&nbsp;PREROUTING&nbsp;-p&nbsp;udp&nbsp;-d&nbsp;204.74.212.217&nbsp;--dport&nbsp;11324&nbsp;-j&nbsp;DNAT&nbsp;--to&nbsp;10.8.0.2:11324 &nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"> <script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>其中13242和11324端口，要和自己安装的emule端口对应。这个可以在emule的选项-》连接界面查看。</p>
<p>以上配置后，还不能获取高ID的话，基本都是windows防火墙原因了。</p>
<p>修改win7 防火墙</p>
<p>在“高级安全Windows防火墙”中的“入站规则”和“出站规则”中，都允许eMule的通过。</p>
<p>然后断开eMule连接，重新连接一次。就可以获取高ID了。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/squid-cache-php-script">squid缓存php页面</a></p><p><a href="http://xinlogs.com/accelerate-app-store-download">快速提升app store下载速度</a></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p><p><a href="http://xinlogs.com/check-slow-php-script">如何找到执行慢的php程序</a></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p></div>]]></description>
	<pubDate>Wed, 27 Oct 2010 02:22:50 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/eMule-VPN-HighID</guid>

</item>
<item>
	<title>瑞豪开源(RASHOST)VPS10个月使用感受</title>
	<link>http://xinlogs.com/rashost-vps</link>
	<description><![CDATA[<p>从2009年12月算来，我使用<strong>瑞豪开源(RASHOST)</strong>提供的VPS已经10个月了，下面说说我的感受。</p>
<p>我选择的是128M Linux VPS，系统采用的CentOS 5</p>
<p>选择理由：因为我就是跑自己的blog，还有开openvpn用来访问一些被墙的站点，所以不需要太多内存。当然这也归功于<strong>瑞豪开源(RASHOST)</strong>他们的技术实力优秀。他们提供的VPS 系统都是经过裁剪和优化的。默认启动系统只需要20多M内存占用。</p>
<p>10个月使用下来，感觉<strong>瑞豪开源(RASHOST)</strong>提供的VPS相当稳定，10个月中将就出现过一次线路问题，大约不到1个小时就解决了。虽然我测试过<strong>瑞豪开源(RASHOST)</strong>提供的VPS网络速度不是很快，从北京ping过去大约300-400ms，但是很稳定。</p>
<p>再说说服务，在使用vps过程中，开始的时候总会有些这样那样的问题，<strong>瑞豪开源(RASHOST)</strong>是通过提交服务单进行解决的。每个服务单都有记录，会很好的解决我遇到的问题。感谢<strong>瑞豪开源(RASHOST)</strong>提供的技术支持。</p>
<p>最后就是方便的支付方式。我选择的是3个月支付一次。一般提前10天就会收到他们的邮件提示，按照提供的账单，通过支付宝就可以完成支付。不需要人工开通和确认了。只要支付完成，后台就显示支付成功。VPS的到期时间也自动计算好了。</p>
<p>我主要是通过nginx+fastcgi+php跑blog，然后又安装了openvpn来做vpn服务器。优化后，大约用35-40M内存，当然这个随着访问量增大而增大。但是感觉个人128M足以。如果以后内存吃紧，通过一些<strong>瑞豪开源(RASHOST)</strong>的推广活动，还可以免费增加部分内存。这个活动很好，我最喜欢了。</p>
<p>目前我已经续费到2011年1月。一直使用良好，在此推荐下。</p>]]></description>
	<pubDate>Mon, 11 Oct 2010 06:13:51 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/rashost-vps</guid>

</item>
<item>
	<title>八达岭野生动物园-停车场乱收费问题</title>
	<link>http://xinlogs.com/post/105</link>
	<description><![CDATA[<p>10月3号和家人一起去了八达岭野生动物园。</p>
<p>一路堵车。。。。经过了3个多小时终于从北四环开到目的地。</p>
<p>给车买了一张票35元，顺利开车进入。野生动物园里一路顺利，跟着一辆铁笼子车，他们前面喂老虎，我们后面跟着看。呵呵</p>
<p><strong>停车乱收费问题</strong></p>
<p>问题发生在回来的时候，出了野生动物园，打算上八达岭高速回城里。结果刚出野生动物园，就有个穿类似交警制服的人站在回北京方向的路上指挥，告诉你从停车场方向走，那边是会北京的路线。</p>
<p>我们按照这个人员的指示，穿过停车场。结果出停车场的时候，就一个蛮横的工作人员告诉我们，我们停车场是按次收费，只要进来就是5元钱。</p>
<p>和他解释什么都没用，就告诉看牌子，按次收费！！！！</p>
<p>这里提醒下大家，以后去八达岭野生动物园，回北京方向已经不要穿停车场，有人指挥也不要信，就是骗你去交钱的！！！</p>]]></description>
	<pubDate>Mon, 11 Oct 2010 05:30:08 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/105</guid>

</item>
<item>
	<title>Hero G3 android 2.1下好用的导航软件</title>
	<link>http://xinlogs.com/lingtu-on-hero-android21</link>
	<description><![CDATA[<p>Hero G3在升级到Android 2.1后就没有什么好用的导航软件了。google map需要流量，这个等于导航的时候随时收费，偶尔用用还可以，不适合长期使用。</p>
<p>凯立德在anroid 2.1有可用版本，但是操作体验比较差，经常按个按钮，半天没有反映需要反复按。而且我还遇到过不能定位的问题，后来重启了手机才解决。</p>
<p>不过现在天行者10终于可以运行在android 2.1下面了。我申请了测试号，感觉使用效果不错。以前andorid 1.5的时候，就是用的天行者9。我习惯要去什么地方都先到<a href="http://www.51ditu.com">www.51ditu.com</a>查查，因为都是图灵的资源，所以51ditu上找到了，基本天行者里肯定可以导航。</p>
<p>目前缺点：没有横屏，开车的时候手机一般都横着放，不是很方便。</p>
<p>触摸反映不灵敏，有的按键也是需要反复按几次才有反映。</p>
<p>下面放几张运行截图（我手机hero g3,系统是自己刷的android 2.1）</p>
<p><img alt="" width="320" height="480" src="/attachment/image/snap20100826_113603.png" /> <img alt="" src="/attachment/image/snap20100826_113619.png" /></p>
<p><img alt="" src="/attachment/image/snap20100826_113633.png" /> <img alt="" src="/attachment/image/snap20100826_113857.png" /></p>
<p>&nbsp;</p>]]></description>
	<pubDate>Thu, 26 Aug 2010 03:50:44 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/lingtu-on-hero-android21</guid>

</item>
<item>
	<title>CENTOS下安装MUDOS跑侠客行</title>
	<link>http://xinlogs.com/Centos-install-mudos</link>
	<description><![CDATA[<p>最近在放假，我又玩了玩很久以前的网络游戏北美侠客行。一个纯文字的MUD游戏。而且自己在CentOS下也架设了一个，下面就说说我的安装过程，给自己做个记录，怕以后忘记。</p>
<p>要架设一个MUD游戏，需要MUDOS和MUDLIB两部分。这里简单解释一下，其实我也刚接触，有不对的地方还望见谅。</p>
<p>MUDOS我理解就是一个跑MUD游戏的平台或者理解为模拟器，只要符合MUDOS要求的MUDLIB都可以通过MUDOS驱动起来。</p>
<p>MUDLIB才是具体游戏的代码，各种MUD游戏其实就是MUDLIB不同，而底层平台基本都是MUDOS。</p>
<p>当然现在除了MUDOS还可以采用FluffOS作为运行平台。<br />
 </p>
<p>下面贴个我架设的侠客行MUD截图（采用XKX早期代码修改来的，和北美侠客行最接近）</p>
<p><img width="695" height="280" alt="" src="/attachment/image/xkx.png" /></p>
<p></p>
<p><strong>下载MUDOS</strong></p>
<p>我采用的是<a href="http://www.pkuxkx.net/download/soft.php?id=20"><b>MudOSv22pre11 For Linux</b></a> 从北大侠客行官方网站下载的。</p>
<p><strong>下载MUDLIB</strong></p>
<p>至于mudlib才是能不能玩的重点，网上可以找到很多版本。我主要下载了如下几种</p>
<p>金庸梦（个人感觉很完整的一套代码，基本是基于98年xkx修改而来）</p>
<p>xkx2001（这个版本是早期一个xkx版本，和北美xkx比较接近）</p>
<p>xkx6dao（和早期xkx最接近的一个版本）</p>
<p>以上三个版本都可以在windows下正常运行，我们要做的就是选择一款移植到linux下。</p>
<p>我是基于xkx6到的mudlib，将xkx2001和金庸梦的部分代码加入过来。这样基本实现了北美侠客行的大部分任务系统，包括斧头帮、镖局、门派任务等</p>
<p><strong>安装mudos</strong></p>
<p>1、将我们下载的<a href="http://www.pkuxkx.net/download/soft.php?id=20"><b>MudOSv22pre11 For Linux</b></a>解压缩，然后进入到解压后的目录。</p>
<p>2、运行 ./build.MudOS<br />
提示如下</p>
<p>Preparing to build standard MudOS driver ...<br />
Trying out some stuff to see what works; ignore errors ...<br />
gmake: Nothing to be done for `nothing'.<br />
./build.MudOS: line 170: xlc: command not found<br />
mkdir: ÎÞ·¨´´½¨Ä¿Â¼¡®tmp¡¯: ÎÄ¼þÒÑ´æÔÚ<br />
install£ºÎÞÐ§Ñ¡Ïî -- f<br />
Çë³¢ÊÔÖ´ÐÐ¡®install --help¡¯À´»ñÈ¡¸ü¶àÐÅÏ¢¡£<br />
rm: ÎÞ·¨É¾³ý¡®tmp/insttest¡¯: Ã»ÓÐÄÇ¸öÎÄ¼þ»òÄ¿Â¼<br />
mkdir: ÎÞ·¨´´½¨Ä¿Â¼¡®obj¡¯: ÎÄ¼þÒÑ´æÔÚ<br />
***************** Configuration completed **************<br />
Installing MudOS on Linux</p>
<p>Using install -c to install binaries in ../bin.<br />
Using gcc -E for preprocessing.<br />
Using gcc -O2 -fomit-frame-pointer -fstrength-reduce to compile.<br />
Using bison -d -y to make the compiler.<br />
Edit GNUmakefile if this is not what you want</p>
<p>Otherwise, type 'gmake' to build MudOS, then 'gmake install'.<br />
上面有些是乱码，因为linux的中文不能正常贴过来，主要是提示一些目录存在和一些安装选项无效。可以不用管。</p>
<p>在安装前，我们用gmake clean 清理一下</p>
<p>3、执行gmake和gmake install进行编译和安装</p>
<p>正常的话，我们就可以在目录下发现driver文件了，这个driver就是为了驱动MUDLIB的。</p>
<p><strong>配置MUDLIB和运行</strong></p>
<p>配置mudlib的过程麻烦一些，一个是driver是否符合mudlib需要，另外一个是mudlib的配置。</p>
<p>先说下mudlib的配置，一般是在mudlib的根目录下存在一个config.h的文件（这个名字可以自己修改为任意名字）</p>
<p>这个配置文件一般需要根据自己的实际路径进行修改</p>
<p>name: 侠客行      (指定你的游戏名字)</p>
<p>port number: 5555  (指定游戏运行的端口)</p>
<p>mudlib directory: /mud/xkx/ (指向到你mudlib的目录)</p>
<p>binary directory: /mud/xkx/ (同样指向到你mudlib目录，其实是你配置文件目录)</p>
<p>其他默认就可以</p>
<p>如果配置全部完成，没有问题。</p>
<p>只要将driver文件拷贝到mudlib目录，我这里是/mud/xkx目录。</p>
<p>然后cd /mud/xkx</p>
<p>./driver config.h &amp;</p>
<p>下面是我的运行提示</p>
<p>[root@ict xkx]# using config file: config.h<br />
Initializing internal tables....<br />
----------------------------------------------------------------------------<br />
侠客行 (MudOS v22pre11) starting up on Linux - Thu Aug 26 10:21:29 2010</p>
<p><br />
Connection to address server (localhost 3992) refused.<br />
]simul_efun loaded successfully.</p>
<p>Loading preloaded files ...<br />
Initializations complete.</p>
<p>Accepting connections on port 5555.</p>
<p>[root@ict xkx]#<br />
 </p>
<p><strong>常见问题</strong></p>
<p><strong>编码问题：</strong>因为我们的mudlib是从windows平台移植过去的，所以文件都是dos格式，需要进行转换。采用如下命令</p>
<p>find . -name *.c|xargs dos2unix<br />
find . -name *.h|xargs dos2unix<br />
find . -name *.o|xargs dos2unix<br />
以上命令将所有.c .h .o结尾的文件转换为unix文件格式</p>
<p><strong>driver编译问题：</strong>很多时候我们编译的driver并不能很好的驱动我们的mudlib。这个时候需要自己查看log目录下的debug.log文件找出具体原因。主要是通过修改 options.h  文件进行调整。</p>
<p> </p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/monitor-network-connections-of-linux">linux网络连接数量监控</a></p><p><a href="http://xinlogs.com/post/11">CentOS里的Xen配置pygrub</a></p><p><a href="http://xinlogs.com/post/17">如何快速统计服务器访问量</a></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p><p><a href="http://xinlogs.com/vps-dropbox-install">一款Linux下同步备份文件的好软件DROPBOX</a></p></div>]]></description>
	<pubDate>Thu, 26 Aug 2010 02:45:02 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Centos-install-mudos</guid>

</item>
<item>
	<title>周末给老婆买了个HTC legend(G6)玩</title>
	<link>http://xinlogs.com/post/102</link>
	<description><![CDATA[<p>我一直使用G3，老婆看功能强大，打算也购买一个玩。</p>
<p>去了中关村，挑来挑去，最后老婆还是看上了G6.</p>
<p>感觉G6的金属外壳、后盖的设计都很好，而且有闪光灯。这些都是比较好的设计。</p>
<p>不过数据线接口变了，不在和G3通用，这个不太喜欢。</p>
<p>按键也感觉没有G3的好，觉得按键很粗糙，一按就咔咔的响（不是按键发音哦，纯机械声音）。</p>
<p>没有了通话和挂机键，也感觉不方便。</p>
<p>不过老婆还是挺喜欢的。</p>
<p>购买就是注意别买到阿三机器就可以了。（好像目前阿三机器也可以通过降级破解了）</p>]]></description>
	<pubDate>Wed, 28 Jul 2010 00:36:25 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/102</guid>

</item>
<item>
	<title>win7安装oracle10g完美解决方案</title>
	<link>http://xinlogs.com/win7-install-oracle</link>
	<description><![CDATA[<p>最近由于项目需要，要求安装oracle10g数据库进行开发。在安装的时候碰到一些问题，这里记录下解决办法。</p>
<p>我的系统是win7 中文32位旗舰版。</p>
<p>数据库是oracle10g</p>
<p><strong>问题1</strong></p>
<p>在安装的时候，首先是系统检查。因为默认oracle是不支持win7系统的，所以我们需要修改下文件，让它支持。</p>
<p>具体办法：</p>
<p>找到database\stage\prereq\db\refhost.xml文件，在文件里添加如下内容</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_2083');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_2083">
<ol class="dp-xml" style="border-bottom: 0px; border-left: 0px; list-style-type: none; margin-left: 5px; border-top: 0px; border-right: 0px">
    <li class="alt"><span><span class="comments">&lt;!--Microsoft&nbsp;Windows&nbsp;7--&gt;</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>
    <li><span class="tag">&lt;</span><span class="tag-name">OPERATING_SYSTEM</span><span class="tag">&gt;</span><span>&nbsp; &nbsp;&nbsp;</span></li>
    <li class="alt"><span class="tag">&lt;</span><span class="tag-name">VERSION</span><span>&nbsp;</span><span class="attribute">VALUE</span><span>=</span><span class="attribute-value">&quot;6.1&quot;</span><span class="tag">/&gt;</span><span>&nbsp; &nbsp;&nbsp;</span></li>
    <li><span class="tag">&lt;/</span><span class="tag-name">OPERATING_SYSTEM</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p><strong>问题2</strong></p>
<p>上面只是检查系统是否符合要求，这个时候如果运行setup.exe还有可能出现错误提示。这个时候只要我们右键点setup.exe文件，然后选择&ldquo;兼容性&rdquo;标签，勾选上&ldquo;以兼容模式运行这个程序&rdquo;并在列表里选择&ldquo;windows xp(service pack 3)&rdquo;。然后记得安装的时候选择基本安装模式，不要用高级模式。高级模式到后面还是不能通过。</p>]]></description>
	<pubDate>Mon, 12 Jul 2010 12:32:40 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/win7-install-oracle</guid>

</item>
<item>
	<title>Hero 使用Android 2.1 ROM 心得。</title>
	<link>http://xinlogs.com/post/100</link>
	<description><![CDATA[<p>上次介绍了下使用Android 2.1的体会，当时因为导航等问题，最终放弃了2.1系统，继续刷回1.5系统用了。</p>
<p>经过这段时间，android 2.1系统不断完善，导航问题也有了突破。感谢各位高手贡献自己的力量。</p>
<p>这次我刷的还是F大制作的Rom：<a title="Permanent Link to Daguu Sense v1.0(Official RUU,BFS,Compcache,SSH..)" rel="bookmark" href="http://ligux.com/?p=920">Daguu Sense v1.0(Official RUU,BFS,Compcache,SSH..)</a></p>
<p>RADIO采用最新的：63.18.55.06PU_6.35.15.14</p>
<p>这个Rom确实达到了高效、干净、稳定的目的。</p>
<p><strong>导航</strong></p>
<p>以前我一直没有采用android 2.1的很大原因就是导航问题。android 2.1原来只能使用高德等导航，效果很不好。KLD需要替换libgps.so使用，而且稳定性不好。我最爱用的天行者根本用不了。</p>
<p>现在论坛上的牛人终于找到了KLD需要替换libgps.so的具体原因，并且放出了修改版本，可以不用替换libgps.so文件完美运行了。</p>
<p>我测试结果是直接安装后，搜星定位都很快。路测鸟巢到五棵松全程12Km，也很稳定，一切正常。</p>
<p><strong>蓝牙</strong></p>
<p>蓝牙在1.5只能用耳机，不能传文件。现在android 2.1下我测试用诺基亚E63给hero传文件，一切正常。</p>
<p><strong>Openvpn</strong></p>
<p>这个Rom安装后，自带openvpn setting软件，设置好后，连接openvpn一切正常。</p>
<p><strong>耗电</strong></p>
<p>反正hero基本是1-2天一充电，android 2.1确实比1.5耗电，但基本还是1-2天一充，没有什么变化。</p>
<p><strong>小结</strong></p>
<p>随着性能、稳定性提升，导航问题解决。目前我已经采用android 2.1系统了，而不是像以前一样刷来玩玩，然后还要刷回1.5日常用。感觉目前hero下的android2.1基本已经满足大多数用户正常使用了。</p>]]></description>
	<pubDate>Mon, 12 Jul 2010 12:11:55 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/100</guid>

</item>
<item>
	<title>HTC Hero 2.1 体验</title>
	<link>http://xinlogs.com/post/96</link>
	<description><![CDATA[<p>最近随着官方放出的hero g3 android 2.1 ROM，开很有很多技术高人也发布了自己的修改、优化版本。</p>
<p>我也忍不住开始刷新手机了。</p>
<p>我选择的是<span id="thread_137874"><a href="android-137874-1-1.html">Daguu Espresso v1.2 By FlZyGaMeUp Release </a></span>，原因很简单，我之前用的ROM就是F大发布的<span id="thread_56409"><a href="android-56409-1-1.html" style="font-weight: bold">FLZYUP Custom ROM v1.6 (Hero Android 1.5固件最终版)</a>。所以这次依然选择了他制作的ROM</span></p>
<p><strong><span>刷新要求</span></strong></p>
<p><span>Recovery版本：recovery-RA-hero-v1.6.2<br />
Radio版本：63.18.55.06OU_6.35.15.01</span></p>
<p><span>以上这些都可以到机锋网找到。</span></p>
<p><span>刷新后，界面确实很漂亮。使用起来也感觉比1.5的ROM多出很多功能。不过速度确实不如以前1.5的ROM了。</span></p>
<p><span>我是晚上刷的，用到第2天中午，觉得还是不如1.5的ROM，又刷回<span id="thread_56409"><a href="http://www.xinlogs.com/editor/fckeditor/editor/android-56409-1-1.html" style="font-weight: bold">FLZYUP Custom ROM v1.6 (Hero Android 1.5固件最终版)</a>这个版本了。</span></span></p>
<p><strong><span><span>主要问题</span></span></strong></p>
<p><span><span>如果就android 2.1的ROM本身来说，已经接近完美了。速度和耗电还不太好，不过有一种说法是只要不是官方的内核，耗电就会高。</span></span></p>
<p><span><span>而F大这次就是没有采用官方内核，而是自己编译的。</span></span></p>
<p><span><span>不过我认为最大的问题是导航软件的兼容性，因为我经常用手机导航。以前1.5的时候，先后使用过KLD、领航者、高德和天行者。</span></span></p>
<p><span><span>KLD的地图和导航都不错，但是明显不是为android开发的，按键很不好用，有时候点半天都没有反应。后来的2010年4月的一个新版本，有所改进。</span></span></p>
<p><span><span>领航者和高德的路线规划和地图都不满意。</span></span></p>
<p><span><span>最后我一直在使用天行者9，这个软件很满意。地图基本和<a href="http://www.51ditu.com">www.51ditu.com</a>网站的一样。外出只要在51ditu.com可以找到地方，就不用担心手机导航不到。反正感觉北京使用，天行者9最好了。</span></span></p>
<p><span><span>而上面这些在android 1.5ROM正常的导航软件，到了android 2.1很少可以正常工作。</span></span></p>
<p><span><span>天行者9是根本不能运行在2.1的ROM</span></span></p>
<p><span><span>KLD需要修改libgps.so文件，然后还有可能信号不稳定，经常断。</span></span></p>
<p><span><span>领航者和高德倒是可以使用，问题这两个软件实现效果和地图都很差。</span></span></p>
<p><span><span>还有个城际通，可以安装，但是出现第一屏提示后，就自动退出了。</span></span></p>
<p><span><span>由于以上原因，我还是刷回了android 1.5 ROM，期待更完美的版本了和更好的导航软件出现了。</span></span></p>]]></description>
	<pubDate>Tue, 22 Jun 2010 02:07:34 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/96</guid>

</item>
<item>
	<title>很久没有写博客了，前几天得阑尾炎了。</title>
	<link>http://xinlogs.com/post/95</link>
	<description><![CDATA[<p>2010年5月27日。。。上午在单位突然得阑尾炎了。。。郁闷呀。</p>
<p>被同事直接给送医院了，老婆也及时赶过来了。</p>
<p>现在好多了，上来记录下。等好了以后，找时间切除阑尾吧。。。。</p>]]></description>
	<pubDate>Wed, 02 Jun 2010 00:32:35 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/95</guid>

</item>
<item>
	<title>哀悼日网站和bo-blog变灰色设置</title>
	<link>http://xinlogs.com/Mourning-CSS-SETUP</link>
	<description><![CDATA[<p>根据国务院文件，5.19-5.21为全国哀悼日，在此期间，全国和各驻外机构下半旗志哀，停止公共娱乐活动，外交部和我国驻外使领馆设立吊唁簿。5月19日14时28分起，全国人民默哀3分钟，届时汽车、火车、舰船鸣笛，防空警报鸣响。 Admin5与很多草根网站都将整站换成素装。并建议中国所有站点更换为素装。<br />
为方便站点哀悼，特提供css滤镜代码，以表哀悼。以下为全站CSS代码。</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_9157');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_9157">
<ol class="dp-css" style="border-bottom: 0px; border-left: 0px; list-style-type: none; margin-left: 5px; border-top: 0px; border-right: 0px">
    <li class="alt"><span><span>html&nbsp;&#123;&nbsp;filter:progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);&nbsp;&#125;&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>使用方法：这段代码可以变网页为黑白，将代码加到CSS最顶端就可以实现素装。建议全国站长动起来。为在地震中遇难的同胞哀悼。</p>
<p>如果网站没有使用CSS，可以在网页/模板的HTML代码&lt;head&gt;和&lt;/head&gt; 之间插入：</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">XML/HTML 代码</span><span class="copyCodeText" onclick="copyIdText('code_9247');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_9247">
<ol class="dp-xml">
    <li class="alt"><span><span class="tag">&lt;</span><span class="tag-name">style</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li>
    <li><span>html&#123;filter:progid:DXImageTransform.Microsoft.BasicImage(</span><span class="attribute">grayscale</span><span>=</span><span class="attribute-value">1</span><span>);&#125; &nbsp;&nbsp;</span></li>
    <li class="alt"><span class="tag">&lt;/</span><span class="tag-name">style</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>有一些站长的网站可能使用这个css 不能生效，是因为网站没有使用最新的网页标准协议</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">XML/HTML 代码</span><span class="copyCodeText" onclick="copyIdText('code_7852');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_7852">
<ol class="dp-xml">
    <li class="alt"><span><span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&quot;&nbsp;&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li>
    <li><span class="tag">&lt;</span><span class="tag-name">html</span><span>&nbsp;</span><span class="attribute">xmlns</span><span>=</span><span class="attribute-value">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>请将网页最头部的&lt;html&gt;替换为以上代码。</p>
<p>有一些网站FLASH动画的颜色不能被CSS滤镜控制，可以在FLASH代码的&lt;object &hellip;&gt;和&lt;/object&gt;之间插入：</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_3112');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_3112">
<ol class="dp-c">
    <li class="alt"><span><span>&lt;param&nbsp;value=</span><span class="string">&quot;false&quot;</span><span>&nbsp;name=</span><span class="string">&quot;menu&quot;</span><span>/&gt; &nbsp;&nbsp;</span></span></li>
    <li><span>&lt;param&nbsp;value=</span><span class="string">&quot;opaque&quot;</span><span>&nbsp;name=</span><span class="string">&quot;wmode&quot;</span><span>/&gt;&nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>最简单的把页面变成灰色的代码是在head 之间加<br />
&nbsp;</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">XML/HTML 代码</span><span class="copyCodeText" onclick="copyIdText('code_7466');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_7466">
<ol class="dp-xml">
    <li class="alt"><span><span class="tag">&lt;</span><span class="tag-name">style</span><span>&nbsp;</span><span class="attribute">type</span><span>=</span><span class="attribute-value">&quot;text/css&quot;</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>html&nbsp;&#123; &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;FILTER:&nbsp;gray &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&#125; &nbsp;&nbsp;</span></li>
    <li><span class="tag">&lt;/</span><span class="tag-name">style</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>下面再看看如何给上面这些应用到bo-blog的页面中呢。</p>
<p>首先我们到bo-blog的根目录找到我们的template模板目录，在其中找到我们使用的模板所采用的CSS文件。在文件最后加入</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_7962');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_7962">
<ol class="dp-xml">
    <li class="alt"><span><span>html&nbsp;&#123;&nbsp;filter:progid:DXImageTransform.Microsoft.BasicImage(</span><span class="attribute">grayscale</span><span>=</span><span class="attribute-value">1</span><span>);&nbsp;&#125;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>另在哀悼日或遇难的新闻，所有专题和主题 图片上不能使用红色标题。</p>]]></description>
	<pubDate>Wed, 21 Apr 2010 00:33:13 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Mourning-CSS-SETUP</guid>

</item>
<item>
	<title>一款Linux下同步备份文件的好软件DROPBOX</title>
	<link>http://xinlogs.com/vps-dropbox-install</link>
	<description><![CDATA[<p>原来一直用tar、sync等软件实现备份。需要些脚本还要找一台其他服务器进行同步。现在有了DROPBOX这个网站提供的服务，一切都变容易了。</p>
<p><strong>DROPBOX网站：</strong></p>
<p><a href="http://www.dropbox.com/">www.dropbox.com</a></p>
<p><strong>DROP功能：</strong></p>
<p>偷懒直接把官方介绍帖过来了。主要就是免费提供2G的同步空间，可以自动同步文件并保留文件的历史版本</p>
<h1>Dropbox Features</h1>
<h2 id="sync">File Sync</h2>
<p>Dropbox allows you to sync your files online and across your computers automatically.</p>
<ul class="blue-bullets">
    <li>2GB of online storage for free, with up to 100GB available to paying customers.</li>
    <li>Sync files of any size or type.</li>
    <li>Sync Windows, Mac and Linux computers.</li>
    <li>Automatically syncs when new files or changes are detected.</li>
    <li>Work on files in your Dropbox even if you're offline. Your changes sync once your computer has an Internet connection again.</li>
    <li>Dropbox transfers will correctly resume where they left off if the connection drops.</li>
    <li>Efficient sync - only the pieces of a file that changed (not the whole file) are synced. This saves you time.</li>
    <li>Doesn't hog your Internet connection. You can manually set bandwidth limits. </li>
</ul>
<h2 id="sharing">File Sharing</h2>
<p>Sharing files is simple and can be done with only a few clicks.</p>
<ul class="blue-bullets">
    <li>Shared folders allow several people to collaborate on a set of files.</li>
    <li>You can see other people's changes instantly.</li>
    <li>A "Public" folder that lets you link directly to files in your Dropbox.</li>
    <li>Control who is able to access shared folders (including ability to kick people out and remove the shared files from their computers).</li>
    <li>Automatically create shareable online photo galleries from folders of photos in your Dropbox.</li>
</ul>
<h2 id="backup">Online Backup</h2>
<p>Dropbox backs up your files online without you having to think about it.</p>
<ul class="blue-bullets">
    <li>Automatic backup of your files.</li>
    <li>Undelete files and folders.</li>
    <li>Restore previous versions of your files.</li>
    <li>30 days of undo history, with unlimited undo available as a paid option.</li>
</ul>
<h2 id="web">Web Access</h2>
<p>A copy of your files are stored on Dropbox's secure servers. This lets you access them from any computer or mobile device.</p>
<ul class="blue-bullets">
    <li>Manipulate files as you would on your desktop - add, edit, delete, rename etc.</li>
    <li>Search your entire Dropbox for files.</li>
    <li>A "Recent Events" feed that shows you a summary of activity in your Dropbox.</li>
    <li>Create shared folders and invite people to them.</li>
    <li>Recover previous versions of any file or undelete deleted files.</li>
    <li>View photo galleries created automatically from photos in your Dropbox.</li>
</ul>
<h2 id="security">Security &amp; Privacy</h2>
<p>Dropbox takes the security and privacy of your files very seriously.</p>
<ul class="blue-bullets">
    <li>Shared folders are viewable only by people you invite.</li>
    <li>All transmission of file data and metadata occurs over an encrypted channel (SSL).</li>
    <li>All files stored on Dropbox servers are encrypted (AES-256) and are inaccessible without your account password.</li>
    <li>Dropbox website and client software have been hardened against attacks from hackers.</li>
    <li>Dropbox employees are not able to view any user's files.</li>
    <li>Online access to your files requires your username and password.</li>
    <li>Public files are only viewable by people who have a link to the file(s). Public folders are not browsable or searchable.</li>
</ul>
<h2 id="mobile">Mobile Device Access</h2>
<p>The free <a href="http://www.xinlogs.com/iphoneapp">Dropbox iPhone app</a> lets you:</p>
<ul class="blue-bullets">
    <li>Access your Dropbox on the go.</li>
    <li>View your files on your iPhone or iPod Touch.</li>
    <li>Download files for offline viewing.</li>
    <li>Take photos and videos and sync them to your Dropbox.</li>
    <li>Share links to files in your Dropbox.</li>
    <li>View interactive photo galleries.</li>
    <li>Sync downloaded files so they're up-to-date.</li>
</ul>
<p>&nbsp;</p>
<p>A mobile-optimized version of the website is available for owners of Blackberry phones and other Internet-capable mobile devices.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>Linux下安装</strong></p>
<p>如果你的Linux服务器安装了Xserver和桌面，完全可以安装官方的指南来安装。但是因为一般的VPS都内存小得可怜，不会奢侈到安装桌面，所以下面主要介绍在没有安装桌面系统的命令行Linux下安装步骤。</p>
<p>关于安装方法的内容转帖自<a href="http://lazyhack.net/install-dropbox-in-vps/">http://lazyhack.net/install-dropbox-in-vps/</a></p>
<p><strong>1、登陆进VPS或者是服务器，进入用户目录</strong></p>
<div class="codeText">
<div id="code_6795">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>cd </span></span>     <link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</li>
</ol>
</div>
</div>
<p><strong>2、下载dropbox的客户端，要For linux那个而非For Nautilus的</strong></p>
<p>这里我是在<a href="http://lazyhack.net/install-dropbox-in-vps/">http://lazyhack.net/install-dropbox-in-vps/</a>文档中找到的地址，官方网站找了半天都是Nautilus的版本</p>
<p>32位下载地址 <a href="http://www.dropbox.com/download?plat=lnx.x86">http://www.dropbox.com/download?plat=lnx.x86</a></p>
<p>64位下载地址 <a href="http://www.dropbox.com/download?plat=lnx.x86_64">http://www.dropbox.com/download?plat=lnx.x86_64</a></p>
<p>我这里用的32位系统，所以下载32位客户端</p>
<div class="codeText">
<div id="code_2958">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>wget http://www.dropbox.com/download?</span><span class="attribute">plat</span><span>=</span><span class="attribute-value">lnx</span><span>.x86 </span></span>     <link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</li>
</ol>
</div>
</div>
<p><strong>3、解压</strong></p>
<div class="codeText">
<div id="code_2090">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>tar zxvf dropbox-lnx.x86-0.7.110.tar.gz </span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p><strong>4、下载dbmakefilelib.py并运行</strong></p>
<div class="codeText">
<div id="code_3236">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>wget http://dl.dropbox.com/u/637552/Dropbox/dbmakefilelib.py </span></span></li>
    <li><span>python dbmakefilelib.py </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>如果出现以下信息，说明它运行正常</p>
<p>dropboxd ran for 15 seconds without quitting - success?</p>
<p>看到它的提示了吗，<a target="_blank" href="http://www.vpser.net/go/dropbox">Dropbox</a>已经启动了，让你运行15秒后再退出，这个过程就是dropbox生成机器信息并保存到db文件的，其实对于国外的<a title="查看 vps 的全部文章" target="_blank" href="http://lazyhack.net/tag/vps/">vps</a>来说几秒时间就够了，我们ctrl－c将其退出，完成接下来的步骤<br />
&nbsp;</p>
<p><strong>5、进入</strong><a target="_blank" href="http://www.vpser.net/go/dropbox"><strong>Dropbox</strong></a><strong>的dot目录导出机器信息</strong></p>
<div class="codeText">
<div id="code_7591">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>cd .~/.dropbox </span></span></li>
    <li><span>$ sqlite3 dropbox.db </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>SQLite version 3.6.22 </span></li>
    <li class="alt"><span>Enter ".help" for instructions </span></li>
    <li><span>Enter SQL statements terminated with a ";" </span></li>
    <li class="alt"><span>sqlite</span><span class="tag">&gt;</span><span> .dump config </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>我们会在导出的信息中看到如下的一串字符</p>
<div>
<div>
<pre>INSERT INTO "config" VALUES(4,'host_id','VmQ0NWFlMTdmYmQ3OGYzMzgyOTM0NWMzN2Q1MGFkOTIzCnAxCi4=
');</pre> </div>
</div>
<p>这个host_id就是机器的唯一标识，我们需要用它来跟自己的账户进行匹配，不过在这之前还有个工作需要做，因为上面的那长串字符很明显可以看出 是用base64编码后的结果，我们得先把它解码再说，注意这里<a target="_blank" href="http://www.vpser.net/go/dropbox">Dropbox</a>耍了个小花招，这串字符串前面的那个”V“，是无用的，我们在解码后的把它 忽略掉<br />
&nbsp;</p>
<p><strong>6、将base64字符串解码</strong> </p>
<p>&nbsp;</p>
<p></p>
<p><strong> </strong></p>
<div class="codeText"><strong> <p class="alt"><span><span>$ echo </span><span class="attribute">mQ0NWFlMTdmYmQ3OGYzMzgyOTM0NWMzN2Q1MGFkOTIzCnAxCi4</span><span>= ｜ base64 -d </span></span></p>
<div>
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li><span>Vd45ae17fbd78f33829345c37d50ad923 </span></li>
    <li><span>p1 </span>     <link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</li>
</ol>
</div>
</strong></div>
<strong> <pre>我的结果是Vd45ae17fbd78f33829345c37d50ad923，忽略掉”V“，就是d45ae17fbd78f33829345c37d50ad923</pre> </strong><p></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>7、将账户信息与机器信息绑定</strong><br />
这步很简单，只需要访问以下网址，并登陆<br />
HOSTID替换成你刚才解码出来的那串字符就行了</p>
<pre><code>https://www.dropbox.com/cli_link?host_id=HOSTID</code></pre> <p><strong>8、建立dropbox的同步目录</strong><br />
dropbox的同步目录默认的是~/Dropbox</p>
<pre><code>$ mkdir ~/Dropbox</code></pre> <p><strong>9、运行，开始你的同步</strong></p>
<p><code>$ ~/.dropbox-dist/dropboxd &amp;</code></p>
<p>到这里dropbox就可以正常运行并同步了，文章标题说的是备份网站数据，那么我们就来使我们的网站数据能够同步到dropbox服务器上<br />
其实很简单，就是建立符号连接而已，windows之前是没有这个功能的<br />
比如要备份/var/www这个目录</p>
<pre><code>cd ~/Dropbox
$ ln -s /var/www web_backup</code></pre> <p>这就可以了,或者要备份/e<a title="tc" target="_blank" href="http://wiki.lazyhack.net/tc">tc</a>目录</p>
<pre><code>$ cd ~/Dropbox
$ ln -s /etc etc_backup</code></pre> <p>ok.发挥你的想象尽情的使用吧。<br />
&nbsp;</p>
<p><strong>推广</strong></p>
<p>如果你看过这篇文章后，打算也使用dropbox。那么你可以使用我下面的链接注册</p>
<p><a href="https://www.dropbox.com/referrals/NTU4NDMyNzI5">https://www.dropbox.com/referrals/NTU4NDMyNzI5</a></p>
<p>采用这个链接注册，你会增加250M空间。注册后是2G，然后会给你再发封邮件告诉你已经提升到2.25G。而我也会增加250M空间。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p><p><a href="http://xinlogs.com/post/16">一个很好的开源企业内部IM解决方案</a></p><p><a href="http://xinlogs.com/post/108">CentOS下的Tomcat停止脚本</a></p><p><a href="http://xinlogs.com/Tomcat-reboot-problems">解决Linux下Tomcat不能重启和停止问题</a></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p></div>]]></description>
	<pubDate>Mon, 05 Apr 2010 03:07:21 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/vps-dropbox-install</guid>

</item>
<item>
	<title>支付宝支付godaddy的郁闷经历</title>
	<link>http://xinlogs.com/alipay-godaddy</link>
	<description><![CDATA[<p>最近帮朋友弄了个网站并注册了域名。</p>
<p>注册域名的时候，选择域名注册商，我原来用的namecheap.com 后来网上看很多人推荐name.com和godaddy.com。</p>
<p>因为godaddy.com支持支付宝，我就选择了godaddy来注册。</p>
<p>其实上面提到的三家都不错，godaddy域名价格最便宜。按照网站提示注册，购买域名，然后支付宝付款。</p>
<p>郁闷就开始。。。。</p>
<p>支付宝显示付款成功，但是godaddy购买的域名还在购物车中，并没有购买成功。</p>
<p><img alt="" src="http://xinlogs.com/attachment/1270399710_88541213.jpg" /></p>
<p>我开始发邮件询问godaddy是什么情况。。。下面是我接到的回复。</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_5777');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_5777">
<ol class="dp-xml" style="border-bottom: 0px; border-left: 0px; list-style-type: none; margin-left: 5px; border-top: 0px; border-right: 0px">
    <li class="alt"><span><span>Thank&nbsp;you&nbsp;for&nbsp;contacting&nbsp;customer&nbsp;support.&nbsp;Unfortunately,&nbsp;products&nbsp;purchased&nbsp;with&nbsp;Alipay&nbsp;may&nbsp;not&nbsp;be&nbsp;available&nbsp;for&nbsp;up&nbsp;to&nbsp;13&nbsp;hours&nbsp;while&nbsp;Alipay&nbsp;confirms&nbsp;that&nbsp;the&nbsp;funds&nbsp;have&nbsp;been&nbsp;received.&nbsp;A&nbsp;receipt&nbsp;does&nbsp;not&nbsp;display&nbsp;until&nbsp;the&nbsp;products&nbsp;are&nbsp;available&nbsp;in&nbsp;the&nbsp;account.&nbsp;If&nbsp;this&nbsp;time&nbsp;frame&nbsp;has&nbsp;passed&nbsp;since&nbsp;your&nbsp;initial&nbsp;purchase,&nbsp;please&nbsp;let&nbsp;us&nbsp;know&nbsp;so&nbsp;we&nbsp;may&nbsp;troubleshoot&nbsp;further. &nbsp;&nbsp;</span></span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>I&nbsp;apologize&nbsp;if&nbsp;I&nbsp;have&nbsp;misunderstood&nbsp;your&nbsp;question.&nbsp;If&nbsp;you&nbsp;find&nbsp;this&nbsp;information&nbsp;does&nbsp;not&nbsp;help&nbsp;you,&nbsp;please&nbsp;reply&nbsp;to&nbsp;this&nbsp;email&nbsp;with&nbsp;a&nbsp;revised&nbsp;description&nbsp;of&nbsp;the&nbsp;issue&nbsp;you&nbsp;&nbsp;are&nbsp;having. &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>If&nbsp;we&nbsp;can&nbsp;assist&nbsp;you&nbsp;further&nbsp;in&nbsp;this&nbsp;matter&nbsp;please&nbsp;let&nbsp;us&nbsp;know. &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>Sincerely, &nbsp;&nbsp;</span></li>
    <li><span>Jesse&nbsp;P &nbsp;&nbsp;</span></li>
    <li class="alt"><span>Online&nbsp;Support&nbsp;Team&nbsp;&nbsp;</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>告诉我支付宝支付需要13个小时的确认时间？？？</p>
<p>我继续发信说明我注册域名是为了立即使用，13小时太长了，我去name.com注册了。他们回信却告诉我，可以退款，但退款周期是5-7个工作日。。。</p>
<p>以前用paypal支付过，都是支付后，域名马上可以使用。这次的支付宝支付太郁闷了。</p>
<p>不过godaddy确实大公司，不用担心他们不退款。我2010-03-31 09:24:44支付成功的，他们在2010-04-02 10:46:22已经将钱打回我支付宝了。</p>
<p>为了以后购买域名不郁闷，我当天下午就去申请里双币信用卡。以后都用paypal支付了。在这里提醒下大家，如果要用支付宝支付godaddy来购买域名，请耐心等待确认支付，而且这个期间不要修改购物车内容，不然会信息支付和购物车不符合而造成购买失败。</p>]]></description>
	<pubDate>Sun, 04 Apr 2010 16:56:54 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/alipay-godaddy</guid>

</item>
<item>
	<title>开启或者关闭MYSQL的query log(查询日志)</title>
	<link>http://xinlogs.com/disable-mysql-query-log</link>
	<description><![CDATA[<p>最近在整理服务器的时候，发现mysql的查询日志文件占用了很多空间。这个查询日志文件部分内容如下，随着查询增加，会越来越大</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_3583');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_3583">
<ol class="dp-xml" style="border-bottom: 0px; border-left: 0px; list-style-type: none; margin-left: 5px; border-top: 0px; border-right: 0px">
    <li class="alt"><span><span>Tcp port: 3306 Unix socket: /tmp/mysql.sock </span></span></li>
    <li><span>Time Id Command Argument </span></li>
    <li class="alt"><span>100404 8:36:49 1 Connect <a href="mailto:zzz@localhost">zzz@localhost</a> on </span></li>
    <li><span>1 Init DB&nbsp;zzz </span></li>
    <li class="alt"><span>1 Query SET NAMES 'utf8' </span></li>
    <li><span>1 Query SELECT * FROM `boblog_counter` LIMIT 0,1 </span></li>
    <li class="alt"><span>1 Query SELECT `blogid`,`pubtime`,`edittime`,`blogalias` FROM `boblog_blogs` WHERE `property`</span><span class="tag">&lt;</span><span class="tag-name">2</span><span> ORDER BY `pubtime`DESC LIMIT 0, 1500 </span></li>
    <li><span>1 Quit </span></li>
    <li class="alt"><span>100404 8:38:01 2 Connect admin@localhost on </span></li>
    <li><span>2 Init DB&nbsp;zzz </span></li>
    <li class="alt"><span>2 Query SET NAMES 'utf8' </span></li>
    <li><span>2 Query SET </span><span class="attribute">sql_mode</span><span>=</span><span class="attribute-value">''</span><span> </span></li>
    <li class="alt"><span>2 Query SELECT * FROM `cmseasy_settings` WHERE `tag`='table-fieldset' ORDER BY 1 DESC limit 1 </span></li>
    <li><span>2 Init DB&nbsp;zzz </span></li>
    <li class="alt"><span>2 Query SET NAMES 'utf8' </span></li>
    <li><span>2 Query SET </span><span class="attribute">sql_mode</span><span>=</span><span class="attribute-value">''</span><span> </span></li>
    <li class="alt"><span>2 Query SELECT * FROM `cmseasy_user` WHERE userid</span><span class="tag">&gt;</span><span>0 ORDER BY 1 DESC limit 1 </span></li>
    <li><span>2 Init DB&nbsp;zzz </span></li>
    <li class="alt"><span>2 Query SET NAMES 'utf8' </span></li>
    <li><span>2 Query SET </span><span class="attribute">sql_mode</span><span>=</span><span class="attribute-value">''</span><span> </span></li>
    <li class="alt"><span>2 Query SELECT count(typeid) as rec_sum FROM `cmseasy_type` </span></li>
    <li><span>2 Query SELECT * FROM `cmseasy_type` ORDER BY `order`,1 limit 1000 </span></li>
    <li class="alt"><span>2 Init DB zzz</span></li>
    <li><span>2 Query SET NAMES 'utf8' </span></li>
    <li class="alt"><span>2 Query SET </span><span class="attribute">sql_mode</span><span>=</span><span class="attribute-value">''</span><span> </span></li>
    <li><span>2 Query SELECT count(1) as rec_sum FROM `cmseasy_friendlink` WHERE state</span><span class="tag">&gt;</span><span>0 and </span><span class="attribute">linktype</span><span>=</span><span class="attribute-value">1</span><span> </span></li>
    <li class="alt"><span>2 Query SELECT * FROM `cmseasy_friendlink` WHERE state</span><span class="tag">&gt;</span><span>0 and </span><span class="attribute">linktype</span><span>=</span><span class="attribute-value">1</span><span> ORDER BY listorder asc,id limit 20 </span></li>
    <li><span>2 Init DB zzz</span></li>
    <li><span>2 Query SET NAMES 'utf8' </span></li>
    <li><span>2 Query SET </span><span class="attribute">sql_mode</span><span>=</span><span class="attribute-value">''</span><span> </span></li>
    <li class="alt"><span>2 Query SELECT count(1) as rec_sum FROM `cmseasy_friendlink` WHERE state</span><span class="tag">&gt;</span><span>0 and </span><span class="attribute">linktype</span><span>=</span><span class="attribute-value">1</span><span> </span></li>
    <li><span>2 Query SELECT * FROM `cmseasy_friendlink` WHERE state</span><span class="tag">&gt;</span><span>0 and </span><span class="attribute">linktype</span><span>=</span><span class="attribute-value">1</span><span> ORDER BY listorder asc,id limit 20 </span></li>
    <li class="alt"><span>2 Init DB&nbsp;zzz </span></li>
    <li><span>2 Query SET NAMES 'utf8' </span></li>
    <li class="alt"><span>2 Query SET </span><span class="attribute">sql_mode</span><span>=</span><span class="attribute-value">''</span><span> </span></li>
    <li><span>2 Query SELECT * FROM `cmseasy_templatetag` WHERE </span><span class="attribute">name</span><span>=</span><span class="attribute-value">'&aring;~E&not;&aring;~O&cedil;&ccedil;&reg;~@&auml;&raquo;~K'</span><span> ORDER BY 1 DESC limit 1 </span></li>
    <li class="alt"><span>2 Init DB&nbsp;zzz </span></li>
    <li><span>2 Query SET NAMES 'utf8' </span></li>
    <li class="alt"><span>2 Query SET </span><span class="attribute">sql_mode</span><span>=</span><span class="attribute-value">''</span><span> </span></li>
    <li><span>2 Query Describe cmseasy_archive </span></li>
    <li class="alt"><span>2 Query SELECT count(1) as rec_sum FROM `cmseasy_archive` WHERE typeid in (2) and </span><span class="attribute">checked</span><span>=</span><span class="attribute-value">1</span><span> and (state IS NULL or state</span><span class="tag">&lt;</span><span class="tag">&gt;</span><span>'-1') </span></li>
    <li><span>2 Query SELECT * FROM `cmseasy_archive` WHERE typeid in (2) and </span><span class="attribute">checked</span><span>=</span><span class="attribute-value">1</span><span> and (state IS NULL or state</span><span class="tag">&lt;</span><span class="tag">&gt;</span><span>'-1') ORDER BY aid desc limit 4 </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>其实记录的都是mysql执行的一些select语句，对于正常运行的服务器，我觉得基本没有必要保留这些日志。</p>
<p>关键是怎么关闭，这个日志的开启与否，可以通过mysql里提交如下命令查看</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_8683');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_8683">
<ol class="dp-xml" style="border-bottom: 0px; border-left: 0px; list-style-type: none; margin-left: 5px; border-top: 0px; border-right: 0px">
    <li class="alt"><span><span>show variables like 'log'; </span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>如果现实 log 的值是 ON就代码开启，如果是OFF就代表关闭</p>
<p>我们可以通过my.cnf配置文件进行配置</p>
<p>在my.cnf文件里，加入general-log = 0就关闭了这个查询日志。如果是general-log = 1就开启了这个查询日志。<br />
&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/23">如何建立两个表间的外键</a></p><p><a href="http://xinlogs.com/post/113">mysqldump解决中文乱码问题</a></p><p><a href="http://xinlogs.com/update-115disk-urls">批量更换115网盘链接</a></p><p><a href="http://xinlogs.com/HeidiSQL">HeidiSQL一款开源的MySQL图形管理软件</a></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p></div>]]></description>
	<pubDate>Sun, 04 Apr 2010 16:35:27 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/disable-mysql-query-log</guid>

</item>
<item>
	<title>HTC hero g3 openvpn设置</title>
	<link>http://xinlogs.com/HTC-Hero-Openvpn</link>
	<description><![CDATA[<p>现在YouTube和google博客等站点都被屏蔽，为了打破限制，只能用vpn来穿越了。</p>
<p>原来一直用pptpd类型vpn，这种类型速度快，但是要求防火墙或者网关支持。对内外支持不好（反正我在单位和家里歌华宽带都不支持）</p>
<p>后来改用openvpn类型的vpn了，发现虽然openvpn配置麻烦，需要安装客户端。但却是对内网支持良好，穿透能力强。</p>
<p>openvpn可以支持多系统（服务器我肯定用linux，这里多系统主要指客户端）</p>
<p>Windows系统可以采用openvpn gui，这个在我博客以前文章提到了，今天要说的是我的手机，htc hero这次也可以让手机连接openvpn服务器上youtube等站点了。</p>
<p><strong>手机型号及系统</strong></p>
<p>我的手机是HTC hero g3</p>
<p>采用的ROM是Flyzup制作的基于android 1.5修改的。</p>
<p>Rom可以到Flyzup网站下载</p>
<p><a href="http://www.innovative-space.com/2010/02/21/flzyup-custom-rom-v1-6-final-release/">http://www.innovative-space.com/2010/02/21/flzyup-custom-rom-v1-6-final-release/</a></p>
<p>其实只要手机用的Rom可以支持openvpn，存在tun.so文件就可以</p>
<p><strong>安装相关软件</strong></p>
<p>首先需要需要安装openvpn，这个软件我们可以到下面地址下载已经编译好的版本。因为是static编译的，所以不需要任何动态库支持直接解压就可以使用。</p>
<p><a href="http://github.com/downloads/fries/android-external-openvpn/openvpn-static-2.1.1.bz2">http://github.com/downloads/fries/android-external-openvpn/openvpn-static-2.1.1.bz2</a></p>
<p>将解压后得到的openvpn-static-2.1.1文件改名为openvpn 并拷贝到手机的/system/xbin/目录下</p>
<p>我是采用手机上安装的Better Terminal Emulator Pro来操作的，也可以用adb连接上usb操作。</p>
<p>有了openvpn后，我们还要创建两个软连接才可以让后面的openvpn顺利建立连接</p>
<p>用Better Terminal Emulator Pro进入终端模式，输入如下命令</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_6088');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_6088">
<ol class="dp-xml" style="border-right: 0px; border-top: 0px; margin-left: 5px; border-left: 0px; border-bottom: 0px; list-style-type: none">
    <li class="alt"><span><span>mkdir /system/xbin/bb </span></span></li>
    <li><span>ln -s /system/xbin/ifconfig /system/xbin/bb/ifconfig </span></li>
    <li class="alt"><span>ln -s /system/xbin/route /system/xbin/bb/route </span></li>
</ol>
</div>
<link href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" type="text/css" rel="stylesheet" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>上面创建两个命令的软连接，是因为后面安装的TunnelDroid软件，总是调用/system/xbin/bb目录下的命令，如果没有命令，就会出错。</p>
<p>用google的电子市场，查找TunnelDroid软件，安装TunnelDroid软件。</p>
<p><strong>配置TunnelDroid</strong></p>
<p>其实和配置Windows下的客户端一样，也需要一个配置文件和3个密钥文件</p>
<p>我们在sd卡的跟目录创建openvpn目录</p>
<p>在openvpn目录放入client.ovpn配置文件和ca.crt、client-1.crt和client-1.key密钥文件</p>
<p>这样启动TunnelDroid后，就会出现client.ovpn的选项，直接选择连接就可以。上面的配置文件和密钥，我都是从配置好的Windows机器拷贝过来的。</p>
<p>目前我测试的android手机、windowsxp、windows7和Linux全部都可以连接openvpn服务器。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/my-htc-hero-mobile">我的新手机HTC hero g3</a></p></div>]]></description>
	<pubDate>Wed, 17 Mar 2010 11:37:12 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/HTC-Hero-Openvpn</guid>

</item>
<item>
	<title>CentOS 5.3下OpenVPN安装和Win7下OpenVPN GUI安装</title>
	<link>http://xinlogs.com/OpenVPN-Install</link>
	<description><![CDATA[<p>本来我是在美国的VPS服务器上安装的pptp vpn，这个vpn可以用windows自带的拨号连接，配置也很方便。刚配置好的时候很好用，可以开youtube也可以访问一些被封闭的站点。但是后来家里的歌华有线好像调整了一些路由配置，导致我在家里就不能连接vpn了。单位也不能连接。我用老婆家里的adsl尝试连接正常，用联通3G连接也正常。。。。这个既然是网络的问题，估计个人也解决不了了</p>
<p>最近单位也开始搞起来封锁了，开心、verycd等都被封。。。又不能用pptpd vpn了。。。看来该想想其他办法了。代理尝试了，不管用，看来不是基于域名的限制。</p>
<p>于是就开始尝试采用openvpn了。</p>
<p>参考了</p>
<p><a href="http://www.throx.net/2008/04/13/openvpn-and-centos-5-installation-and-configuration-guide/">http://www.throx.net/2008/04/13/openvpn-and-centos-5-installation-and-configuration-guide/</a></p>
<p><a href="http://www.xiaohui.com/dev/server/20070514-install-openvpn.htm">http://www.xiaohui.com/dev/server/20070514-install-openvpn.htm</a></p>
<p><strong>2010年10月14日更新</strong></p>
<p>加入官方CentOS下,iptables规则修改.保证顺利nat上网</p>
<p><strong>整体方案</strong></p>
<p>采用位于美国的CentOS 5.3 Linux服务器搭建openvpn服务器，并通过iptables的nat功能使openvpn服务器当做客户端网关。</p>
<p>客户端安装OpenVPN GUI程序连接服务器</p>
<p><strong>服务器</strong></p>
<p>服务器采用位于美国的vps</p>
<p>系统CentOS 5.3</p>
<p>安装openvpn作为vpn服务器软件</p>
<p><strong>OpenVPN服务器安装</strong></p>
<p>kernel 需要<strong>支持 tun 设备</strong>, 需要加载 iptables 模块. <br />
检查 tun 是否安装:</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_8743');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_8743">
<ol class="dp-xml">
    <li class="alt"><span><span>modinfo tun </span></span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>或者 </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>find / -name tun.o -print </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>安装需要的相关软件</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_5504');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_5504">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>yum install rpm-build </span></span></li>
    <li><span>yum install autoconf.noarch </span></li>
    <li class="alt"><span>yum install zlib-devel </span></li>
    <li><span>yum install pam-devel </span></li>
    <li class="alt"><span>yum install openssl-devel </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>安装环境准备好后，我们下载需要安装的软件。一共需要下载两个软件openvpn 2.0.9和lzo-1.08-4</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_2756');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_2756">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>wget http://openvpn.net/release/openvpn-2.0.9.tar.gz </span></span></li>
    <li><span>wget http://openvpn.net/release/lzo-1.08-4.rf.src.rpm </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>安装lzo</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_2338');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_2338">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>rpmbuild --rebuild lzo-1.08-4.rf.src.rpm </span></span></li>
    <li><span>rpm -Uvh /usr/src/redhat/RPMS/i386/lzo-*.rpm</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>安装openvpn</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_6883');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_6883">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>rpmbuild -tb openvpn-2.0.9.tar.gz </span></span></li>
    <li><span>rpm -Uvh /usr/src/redhat/RPMS/i386/openvpn-2.0.9-1.i386.rpm </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>安装后，复制配置文件</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_3327');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_3327">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>cp -r /usr/share/doc/openvpn-2.0.9/easy-rsa/ /etc/openvpn/ </span></span></li>
    <li><span>cp /usr/share/doc/openvpn-2.0.9/sample-config-files/server.conf /etc/openvpn/ </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>配置生成CA脚本需要的配置文件vars</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_1803');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_1803">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>vi /etc/openvpn/easy-rsa/</span></span><span>vars</span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>打开vars后，找到文件最后的如下内容</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_2532');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_2532">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>export </span><span class="attribute">KEY_COUNTRY</span><span>=</span><span class="attribute-value">KG</span><span> </span></span></li>
    <li><span>export </span><span class="attribute">KEY_PROVINCE</span><span>=</span><span class="attribute-value">NA</span><span> </span></li>
    <li class="alt"><span>export </span><span class="attribute">KEY_CITY</span><span>=</span><span class="attribute-value">BISHKEK</span><span> </span></li>
    <li><span>export </span><span class="attribute">KEY_ORG</span><span>=</span><span class="attribute-value">"OpenVPN-TEST"</span><span> </span></li>
    <li class="alt"><span>export </span><span class="attribute">KEY_EMAIL</span><span>=</span><span class="attribute-value">"me@myhost.mydomain"</span><span> </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>根据自己信息修改上面内容,下面是具体含义</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_1636');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_1636">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>export </span><span class="attribute">KEY_COUNTRY</span><span>=</span><span class="attribute-value">KG</span><span> 设置国家 </span></span></li>
    <li><span>export </span><span class="attribute">KEY_PROVINCE</span><span>=</span><span class="attribute-value">NA</span><span> 设置省份 </span></li>
    <li class="alt"><span>export </span><span class="attribute">KEY_CITY</span><span>=</span><span class="attribute-value">BISHKEK</span><span> 设置城市 </span></li>
    <li><span>export </span><span class="attribute">KEY_ORG</span><span>=</span><span class="attribute-value">"OpenVPN-TEST"</span><span> 设置组织 </span></li>
    <li class="alt"><span>export </span><span class="attribute">KEY_EMAIL</span><span>=</span><span class="attribute-value">"me@myhost.mydomain"</span><span> 设置邮件 </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>设置好后，执行如下命令</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_6937');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_6937">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>cd /etc/openvpn/easy-rsa/ </span></span></li>
    <li><span>. ./vars </span></li>
    <li class="alt"><span>./clean-all </span></li>
    <li><span>注意上面的. ./vars两个点之间有一个空格 </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>建立CA证书</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_5043');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_5043">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>./build-ca </span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>生成后，ls keys 可以看到ca.crt ca.key文件</p>
<p>建立服务器密钥</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_1625');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_1625">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>./build-key-server xinlogs </span></span></li>
    <li><span>注意这里的xinlogs是我给密钥起的名字，可以根据个人情况修改 </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>生成Diffie-Hellman文件</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_8054');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_8054">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>./build-dh </span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>以上文件都正确生成后，拷贝文件到正确目录</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_3008');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_3008">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>cd /etc/openvpn/easy-rsa/ </span></span></li>
    <li><span>cp keys/ca.crt ../ </span></li>
    <li class="alt"><span>cp keys/dh1024.pem ../ </span></li>
    <li><span>cp keys/xinlogs.key ../ </span></li>
    <li class="alt"><span>cp keys/xinlogs.crt ../ </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>生成客户端密钥</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_2881');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_2881">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>./build-key client-1 </span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>这里client-1是客户端密钥的文件名，如果需要创建多个客户端密钥，就修改client-1名字多次生成即可。</p>
<p>修改/etc/openvpn/server.conf配置</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_7600');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_7600">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>local 204.74.212.217 </span></span></li>
    <li><span>#修改local后面ip为服务器地址 </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>dev tap </span></li>
    <li class="alt"><span>;dev tun </span></li>
    <li><span>#默认是dev tun修改为dev tap,tap是可以路由模式 tun 是以太网隧道模式。具体区别我也不太清楚 </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>ca ca.crt </span></li>
    <li class="alt"><span>cert xinlogs.crt </span></li>
    <li><span>key xinlogs.key </span></li>
    <li class="alt"><span>#cert后面修改为生成的服务器crt文件xinlogs.crt </span></li>
    <li><span>#key后面修改为生成的服务器key文件xinlogs.key </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>dh dh1024.pem </span></li>
    <li class="alt"><span>#dh后面修改问生成的dh1024.pem </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>server 10.8.0.0 255.255.255.0 </span></li>
    <li><span>#server后面基本就用默认的10.8.0.0 255.255.255.0即可 </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>ifconfig-pool-persist ipp.txt </span></li>
    <li class="alt"><span>#这个默认的ipp.txt就可以 </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>push "route 10.8.0.0 255.255.255.0" </span></li>
    <li><span>#添加客户端路由 </span></li>
    <li class="alt"><span>push "redirect-gateway" </span></li>
    <li><span>#修改客户端默认路由 </span></li>
    <li class="alt"><span>push "dhcp-option DNS 8.8.8.8" </span></li>
    <li><span>#修改客户端默认dns </span></li>
    <li class="alt"><span>client-to-client </span></li>
    <li><span>#允许连接到vpn的客户端可以互相访问 </span></li>
    <li class="alt"><span>duplicate-cn </span></li>
    <li><span>keepalive 10 120 </span></li>
    <li class="alt"><span>comp-lzo </span></li>
    <li><span>#启用lzo压缩 </span></li>
    <li class="alt"><span>user nobody </span></li>
    <li><span>group nobody </span></li>
    <li class="alt"><span>persist-key </span></li>
    <li><span>persist-tun </span></li>
    <li class="alt"><span>status /var/log/openvpn-status.log </span></li>
    <li><span>log /var/log/openvpn.log </span></li>
    <li class="alt"><span>log-append /var/log/openvpn.log </span></li>
    <li><span>verb 3 </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p><strong>启动停止openvpn</strong></p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_1149');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_1149">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>service openvpn start </span></span></li>
    <li><span>#启动openvpn服务 </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>service openvpn stop </span></li>
    <li class="alt"><span>#停止openvpn服务 </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p><strong>配置iptables</strong></p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_7010');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_7010">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eth0 -j SNAT --to-source 214.174.212.217 </span></span></li>
    <li><span>#上面命令最后的214.174.212.217是服务器的公网地址，需要根据自己情况修改 </span></li>
    <li class="alt"><span>service iptables save </span></li>
</ol>
</div>
</div>
<p>确认net.ipv4.ip_forward = 1后，服务器就全部配置完成。</p>
<p>如果是用的CentOS官方版本,不是VPS.那因为它自带的iptables规则限制,还需要在/etc/sysconfig/iptables加入下面语句才可以顺利nat上网</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_5461');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_5461">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>-A&nbsp;RH-Firewall-1-INPUT&nbsp;-i&nbsp;tap+&nbsp;-j&nbsp;ACCEPT&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"> <script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>&nbsp;</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_3930');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_3930">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>cat /etc/sysctl.conf |grep forward </span></span></li>
    <li><span># Controls IP packet forwarding </span></li>
    <li class="alt"><span class="attribute">net.ipv4.ip_forward</span><span> = </span><span class="attribute-value">1</span><span> </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>#如果不是1，请用vi修改/etc/sysctl.conf文件 </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p><strong>Win7下Openvpn GUI安装</strong></p>
<p>从 <a target="_blank" href="http://openvpn.se/">http://openvpn.se</a>下载安装文件</p>
<p class="text-without-space">Latest stable release: <strong>1.0.3</strong> with OpenVPN 2.0.9 (2006-10-17)</p>
<p class="text-without-space">我们直接下载<a href="http://openvpn.se/files/install_packages/openvpn-2.0.9-gui-1.0.3-install.exe">http://openvpn.se/files/install_packages/openvpn-2.0.9-gui-1.0.3-install.exe</a></p>
<p class="text-without-space"><strong>注意：下载后，别着急双击安装。先右键属性，设置兼容模式为windosxp sp3 并用管理员身份运行。</strong></p>
<p class="text-without-space"><img alt="" src="/attachment/1268635851_23046e9f.png" /></p>
<p class="text-without-space">然后再运行安装。</p>
<p class="text-without-space"><strong>客户端配置</strong></p>
<p class="text-without-space">安装后，将服务器/etc/openvpn/easy-rsa/keys/目录下的ca.crt、client-1.crt和client-1.key三个文件拷贝到C:Program FilesOpenVPNconfig目录下</p>
<p class="text-without-space">再将C:Program FilesOpenVPNsample-config目录下的client.ovpn文件拷贝到C:Program FilesOpenVPNconfig目录下。</p>
<p class="text-without-space">在开始-&gt;所有程序里找到openvpn，进入里面右键点击OpenVPN GUI属性，同样修改兼容模式为windows xp sp3 以管理员运行</p>
<p class="text-without-space">修改后，运行openvpn gui程序</p>
<p class="text-without-space">正确运行后，电脑的右下角会出现openvpn的图标，右键点击选择Edit Config来修改客户端配置文件</p>
<p class="text-without-space">下面是我全部客户端配置文件</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_9401');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_9401">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>############################################## </span></span></li>
    <li><span># Sample client-side OpenVPN 2.0 config file # </span></li>
    <li class="alt"><span># for connecting to multi-client server. # </span></li>
    <li><span># # </span></li>
    <li class="alt"><span># This configuration can be used by multiple # </span></li>
    <li><span># clients, however each client should have # </span></li>
    <li class="alt"><span># its own cert and key files. # </span></li>
    <li><span># # </span></li>
    <li class="alt"><span># On Windows, you might want to rename this # </span></li>
    <li><span># file so it has a .ovpn extension # </span></li>
    <li class="alt"><span>############################################## </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span># Specify that we are a client and that we </span></li>
    <li><span># will be pulling certain config file directives </span></li>
    <li class="alt"><span># from the server. </span></li>
    <li><span>client </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># Use the same setting as you are using on </span></li>
    <li class="alt"><span># the server. </span></li>
    <li><span># On most systems, the VPN will not function </span></li>
    <li class="alt"><span># unless you partially or fully disable </span></li>
    <li><span># the firewall for the TUN/TAP interface. </span></li>
    <li class="alt"><span>dev tap </span></li>
    <li><span>;dev tun </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># Windows needs the TAP-Win32 adapter name </span></li>
    <li class="alt"><span># from the Network Connections panel </span></li>
    <li><span># if you have more than one. On XP SP2, </span></li>
    <li class="alt"><span># you may need to disable the firewall </span></li>
    <li><span># for the TAP adapter. </span></li>
    <li class="alt"><span>;dev-node MyTap </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span># Are we connecting to a TCP or </span></li>
    <li><span># UDP server? Use the same setting as </span></li>
    <li class="alt"><span># on the server. </span></li>
    <li><span>;proto tcp </span></li>
    <li class="alt"><span>proto udp </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span># The hostname/IP and port of the server. </span></li>
    <li><span># You can have multiple remote entries </span></li>
    <li class="alt"><span># to load balance between the servers. </span></li>
    <li><span>remote 214.174.212.217 1194 </span></li>
    <li class="alt"><span>;remote my-server-2 1194 </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span># Choose a random host from the remote </span></li>
    <li><span># list for load-balancing. Otherwise </span></li>
    <li class="alt"><span># try hosts in the order specified. </span></li>
    <li><span>;remote-random </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># Keep trying indefinitely to resolve the </span></li>
    <li class="alt"><span># host name of the OpenVPN server. Very useful </span></li>
    <li><span># on machines which are not permanently connected </span></li>
    <li class="alt"><span># to the internet such as laptops. </span></li>
    <li><span>resolv-retry infinite </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># Most clients don't need to bind to </span></li>
    <li class="alt"><span># a specific local port number. </span></li>
    <li><span>nobind </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># Downgrade privileges after initialization (non-Windows only) </span></li>
    <li class="alt"><span>;user nobody </span></li>
    <li><span>;group nobody </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># Try to preserve some state across restarts. </span></li>
    <li class="alt"><span>persist-key </span></li>
    <li><span>persist-tun </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># If you are connecting through an </span></li>
    <li class="alt"><span># HTTP proxy to reach the actual OpenVPN </span></li>
    <li><span># server, put the proxy server/IP and </span></li>
    <li class="alt"><span># port number here. See the man page </span></li>
    <li><span># if your proxy server requires </span></li>
    <li class="alt"><span># authentication. </span></li>
    <li><span>;http-proxy-retry # retry on connection failures </span></li>
    <li class="alt"><span>;http-proxy [proxy server] [proxy port #] </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span># Wireless networks often produce a lot </span></li>
    <li><span># of duplicate packets. Set this flag </span></li>
    <li class="alt"><span># to silence duplicate packet warnings. </span></li>
    <li><span>;mute-replay-warnings </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># SSL/TLS parms. </span></li>
    <li class="alt"><span># See the server config file for more </span></li>
    <li><span># description. It's best to use </span></li>
    <li class="alt"><span># a separate .crt/.key file pair </span></li>
    <li><span># for each client. A single ca </span></li>
    <li class="alt"><span># file can be used for all clients. </span></li>
    <li><span>ca ca.crt </span></li>
    <li class="alt"><span>cert client-1.crt </span></li>
    <li><span>key client-1.key </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># Verify server certificate by checking </span></li>
    <li class="alt"><span># that the certicate has the nsCertType </span></li>
    <li><span># field set to "server". This is an </span></li>
    <li class="alt"><span># important precaution to protect against </span></li>
    <li><span># a potential attack discussed here: </span></li>
    <li class="alt"><span># http://openvpn.net/howto.html#mitm </span></li>
    <li><span># </span></li>
    <li class="alt"><span># To use this feature, you will need to generate </span></li>
    <li><span># your server certificates with the nsCertType </span></li>
    <li class="alt"><span># field set to "server". The build-key-server </span></li>
    <li><span># script in the easy-rsa folder will do this. </span></li>
    <li class="alt"><span>;ns-cert-type server </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span># If a tls-auth key is used on the server </span></li>
    <li><span># then every client must also have the key. </span></li>
    <li class="alt"><span>;tls-auth ta.key 1 </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span># Select a cryptographic cipher. </span></li>
    <li><span># If the cipher option is used on the server </span></li>
    <li class="alt"><span># then you must also specify it here. </span></li>
    <li><span>;cipher x </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># Enable compression on the VPN link. </span></li>
    <li class="alt"><span># Don't enable this unless it is also </span></li>
    <li><span># enabled in the server config file. </span></li>
    <li class="alt"><span>comp-lzo </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span># Set log file verbosity. </span></li>
    <li><span>verb 3 </span></li>
    <li class="alt">&nbsp;</li>
    <li><span># Silence repeating messages </span></li>
    <li class="alt"><span>;mute 20 </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>route-method exe </span></li>
    <li><span>route-delay 2 </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p class="text-without-space">其实主要修改的就是如下地方</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_9227');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_9227">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>client </span></span></li>
    <li><span>#说明这个是客户端配置文件 </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>dev tap </span></li>
    <li class="alt"><span>;dev tun </span></li>
    <li><span>#这个和服务器一样就可以 </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>remote 214.174.212.217 1194 </span></li>
    <li class="alt"><span>#这个ip要修改为服务器的公网ip地址 </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>resolv-retry infinite </span></li>
    <li><span>nobind </span></li>
    <li class="alt"><span>persist-key </span></li>
    <li><span>persist-tun </span></li>
    <li class="alt">&nbsp;</li>
    <li>&nbsp;</li>
    <li class="alt"><span>ca ca.crt </span></li>
    <li><span>cert client-1.crt </span></li>
    <li class="alt"><span>key client-1.key </span></li>
    <li><span>#上面三行一定要根据自己生成的密钥配合 </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>comp-lzo </span></li>
    <li class="alt"><span>#启用lzo压缩 </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span># Set log file verbosity. </span></li>
    <li><span>verb 3 </span></li>
    <li class="alt">&nbsp;</li>
    <li>&nbsp;</li>
    <li class="alt"><span>route-method exe </span></li>
    <li><span>route-delay 2 </span></li>
    <li class="alt"><span>#最后这两行win7如果不加上，就不能启动修改路由，导致拨vpn成功，但是不能通过远程服务器做网关上网 </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>这些配置完成后，右键点openvpn gui在桌面右下角图标选择Connect连接</p>
<p>我正确连接后的日志如下</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_3077');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_3077">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>Mon Mar 15 13:03:14 2010 OpenVPN 2.0.9 Win32-MinGW [SSL] [LZO] built on Oct 1 2006 </span></span></li>
    <li><span>Mon Mar 15 13:03:14 2010 IMPORTANT: OpenVPN's default port number is now 1194, based on an official port number assignment by IANA. OpenVPN 2.0-beta16 and earlier used 5000 as the default port. </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:14 2010 WARNING: No server certificate verification method has been enabled. See http://openvpn.net/howto.html#mitm for more info. </span></li>
    <li><span>Mon Mar 15 13:03:14 2010 LZO compression initialized </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:14 2010 Control Channel MTU parms [ L:1574 D:138 EF:38 EB:0 ET:0 EL:0 ] </span></li>
    <li><span>Mon Mar 15 13:03:14 2010 Data Channel MTU parms [ L:1574 D:1450 EF:42 EB:135 ET:32 EL:0 AF:3/1 ] </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:14 2010 Local Options hash (</span><span class="attribute">VER</span><span>=</span><span class="attribute-value">V4</span><span>): 'd79ca330' </span></li>
    <li><span>Mon Mar 15 13:03:14 2010 Expected Remote Options hash (</span><span class="attribute">VER</span><span>=</span><span class="attribute-value">V4</span><span>): 'f7df56b8' </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:14 2010 UDPv4 link local: [undef] </span></li>
    <li><span>Mon Mar 15 13:03:14 2010 UDPv4 link remote: 204.74.212.217:1194 </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:16 2010 TLS: Initial packet from 204.74.212.217:1194, </span><span class="attribute">sid</span><span>=</span><span class="attribute-value">3d4cf00a</span><span> 84deb309 </span></li>
    <li><span>Mon Mar 15 13:03:18 2010 VERIFY OK: </span><span class="attribute">depth</span><span>=</span><span class="attribute-value">1</span><span>, /</span><span class="attribute">C</span><span>=</span><span class="attribute-value">US</span><span>/</span><span class="attribute">ST</span><span>=</span><span class="attribute-value">Beijing</span><span>/</span><span class="attribute">L</span><span>=</span><span class="attribute-value">BEIJING</span><span>/</span><span class="attribute">O</span><span>=</span><span class="attribute-value">xinlogs</span><span>.com/</span><span class="attribute">CN</span><span>=</span><span class="attribute-value">babodx</span><span>/</span><span class="attribute">emailAddress</span><span>=</span><span class="attribute-value">babodx</span><span>@gmail.com </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:18 2010 VERIFY OK: </span><span class="attribute">depth</span><span>=</span><span class="attribute-value">0</span><span>, /</span><span class="attribute">C</span><span>=</span><span class="attribute-value">US</span><span>/</span><span class="attribute">ST</span><span>=</span><span class="attribute-value">Beijing</span><span>/</span><span class="attribute">O</span><span>=</span><span class="attribute-value">xinlogs</span><span>.com/</span><span class="attribute">CN</span><span>=</span><span class="attribute-value">babodx</span><span>/</span><span class="attribute">emailAddress</span><span>=</span><span class="attribute-value">babodx</span><span>@gmail.com </span></li>
    <li><span>Mon Mar 15 13:03:20 2010 Data Channel Encrypt: Cipher 'BF-CBC' initialized with 128 bit key </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:20 2010 Data Channel Encrypt: Using 160 bit message hash 'SHA1' for HMAC authentication </span></li>
    <li><span>Mon Mar 15 13:03:20 2010 Data Channel Decrypt: Cipher 'BF-CBC' initialized with 128 bit key </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:20 2010 Data Channel Decrypt: Using 160 bit message hash 'SHA1' for HMAC authentication </span></li>
    <li><span>Mon Mar 15 13:03:20 2010 Control Channel: TLSv1, cipher TLSv1/SSLv3 DHE-RSA-AES256-SHA, 1024 bit RSA </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:20 2010 [babodx] Peer Connection Initiated with 214.174.212.217:1194 </span></li>
    <li><span>Mon Mar 15 13:03:21 2010 SENT CONTROL [babodx]: 'PUSH_REQUEST' (</span><span class="attribute">status</span><span>=</span><span class="attribute-value">1</span><span>) </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:21 2010 PUSH: Received control message: 'PUSH_REPLY,route 10.8.0.0 255.255.255.0,redirect-gateway,dhcp-option DNS 8.8.8.8,route-gateway 10.8.0.1,ping 10,ping-restart 120,ifconfig 10.8.0.3 255.255.255.0' </span></li>
    <li><span>Mon Mar 15 13:03:21 2010 OPTIONS IMPORT: timers and/or timeouts modified </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:21 2010 OPTIONS IMPORT: --ifconfig/up options modified </span></li>
    <li><span>Mon Mar 15 13:03:21 2010 OPTIONS IMPORT: route options modified </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:21 2010 OPTIONS IMPORT: --ip-win32 and/or --dhcp-option options modified </span></li>
    <li><span>Mon Mar 15 13:03:21 2010 TAP-WIN32 device [本地连接 3] opened: .Global{A958F4F2-14AF-49E6-9FBF-4FC25B8D8786}.tap </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:21 2010 TAP-Win32 Driver Version 8.4 </span></li>
    <li><span>Mon Mar 15 13:03:21 2010 TAP-Win32 </span><span class="attribute">MTU</span><span>=</span><span class="attribute-value">1500</span><span> </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:21 2010 Notified TAP-Win32 driver to set a DHCP IP/netmask of 10.8.0.3/255.255.255.0 on interface {A958F4F2-14AF-49E6-9FBF-4FC25B8D8786} [DHCP-serv: 10.8.0.0, lease-time: 31536000] </span></li>
    <li><span>Mon Mar 15 13:03:21 2010 Successful ARP Flush on interface [29] {A958F4F2-14AF-49E6-9FBF-4FC25B8D8786} </span></li>
    <li class="alt"><span>Mon Mar 15 13:03:23 2010 TEST ROUTES: 2/2 succeeded </span><span class="attribute">len</span><span>=</span><span class="attribute-value">1</span><span> </span><span class="attribute">ret</span><span>=</span><span class="attribute-value">1</span><span> </span><span class="attribute">a</span><span>=</span><span class="attribute-value">0</span><span> u/</span><span class="attribute">d</span><span>=</span><span class="attribute-value">up</span><span> </span></li>
    <li><span>Mon Mar 15 13:03:23 2010 route ADD 214.174.212.217 MASK 255.255.255.255 192.168.2.1 </span></li>
    <li class="alt"><span>操作完成! </span></li>
    <li><span>Mon Mar 15 13:03:23 2010 route DELETE 0.0.0.0 MASK 0.0.0.0 192.168.2.1 </span></li>
    <li class="alt"><span>操作完成! </span></li>
    <li><span>Mon Mar 15 13:03:23 2010 route ADD 0.0.0.0 MASK 0.0.0.0 10.8.0.1 </span></li>
    <li class="alt"><span>操作完成! </span></li>
    <li><span>Mon Mar 15 13:03:23 2010 route ADD 10.8.0.0 MASK 255.255.255.0 10.8.0.1 </span></li>
    <li class="alt"><span>操作完成! </span></li>
    <li><span>Mon Mar 15 13:03:23 2010 Initialization Sequence Completed </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/vps-dropbox-install">一款Linux下同步备份文件的好软件DROPBOX</a></p><p><a href="http://xinlogs.com/post/16">一个很好的开源企业内部IM解决方案</a></p><p><a href="http://xinlogs.com/linux-ddos-defender">Linux防御DDOS攻击</a></p></div>]]></description>
	<pubDate>Mon, 15 Mar 2010 05:27:55 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/OpenVPN-Install</guid>

</item>
<item>
	<title>CentOS 5.4 基于HP Proliant DL380 G5服务器配置Modular Smart Array 1000存储</title>
	<link>http://xinlogs.com/HP-MSA1000-DL380G5-Centos5</link>
	<description><![CDATA[<p>原来单位的存储一直是分两个800G的区，挂在到Windows下。Windows的系统总要担心病毒，所以打算迁移到CentOS Linux下。</p>
<p>参考了<a href="http://blog.s135.com/post/415/">http://blog.s135.com/post/415/</a>这篇文章，但是他的文章里是单控制器，并且没有用到光纤。所以配置上有些不同</p>
<p><strong>硬件配置</strong></p>
<p>一台HP MSA 1000存储设备（包含两个Modular Smart Array 1000控制器）</p>
<p>一台HP Storage SAN 4/8光纤交换机</p>
<p>一台HP Proliant DL380 G5 2U服务器</p>
<p>七块SCSI 300G硬盘</p>
<p>一块HP StorageWorks FC1142SR 4GB PCI-E 光纤卡</p>
<p><img alt="" width="400" height="429" src="http://xinlogs.com/attachment/1268291756_3323fe38.jpg" /></p>
<p>从两个Modular Smart Array 1000的控制器后面连接光纤到光纤交换机。然后将光纤卡安装到服务器上，用光纤连接光纤卡到光纤交换机。</p>
<p><img alt="" width="200" height="214" src="http://xinlogs.com/attachment/1268291876_430536d8.jpg" /><img alt="" width="200" height="214" src="http://xinlogs.com/attachment/1268291876_1749bde7.jpg" /></p>
<p><strong>软件配置</strong></p>
<p>先对各种硬件的fireware进行下更新。</p>
<p>从惠普网站下载update fireware光盘，下载的文件为firmware-8.60-0.zip，大小463M左右，然后解压刻成光盘</p>
<p>下载地址<a href="ftp://ftp.hp.com/pub/softlib2/software1/cd/p1040529012/v53483/firmware-8.60-0.zip">ftp://ftp.hp.com/pub/softlib2/software1/cd/p1040529012/v53483/firmware-8.60-0.zip</a></p>
<p>用光盘启动服务器，然后安装提示做就可以。它会更新网卡、服务器等设备的fireware。都是自动检测并更新的，很简单</p>
<p>确保各种fireware都更新后，下面需要用到smartstart光盘来对存储进行配置了</p>
<p>从惠普网站下载smartstart光盘，下载的文件smartstart-8.30-0-x86.zip，大小576M左右，也是解压刻录光盘</p>
<p>下载地址<a href="ftp://ftp.hp.com/pub/softlib2/software1/cd/p1040463476/v49882/smartstart-8.30-0-x86.zip">ftp://ftp.hp.com/pub/softlib2/software1/cd/p1040463476/v49882/smartstart-8.30-0-x86.zip</a></p>
<p>然后用光盘启动服务器，按照提示进入后，选择第2项配置存储卡，第一项是用来安装操作系统的，我发现没有Linux的操作系统。。。都是Windows系列。</p>
<p>可以发现服务器自己的raid卡 HP Smart Array E200和MSA 1000存储。</p>
<p>我是先将服务器的3块硬盘组成一个Raid 5，然后再配置MSA 1000的存储，也是将7块盘组成Raid 5。我看了下资料，说raid 6比raid5要损失8%-15%的性能，但是可以保证同时坏2块盘不丢失数据。不过我觉得raid5够用了。</p>
<p>因为是双控制器，我这里的fireware是4.48所以采用的是active/standby模式。如果打算用active/active模式，需要更新fireware到7.0版本</p>
<p>用smartstart光盘做好raid后，就可以给服务器安装系统了。</p>
<p><strong>安装CentOS 5.4 64bit</strong></p>
<p>安装CentOS 5.4 64bit版本前，先将连接到服务器的光纤拔掉，要不系统总是提示/dev/sda不可读取，这里的sda就是我们存储。</p>
<p>一切安装正常安装就可以。</p>
<p>正常安装后，连接好光纤，再启动服务器。</p>
<p>这个时候因为没有安装驱动，服务器在启动过程中会报很多end_request: error</p>
<p>而且我还发现如果不安装驱动，我们可以通过fdisk -l查找到存储设备，但是每次重启或者存储关机再开，存储的设备名都会变，有时候是/dev/sda有时候是/dev/sdb。所以很难在/etc/fstab里写入mount的配置。</p>
<p><strong>安装HBA卡驱动</strong></p>
<p>到HP网站下载驱动</p>
<p><a href="http://h20000.www2.hp.com/bizsupport/TechSupport/SoftwareIndex.jsp?lang=en&amp;cc=us&amp;prodNameId=1809832&amp;prodTypeId=12169&amp;prodSeriesId=1809835&amp;swLang=8&amp;taskId=135&amp;swEnvOID=4004">http://h20000.www2.hp.com/bizsupport/TechSupport/SoftwareIndex.jsp?lang=en&amp;cc=us&amp;prodNameId=1809832&amp;prodTypeId=12169&amp;prodSeriesId=1809835&amp;swLang=8&amp;taskId=135&amp;swEnvOID=4004</a></p>
<p>也可以直接下载</p>
<p><a href="ftp://ftp.hp.com/pub/softlib/software10/COL19426/co-74973-1/hp_qla2x00-2009-03-17.tar.gz">ftp://ftp.hp.com/pub/softlib/software10/COL19426/co-74973-1/hp_qla2x00-2009-03-17.tar.gz</a></p>
<p><a href="ftp://ftp.hp.com/pub/softlib/software11/COL28061/co-69719-3/hp-fc-enablement-2009-12-16.tar.gz">ftp://ftp.hp.com/pub/softlib/software11/COL28061/co-69719-3/hp-fc-enablement-2009-12-16.tar.gz</a></p>
<p>上面两个文件，一个是qla2x00的驱动，后面一个是Linux fibre channel enablement kits for QLogic HBAs and mezzanine cards</p>
<p>下载后解压安装</p>
<p>
<table cellspacing="1" cellpadding="0" width="100%">
    <tbody>
        <tr>
            <td>
            <h3 class="title2" style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; font-size: 10pt"><a name="d0e2456"></a>Installation instructions</h3>
            </td>
        </tr>
        <tr>
            <td bgcolor="#0066ff" height="4">&nbsp;</td>
        </tr>
    </tbody>
</table>
</p>
<div class="procedure" style="margin-left: 0pt">
<ol type="1" style="font-family: Arial; color: #000000; margin-left: 20pt; font-size: 10pt">
    <li>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Download the appropriate driver kit for your distribution. The driver kit file will be in the format <code class="computeroutput" style="font-size: 10pt">hp_qla2x00-yyyy-mm-dd.tar.gz</code>.</p>
    </li>
    <li>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Copy the driver kit to the target system.</p>
    </li>
    <li>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Uncompress and untar the driver kit using the following command:</p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># tar zxvf hp_qla2x00-yyyy-mm-dd.tar.gz</code></p>
    </li>
    <li>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Change directory to the <code class="computeroutput" style="font-size: 10pt">hp_qla2x00-yyyy-mm-dd</code> directory.</p>
    </li>
    <li>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Execute the <code class="command" style="font-size: 10pt">INSTALL</code> command.</p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">The <code class="command" style="font-size: 10pt">INSTALL</code> command syntax will vary depending on your conﬁguration. If a previous driver kit is installed, you can invoke the <code class="command" style="font-size: 10pt">INSTALL</code> command without any arguments as the script will use the currently loaded conﬁguration:</p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># ./INSTALL</code></p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">To force the installation to failover mode, use the <code class="computeroutput" style="font-size: 10pt">-f</code> ﬂag:</p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># ./INSTALL -f</code></p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">To force the installation to single-path mode, use the <code class="computeroutput" style="font-size: 10pt">-s</code> ﬂag:</p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># ./INSTALL -s</code></p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Use the <code class="command" style="font-size: 10pt">-h</code> option of the <code class="command" style="font-size: 10pt">INSTALL</code> script for a list of all supported arguments. The <code class="command" style="font-size: 10pt">INSTALL</code> script will install the appropriate driver RPM for your conﬁguration, as well as the appropriate ﬁbreutils RPM. Once the <code class="command" style="font-size: 10pt">INSTALL</code> script is ﬁnished, you will either have to reload the QLogic driver modules (qla2xxx, qla2300, qla2400, qla2xxx_conf) or reboot your server.</p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">The commands to reload the driver are:</p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># /opt/hp/src/hp_qla2x00src/unload.sh</code></p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># modprobe qla2xxx_conf</code></p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># modprobe qla2xxx</code></p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># modprobe qla2300</code></p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># modprobe qla2400</code></p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">The command to reboot the server is:</p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># reboot</code></p>
    <div class="caution" style="margin-left: 0.5in; margin-right: 0.5in">
    <table border="0" cellspacing="1" summary="Caution" cellpadding="0">
        <tbody>
            <tr>
                <td>&nbsp;</td>
                <td bgcolor="#555555" height="3">&nbsp;</td>
            </tr>
            <tr>
                <td valign="top" rowspan="2" width="25" align="center">&nbsp;</td>
                <th align="left">&nbsp;</th>
            </tr>
            <tr>
                <td valign="top" align="left">
                <p style="font-family: Arial; color: #000000; font-size: 10pt"><span style="font-weight: bold">CAUTION: </span>If your boot device is a SAN attached device you will have to reboot your server.</p>
                </td>
            </tr>
            <tr>
                <td>&nbsp;</td>
                <td bgcolor="#555555" height="1">&nbsp;</td>
            </tr>
            <tr>
                <td height="10" colspan="2">&nbsp;</td>
            </tr>
        </tbody>
    </table>
    </div>
    </li>
</ol>
</div>
<p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">To verify which RPM versions are installed, use the <code class="command" style="font-size: 10pt">rpm</code> command with the <code class="command" style="font-size: 10pt">-q</code> option.</p>
<p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">For example:</p>
<p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># rpm -q hp_qla2x00src</code></p>
<p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># rpm &ndash;q fibreutils</code></p>
<p>然后在继续安装HP Fibre Channel Enablement Kit</p>
<p>
<table cellspacing="1" cellpadding="0" width="100%">
    <tbody>
        <tr>
            <td>
            <h3 class="title2" style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; font-size: 10pt"><a name="d0e2332"></a>Installing the HP Fibre Channel Enablement Kit</h3>
            </td>
        </tr>
        <tr>
            <td bgcolor="#0066ff" height="4">&nbsp;</td>
        </tr>
    </tbody>
</table>
</p>
<p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">To install the HP Fibre Channel Enablement Kit, do the following:</p>
<div class="orderedlist">
<ol type="1" style="font-family: Arial; color: #000000; margin-left: 20pt; font-size: 10pt">
    <li>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Download the <code class="computeroutput" style="font-size: 10pt">hp-fc-enablement-yyyy-mm-dd.tar.gz</code> file for your operating system and copy it to the target server</p>
    </li>
    <li>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Untar the enablement kit by executing the command to create the directory, <code class="command" style="font-size: 10pt">hp-fc-enablement-yyyy-mm-dd</code>.</p>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># tar zxvf hp-fc-enablement-yyyy-mm-dd.tar.gz</code></p>
    </li>
    <li>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Browse to the directory <code class="command" style="font-size: 10pt">hp-fc-enablement-yyyy-mm-dd</code>.</p>
    </li>
    <li>
    <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">Do one of the following to execute the <code class="command" style="font-size: 10pt">install.sh</code> script.</p>
    <div class="orderedlist">
    <ol type="a" style="font-family: Arial; color: #000000; margin-left: 20pt; font-size: 10pt">
        <li>
        <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">If you are not using Device Mapper multipathing execute the following command:</p>
        <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># ./install.sh -s </code></p>
        </li>
        <li>
        <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">If you are using Device Mapper multipathing execute the following command:</p>
        <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># ./install.sh -m</code></p>
        <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt">The <code class="computeroutput" style="font-size: 10pt">hp-fc-enablement</code> and <code class="computeroutput" style="font-size: 10pt">fibreutils</code> RPMs should be installed once this install completes. To verify the installation, enter the following commands:</p>
        <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># rpm -q hp-fc-enablement </code></p>
        <p style="margin-top: 4pt; font-family: Arial; margin-bottom: 0pt; color: #000000; font-size: 10pt"><code class="command" style="font-size: 10pt"># rpm -q fibreutils </code></p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in">
        <table border="0" cellspacing="1" summary="Note" cellpadding="0">
            <tbody>
                <tr>
                    <td>&nbsp;</td>
                    <td bgcolor="#555555" height="3">&nbsp;</td>
                </tr>
                <tr>
                    <td valign="top" rowspan="2" width="25" align="center">&nbsp;</td>
                    <th align="left">&nbsp;</th>
                </tr>
                <tr>
                    <td valign="top" align="left">
                    <p style="font-family: Arial; color: #000000; font-size: 10pt"><span style="font-weight: bold">NOTE: </span>For use with the driver that comes with the kernel you will need fibreutils 3.x or greater.</p>
                    </td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                    <td bgcolor="#555555" height="1">&nbsp;</td>
                </tr>
                <tr>
                    <td height="10" colspan="2">&nbsp;</td>
                </tr>
            </tbody>
        </table>
        </div>
        </li>
    </ol>
    </div>
    </li>
</ol>
</div>
<p>全部完成后，我们需要查看下/etc/modprobe.conf</p>
<p>如果有下面图中标记的一些信息加入，说明上面的驱动安装正确。</p>
<p><img width="800" height="250" alt="" src="http://xinlogs.com/attachment/1268380135_3698de3f.png" /></p>
<p>确实正确后，我们重启下服务器。</p>
<p>当再次进入系统后，我们的存储应该被识别为/dev/sda设备</p>
<p>用fdisk -l /dev/sda查看下，如果没有问题了，就可以使用fdisk /dev/sda进行分区</p>
<p>我是把全部1.6T分成一个区/dev/sda1</p>
<p>然后e2lable /dev/sda1 /data给卷标</p>
<p>在/etc/fstab文件里加入/dev/sda1的挂着位置</p>
<p>这样以后每次启动系统，就自动将存储挂着到系统的/data目录中了。如下图</p>
<p><img width="500" height="300" alt="" src="http://xinlogs.com/attachment/1268380341_32244d04.png" /></p>
<p><strong>总结</strong></p>
<p>本来参考<a href="http://www.s135.com">www.s135.com</a>博主的文章配置的，后来发现因为用了光纤卡，不安装驱动会有问题。还有就是双控制器的active/active和active/standby模式需要通过刷新不同的fireware实现。总得来说这个存储配置起来不难，安装官方文档和网络上一些文档就可以。写这篇文档就是为了记录下自己的配置过程，省的以后再配置还要到处找文档查资料。</p>]]></description>
	<pubDate>Fri, 12 Mar 2010 07:56:08 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/HP-MSA1000-DL380G5-Centos5</guid>

</item>
<item>
	<title>HP台式机器，ghost系统后，提示windows could not start </title>
	<link>http://xinlogs.com/HP-Computer-Ghost-Problem</link>
	<description><![CDATA[<p>今天单位一台HP dx7518的台式机器，ghost了一个winxp系统。但是只要一开机，就提示</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_5913');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_5913">
<ol class="dp-xml" style="border-right: 0px; border-top: 0px; margin-left: 5px; border-left: 0px; border-bottom: 0px; list-style-type: none">
    <li class="alt"><span><span>windows&nbsp;could&nbsp;not&nbsp;start&nbsp;because&nbsp;of&nbsp;a&nbsp;computer&nbsp;disk&nbsp;hardware&nbsp;configuration&nbsp;problem&nbsp; &nbsp;&nbsp;</span></span></li>
    <li><span>could&nbsp;not&nbsp;read&nbsp;from&nbsp;the&nbsp;selected&nbsp;boot&nbsp;disk&nbsp;check&nbsp;boot&nbsp;path&nbsp;and&nbsp;disk&nbsp;harware &nbsp;&nbsp;</span></li>
    <li class="alt"><span>please&nbsp;check&nbsp;the&nbsp;windows&nbsp;documentation&nbsp;about&nbsp;hardware&nbsp;disk&nbsp;configuation&nbsp;and&nbsp;your&nbsp;hardware&nbsp;refer&nbsp;once&nbsp;manuals&nbsp;for&nbsp;additional&nbsp;information&nbsp;&nbsp;&nbsp;</span></li>
</ol>
</div>
<link href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" type="text/css" rel="stylesheet" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>开始我以为是硬盘的设置问题，后来发现硬盘已经设置为IDE模式了。</p>
<p>后来网上查找，发现是和BIOS里的WDRT Support选项有关系。。。</p>
<p><strong>解决办法</strong></p>
<p>开机进入bios设置，选择Power management Setup 再选择WDRT Support 将后面值修改为disable</p>
<p><strong><font color="#0000ff">WDRT SUPPORT</font></strong>：watchdog resource table 一种加密狗。通过这种加密保护来拒绝安装非随机配备的操作系统。同样，全系的HP 家用、商用台式机、笔记本，进行GHOST安装后报错，也可以用此方法解决。<br />
&nbsp;&nbsp;</p>]]></description>
	<pubDate>Thu, 11 Mar 2010 16:23:52 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/HP-Computer-Ghost-Problem</guid>

</item>
<item>
	<title>win7下使用联通无线上网卡HUAWEI E1750</title>
	<link>http://xinlogs.com/HUAWEI-E1750-on-Win7</link>
	<description><![CDATA[<p>老婆单位年底搞活动，抽奖中了一个联通的无线上网卡。型号HUAWEI E1750</p>
<p>本来打算给我笔记本用的，我系统是Windows 7。结果发现用不了，安装上以后，无线上网软件提示找不到设备。。。。。。</p>
<p><strong>解决办法</strong></p>
<p>让Windows 7自动找驱动，肯定是没戏了。用光盘自带软件的驱动也不灵。后来到HUAWEI网站查找最近驱动，最终下面网站找到了相关更新</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_5676');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_5676">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>http://www.huaweidevice.com/cn/downloadCenter.do?</span><span class="attribute">method</span><span>=</span><span class="attribute-value">doListSoftware</span><span class="attribute">id</span><span>=</span><span class="attribute-value">1</span><span>&amp;fla&nbsp;</span><span class="attribute">y</span><span>=</span><span class="attribute-value">find</span><span class="attribute">softwareName</span><span>=</span><span class="attribute-value">E1750</span><span>&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"> <script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_8177');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_8177">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
    <li class="alt"><span><span>E1750&nbsp;E1750-WINMACB300D00SP04C112(&nbsp;U&nbsp;TPS11[1].301.08.24.112_MAC11.3&nbsp;01.06.07.112)(China&nbsp;Unicom)&nbsp;China&nbsp;Unicom&nbsp;&nbsp;2009-12-23&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css"> <script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>以上是Win7下可以使用的驱动更新。大约28M</p>
<p>安装步骤是先安装Mobile_Card_Driver_3.09.exe驱动，然后正确识别设备后，运行UTPS11.301.08.24.112_MAC11.301.06.07.112.B433.exe更新设备的固件。最后再安装无线上网软件。</p>
<p>可是我安装文档的方法，在Win7下并没有成功，运行UTPS11.301.08.24.112_MAC11.301.06.07.112.B433.exe更新的时候，总是提示没有找到设备或者正在有软件占用设备或者没有管理员权限。。。。。</p>
<p>后来找了一台WinXP系统的机器，按照文档步骤一次成功。</p>
<p>然后再将更新过的E1750插到Win7上面，就可以自动识别设备了。识别成功后如下图。</p>
<p><img alt="" src="/attachment/1265905339_62689fc7.png" /></p>
<p>这样继续安装无线上网软件就可以正确识别并上网了。下面是正确识别后的截图</p>
<p><img alt="" src="/attachment/1265905507_6608eff9.png" /></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/macbook-air-use-e1750-3g-mobilecard">2012 macbook Air 使用华为E1750 3g上网卡</a></p></div>]]></description>
	<pubDate>Thu, 11 Feb 2010 16:26:03 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/HUAWEI-E1750-on-Win7</guid>

</item>
<item>
	<title>我的新手机HTC hero g3</title>
	<link>http://xinlogs.com/my-htc-hero-mobile</link>
	<description><![CDATA[<p>关注HTC hero G3很久了，大约从10月份开始吧。当时就和老婆说生日打算换个手机，后来生日当天去中关村看了看，但是没有购买，报价3000。关键是不知道怎么选购。回来后网上做功课，查询论坛和淘宝。最后决定在淘宝的一家北京实体店购买。在木樨园桥附近。2010年1月25日周一购买的。</p>
<p>购买的最终手机价格是2860元，又选购了8G TF卡，一块MOMAX电池+座充+车充+手机套。3370元。</p>
<p>购买后，由卖家给刷安逸1.2的ROM并给8G卡预装一些软件。</p>
<p>整体感觉比我原来用的windows手机eten x800速度快了不少。android系统也很漂亮。</p>
<p>我的联系人是先用Win7的windows mobile设备管理将原来windows手机的联系人导出到outlook，最后导出到excel并生成cvs文件。</p>
<p>然后导入到Gmail邮件的通讯录。这样通过hero G3的同步gmail联系人，就可以导入到新手机了。</p>
<p>感觉和gmail配合的相当好。短信也可以备份到gmail保存。</p>
<p><strong>刷机</strong></p>
<p>手机买来就开始装软件，尝试导航，使用感觉不错。不过在论坛学习，发现很多系统都比我这个新，就产生了刷机的想法。</p>
<p>开始先尝试刷radio。radio是负责手机通讯的模块，可以理解为电话用的驱动吧。</p>
<p>我原来的版本比较低，自己先尝试刷了63.18.55.06JU_6.35.09.26最新版本。</p>
<p><strong>刷radio办法</strong></p>
<p>机器买来的时候，又商家默认刷了啊兴的2.5 recovery。我就用了一个1G的卡，格式化为FAT32文件系统。将下载的radio更新文件拷贝到卡的根目录，并改名为update.zip</p>
<p>关闭手机，同时按Home+Power键进入recovery界面(就是小房子+开机键)。</p>
<p>等出现recovery界面，选择第2项，将sd卡上的update.zip刷入手机。</p>
<p>注意刷完后，一定要重启一次手机。</p>
<p>刷这个很简单，一会就完成了。感觉不错。呵呵</p>
<p>关于Rom的选择，我再论坛上找了很久，也发帖求助了很多高手。大家普遍认为安卓1.2就是稳定，但是速度很慢。</p>
<p>大家推荐我的主要是Flzyup的Rom和modaco的Rom</p>
<p>我怕Modaco的Rom中文支持不友好，就决定从Flzyup制作的Rom选择了。目前来说G3的Rom有基于android 1.5的，也有基于2.0</p>
<p>但是普遍认为2.0 Rom目前不成熟，毕竟官方没有出来呢。所以我就只选择基于android 1.5的Rom了。</p>
<p>F大（flzyup的亲切称呼）的Rom基于1.5系统的主要如下</p>
<h2><a title="FLZYUP Custom ROM v1.5 final(惊喜一)" href="http://www.innovative-space.com/2010/01/14/flzyup-custom-rom-v1-5-final/" rel="bookmark">FLZYUP Custom ROM v1.5 final(惊喜一)</a></h2>
<h2><a title="FLZYUP Custom ROM v1.4 (Paid APPs+New ICONs)" href="http://www.innovative-space.com/2010/01/10/flzyup-custom-rom-v1-4-paid-apps-new-icons/" rel="bookmark">FLZYUP Custom ROM v1.4 (Paid APPs+New ICONs)</a></h2>
<h2><a title="FLZYUP_Custom_ROM_v1.3_final大内存版本" href="http://www.innovative-space.com/2009/12/23/flzyup_custom_rom_v1-3_final-large-me/" rel="bookmark">FLZYUP_Custom_ROM_v1.3_final大内存版本</a></h2>
<h2><a title="FLZYUP Custom ROM v1.3 final all fixed [特效包已发布]" href="http://www.innovative-space.com/2009/12/07/flzyup-custom-rom-v1-3-release/" rel="bookmark">FLZYUP Custom ROM v1.3 final all fixed [特效包已发布]</a></h2>
<p>1.4版本是基于1.3的基础上优化完善的，1.5是基于全新内核制作的。</p>
<p>因为我看论坛上很多人反映F大1.5版本耗电，本来G3也就坚持2天，如果刚买手机经常玩，1天就够呛了。。。所以没敢使用这个费电的新版本。我保守的选择了1.4版本。</p>
<p><strong>准备刷机</strong></p>
<p>论坛坚持了2天，大家一直讨论刷那个版本好，可以参考<a href="http://www.androidin.net/bbs/thread-51055-1-1.html">http://www.androidin.net/bbs/thread-51055-1-1.html</a></p>
<p>最终决定刷F大的1.4版本。看到F大1.4是自动支持app2sd技术的，但是前提是你的卡必须有ext分区。我的8G卡目前就1个Fat32分区，于是考虑先分区。</p>
<p>但是Win7没有找到合适的分区软件，后来发现xda论坛发布的<strong>RA-hero-v1.5.2</strong> recovery可以支持在手机的recovery模式给卡分区。我就先刷了这个recovery</p>
<p><strong>刷recovery</strong></p>
<p><strong>主要参考<a href="http://forum.xda-developers.com/showthread.php?t=561124">http://forum.xda-developers.com/showthread.php?t=561124</a></strong></p>
<p>There are several ways to install a custom recovery, choose the one that suits you most (I probably forgot a few).<br />
<br />
<i>via adb</i> <font color="#ff0000"><b>-&gt; Requires a custom recovery (with test-keys) like Cyanogen's v1.4 or my previous recovery</b></font><br />
&nbsp;</p>
<div style="margin: 5px 20px 20px">
<div class="smallfont" style="margin-bottom: 2px">Code:</div>
<pre class="alt2" dir="ltr" style="border-right: 1px inset; padding-right: 6px; border-top: 1px inset; padding-left: 6px; padding-bottom: 6px; margin: 0px; overflow: auto; border-left: 1px inset; width: 640px; padding-top: 6px; border-bottom: 1px inset; height: 130px; text-align: left">
Copy recovery-RA-hero-v1.5.2.img to the root of your sdcard
Boot into your current custom recovery (boot while holding HOME)
Connect your Hero via usb to your pc/mac/...
adb shell
$su (not required if you have root already)
#mount -a
#flash_image recovery /sdcard/recovery-RA-hero-v1.5.2.img</pre>
</div>
<p>我采用的上面这个方法安装的。</p>
<p>不过首先要在机器上安装adb工具和手机驱动</p>
<p>驱动采用网上下载的AndroidDriverFiles驱动程序.rar</p>
<p>adb本来是包含在android sdk工具里面的，但是sdk太大了，好几百兆。。。。我就在网上找了一个adb_win.zip的分离包。572k，就2个文件。</p>
<p>先将adb_win.zip解压缩，得到adb.exe和AdbWinApi.dll文件。将2个文件复制到Windows目录下的System32目录。</p>
<p>这样在windows的命令行窗口输入adb命令，可以看到如下输出</p>
<p>Android Debug Bridge version 1.0.20下面还有很多使用说明，就不用管了。</p>
<p>现在准备好adb了，再把AndroidDriverFiles驱动程序.rar解压到一个目录，准备连接手机的时候使用。</p>
<p>以上都准备好后，关闭手机，按Home+Power键进入recovery模式，将USB线连上电脑。如果提示安装驱动，就手动到AndroidDriverFiles驱动程序解压后的目录找。</p>
<p>驱动识别完成后，就打开windows的命令行窗口（Win+R，输入cmd回车）</p>
<p>输入adb shell</p>
<p>然后su回车</p>
<p>mount -a回车</p>
<p>上面的su和mount -a 都可能返回错误，不用管它。</p>
<p>最后输入flash_image recovery /sdcard/recovery-RA-hero-v1.5.2.img 回车。</p>
<p>这样就把新的recovery刷入了。</p>
<p>重启进入recovery模式，如图</p>
<p><img alt="" src="http://xinlogs.com/attachment/1265094219_72970950.png" /></p>
<p>然后在Wipe里面执行如下3项</p>
<p>Wipe</p>
<ul>
    <li>Wipe data/factory reset :: Wipe /data and /cache</li>
    <li>Wipe Dalvik-cache :: Wipe Dalvik-cache both on /data and ext</li>
    <li>Wipe SD:ext partition : Wipe the ext partition on your sdcard</li>
</ul>
<p>再给sd卡分区。</p>
<p>Partition sdcard</p>
<ul>
    <li>Partition SD :: Interactive SD partitioning</li>
</ul>
<p>这样就给sd卡分好去了，我的8G卡，默认是32M的swap分区 512M的ext分区。最后是一个大的Fat32分区。</p>
<p>这样就可以关机了。</p>
<p><strong>刷FLZYUP_Custom_ROM_v1.4-signed.zip系统</strong></p>
<p>上面的准备工作全完成了，再来刷系统。</p>
<p>将分好区的sd卡，放到电脑读卡器上，从电脑将FLZYUP_Custom_ROM_v1.4-signed.zip拷贝到根目录。因为win7只能识别出FAT32分区，所以肯定是拷贝到FAT32分区上。</p>
<p>然后返回手机开机进入recovery模式，选择</p>
<ul>
    <li>Flash zip from sdcard :: Flash a zip update file from your sdcard</li>
</ul>
<p>按照提示往下刷就可以了。刷好后提示如下</p>
<p><img alt="" src="http://xinlogs.com/attachment/1265094552_16734a47.png" /></p>
<p>然后重启手机就可以了。</p>
<p><strong>注意</strong></p>
<p>刷完后，第一次重启很慢很慢，这个正常。我当时以为手机刷坏了，总停在HTC那屏上。。。还到论坛发帖求助呢。。</p>
<p>后来发现第一次重启后，看到绿色小人和听到声音大约1分20秒，然后就是那个HTC三个字母的屏幕，大约等了10分钟。。。就会进入下面屏幕</p>
<p><img alt="" src="http://xinlogs.com/attachment/1265094691_2564fb5c.png" /></p>
<p>按照提示设置好手机，就可以享受新系统了。</p>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/HTC-Hero-Openvpn">HTC hero g3 openvpn设置</a></p></div>]]></description>
	<pubDate>Tue, 02 Feb 2010 07:12:21 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/my-htc-hero-mobile</guid>

</item>
<item>
	<title>诺基亚E63刷机</title>
	<link>http://xinlogs.com/E63-nokia-fireware-update</link>
	<description><![CDATA[<p>前几天老婆的E63手机总是死机，一直在跟我抱怨。。。本来想给她买个iphone，结果老婆说不喜欢，还是喜欢她红色的E63.</p>
<p>我想想手机买了1年多了，也没有更新过，不如刷个新系统看看吧。于是就开始搜索资料、准备软件。</p>
<p>具体刷机步骤参考<a href="http://nokia.zol.com.cn/188/297_1876549.html">http://nokia.zol.com.cn/188/297_1876549.html</a></p>
<p><strong>诺基亚刷机方法</strong></p>
<p>主要是官方刷新，还是用第三方软件刷新</p>
<p>官方的在线刷新就是用官方公布的软件直接更新手机的系统。但是官方更新只限于行货手机，因为官方是根据你手机的CODE号码来为你更新手机系统的，如果你手机的CODE是外国的，那刷新后，就没有中文系统了。所以这个不适合大多数水货手机</p>
<p><span style="font-size: larger">我查看了一下，老婆手机的CODE是0569944: 马来西亚的。用官方的估计不行，于是就开始考虑第三方软件。</span></p>
<p><span style="font-size: larger">发现比较著名的就是凤凰刷机工具了。</span></p>
<p><span style="font-size: larger">其实简单的说&ldquo;凤凰刷机&rdquo;就是刷机软件的一种，而非官方的刷机软件而已，由于其在性能上有官方刷机软件很多不能完成的任务，因而收到的机友的广泛追捧。</span></p>
<p><span style="font-size: larger"><strong>准备工作</strong></span></p>
<p><span style="font-size: larger">首先是下载凤凰刷机软件</span></p>
<p><span style="font-size: larger">参考这里<a href="http://nokia.zol.com.cn/1/18_299.html">http://nokia.zol.com.cn/1/18_299.html</a></span></p>
<p><span style="font-size: larger">我下载的就是<a target="_blank" href="http://nokia.zol.com.cn/1/18_299.html"><font color="#ff00ff" size="4"><font color="#0000ff">凤凰刷机2009.34.7.40015最新XX版09.10.30发</font><font color="#0000ff">布</font></font></a></span></p>
<p><span style="font-size: larger">下载好凤凰刷机软件后，就是备份手机存储卡上的内容和联系人了。我是直接用读卡器把存储卡拷贝到电脑，然后用诺基亚PC套件导出的联系人。</span></p>
<p><span style="font-size: larger">这些都弄好了，就可以进入刷机步骤了。</span></p>
<p><strong><span style="font-size: larger">刷机步骤</span></strong></p>
<p><span style="font-size: larger">安装好凤凰刷机软件，并打开</span></p>
<p><span style="font-size: larger">选择Tools-&gt;Image file download</span></p>
<p><span style="font-size: larger"><img alt="" src="http://xinlogs.com/attachment/1264663937_51217132.jpg" /></span></p>
<p><span style="font-size: larger">然后在Product code内输入你想刷的系统的code码，我这里输入的0569941，新加坡的版本</span></p>
<p><span style="font-size: larger">输入完成后，点download等待下载，大小在60-80M。</span></p>
<p><span style="font-size: larger">下载完成后，点cancel就可以了。</span></p>
<p><span style="font-size: larger">系统下载好了，我们就该向手机内刷了。用USB的数据线连接手机。在手机上选择PC套件模式。</span></p>
<p>&nbsp;</p>
<p><span style="color: #000000">然后选择凤凰2009的菜单file---manage connection，跳出菜单NO CONECTION，再点&ldquo;NEW&rdquo;按键。</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img alt="" src="http://xinlogs.com/attachment/1264664253_65333f35.jpg" /></p>
<p><span style="font-size: larger"><span style="color: #000000">按NEW键之后会出现下图：</span></span></p>
<p><font color="#ff0000" size="4"><img alt="" src="http://xinlogs.com/attachment/1264664287_3506a5b8.jpg" /></font></p>
<p><span style="color: #000000"><span style="font-size: larger">选择USB后，按下一步，直到完成。这样连接里会才会出现USB和NO CONNECTIONS两个选择，一个是USB连接，一个是没有连接，如果是USB连接，表示手机正常。选择USB，点击&ldquo;APPLY&rdquo;按钮,然后点击Cancel，连接完成</span></span></p>
<p><span style="color: #000000"><span style="font-size: larger"><img alt="" src="http://xinlogs.com/attachment/1264664448_3028ece2.jpg" /></span></span></p>
<p><span style="color: #000000"><span style="font-size: larger"><img alt="" src="http://xinlogs.com/attachment/1264664448_6929f4a7.jpg" /></span></span></p>
<p><span style="font-size: larger"><span style="color: #000000">菜单File ,open Product，系统会自动调出诺基亚各个型号的RM菜单，你选择自己的机型即可，比如诺基亚E63为RM-437，找到后点OK。</span></span></p>
<p><span style="font-size: larger"><span style="color: #000000"><img alt="" src="http://xinlogs.com/attachment/1264664526_7710f9ab.jpg" /></span></span></p>
<p><span style="font-size: larger"><span style="color: #000000"><img alt="" src="http://xinlogs.com/attachment/1264664526_22505832.jpg" /></span></span></p>
<p><span style="font-size: larger"><span style="color: #000000">选择RM-437的画面，在出现的提示框里找RM-437，选中，然后点OK，选择normal.</span></span></p>
<p><span style="font-size: larger"><span style="color: #000000">凤凰2009软件菜单Flashing-----Fireware Update,出现下面画面</span></span></p>
<p><span style="font-size: larger"><span style="color: #000000"><img alt="" src="http://xinlogs.com/attachment/1264664646_26236df9.jpg" /></span></span></p>
<p><span style="font-size: larger"><span style="color: #000000"><font color="#ff0000" size="4">这里有一个非常关键的地方需要注意,就是上图选择RM-437之后,要注意看Product CODE:显示的CODE是多少,如果是欧版的CODE(比如0582481),那就需要你选择以下亚太的CODE的系统,选择你刚才下载的比如<font color="#000000" size="2">0569941</font>的系统. 点击下图右边的小方块(小方块上有省略号的那个)</font><br />
</span></span></p>
<p><font size="4"><font color="#0000ff">想刷400.21.013的朋友，如果下载了400的固件，但是在这里没有找到400的话，可以来这里看下</font></font></p>
<p><font color="#ff0000">凤凰菜单栏进入：<font color="#ff0000">TOOLS-Options-product locetion</font>（下图）</font></p>
<p><font color="#ff0000"><img alt="" src="http://xinlogs.com/attachment/1264664826_9821f55e.jpg" /></font></p>
<p><font color="#ff0000">红色线标注的栏目原来是空白的，这里需要设置下路径，点右边的&ldquo;add&rdquo;添加路径如图所示，然后点&ldquo;apply&rdquo;确认后退出。<br />
</font>哈哈，看下图出现了400.21.013了</p>
<p><img alt="" src="http://xinlogs.com/attachment/1264664973_70886098.jpg" /></p>
<p>点击&quot;Refurbish&quot;开始刷机，在进入这个程序之后，无论计算机屏幕右下角出现什么提示，均不要搭理它，直到提示成功。</p>
<p>&nbsp;</p>
<p><img alt="" src="http://xinlogs.com/attachment/1264665091_98715898.jpg" /></p>
<p>到这里就算完成了。哈哈</p>
<p>以上内容基本都是从下面两篇帖子上转过来的。如果有什么不明白，可以直接去看原帖。我只是记录下，省的以后刷机还要找资料。</p>
<h2 style="font-size: 20px">[原创][教程]诺基亚E63用凤凰2009成功刷机</h2>
<h2 style="font-size: 20px">0300 凤凰2009成功刷 E63最新固件 400.21.013</h2>
<p>&nbsp;</p>]]></description>
	<pubDate>Thu, 28 Jan 2010 07:53:20 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/E63-nokia-fireware-update</guid>

</item>
<item>
	<title>postfix+extmail的附件大小显示和限制问题解决办法</title>
	<link>http://xinlogs.com/postfix-extmail-attachment-bug</link>
	<description><![CDATA[<p>最近在给一个公司部署了postfix+<span class="t_tag" onclick="tagshow(event)" href="tag.php?name=extmail">extmail</span>的<span class="t_tag" onclick="tagshow(event)" href="tag.php?name=%E9%82%AE%E4%BB%B6">邮件</span><span class="t_tag" onclick="tagshow(event)" href="tag.php?name=%E7%B3%BB%E7%BB%9F">系统</span>后，遇到了附件大小限制问题。<br />
<br />
ext<span class="t_tag" onclick="tagshow(event)" href="tag.php?name=mail">mail</span>默认设置是5M，但是由于extmail的统计大小方法问题，一般附件限制比设置的小了1/3。也就是你设置了5M，也就能到3M多。<br />
<br />
这里先说下大小限制的配置。<br />
<br />
一、修改extmail的<span class="t_tag" onclick="tagshow(event)" href="tag.php?name=web">web</span>mail.cf文件<br />
<br />
SYS_MESSAGE_SIZE_LIMIT = 5242880 注意：以位为单位为5M字节。 <br />
<br />
SYS_MESSAGE_SIZE_LIMIT = xxx<br />
<br />
二、修改/etc/postfix/main.cf文件，<br />
<br />
message_size_limit = xxx<br />
<br />
<br />
三、重启postfix即可，service postfix restrart 和重启apache，service httpd restart<br />
<br />
<br />
<strong>如何解决附件限制大小和系统文件大小相差1/3呢？</strong></p>
<p>首先是修改/var/www/extsuite/extmail/libs/Ext/App目录下的Compose.pm文件<br />
&nbsp;</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_4811');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_4811">
<ol class="dp-xml">
    <li class="alt"><span><span>sub&nbsp;is_oversize&nbsp;{ &nbsp;&nbsp;</span></span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$</span><span class="attribute">self</span><span>&nbsp;=&nbsp;</span><span class="attribute-value">shift</span><span>; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$</span><span class="attribute">sys</span><span>&nbsp;=&nbsp;$self-</span><span class="tag">&gt;</span><span>{sysconfig}; &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$</span><span class="attribute">maxsize</span><span>&nbsp;=&nbsp;$sys-</span><span class="tag">&gt;</span><span>{SYS_MESSAGE_SIZE_LIMIT}; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$</span><span class="attribute">tsize</span><span>&nbsp;=&nbsp;</span><span class="attribute-value">shift</span><span>; &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0&nbsp;unless&nbsp;defined&nbsp;$maxsize&nbsp;and&nbsp;$maxsize&nbsp;</span><span class="tag">&gt;</span><span>&nbsp;0; &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0&nbsp;unless&nbsp;defined&nbsp;$tsize&nbsp;and&nbsp;$tsize&nbsp;</span><span class="tag">&gt;</span><span>&nbsp;0; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($tsize&nbsp;</span><span class="tag">&gt;</span><span>=&nbsp;$maxsize)&nbsp;{ &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$maxsize; &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;0; &nbsp;&nbsp;</span></li>
    <li><span>} &nbsp;&nbsp;</span></li>
</ol>
</div>
<link href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" type="text/css" rel="stylesheet" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p><br />
注意到上面的if ($tsize &gt;= $maxsize)了吧，修改为if ($tsize &gt;= 1.29*$maxsize)<br />
<br />
这样修改后，基本extmail的附件限制大小就和系统显示的文件大小一样。<br />
<br />
目前还有一个文件，就是我们上传一个1M的内容，显示出来的附件大小大约是1.3M，这个问题需要修改一个human函数解决。<br />
<br />
在/var/www/extsuite/extmail/libs/Ext目录下，打开Utils.pm文件<br />
<br />
找到如下函数<br />
<br />
&nbsp;</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_6657');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_6657">
<ol class="dp-xml">
    <li class="alt"><span><span>sub&nbsp;human_size&nbsp;{ &nbsp;&nbsp;</span></span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$</span><span class="attribute">s</span><span>&nbsp;=&nbsp;$_[0]; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;if($s</span><span class="tag">&lt;</span><span class="tag-name">1024</span><span>)&nbsp;{ &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sprintf(&quot;%0.2f&quot;,&nbsp;$s/1024).&quot;K&quot;; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}elsif($s</span><span class="tag">&lt;</span><span class="tag-name">1024</span><span>*1024)&nbsp;{ &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sprintf(&quot;%0.1f&quot;,&nbsp;$s/1024).&quot;K&quot;; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{ &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sprintf(&quot;%0.1f&quot;,&nbsp;$s/(1024*1024)).&quot;M&quot;; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</span></li>
    <li><span>} &nbsp;&nbsp;</span></li>
</ol>
</div>
<link href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" type="text/css" rel="stylesheet" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>将函数修改如下<br />
&nbsp;</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_7785');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_7785">
<ol class="dp-xml">
    <li class="alt"><span><span>sub&nbsp;human_size&nbsp;{ &nbsp;&nbsp;</span></span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$</span><span class="attribute">s</span><span>&nbsp;=&nbsp;$_[0]; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;if($s</span><span class="tag">&lt;</span><span class="tag-name">1024</span><span>)&nbsp;{ &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sprintf(&quot;%0.2f&quot;,&nbsp;$s/1024/1.36).&quot;K&quot;; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}elsif($s</span><span class="tag">&lt;</span><span class="tag-name">1024</span><span>*1024)&nbsp;{ &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sprintf(&quot;%0.1f&quot;,&nbsp;$s/1024/1.36).&quot;K&quot;; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{ &nbsp;&nbsp;</span></li>
    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sprintf(&quot;%0.1f&quot;,&nbsp;$s/(1024*1024*1.36)).&quot;M&quot;; &nbsp;&nbsp;</span></li>
    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</span></li>
    <li><span>} &nbsp;&nbsp;</span></li>
</ol>
</div>
<link href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" type="text/css" rel="stylesheet" />
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
<p>这样就解决了extmail的附件大小显示和限制问题。<br />
<br />
目前还有一个遗留问题，就是在folder.htm模板界面里显示的邮件大小还是比系统文件大1/3。这个不知道怎么修改了。找到了对应函数，但是它直接显示的多少M或者多少K，用除1.36会出现问题。。。。这个期待<span class="t_tag" onclick="tagshow(event)" href="tag.php?name=%E9%AB%98%E6%89%8B">高手</span>解决了。</p>]]></description>
	<pubDate>Sun, 24 Jan 2010 14:03:27 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/postfix-extmail-attachment-bug</guid>

</item>
<item>
	<title>extman后台登陆问题解决方法</title>
	<link>http://xinlogs.com/extman</link>
	<description><![CDATA[<p>前一阵子给一个公司架设了postfix+mysql+extmail的邮件系统。</p>
<p>用了一段时间后，发现后台管理的extman不能登录了，提示如下</p>
<p>Can't open /tmp/<span class="t_tag" onclick="tagshow(event)" href="tag.php?name=extman">extman</span>//sid_26da75f9aec35f2cbc6b4fa425ab525e, No such file or directory<br />
&nbsp;</p>
<p>后来发现是/tmp目录下的extman目录被系统清除了。。</p>
<p>然后再网络上找了一些解决办法，说是Linux系统在启动的时候，会清理/tmp目录。建议将这个目录设置在/var/tmp目录下。</p>
<p>结果用了一段时间后，发现一样是被清理。。。。</p>
<p>我的系统是CentOS 5.3 64bit</p>
<p>最后我通过修改，/var/www/extsuite/extman/webmail.cf文件里面的配置</p>
<blockquote># sys_sess_dir, the session dir<br />
SYS_SESS_DIR = /tmp/extman/</blockquote>
<p>将SYS_SESS_DIR指定到了/data/extman下面了。估计这次系统不会清除这个目录了吧</p>
<p>还有一种常见错误就是提示</p>
<p>Can't open /tmp/extman//sid_89b33ec5ce0b5903f24035aa4ad76d15, Permission denied</p>
<p>这个是因为extman 那个临时目录的权限不对。</p>
<p>可以设置为777就ok了</p>]]></description>
	<pubDate>Tue, 19 Jan 2010 02:16:38 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/extman</guid>

</item>
<item>
	<title>谷歌要退出中国了。。。</title>
	<link>http://xinlogs.com/Google-May-Totally-Withdraw-From-China</link>
	<description><![CDATA[<p>昨天看到了谷歌要退出中国的消息了，感到很惋惜。。。又一个全球认为好的东西被中国挡在了门外。</p>
<p>不知道最近中国怎么了，怎么什么全球流行的东西，中国都排斥呢</p>
<p>youtube全球最流行的视频网站。。。中国屏蔽了</p>
<p>world of warcraft 全球流行的网络游戏。。。中国审批问题严重</p>
<p>google 那么好的的搜索引擎。。。。现在被迫要退出中国</p>
<p>我一直在使用gmail、webmasters等工具，看来这些以后要想使用。。。都需要付出更多了。看来现在这个vps需要加些内存来给更多朋友提供vpn了。</p>
<p>真的不希望google退出中国，这样下去中国会逐渐和全球格格不入的。</p>
<p>&nbsp;</p>]]></description>
	<pubDate>Thu, 14 Jan 2010 02:10:49 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Google-May-Totally-Withdraw-From-China</guid>

</item>
<item>
	<title>沙丁鱼挂机赚钱</title>
	<link>http://xinlogs.com/post/76</link>
	<description><![CDATA[<p>最近没事就在挂一个沙丁鱼的软件，下面看看介绍</p>
<p><strong>介绍</strong></p>
<p>沙丁鱼是一款免费提高网站访问量，增加IP、PV、Alexa排名的软件，适用于所有网站站长、企业和普通网友。本系统可以快速、高度仿真地提高网站人气，增加网页外部链接的点击量，提高弹窗弹出数，使用全免费、操作全自动，只要能上网就可以受益您的网站。</p>
<p>软件很简单，只要申请用户后，开机挂着就ok了。</p>
<p>下面是我的一张1月份的收款图。</p>
<p><img alt="" src="http://xinlogs.com/attachment/1263429216_92845fd5.png" /></p>
<p>沙丁鱼网址：<a href="http://www.virtualvisit.cn/index.php?inductid=d8bdc54259de42323fd1e05881e77c96">www.virtualvisit.cn</a></p>
<p>这个软件赚钱不多，不过信誉可靠。属于没事闲着就挂着，1个月有个4-5块的。。。</p>
<p>有兴趣也可以常来访问我的网站</p>
<p><a href="http://a2f805f4.qvvo.com/">http://a2f805f4.qvvo.com/</a></p>]]></description>
	<pubDate>Thu, 14 Jan 2010 00:37:16 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/76</guid>

</item>
<item>
	<title>win7下启动telnet--转载</title>
	<link>http://xinlogs.com/open-telnet-win7</link>
	<description><![CDATA[<p>因为我日常需要用到telnet来管理交换机，所以经常用到telnet。</p>
<p>升级到win7后，发现telnet不能用了，提示如下</p>
<p><img alt="" src="http://xinlogs.com/attachment/1263273316_9469f971.png" /></p>
<p>后来查找资料发现</p>
<p>Windows 7出于安全性考虑屏蔽了Telnet。</p>
<p>如何开启呢？</p>
<p>在开始菜单-》控制面板-》程序界面中，点&ldquo;打开或关闭Windows功能&rdquo;如下图</p>
<p><img alt="" src="http://xinlogs.com/attachment/1263273814_4338d20b.png" /></p>
<p>然后在弹出的&quot;Windows功能&quot;界面中，选择上Telnet客户端，点击确定按钮。如下图</p>
<p><img alt="" src="http://xinlogs.com/attachment/1263273936_67310301.png" /></p>
<p>通过上面这些设置，就打开了Windows默认屏蔽的Telnet功能了。</p>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/quickmacro-on-win7">windows 7平台下按键精灵的后台运行</a></p></div>]]></description>
	<pubDate>Tue, 12 Jan 2010 05:26:25 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/open-telnet-win7</guid>

</item>
<item>
	<title>windows 7平台下按键精灵的后台运行</title>
	<link>http://xinlogs.com/quickmacro-on-win7</link>
	<description><![CDATA[<p>上次写了一篇<a href="druid-ubrs-quickmacro-code/">野D带黑上，后台挂机按键精灵代码</a>，有人反映win7下按键精灵后台代码不能运行。这里单独说明下。</p><p>首先的我win7系统是32为的windows7 旗舰版，按键精灵版本是7.20.5292 免费版。</p><p>在刚一开按键精灵的时候，会提示Init Seg Error。这个不用管，直接点确定就可以。</p><p>然后打开按键精灵后，我们点&ldquo;设置&rdquo;按钮</p><p><img src="http://xinlogs.com/attachment/1262849735_6203afea.png" border="0" /></p><p>然后在弹出来的设置界面中，将热键模式选择为增强模式，如下图所示。</p><p><img src="http://xinlogs.com/attachment/1262849876_167651ed.png" border="0" /></p><p>点确定后，返回按键精灵主界面。</p><p><strong>创建带黑上脚本</strong></p><p>点击新建按钮，进入&ldquo;按键精灵-我的脚本&rdquo;界面。然后点击这个界面中的&ldquo;源文件&rdquo;标签，如下图所示（注意红色三角标记）</p><p><img src="http://xinlogs.com/attachment/1262850072_8274d5fc.png" border="0" /></p><p>然后将带黑上脚本的代码粘贴进来。并在右侧&ldquo;描述&rdquo;里，写上黑上后台。点击保存退出，如下图所示</p><p><img src="http://xinlogs.com/attachment/1262850270_47708504.png" border="0" /></p><p>到这里按键精灵设置完毕。</p><p>只要打开刷黑上的小德号窗口，按F10启动脚本就可以了。然后再切换窗口双开，上网都可以。这个脚本会一直往小德号的窗口发送指令的。</p><p>具体如何刷黑上，可以参考<a href="post/60/">德鲁伊黑上带刷详细图文攻略 1.0版本</a></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/open-telnet-win7">win7下启动telnet--转载</a></p></div>]]></description>
	<pubDate>Thu, 07 Jan 2010 07:48:10 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/quickmacro-on-win7</guid>

</item>
<item>
	<title>playframework--helloworld程序编写</title>
	<link>http://xinlogs.com/playframework-helloworld</link>
	<description><![CDATA[<p>本文参考官方<a href="http://www.playframework.org/documentation/1.0/firstapp">http://www.playframework.org/documentation/1.0/firstapp</a>教程，基本上是翻译</p>
<p>转载请注明<a href="http://www.xinlogs.com/">http://www.xinlogs.com</a></p>
<p>在安装完playframework框架后，我们就可以编写一个helloworld程序来看看playframework框架是如何工作的了。</p>
<p>我是在C:盘的当前用户目录下，建立了一个playframework目录。在命令窗口，进入这个目录</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262825988_46530e27.png" /></p>
<p>在c:usersbaboplayframework目录下输入下面命令，创建项目</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_125');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_125">
<ol class="dp-xml" style="border-bottom: 0px; border-left: 0px; list-style-type: none; margin-left: 5px; border-top: 0px; border-right: 0px">
    <li class="alt"><span><span>play new helloworld </span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>然后play框架会提示你输入程序的全名称，这里就输入helloworld即可</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262826264_788423f9.png" /></p>
<p>play new helloworld会在当前目录下，创建一个helloworld目录，用来保存项目的全部文件。</p>
<p>下面运行我们新创建的项目，进入项目的目录helloworld，输入play run</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262826643_88366d2b.png" /></p>
<p>当看到入上图提示，证明项目已经跑在9000端口等我们访问了。让我们打开浏览器输入<a href="http://localhost:9000/">http://localhost:9000</a>访问下看看</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262826899_34879acd.png" /></p>
<p>看到上图显示的默认欢迎界面，说明我们的项目已经成功创建。下面我们看看play框架是如何显示出这个页面的</p>
<p>play框架里，你创建项目以后，程序的入口点在 <b>conf/routes</b> 文件。这个文件定义了程序全部可以被访问的URL地址。如果你打开 <b>conf/routes</b> 文件，你会看到第一个&lsquo;route&rsquo;信息就是如下语句<br />
&nbsp;</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_6240');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_6240">
<ol class="dp-xml" style="border-bottom: 0px; border-left: 0px; list-style-type: none; margin-left: 5px; border-top: 0px; border-right: 0px">
    <li class="alt"><span><span>GET / Application.index </span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>以上语句，告诉play框架，当web服务器收到一个访问 / 路径的的GET请求，就调用Application.index的java方法。实际上Application.index方法是<strong>controllers.Application.index</strong>的简写，因为controllers package 已经被import进来。</p>
<p>一个play框架程序的每个URL都会有入口点，我们叫这些方法Action。定义这些方法的类，我们叫做 <b>'controllers'。</b></p>
<p>下面我们看看 <b>controllers.Application</b> controller。 打开<b>helloworld/app/controllers/Application.java</b> 文件:</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">Java 代码</span><span class="copyCodeText" onclick="copyIdText('code_9784');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_9784">
<ol class="dp-j">
    <li class="alt"><span><span class="keyword">package</span><span> controllers; </span></span></li>
    <li>&nbsp;</li>
    <li class="alt"><span class="keyword">import</span><span> play.mvc.*; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span class="keyword">public</span><span> </span><span class="keyword">class</span><span> Application </span><span class="keyword">extends</span><span> Controller &#123; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span class="keyword">public</span><span> </span><span class="keyword">static</span><span> </span><span class="keyword">void</span><span> index() &#123; </span></li>
    <li><span>render(); </span></li>
    <li class="alt"><span>&#125; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>&#125; </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>我们可以看到Application的父类是 <b>play.mvc.Controller</b> 类。这个类为controllers提供了很多有用的方法, 像<b>render() </b>方法，我们用在index action里。</p>
<p>这个index action 被定义为一个 <b>'public static void' </b>方法. action方法是static的, 因为controller类从来都不会有实例. 总是返回void类型.</p>
<p>默认的index action 很简单: 它调用<b>render() </b>方法告诉Play框架去返回一个模板页面.用一个模板生成http响应是最常见的方法(但不是就这一个种方法)。</p>
<p>模板是在 <b>/app/views</b> 目录下的一个简单的text文件. 因为我们没有指定一个模板, 所以这个action将用一个默认的模板: <b>Application/index.html</b></p>
<p>让我们看下模板文件的内容，打开<strong>helloworld/app/views/Application/index.html</strong> 文件:</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">XML/HTML 代码</span><span class="copyCodeText" onclick="copyIdText('code_8842');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_8842">
<ol class="dp-xml">
    <li class="alt"><span><span>#&#123;extends 'main.html' /&#125; </span></span></li>
    <li><span>#&#123;set title:'Home' /&#125; </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>#&#123;welcome /&#125; </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>模板的内容看起来很简洁。实际上你看到的全是Play标签。它常接近JSP标签。上面的 <b>#&#123;welcome /&#125;</b>标签，就是生成我们在浏览器看到的默认欢迎页面。</p>
<p>这个<strong>#&#123;extends /&#125;</strong> 标签告诉Play框架这个模板继承于另外一个叫 <b>main.html</b>的模板文件。模板继承是一个很棒的概念，在用于创建复杂网页的共用部分重用上。</p>
<p>打开 <b>helloworld/app/views/main.html</b> 模板:</p>
<p>&nbsp;</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">XML/HTML 代码</span><span class="copyCodeText" onclick="copyIdText('code_8740');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_8740">
<ol class="dp-xml">
    <li class="alt"><span><span>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span><span class="tag">&gt;</span><span> </span></span></li>
    <li>&nbsp;</li>
    <li class="alt"><span class="tag">&lt;</span><span class="tag-name">html</span><span> </span><span class="attribute">xmlns</span><span>=</span><span class="attribute-value">&quot;http://www.w3.org/1999/xhtml&quot;</span><span> </span><span class="attribute">xml:lang</span><span>=</span><span class="attribute-value">&quot;en&quot;</span><span> </span><span class="attribute">lang</span><span>=</span><span class="attribute-value">&quot;en&quot;</span><span class="tag">&gt;</span><span> </span></li>
    <li><span class="tag">&lt;</span><span class="tag-name">head</span><span class="tag">&gt;</span><span> </span></li>
    <li class="alt"><span class="tag">&lt;</span><span class="tag-name">title</span><span class="tag">&gt;</span><span>#&#123;get 'title' /&#125;</span><span class="tag">&lt;/</span><span class="tag-name">title</span><span class="tag">&gt;</span><span> </span></li>
    <li><span class="tag">&lt;</span><span class="tag-name">meta</span><span> </span><span class="attribute">http-equiv</span><span>=</span><span class="attribute-value">&quot;Content-Type&quot;</span><span> </span><span class="attribute">content</span><span>=</span><span class="attribute-value">&quot;text/html; charset=utf-8&quot;</span><span class="tag">/&gt;</span><span> </span></li>
    <li class="alt"><span class="tag">&lt;</span><span class="tag-name">link</span><span> </span><span class="attribute">rel</span><span>=</span><span class="attribute-value">&quot;stylesheet&quot;</span><span> </span><span class="attribute">type</span><span>=</span><span class="attribute-value">&quot;text/css&quot;</span><span> </span><span class="attribute">media</span><span>=</span><span class="attribute-value">&quot;screen&quot;</span><span> </span></li>
    <li><span class="attribute">href</span><span>=</span><span class="attribute-value">&quot;@&#123;'/public/stylesheets/main.css'&#125;&quot;</span><span> </span><span class="tag">/&gt;</span><span> </span></li>
    <li class="alt"><span class="tag">&lt;</span><span class="tag-name">link</span><span> </span><span class="attribute">rel</span><span>=</span><span class="attribute-value">&quot;shortcut icon&quot;</span><span> </span><span class="attribute">type</span><span>=</span><span class="attribute-value">&quot;image/png&quot;</span><span> </span></li>
    <li><span class="attribute">href</span><span>=</span><span class="attribute-value">&quot;@&#123;'/public/images/favicon.png'&#125;&quot;</span><span> </span><span class="tag">/&gt;</span><span> </span></li>
    <li class="alt"><span class="tag">&lt;/</span><span class="tag-name">head</span><span class="tag">&gt;</span><span> </span></li>
    <li><span class="tag">&lt;</span><span class="tag-name">body</span><span class="tag">&gt;</span><span> </span></li>
    <li class="alt"><span>#&#123;doLayout /&#125; </span></li>
    <li><span class="tag">&lt;/</span><span class="tag-name">body</span><span class="tag">&gt;</span><span> </span></li>
    <li class="alt"><span class="tag">&lt;/</span><span class="tag-name">html</span><span class="tag">&gt;</span><span> </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>看到<strong>#&#123;doLayout /&#125;</strong> 标签了吧，它就是<strong>Application/index.html</strong> 文件内容被插入的位置</p>
<p><strong>创建一个表单</strong></p>
<p>下面我们将从一个可以输入我们名字的表单来开始写我们的程序。</p>
<p>编辑 <b>helloworld/app/views/Application/index.html</b> 模板，如下所示</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">XML/HTML 代码</span><span class="copyCodeText" onclick="copyIdText('code_8433');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_8433">
<ol class="dp-xml">
    <li class="alt"><span><span>#&#123;extends 'main.html' /&#125; </span></span></li>
    <li><span>#&#123;set title:'Home' /&#125; </span></li>
    <li class="alt">&nbsp;</li>
    <li><span class="tag">&lt;</span><span class="tag-name">form</span><span> </span><span class="attribute">action</span><span>=</span><span class="attribute-value">&quot;@&#123;Application.sayHello()&#125;&quot;</span><span> </span><span class="attribute">method</span><span>=</span><span class="attribute-value">&quot;GET&quot;</span><span class="tag">&gt;</span><span> </span></li>
    <li class="alt"><span class="tag">&lt;</span><span class="tag-name">input</span><span> </span><span class="attribute">type</span><span>=</span><span class="attribute-value">&quot;text&quot;</span><span> </span><span class="attribute">name</span><span>=</span><span class="attribute-value">&quot;myName&quot;</span><span> </span><span class="tag">/&gt;</span><span> </span></li>
    <li><span class="tag">&lt;</span><span class="tag-name">input</span><span> </span><span class="attribute">type</span><span>=</span><span class="attribute-value">&quot;submit&quot;</span><span> </span><span class="attribute">value</span><span>=</span><span class="attribute-value">&quot;Say hello!&quot;</span><span> </span><span class="tag">/&gt;</span><span> </span></li>
    <li class="alt"><span class="tag">&lt;/</span><span class="tag-name">form</span><span class="tag">&gt;</span><span> </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>我们使用@&#123;...&#125; 符号让Play框架自动生成可以调用Application.sayHello action的URL。现在，刷新下我们的浏览器。</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262833657_60355058.png" /></p>
<p>我们得到了一个错误，因为我们引用的 Application.sayHello action不存在。让我们在helloworld/app/controllers/Application.java文件里创建它。</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">Java 代码</span><span class="copyCodeText" onclick="copyIdText('code_2733');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_2733">
<ol class="dp-j">
    <li class="alt"><span><span class="keyword">package</span><span> controllers; </span></span></li>
    <li>&nbsp;</li>
    <li class="alt"><span class="keyword">import</span><span> play.mvc.*; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span class="keyword">public</span><span> </span><span class="keyword">class</span><span> Application </span><span class="keyword">extends</span><span> Controller &#123; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span class="keyword">public</span><span> </span><span class="keyword">static</span><span> </span><span class="keyword">void</span><span> index() &#123; </span></li>
    <li><span>render(); </span></li>
    <li class="alt"><span>&#125; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span class="keyword">public</span><span> </span><span class="keyword">static</span><span> </span><span class="keyword">void</span><span> sayHello(String myName) &#123; </span></li>
    <li><span>render(myName); </span></li>
    <li class="alt"><span>&#125; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>&#125; </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>我们在action方法里声明了<strong>myName</strong>参数，它将被自动填充上来自表单提交的HTTP <strong>myName</strong> 参数。</p>
<p>现在我们在访问<a href="http://localhost:9000">http://localhost:9000</a>显示如下</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262842031_8753f4d3.png" /></p>
<p>在文本框输入你的名字，然后提交，你会发现一个新的错误。</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262842309_690736db.png" /></p>
<p>这个错误显而易见，Play框架调用sayHello action方法的默认模板，但是这个模板不存在。让我们创建<strong>helloworld/app/views/Application/sayHello.html</strong>文件</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">XML/HTML 代码</span><span class="copyCodeText" onclick="copyIdText('code_3443');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_3443">
<ol class="dp-xml">
    <li class="alt"><span><span>#&#123;extends 'main.html' /&#125; </span></span></li>
    <li><span>#&#123;set title:'Home' /&#125; </span></li>
    <li class="alt">&nbsp;</li>
    <li><span class="tag">&lt;</span><span class="tag-name">h1</span><span class="tag">&gt;</span><span>Hello $&#123;myName ?: 'guest'&#125;!</span><span class="tag">&lt;/</span><span class="tag-name">h1</span><span class="tag">&gt;</span><span> </span></li>
    <li class="alt">&nbsp;</li>
    <li><span class="tag">&lt;</span><span class="tag-name">a</span><span> </span><span class="attribute">href</span><span>=</span><span class="attribute-value">&quot;@&#123;Application.index()&#125;&quot;</span><span class="tag">&gt;</span><span>Back to form</span><span class="tag">&lt;/</span><span class="tag-name">a</span><span class="tag">&gt;</span><span> </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>然后刷新浏览器页面，显示如下</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262842580_8493f286.png" /></p>
<p>我们看到了sayHello.html文件里使用了groovy的<strong>'?:'</strong>操作符。当我们<strong>myName</strong>没有没有被填充的时候，它默认用'guest'填充myName。</p>
<p>到这里，我们的HelloWorld程序已经可以正常运行了。但是我们还有几个问题需要解决。</p>
<p>如何显示更好的URL，这个对于SEO还是比较重要的。</p>
<p>如何自定义LayOut</p>
<p>如何对输入的字符进行验证</p>
<p>如何自动测试。</p>
<p>后面我们慢慢实现。</p>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/playframework-video">playframework--开发视频</a></p><p><a href="http://xinlogs.com/playframework">playframework--play！java on rails框架</a></p><p><a href="http://xinlogs.com/playframework-installation-guide">playframework--Installation guide 安装手册【翻译】</a></p></div>]]></description>
	<pubDate>Thu, 07 Jan 2010 05:43:37 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/playframework-helloworld</guid>

</item>
<item>
	<title>野D带黑上，后台挂机按键精灵代码</title>
	<link>http://xinlogs.com/druid-ubrs-quickmacro-code</link>
	<description><![CDATA[<p>本文章原创，转载请注明出处 鑫的方向 <a href="http://www.xinlogs.com">http://www.xinlogs.com</a></p>
<p>前面写了一篇<a href="http://www.xinlogs.com/post/60/">德鲁伊黑上带刷详细图文攻略 1.0版本</a>，很多朋友想要带刷时候使用的后台代码。</p>
<p>为了帮人帮到底，和小站的人气。这里放出代码。</p>
<p>代码是运行在按键精灵里的。在winxp+按键精灵7和win7+按键精灵7下测试通过</p>
<p>如果转载，请注明 鑫的方向 <a href="http://www.xinlogs.com/">http://www.xinlogs.com</a></p>
<p></p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_5539');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_5539">
<ol class="dp-vb">
    <li class="alt"><span><span>Plugin hwnd=Window.GetKeyFocusWnd() </span></span></li>
    <li><span>Rem start </span></li>
    <li class="alt"><span class="keyword">For</span><span> 30 </span></li>
    <li><span>Plugin Bkgnd.KeyPress(hwnd,70) </span></li>
    <li class="alt"><span>Delay 300 </span></li>
    <li><span>EndFor </span></li>
    <li class="alt"><span>Delay 1000 </span></li>
    <li><span>Plugin Bkgnd.KeyDown(hwnd,16) </span></li>
    <li class="alt"><span>Plugin Bkgnd.KeyPress(hwnd,87) </span></li>
    <li><span>Plugin Bkgnd.KeyUp(hwnd,16) </span></li>
    <li class="alt"><span>Delay 500 </span></li>
    <li><span class="keyword">For</span><span> 30 </span></li>
    <li class="alt"><span>Plugin Bkgnd.KeyPress(hwnd,70) </span></li>
    <li><span>Delay 300 </span></li>
    <li class="alt"><span>EndFor </span></li>
    <li><span>Delay 1000 </span></li>
    <li class="alt"><span>Plugin Bkgnd.KeyDown(hwnd,18) </span></li>
    <li><span>Plugin Bkgnd.KeyPress(hwnd,68) </span></li>
    <li class="alt"><span>Plugin Bkgnd.KeyUp(hwnd,18) </span></li>
    <li><span>Delay 500 </span></li>
    <li class="alt"><span class="keyword">For</span><span> 30 </span></li>
    <li><span>Plugin Bkgnd.KeyPress(hwnd,70) </span></li>
    <li class="alt"><span>Delay 300 </span></li>
    <li><span>EndFor </span></li>
    <li class="alt"><span>Delay 1000 </span></li>
    <li><span class="keyword">For</span><span> 8 </span></li>
    <li class="alt"><span>Plugin Bkgnd.KeyDown(hwnd,16) </span></li>
    <li><span>Plugin Bkgnd.KeyPress(hwnd,82) </span></li>
    <li class="alt"><span>Plugin Bkgnd.KeyUp(hwnd,16) </span></li>
    <li><span>EndFor </span></li>
    <li class="alt"><span>Delay 500 </span></li>
    <li><span>Goto start </span></li>
    <li class="alt">&nbsp;</li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p><strong>代码说明：</strong></p>
<p>上面是我自己使用的代码，我的快捷键设置和大家不一样，所以别人使用，请注意修改快捷键。</p>
<p>精灵之火（野性） Shift+R</p>
<p>树皮 Shift+W</p>
<p>狂暴回复 Alt+D</p>
<p>横扫+重殴 宏 F （其实就是个AOE宏，需要不断切换目标，保证重殴可以放出来就可以）</p>
<p>以上就是我带刷的代码，基本保证装备不红，人物不死。</p>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/60">德鲁伊黑上带刷详细图文攻略 1.0版本</a></p><p><a href="http://xinlogs.com/wow-1-70-Express-Upgrade">国服3.13 德鲁伊带小号快速升级（1-70全程带）</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p></div>]]></description>
	<pubDate>Sun, 03 Jan 2010 03:16:29 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/druid-ubrs-quickmacro-code</guid>

</item>
<item>
	<title>2010年北京第一场雪</title>
	<link>http://xinlogs.com/2010-snow-frist</link>
	<description><![CDATA[<p>2010年1月2日凌晨，北京开始飘落第一场雪。雪花很小。。。只有薄薄一层。。。。到了2日晚上雪花开始变大。。。</p>
<p>现在3日早上。。。大大的雪花，厚厚一层雪。。。</p>
<p>下午打算带老婆孩子玩学去了。</p>]]></description>
	<pubDate>Sun, 03 Jan 2010 02:57:07 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/2010-snow-frist</guid>

</item>
<item>
	<title>drupal在nginx 0.8.15下的简洁URL配置</title>
	<link>http://xinlogs.com/druapl-url-nginx-rewrite</link>
	<description><![CDATA[<p>最近在学习drupal，发现这个程序比xoops、joomla都灵活，对应的学习曲线也高。反正安装后，根本不知道真没设置。呵呵</p>
<p>下面先在nginx上配置了rewrite规则，让drupal支持简洁的URL</p>
<p></p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_6531');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_6531">
<ol class="dp-c">
    <li class="alt"><span><span>server </span></span></li>
    <li><span>&#123; </span></li>
    <li class="alt"><span>listen 80; </span></li>
    <li><span>server_name drupal.xinlogs.com; </span></li>
    <li class="alt"><span>index index.html index.htm index.php; </span></li>
    <li><span>root /data0/htdocs/drupal; </span></li>
    <li class="alt">&nbsp;</li>
    <li><span><span class="preprocessor">#limit_conn crawler 20; </span></span></li>
    <li class="alt"><span>location = / &#123; </span></li>
    <li><span>index index.php; </span></li>
    <li class="alt"><span>&#125; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>location / &#123; </span></li>
    <li><span>index index.php index.html; </span></li>
    <li class="alt">&nbsp;</li>
    <li><span class="keyword">if</span><span> (!-f $request_filename) &#123; </span></li>
    <li class="alt"><span>rewrite ^(.*)$ /index.php?q=$1 last; </span></li>
    <li><span class="keyword">break</span><span>; </span></li>
    <li class="alt"><span>&#125; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span class="keyword">if</span><span> (!-d $request_filename) &#123; </span></li>
    <li><span>rewrite ^(.*)$ /index.php?q=$1 last; </span></li>
    <li class="alt"><span class="keyword">break</span><span>; </span></li>
    <li><span>&#125; </span></li>
    <li class="alt"><span>&#125; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>location ~ .*.(php&#124;php5)?$ </span></li>
    <li><span>&#123; </span></li>
    <li class="alt"><span>fastcgi_pass unix:/tmp/php-cgi.sock; </span></li>
    <li><span><span class="preprocessor">#fastcgi_pass 127.0.0.1:9000; </span></span></li>
    <li class="alt"><span>fastcgi_index index.php; </span></li>
    <li><span>include fcgi.conf; </span></li>
    <li class="alt"><span>&#125; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>location ~ .*.(gif&#124;jpg&#124;jpeg&#124;png&#124;bmp&#124;swf)$ </span></li>
    <li><span>&#123; </span></li>
    <li class="alt"><span>expires 30d; </span></li>
    <li><span>&#125; </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>location ~ .*.(js&#124;css)?$ </span></li>
    <li class="alt"><span>&#123; </span></li>
    <li><span>expires 1h; </span></li>
    <li class="alt"><span>&#125; </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>log_format drupal_access </span><span class="string">'$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span><span> </span></li>
    <li><span class="string">'$status $body_bytes_sent &quot;$http_referer&quot; '</span><span> </span></li>
    <li class="alt"><span class="string">'&quot;$http_user_agent&quot; $http_x_forwarded_for'</span><span>; </span></li>
    <li><span>access_log /data1/logs/drupal_access.log drupal_access; </span></li>
    <li class="alt"><span>&#125; </span></li>
</ol>
</div>
<link href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" type="text/css" rel="stylesheet" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/nginx-epool-events">nginx采用epoll的事件模型，为何效率高。</a></p><p><a href="http://xinlogs.com/nginx-301-rewrite">nginx通过301统一入口域名</a></p><p><a href="http://xinlogs.com/Solve-nginx-502-mistakes">nginx通过轮询避免php-fpm引起的502错误</a></p><p><a href="http://xinlogs.com/howto-open-rewrite-log">伪静态规则调试技巧</a></p></div>]]></description>
	<pubDate>Fri, 01 Jan 2010 05:40:55 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/druapl-url-nginx-rewrite</guid>

</item>
<item>
	<title>新年祝福短信</title>
	<link>http://xinlogs.com/happy-new-year-message</link>
	<description><![CDATA[<p>以下内容来自网络，并非原创</p>
<p>一年一度，新春伊始，短信传情特恭祝：大财小财意外财，财源滚滚来；官运财运桃花运，运运总亨通；亲人爱人和友人，人人都平安。元旦快乐，万事如意！</p>
<p>2010年1月1日1时1分1秒，幸福卫星跟踪你，快乐导弹瞄准你，财富枪支指向你，祝福子弹围剿你，看你还能往哪躲。祝元旦快乐！</p>
<p>牛尾扫尽忧烦，虎首迎来吉祥。祝你虎年大旺：生活虎跃龙腾，名誉虎气冲天，事业虎啸风生，钱财虎踞龙盘！</p>
<p>新年到了，送你一条鱼＞＜(((;＞，希望你在新的一年里，财富有余，顿顿有鱼，精神有余，幸福有余。元旦快乐！</p>
<p>送你短信一条，收到就&ldquo;新&rdquo;；加上诚挚祝福，理解就&ldquo;新&rdquo;；配上贴心问候，感动就&ldquo;新&rdquo;；元旦来了，开心就&ldquo;新&rdquo;。祝新年快乐！</p>
<p>想当领导怕罗嗦；想办企业怕税多；想拍电影怕太火；想吃火锅怕太热；最想做而又不怕的是，在你圆脑瓜上写：圆蛋快乐！</p>
<p>过去的一年，你做牛人走牛运发牛财，就连牛皮也吹得清新脱俗；未来的一年，你行虎步发虎威有虎气，就连老虎的臀部也可以摸几把。新年快乐！</p>
<p>╭☆╯★╰☆╮╭☆╯ 元旦快乐 ╰☆╮ ╰☆╮ 生活愉快 ╭☆╯ ╰☆╮★╭☆╯</p>
<p>新年翩翩而至，旧岁渐渐而逝。元旦的到来，伴随着我的祝福，满怀希望的望眼幸福，携手快乐欢度这个新年的的伊始，我们大声喊出&ldquo;元旦快乐&rdquo;！</p>
<p>日照元旦生紫烟，遥看幸福挂前川，飞流直下三千尺，疑是快乐落九天。横看健康竖平安，远近高低各好运，不识元旦真面目，只缘未收我短信。元旦快乐！</p>
<p>&nbsp;</p>]]></description>
	<pubDate>Fri, 01 Jan 2010 04:08:23 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/happy-new-year-message</guid>

</item>
<item>
	<title>bo-blog 2.1.1如何加入google广告条</title>
	<link>http://xinlogs.com/bo-blog-insert-googleadsense</link>
	<description><![CDATA[<p>刚开始使用的bo-blog的时候也不知道如何加入google广告条，经过这几天的咕哝，现在已经成功在右边和下面加入。方法记录如下</p>
<p><strong>右侧边栏加入google广告</strong></p>
<p>进入后台管理-&gt;常规管理-&gt;模块配置</p>
<p>点击左侧的新建/编辑项目 如图</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262226738_418266e6.png" /></p>
<p>然后在手动添加项目中选择侧边模块，确定。如图</p>
<p><img alt="" src="http://xinlogs.com/attachment/1262226860_83688c76.png" /></p>
<p>确认后，进入到新增/编辑项目页面</p>
<p>项目名称--这个是在后台编辑的时候，给自己分辨模块用的，随意命名。我的叫做googleadsense，注意：只能字母和数字</p>
<p>项目描述--随意填写</p>
<p>抬头文字--显示在首页侧边栏上，我的叫做广告栏，根据个人情况写</p>
<p>栏目内容--这里写入google的广告代码就可以了</p>
<p>这个办法最容易，不用修改模板。如果加入后，首页显示google广告栏，里面内容是白的，不要着急，过段时间就可以显示了。我第一个广告大约在30分钟后，才正确显示出来。</p>
<p><strong>博客底部加入google广告</strong></p>
<p>底部加入广告，也可以用上面类似的办法，通过加入底部模块实现。但是我尝试了，不好对齐，而且有的模板会破坏底部风格。所以我没有用添加底部模块的办法。</p>
<p>我采用直接修改模板的elements.php文件方法。</p>
<p>到bo-blog的template目录下，找到自己使用的模板文件夹，我用的neowin2，所以对应目录就是neowin2</p>
<p>在模板目录下，打开elements.php文件。找到文件里的displayfooter位置，在displayfooter段里面加入google广告代码。入下所示</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">PHP 代码</span><span class="copyCodeText" onclick="copyIdText('code_8194');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_8194">
<ol class="dp-c">
    <li class="alt"><span><span class="vars">$elements</span><span>[</span><span class="string">'displayfooter'</span><span>]=&lt;&lt;&lt;eot </span></span></li>
    <li><span>&lt;div </span><span class="keyword">class</span><span>=</span><span class="string">&quot;clear&quot;</span><span>&gt; &lt;/div&gt; </span></li>
    <li class="alt"><span>&lt;/div&gt; </span></li>
    <li><span>&lt;div </span><span class="keyword">class</span><span>=</span><span class="string">&quot;content-box-b&quot;</span><span>&gt; </span></li>
    <li class="alt"><span>&lt;div </span><span class="keyword">class</span><span>=</span><span class="string">&quot;content-box-b-r&quot;</span><span>&gt; </span></li>
    <li><span>&lt;div </span><span class="keyword">class</span><span>=</span><span class="string">&quot;content-box-b-l&quot;</span><span>&gt;&lt;/div&gt; </span></li>
    <li class="alt"><span>&lt;/div&gt; </span></li>
    <li><span>&lt;/div&gt; </span></li>
    <li><span>/* 下面为google广告代码 */ </span></li>
    <li class="alt"><span>&lt;center&gt; </span></li>
    <li><span>&lt;script type=</span><span class="string">&quot;text/javascript&quot;</span><span>&gt;&lt;!-- </span></li>
    <li class="alt"><span>google_ad_client = </span><span class="string">&quot;pub-2759888315234430&quot;</span><span>; </span></li>
    <li><span class="comment">/* 728x90, ... 09-12-21 */</span><span> </span></li>
    <li class="alt"><span>google_ad_slot = </span><span class="string">&quot;9531615827&quot;</span><span>; </span></li>
    <li><span>google_ad_width = 728; </span></li>
    <li class="alt"><span>google_ad_height = 90; </span></li>
    <li><span class="comment">//--&gt; </span></li>
    <li class="alt"><span>&lt;/script&gt; </span></li>
    <li><span>&lt;script type=</span><span class="string">&quot;text/javascript&quot;</span><span> </span></li>
    <li class="alt"><span>src=</span><span class="string">&quot;http://pagead2.googlesyndication.com/pagead/show_ads.js&quot;</span><span>&gt; </span></li>
    <li><span>&lt;/script&gt; </span></li>
    <li class="alt"><span>&lt;/center&gt; </span></li>
    <li class="alt"><span>/*google广告代码结束*/ </span></li>
    <li><span>&lt;div id=</span><span class="string">&quot;footer&quot;</span><span>&gt; </span></li>
    <li class="alt"><span>&lt;div id=</span><span class="string">&quot;footer-r&quot;</span><span>&gt; </span></li>
    <li><span>&lt;div id=</span><span class="string">&quot;footer-l&quot;</span><span>&gt; </span></li>
    <li class="alt"><span>&lt;div id=</span><span class="string">&quot;footer-misc&quot;</span><span>&gt; </span></li>
    <li><span>Skin By &lt;a href=</span><span class="string">&quot;http://www.neowin.net/&quot;</span><span> target=</span><span class="string">&quot;_blank&quot;</span><span>&gt;Neowin&lt;/a&gt;&lt;br /&gt; </span></li>
    <li class="alt"><span>Transplanted By &lt;a href=</span><span class="string">&quot;http://blog.meiu.cn/&quot;</span><span> target=</span><span class="string">&quot;_blank&quot;</span><span>&gt;Lingter&lt;/a&gt; </span></li>
    <li><span>&lt;/div&gt; </span></li>
    <li class="alt"><span>&lt;div id=</span><span class="string">&quot;footer-copyright&quot;</span><span>&gt; </span></li>
    <li><span>&#123;section_foot_components&#125; </span></li>
    <li class="alt"><span>&lt;div id=</span><span class="string">&quot;processtime&quot;</span><span>&gt; </span></li>
    <li><span>&lt;/div&gt; </span></li>
    <li class="alt"><span>&lt;/div&gt; </span></li>
    <li><span>&lt;div </span><span class="keyword">class</span><span>=</span><span class="string">&quot;clear&quot;</span><span>&gt;&lt;/div&gt; </span></li>
    <li class="alt"><span>&lt;/div&gt; </span></li>
    <li><span>&lt;/div&gt; </span></li>
    <li class="alt"><span>&lt;/div&gt; </span></li>
    <li><span>&lt;/div&gt; </span></li>
    <li class="alt"><span>eot; </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>上面的代码就是在博客下面，footer信息的上面，加入一条google广告。效果可以参考<a href="http://www.xinlogs.com">www.xinlogs.com</a>的样子</p>]]></description>
	<pubDate>Thu, 31 Dec 2009 02:52:01 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/bo-blog-insert-googleadsense</guid>

</item>
<item>
	<title>playframework--Installation guide 安装手册【翻译】</title>
	<link>http://xinlogs.com/playframework-installation-guide</link>
	<description><![CDATA[<h1 id="Installationguide">Installation guide 安装手册</h1>
<h2 id="aPrerequisitesa"><a>Prerequisites</a> 前提条件</h2>
<p>To run the play framework, you need <a href="http://java.sun.com">Java 5 or later</a>. If you wish to build play from source, you will need the <a href="http://bazaar-vcs.org/">Bazaar source control client</a> to fetch the source code and <a href="http://ant.apache.org/">Ant</a> to build it.</p>
<p>要运行Play框架，你需要Java 5以后的的JDK。如果你想从源码构建play框架，你需要用Bazaar源码控制的客户端去获取源代码并用Ant创建它。</p>
<p class="note">If you are using MacOS, java is just built-in. If you are using linux, make sure to use either the Sun-JDK or OpenJDK (and not gcj which is the default java command on many linux distro). If you are using Windows, just download and install the latest JDK package.</p>
<p class="note">如果你用MacOS系统，java是内建的。如果你用Linux系统，确定你使用的是Sun-JDK或者OpenJDK（不要是gcj，很多linux发行版默认都用gcj作为默认的java环境）。如果你用Windows系统，只要下载并安装最新发行的JDK包。</p>
<p>Be sure to have java in the current path (try to type <b>java -version</b> to check). Play will use the default java or the one available at the <b>$JAVA_HOME</b> path if defined.</p>
<p>确定java在当前路径（可以通过在命令行输入<strong>java -version</strong>检查）。Play框架将调用默认java或者一个在<strong>$JAVA_HOME</strong>环境变量声明的路径里的java。</p>
<p>The play command line utility uses python. So it should work out of the box on any UNIX system. If you&rsquo;re running Windows, don&rsquo;t worry, a python runtime is bundled with the framework.</p>
<p>play框架的命令行工具是用python写的。所以它应该可以在任意Unix系统上工作，如果你是Windows系统，别担心，一个python的运行环境已经内建在框架里了。</p>
<h2 id="aDownloadthebinarypackagea"><a>Download the binary package</a> 下载二进制包</h2>
<p>Download the latest <a href="http://download.playframework.org/">play binary package</a> and extract the archive. For convenience, you should add the framework installation directory to your system PATH. If you&rsquo;re on UNIX, make sure that the <em>play</em> script is runnable (otherwise simply do a <b>chmod +x play</b>). That&rsquo;s all.</p>
<p>下载最新的play框架二进制包并解压缩。为了方便，你应该将play框架的安装目录添加到你系统的path环境变量里。如果你用unix，确认play脚本可以运行（否则可以执行<strong>chmod +x play</strong>）<strong>.</strong></p>
<p class="note"><strong>Tip 建议</strong><br />
<br />
If you need to rebuild the framework for whatever reason, run <strong>ant</strong> from the <strong>$PLAY_HOME/framework</strong> directory.</p>
<p class="note">如果你需要重建框架，从 <strong>$PLAY_HOME/framework</strong> 目录运行<strong>ant</strong>。</p>
<h2 id="aBuildfromthelatestsourcesa"><a>Build from the latest sources</a> 从最新源码建立</h2>
<p>To benefit from the latest improvements and bug fixes, you may want to compile play from sources. You&rsquo;ll need a <a href="http://bazaar-vcs.org/Download">Bazaar client</a> to fetch the sources and <a href="http://ant.apache.org/">Ant</a> to build the framework.</p>
<p>为了最新的改善和bug修复，你也许想从源代码编译play框架。你将需要一个Bazaar客户端去获取源代码并用Ant建立play框架。</p>
<p>From the command line:</p>
<p>通过下面的命令行建立</p>
<pre><code># bzr checkout lp:play
# cd play/framework
# ant
</code></pre>
<p>The Play framework is ready to use.</p>
<p class="note">lp:play currently aliases to http:bazaar.launchpad.net/%7Eplay-developers/play/1.0/</p>
<h2 id="aUsingtheplaycommanda"><a>Using the play command</a> 是用play命令</h2>
<p>When the framework is correctly installed, open a shell and execute <strong>play</strong>.</p>
<p>当框架正确安装后，打开一个shell并执行<strong>play</strong></p>
<pre><code>$ play
</code></pre>
<p>You should see the play default message:</p>
<p>你应该看到play的默认信息</p>
<p><img border="0" alt="" src="http://www.playframework.org/documentation/1.0/images/help" /></p>
<p>You can get more help on any specific command using <strong>play help any-command-name-here</strong>. For example, try:</p>
<p>你可以获得更多帮助在任何具体命令上用 <strong>play help any-command-name-here例如，尝试</strong></p>
<pre><code># play help run
</code></pre>
<h2 id="aCreatinganewapplicationa"><a>Creating a new application</a> 创建一个新的应用</h2>
<p>Use the <b>new</b> command to create a new application. You must give a non-existent path where the application will be created.</p>
<p>用<strong>new</strong>命令创建一个新的应用。你必须给一个不存在的名字，才可以创建应用（就是给一个以前没有的项目名字）</p>
<pre><code># play new myApp
</code></pre>
<p><img border="0" alt="" src="http://www.playframework.org/documentation/1.0/images/guide1-1" /></p>
<p>Will create a new application. Start it with:</p>
<p>创建一个新的应用，用下面命令</p>
<pre><code># play run myApp
</code></pre>
<p>You can then open a browser at <a href="http://localhost:9000">http://localhost:9000</a> and see the default page for the application.</p>
<p>你可以用浏览器访问 <a href="http://localhost:9000">http://localhost:9000</a>并看到应用的默认页面。</p>
<p><img border="0" alt="" src="http://www.playframework.org/documentation/1.0/images/guide1-2" /></p>
<p class="note"><b>Your play environnement is ready</b><br />
&nbsp;</p>
<p class="note"><b>你的play框架已经准备好了</b></p>
<p class="note"><b>关于如何使用play框架，可以参考视频</b></p>
<p class="note"><b><a href="http://www.xinlogs.com/playframework-video/">http://www.xinlogs.com/playframework-video/</a></b></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/playframework">playframework--play！java on rails框架</a></p><p><a href="http://xinlogs.com/playframework-video">playframework--开发视频</a></p><p><a href="http://xinlogs.com/playframework-helloworld">playframework--helloworld程序编写</a></p></div>]]></description>
	<pubDate>Wed, 30 Dec 2009 10:30:02 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/playframework-installation-guide</guid>

</item>
<item>
	<title>apache下多虚拟主机的配置与管理</title>
	<link>http://xinlogs.com/apache-VirtualHost-Configure</link>
	<description><![CDATA[<p>当一台服务器想给多个域名提供web服务的时候，我们可以使用apache虚拟主机配置。</p>
<p>apache的配置文件在centos系统下，默认放在/etc/httpd/conf目录下的httpd.conf文件里。</p>
<p>虚拟主机的配置如下</p>
<div class="codeText">
<div class="codeHead"><span class="copyCodeText" onclick="copyIdText('code_8025');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_8025">
<ol class="dp-cpp">
    <li class="alt"><span><span class="preprocessor">#############TEST VirtualHost </span></span></li>
    <li><span>&lt;VirtualHost *:80&gt; </span></li>
    <li class="alt"><span>ServerAdmin <a href="mailto:babodx@gmail.com">babodx@gmail.com</a></span></li>
    <li><span>DocumentRoot </span><span class="string">&quot;/home/babo&quot;</span><span> </span></li>
    <li class="alt"><span>ServerName <a href="http://www.xinlogs.com">www.xinlogs.com</a> </span></li>
    <li><span>DirectoryIndex index.html </span></li>
    <li class="alt"><span>ErrorLog logs/www.xinlogs.com_error_log </span></li>
    <li><span>CustomLog logs/www.xinlogs.com-access_log common </span></li>
    <li class="alt">&nbsp;</li>
    <li class="alt"><span>&lt;/VirtualHost&gt; </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>如果我们apache给10个或更多的域名提供web服务，这样的话，我们的httpd.conf就会有很多&lt;VirtualHost *:80&gt;这样的配置段落，看起来很长，管理起来也很麻烦。而且一个apache同时给几十个web域名提供虚拟主机，完全没有问题。那该如何写配置文件便于我们管理呢？</p>
<p><strong>解决办法</strong></p>
<p>为了管理方便，配置文件的结构清晰。</p>
<p>我们完全可以将每个虚拟主机的配置文件放在独立文件中，这样apache的主要配置文件httpd.conf看上去很简洁。</p>
<p>只要在最后加入</p>
<div class="codeText"><span class="copyCodeText" onclick="copyIdText('code_3505');" style="cursor: pointer">复制内容到剪贴板</span>
<div id="code_3505">
<ol class="dp-xml">
    <li class="alt"><span><span>Include conf/vhost_*.conf </span></span></li>
</ol>
</div>
</div>
<p>&nbsp;</p>
<p>然后再conf目录里，每个虚拟主机的文件只要以vhost_开头，后面可以用自己的域名加.conf后缀。比如有个test.com的域名要做web。</p>
<p>我们就可以直接在conf目录创建一个vhost_test.com.conf文件，文件里写入虚拟主机配置，比如</p>
<div class="codeText">
<div class="codeHead"><span class="copyCodeText" onclick="copyIdText('code_7220');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_7220">
<ol class="dp-xml">
    <li class="alt"><span><span>#############TEST VirtualHost </span></span></li>
    <li><span class="tag">&lt;</span><span class="tag-name">VirtualHost</span><span> *:80</span><span class="tag">&gt;</span><span> </span></li>
    <li class="alt"><span>ServerAdmin <a href="mailto:babodx@gmail.com">babodx@gmail.com</a></span></li>
    <li><span>DocumentRoot &quot;/home/test.com&quot; </span></li>
    <li class="alt"><span>ServerName test.com </span></li>
    <li><span>DirectoryIndex index.html </span></li>
    <li class="alt"><span>ErrorLog logs/test.com_error_log </span></li>
    <li><span>CustomLog logs/test.com-access_log common </span></li>
    <li class="alt">&nbsp;</li>
    <li><span class="tag">&lt;/</span><span class="tag-name">VirtualHost</span><span class="tag">&gt;</span><span> </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>通过这种配置结构，我们管理再多的虚拟主机也不用怕。只要修改conf目录下对应虚拟主机的配置文件即可。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/howto-open-rewrite-log">伪静态规则调试技巧</a></p></div>]]></description>
	<pubDate>Wed, 30 Dec 2009 08:57:34 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/apache-VirtualHost-Configure</guid>

</item>
<item>
	<title>德鲁伊黑上带刷详细图文攻略 1.0版本</title>
	<link>http://xinlogs.com/post/60</link>
	<description><![CDATA[<p>转载请注明<a href="/">http://www.xinlogs.com</a>原创<br />想写这篇文章很久了，一直没有整时间弄，今天给整理出来了。 2009年12月28日<br />转载请注明<a href="/">http://www.xinlogs.com</a>原创<br /><br />我一般都是卡1楼的9个召唤师，正常情况下卡7个以上。下面主要说说如何解决引召唤师和卡召唤师的时候可能遇到的问题。<br /><br /><strong>解决问题<br /></strong><br />看到很多人都在讨论德鲁伊如何带黑上，网站上有图片、有视频、有讨论。但是这些资料总是不能明白的说清楚如何卡召唤师？如何不在卡的过程中被冲锋？该怎么跑位？该用什么天赋？该卡在哪里？卡住后，如何双开或者上网浏览网页？如何修理装备？卡住后，时间长了，人物对面的怪怎么办？<br /><br /><strong>天赋<br /></strong>天赋不用说，肯定是野D天赋，但是具体加法呢，为了最大化输出，我选择0 46 15的天赋<br /><img class="insertimage" src="attachment.php?fid=19" border="0" /><img class="insertimage" src="attachment.php?fid=20" border="0" /><img class="insertimage" src="attachment.php?fid=21" border="0" /><br /><br /><strong>装备<br /></strong>在保证可以回血的前提下，尽量用最大化DPS。而回血，就靠武器、FM、饰品、头部多彩宝石。<br /><br /><strong>具体卡位过程<br /></strong>首先进入黑石塔。<br /><img class="insertimage" src="attachment.php?fid=22" border="0" /><br /><br />然后向红色箭头方向进入<br /><br /><img class="insertimage" src="attachment.php?fid=23" border="0" /><br /><br />进入后，可以清理掉小怪。也可以潜行直接进入。从箭头方向进入黑上。<br /><br /><img class="insertimage" src="attachment.php?fid=24" border="0" /><br /><br />我潜行上来，继续向前就进入到黑上了。可以看到里面有巡逻的龙人。<br /><br /><img class="insertimage" src="attachment.php?fid=25" border="0" /><br /><br />注意：1层有2个龙人，然后楼梯上面（2层）还有3个龙人，全部拉在刚上楼梯右边的墙边，AOE掉。<br /><br /><img class="insertimage" src="attachment.php?fid=26" border="0" /><br /><br />杀掉龙人，就可以清理每个房间的小怪了。我们来这里，是为了卡召唤师。所以除了召唤师其他怪全部要杀掉。每个房间就剩下召唤师。<br />清理的方法很简单，标记召唤师。然后只要你抗的住，就可以一直杀除了召唤师以外的怪。抗不住了，就跑出副本，然后再回来就ok了。我目前5T6，可以杀2-3个房间，跑出去一次。<br /><br /><img class="insertimage" src="attachment.php?fid=27" border="0" /><br /><br />下面先看看最终卡bug的位置。就是进入黑上后，左手第一个房间。<br /><br /><br /><br /><img class="insertimage" src="attachment.php?fid=28" border="0" /><br /><br />引怪的问题，我们要速度给每个房间的怪上精灵之火引怪。如果房间有2个召唤师，只要给1个上精灵之火就可以。利用野性精灵之火和人行精灵之火没有CD的特点，一个用野性、一个用人行交替开怪。<br />然后将怪拉到2层的玉米房里<br /><br /><img class="insertimage" src="attachment.php?fid=29" border="0" /><br /><br />注意看上面的图，很多人问总被冲锋怎么办。<br />其实有2个办法，一个是XD自己是工程D。用地精火箭鞋。但是这个办法在引了9个召唤师，大量召唤黑手老兵后，还是很容易被冲锋到，很考验操作很运气。而且穿了工程鞋，损失不少DPS。<br />另外我认为比较好的方式就是，让QS帮我们上个保护祝福。<br />上面图上就是开始的时候QS站在右边墙角，这里只要QS不动，就不会进入战斗。<br />然后XD跑进玉米房的右边角落。 当所有召唤师都进入房间后，QS跑到玉米房门口，准备给XD上保护祝福。<br /><br /><img class="insertimage" src="attachment.php?fid=30" border="0" /><br /><br />在进入这个角落的时候，趁着召唤师和怪都没有过来，给自己上愈合和回春。因为不能打到召唤师，后面就只能死抗和普通攻击召唤出来的怪了。等召唤师全部进入房间，就向前跑，从木桶上跳出来。<br /><br /><img class="insertimage" src="attachment.php?fid=31" border="0" /><br /><br />按照上图的方向从木桶上跳出来，之所以从木桶上跳，就为了不被冲锋到。<br /><br /><img class="insertimage" src="attachment.php?fid=32" border="0" /><br /><br />落地后第一时间调整到上面图的位置，然后由门外的QS给上保护祝福。然后变豹子开疾跑<br /><br /><img class="insertimage" src="attachment.php?fid=33" border="0" /><br />变豹子开疾跑，向红圈位置跑过去。然后贴着墙角拐弯<br /><br /><img class="insertimage" src="attachment.php?fid=34" border="0" /><br />拐弯后，沿着红色路线跑到bug房间门口<br /><img class="insertimage" src="attachment.php?fid=35" border="0" /><br />跑到房间门口的时候，保护肯定没有了，为了不让冲锋到，一定要靠右侧的门拐进去<br /><br /><img class="insertimage" src="attachment.php?fid=36" border="0" /><br />进入bug房间后，沿红色箭头跳上台子，然后速度变熊，转身，背靠bug点。顺利的话，可以卡7个-8个召唤师<br /><br /><strong>下面放一张我卡好的截图</strong><br /><img class="insertimage" src="attachment.php?fid=37" border="0" /><br /><br />修理装备需要靠右工程的号放修理机器人。<br />在刷的过程中，XD对面总会卡一些远程怪，这个也要靠放修理机器的号协助清理一下，一般1小时修理一次的时候，顺便清理。<br /><br />至于双卡或者刷的时候在开浏览器上网，就不能用普通的按键精灵脚本了，需要用后台支持模式的代码。<br />这个代码，我稍后放出。<br /><br />以上就是我的经验了，转载请注明 <a href="/">http://www.xinlogs.com</a></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/wow-1-70-Express-Upgrade">国服3.13 德鲁伊带小号快速升级（1-70全程带）</a></p><p><a href="http://xinlogs.com/druid-ubrs-quickmacro-code">野D带黑上，后台挂机按键精灵代码</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p></div>]]></description>
	<pubDate>Mon, 28 Dec 2009 11:35:16 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/60</guid>

</item>
<item>
	<title>解决Linux下Tomcat不能重启和停止问题</title>
	<link>http://xinlogs.com/Tomcat-reboot-problems</link>
	<description><![CDATA[<p>我的Tomcat 5.5.28安装在CentOS 5.3 64bit系统上<br />
每次重启都停住，只要要等5-10分钟才可以。<br />
系统reboot或者shutdown也都卡在关闭tomcat的过程中<br />
后来发现直接用/usr/local/tomcat/bin/shutdown.sh一样存在问题，但是如果Tomcat什么项目都不加载，却正常。<br />
我怀疑是tomcat加载的lib或者jar文件一多，重启和关闭就会慢的巨慢。。。甚至10分钟以上。<br />
为了解决这个问题，我修改了/etc/init.d/目录下的tomcat文件，让关闭或者重启的时候，直接通过kill命令杀掉tomcat进程。<br />
下面是我/etc/init.d/tomcat文件<br />
<br />
&nbsp;</p>
<div class="codeText">
<div class="codeHead"><span class="lantxt">C/C++ 代码</span><span class="copyCodeText" onclick="copyIdText('code_7437');" style="cursor: pointer">复制内容到剪贴板</span></div>
<div id="code_7437">
<ol class="dp-cpp">
    <li class="alt"><span><span class="preprocessor">#!/bin/bash </span></span></li>
    <li><span class="preprocessor"># </span></li>
    <li class="alt"><span class="preprocessor"># Startup script for the tomcat </span></li>
    <li><span class="preprocessor"># </span></li>
    <li class="alt"><span class="preprocessor"># chkconfig: 345 80 15 </span></li>
    <li><span class="preprocessor"># description: Tomcat is a Servlet+JSP Engine. </span></li>
    <li class="alt">&nbsp;</li>
    <li><span class="preprocessor"># Source function library. </span></li>
    <li class="alt"><span>. /etc/rc.d/init.d/functions </span></li>
    <li>&nbsp;</li>
    <li class="alt">&nbsp;</li>
    <li><span>export JAVA_HOME=/usr/local/jdk1.6.0_16 </span></li>
    <li class="alt"><span>export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar </span></li>
    <li><span>export PATH=$PATH:$JAVA_HOME/bin </span></li>
    <li class="alt">&nbsp;</li>
    <li><span>export CATALINA_BASE=/usr/local/tomcat </span></li>
    <li class="alt"><span>export CATALINA_HOME=/usr/local/tomcat </span></li>
    <li><span>export CATALINA_TMPDIR=/usr/local/tomcat/temp </span></li>
    <li class="alt"><span>export JRE_HOME=/usr/local/jdk1.6.0_16 </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>start()&#123; </span></li>
    <li><span class="keyword">if</span><span> [ -z $(/sbin/pidof java) ]; then </span></li>
    <li class="alt"><span>echo </span><span class="string">&quot;Starting tomcat&quot;</span><span> </span></li>
    <li><span>/usr/local/tomcat/bin/startup.sh </span></li>
    <li class="alt"><span>touch /var/lock/subsys/tomcat </span></li>
    <li><span class="keyword">else</span><span> </span></li>
    <li class="alt"><span>echo </span><span class="string">&quot;tomcat allready running&quot;</span><span> </span></li>
    <li><span>fi </span></li>
    <li class="alt"><span>&#125; </span></li>
    <li>&nbsp;</li>
    <li class="alt">&nbsp;</li>
    <li><span>stop()&#123; </span></li>
    <li class="alt"><span class="keyword">if</span><span> [ ! -z $(/sbin/pidof java) ]; then </span></li>
    <li><span>echo </span><span class="string">&quot;Shutting down tomcat&quot;</span><span> </span><span>
    <p><font color="#000000"><span class="preprocessor">#下面就是关闭的核心代码了，用ps获取tomcat进程id，直接kill掉 </span></font></p>
    </span></li>
    <li class="alt"><span>ps aux&#124;grep tomcat&#124;grep startup&#124;awk </span><span class="string">'&#123;print $2&#125;'</span><span>&#124;xargs kill -9 </span></li>
    <li><span class="preprocessor">#/usr/local/tomcat/bin/shutdown.sh </span></li>
    <li class="alt"><span>until [ -z $(/sbin/pidof java) ]; </span><span class="keyword">do</span><span> :; done </span></li>
    <li><span>rm -f /var/lock/subsys/tomcat </span></li>
    <li class="alt"><span class="keyword">else</span><span> </span></li>
    <li><span>echo </span><span class="string">&quot;tomcat not running&quot;</span><span> </span></li>
    <li class="alt"><span>fi </span></li>
    <li><span>&#125; </span></li>
    <li class="alt">&nbsp;</li>
    <li>&nbsp;</li>
    <li class="alt"><span class="keyword">case</span><span> </span><span class="string">&quot;$1&quot;</span><span> in </span></li>
    <li><span>start) </span></li>
    <li class="alt"><span>start </span></li>
    <li><span>;; </span></li>
    <li class="alt"><span>stop) </span></li>
    <li><span>stop </span></li>
    <li class="alt"><span>;; </span></li>
    <li><span>restart) </span></li>
    <li class="alt"><span>stop </span></li>
    <li><span>start </span></li>
    <li class="alt"><span>;; </span></li>
    <li><span>status) </span></li>
    <li class="alt"><span>/usr/local/tomcat/bin/catalina.sh version </span></li>
    <li><span>;; </span></li>
    <li class="alt"><span>*) </span></li>
    <li><span>echo </span><span class="string">&quot;Usage: $0 &#123;start&#124;stop&#124;restart&#124;status&#125;&quot;</span><span> </span></li>
    <li class="alt"><span>esac </span></li>
    <li>&nbsp;</li>
    <li class="alt"><span>exit 0 </span></li>
    <li>&nbsp;</li>
    <li class="alt">&nbsp;</li>
</ol>
</div>
<link href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css" type="text/css" rel="stylesheet" /><script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script></div>
<p>&nbsp;</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/ssh-login-protection-by-denyhosts">通过denyhosts保护ssh登陆</a></p><p><a href="http://xinlogs.com/post/17">如何快速统计服务器访问量</a></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p></div>]]></description>
	<pubDate>Mon, 28 Dec 2009 03:12:51 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Tomcat-reboot-problems</guid>

</item>
<item>
	<title>playframework--开发视频</title>
	<link>http://xinlogs.com/playframework-video</link>
	<description><![CDATA[<a href="http://www.playframework.org/">www.playframework.org</a>网站上本来首页有一段大约10分钟的视频。内容是10分钟开发一个web程序，包括数据库的curd操作。<br />但是由于视频是放在了<span style="color: #800000"><a href="http://vimeo.com/">http://vimeo.com/</a><br /></span><span style="color: #000000">国内正常情况下访问不到。<br />我在浏览首页的时候，发现可以通过<a href="http://www.playframework.org/">www.playframework.org</a>下载mp4的视频观看。<br />下面给出下载地址，感兴趣的朋友可以下载观看<br /></span><span style="color: #800000">http://download.playframework.org/presentations/screencast.mp4<br /><br />视频截图<br /><img src="http://www.playframework.org/images/screen.png" border="0" /></span><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/playframework-helloworld">playframework--helloworld程序编写</a></p><p><a href="http://xinlogs.com/playframework">playframework--play！java on rails框架</a></p><p><a href="http://xinlogs.com/playframework-installation-guide">playframework--Installation guide 安装手册【翻译】</a></p></div>]]></description>
	<pubDate>Sun, 27 Dec 2009 14:53:33 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/playframework-video</guid>

</item>
<item>
	<title>playframework--play！java on rails框架</title>
	<link>http://xinlogs.com/playframework</link>
	<description><![CDATA[今天看程序员，发现了play！framework这个java web框架。<br />以前也接触过SSH框架，struts+spring+hibernate。。。看着每一个部分那厚厚的参考书。。我就害怕。<br />后来就看了一阵子ruby on rails。彻底喜欢上了那种简洁的风格，约定优先配置也很棒。<br /><br />知道发现play框架，才知道原来java也可以这样简洁。play框架扔掉了J2EE的各种规范。。。完全像rails一样简洁了<br /><br />Play！的主要特性： <ul><li>&nbsp;&nbsp;&nbsp; 简单的开发周期。该框架可自动编译和重新装载已改变的源文件。 </li><li>&nbsp;&nbsp;&nbsp; 智能绑定HTTP参数到Java方法参数。 </li><li>&nbsp;&nbsp;&nbsp; 基于Apache Mina的快速HTTP服务器(<a href="http://mina.apache.org/" target="_blank"><span style="color: #006699">http://mina.apache.org</span></a>)。 </li><li>&nbsp;&nbsp;&nbsp; 一个基于Groovy的强大的模板引擎，可实现多层继承，定制用户标签等功能。 </li><li>&nbsp;&nbsp;&nbsp; 优秀的错误报告功能：发生异常时，该框架会直接显示出错误的源代码，甚至是模板代码。 </li></ul><p>目前playframework网站的资料也比较全。从安装入门到开发实例应有尽有。我打算有时间慢慢翻译过来，发布在我的博客上。也是对自己学习的一种激励。<br /><br /><br /><strong>官方网站<br /></strong><a href="http://www.playframework.org/" target="_blank">http://www.playframework.org/</a><br />&nbsp;<br />各种实例<br /></p><h2>Yet Another Blog Engine</h2><p>The final application from the <a href="http://www.playframework.org/documentation/1.0/guide1">play guide</a> tutorial.</p><p><img src="http://www.playframework.org/documentation/1.0/images/yabe" border="0" width="1050" height="612" /></p><h2>Forum</h2><p>A simple forum application using JPA.</p><p><img src="http://www.playframework.org/documentation/1.0/images/forum" border="0" width="996" height="649" /></p><h2>Jobboard</h2><p>A full faetured job board application that uses the CRUD module to automatically generate the administration area. </p><p><img src="http://www.playframework.org/documentation/1.0/images/jobboard" border="0" width="996" height="649" /></p><h2>Chat</h2><p>An HTTP based chat application. We use the asynchronous request model to be able to handle a lot of simultaneous connected users without resources waste.</p><p><img src="http://www.playframework.org/documentation/1.0/images/chat" border="0" width="996" height="649" /></p><h2>Stock watcher</h2><p>Based on the default GWT tutorial, it shows how to use GWT within a play application.</p><p><img src="http://www.playframework.org/documentation/1.0/images/stocks" border="0" width="996" height="649" /></p><h2>My lists</h2><p>A clone of the the well known 37Signals TadaList application built using the Google App Engine support. It uses Siena as persistence engine.</p><p><img src="http://www.playframework.org/documentation/1.0/images/lists" border="0" width="996" height="649" /></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/playframework-helloworld">playframework--helloworld程序编写</a></p><p><a href="http://xinlogs.com/playframework-video">playframework--开发视频</a></p><p><a href="http://xinlogs.com/playframework-installation-guide">playframework--Installation guide 安装手册【翻译】</a></p></div>]]></description>
	<pubDate>Sat, 26 Dec 2009 15:59:46 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/playframework</guid>

</item>
<item>
	<title>平安夜观看十月围城</title>
	<link>http://xinlogs.com/Bodyguards-and-Assassins</link>
	<description><![CDATA[09年平安夜，下班早早就去接老婆。一路还算顺利，没有堵车。大约5点30到达电影院。<br />自己订的位置，需要提前1小时确认买票，结果我们的位置没有。。。。。幸运的是，有个更好的位置，也没有来确认，我们直接买了那2张票。<br />十月围城 英文名字 Bodyguards-and-Assassins <br />主要演员<br />&nbsp;谢霆锋 XIETINGFENG<br />&nbsp; 黎明 LIMING<br />&nbsp; 甄子丹 ZHENZIDAN<br />&nbsp; 梁家辉 LIANGJIAHUI <br />&nbsp; 胡军 HUJUN<br />&nbsp; 任达华 RENDAHUA<br />&nbsp; 曾志伟 ZENGZHIWEI<br />&nbsp; 王柏杰 WANGBOJIE<br />&nbsp; 范冰冰 FANBINGBING<br />影片讲述孙中山要到香港筹募起义捐款，负责接待他的义士商人知道有一批满清政府派来的刺客暗杀，所以立刻花钱请了一批身怀绝技的保镖护送，最后顺利将孙中山安全送回广州。<br /><br />看到为了保护孙中山，影片中各位义士相继死去的时候，老婆都哭了。我觉得这个片子可以当作爱国教育片。为了祖国的明天、为了希望，每个小人物为了完成自己的诺言，都拼上了性命，至死方休。<br /><br />作为80后的我们。。。。确实从影片中了经理了一次洗礼<div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/bianfuxia-3-heianqishi">【电影发布】蝙蝠侠前传3：黑暗骑士崛起</a></p><p><a href="http://xinlogs.com/chaofanzhizhuxia">【电影发布】超凡蜘蛛侠2012</a></p></div>]]></description>
	<pubDate>Fri, 25 Dec 2009 03:35:02 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Bodyguards-and-Assassins</guid>

</item>
<item>
	<title>[转] 我的老婆80后</title>
	<link>http://xinlogs.com/Wife-80</link>
	<description><![CDATA[今天发现个很有意思的漫画，就给转过来了。叫做我的老婆80后，作为80后的我看了以后，确实有些同感<br /><img class="insertimage" src="attachment.php?fid=14" border="0" width="350" height="994" /><br /><br /><img class="insertimage" src="attachment.php?fid=15" border="0" width="350" height="994" /><br /><br /><img class="insertimage" src="attachment.php?fid=16" border="0" width="350" height="994" /><br /><br /><img class="insertimage" src="attachment.php?fid=17" border="0" width="400" height="1136" /><br /><br /><img class="insertimage" src="attachment.php?fid=18" border="0" width="28" height="30" /><br />]]></description>
	<pubDate>Fri, 25 Dec 2009 02:55:56 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Wife-80</guid>

</item>
<item>
	<title>nginx采用epoll的事件模型，为何效率高。</title>
	<link>http://xinlogs.com/nginx-epool-events</link>
	<description><![CDATA[<p>以前就知道在linux下nginx采用epoll事件模型，处理效率高。但是一直不知道具体为什么，今天查看了下文档，了解了原因。<br />首先nginx支持一下这些事件模型（才考nginx的wiki）<br /></p><p>Nginx支持如下处理连接的方法（I/O复用方法），这些方法可以通过<span style="font-family: Courier New">use</span>指令指定。 </p><ul><li><strong>select</strong> - 标准方法。 如果当前平台没有更有效的方法，它是编译时默认的方法。你可以使用配置参数 <span style="font-family: Courier New">--with-select_module</span> 和 <span style="font-family: Courier New">--without-select_module</span> 来启用或禁用这个模块。 </li><li><strong>poll</strong> - 标准方法。 如果当前平台没有更有效的方法，它是编译时默认的方法。你可以使用配置参数 <span style="font-family: Courier New">--with-poll_module</span> 和 <span style="font-family: Courier New">--without-poll_module</span> 来启用或禁用这个模块。 </li><li><strong>kqueue</strong> - 高效的方法，使用于 FreeBSD 4.1+, OpenBSD 2.9+, NetBSD 2.0 和 MacOS X. 使用双处理器的MacOS X系统使用kqueue可能会造成内核崩溃。 </li><li><strong>epoll</strong> - 高效的方法，使用于Linux内核2.6版本及以后的系统。在某些发行版本中，如SuSE 8.2, 有让2.4版本的内核支持epoll的补丁。 </li><li><strong>rtsig</strong> - 可执行的实时信号，使用于Linux内核版本2.2.19以后的系统。默认情况下整个系统中不能出现大于1024个POSIX实时(排队)信号。这种情况对于高负载的服务器来说是低效的；所以有必要通过调节内核参数 <span style="font-family: Courier New">/proc/sys/kernel/rtsig-max</span> 来增加队列的大小。可是从Linux内核版本2.6.6-mm2开始， 这个参数就不再使用了，并且对于每个进程有一个独立的信号队列，这个队列的大小可以用 RLIMIT_SIGPENDING 参数调节。当这个队列过于拥塞，nginx就放弃它并且开始使用 <span style="font-family: Courier New">poll</span> 方法来处理连接直到恢复正常。 </li><li><strong>/dev/poll</strong> - 高效的方法，使用于 Solaris 7 11/99+, HP/UX 11.22+ (eventport), IRIX 6.5.15+ 和 Tru64 UNIX 5.1A+. </li><li><strong>eventport</strong> - 高效的方法，使用于 Solaris 10. 为了防止出现内核崩溃的问题， 有必要安装 <a rel="nofollow" href="http://sunsolve.sun.com/search/document.do?assetkey=1-26-102485-1" title="http://sunsolve.sun.com/search/document.do?assetkey=1-26-102485-1" class="external text">这个</a> 安全补丁。 </li></ul><p>在linux下面，只有epoll是高效的方法。<br /><br />下面再来看看epoll到底是如何高效的<br />Epoll是<a href="http://www.hudong.com/wiki/Linux&aring;&aelig;%20&cedil;" target="_blank" title="Linux内核" class="innerlink">Linux内核</a>为处理大批量句柄而作了改进的<a href="http://www.hudong.com/wiki/poll" target="_blank" title="poll" class="innerlink">poll</a>。要使用epoll只需要这三个系统调用：epoll_create(2)， epoll_ctl(2)， epoll_wait(2)。它是在2.5.44内核中被引进的(epoll(4) is a new API introduced in Linux kernel 2.5.44)，在2.6内核中得到广泛应用。<br /><br />epoll的优点<br /></p><ul><li>支持一个进程打开大数目的<a href="http://www.hudong.com/wiki/socket" target="_blank" title="socket" class="innerlink">socket</a>描述符(FD)</li></ul><p>select 最不能忍受的是一个进程所打开的FD是有一定限制的，由FD_SETSIZE设置，默认值是2048。对于那些需要支持的上万连接数目的IM服务器来说显然太少了。这时候你一是可以选择修改这个宏然后重新编译内核，不过资料也同时指出这样会带来网络效率的下降，二是可以选择多进程的解决方案(传统的Apache方案)，不过虽然linux上面创建进程的代价比较小，但仍旧是不可忽视的，加上进程间数据同步远比不上线程间同步的高效，所以也不是一种完美的方案。不过 epoll则没有这个限制，它所支持的FD上限是最大可以打开文件的数目，这个数字一般远大于2048,举个例子,在1GB内存的机器上大约是10万左右，具体数目可以cat /proc/sys/fs/file-max察看,一般来说这个数目和系统内存关系很大。</p><ul><li>IO效率不随FD数目增加而线性下降</li></ul><p>传统的select/poll另一个致命弱点就是当你拥有一个很大的socket集合，不过由于网络延时，任一时间只有部分的socket是&quot;活跃&quot;的，但是select/poll每次调用都会线性扫描全部的集合，导致效率呈现线性下降。但是epoll不存在这个问题，它只会对&quot;活跃&quot;的socket进行操作---这是因为在内核实现中epoll是根据每个fd上面的callback函数实现的。那么，只有&quot;活跃&quot;的socket才会主动的去调用 callback函数，其他idle状态socket则不会，在这点上，epoll实现了一个&quot;伪&quot;AIO，因为这时候推动力在os内核。在一些 benchmark中，如果所有的socket基本上都是活跃的---比如一个高速LAN环境，epoll并不比select/poll有什么效率，相反，如果过多使用epoll_ctl,效率相比还有稍微的下降。但是一旦使用idle connections模拟<a href="http://www.hudong.com/wiki/WAN" target="_blank" title="WAN" class="innerlink">WAN</a>环境,epoll的效率就远在select/poll之上了。</p><ul><li>使用<a href="http://www.hudong.com/wiki/mmap" title="mmap" class="innerlink">mmap</a>加速内核与用户空间的消息传递。</li></ul><p>这点实际上涉及到epoll的具体实现了。无论是select,poll还是epoll都需要内核把FD消息通知给用户空间，如何避免不必要的内存拷贝就很重要，在这点上，epoll是通过内核于用户空间mmap同一块内存实现的。而如果你想我一样从2.5内核就关注epoll的话，一定不会忘记手工 mmap这一步的。</p><ul><li>内核微调</li></ul><p>这一点其实不算epoll的优点了，而是整个linux平台的优点。也许你可以怀疑linux平台，但是你无法回避linux平台赋予你微调内核的能力。比如，内核<a href="http://www.hudong.com/wiki/TCP/IP" target="_blank" title="TCP/IP" class="innerlink">TCP/IP</a>协议栈使用内存池管理sk_buff结构，那么可以在运行时期动态调整这个内存pool(skb_head_pool)的大小--- 通过echo XXXX&gt;/proc/sys/net/core/hot_list_length完成。再比如listen函数的第2个参数(TCP完成3次握手的数据包队列长度)，也可以根据你平台内存大小动态调整。更甚至在一个数据包面数目巨大但同时每个数据包本身大小却很小的特殊系统上尝试最新的<a href="javascript:linkredwin('NAPI');" title="NAPI" class="link_red">NAPI</a>网卡驱动架构。<br /><br /><strong>以上这些epoll内容，参考epoll_互动百科<br /><br /></strong>在我128M的vps上，我查看了一下，file-max的数量已经达到11945<br />应该说确实比apache的方式要好，而且资源占用也少。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/druapl-url-nginx-rewrite">drupal在nginx 0.8.15下的简洁URL配置</a></p><p><a href="http://xinlogs.com/nginx-301-rewrite">nginx通过301统一入口域名</a></p><p><a href="http://xinlogs.com/howto-open-rewrite-log">伪静态规则调试技巧</a></p><p><a href="http://xinlogs.com/Solve-nginx-502-mistakes">nginx通过轮询避免php-fpm引起的502错误</a></p></div>]]></description>
	<pubDate>Thu, 24 Dec 2009 15:22:36 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/nginx-epool-events</guid>

</item>
<item>
	<title>学生罚站被冻死，“死得舒坦”---山东事件</title>
	<link>http://xinlogs.com/Students-freeze-to-death</link>
	<description><![CDATA[12月18日，山东潍坊市临朐县五井中学初一学生张继鑫被发现死在校内一条排水沟里。对于学生的身亡，校方称是一起意外事故。有知情人则称，孩子被老师罚站，老师则因喝酒忘记了学生，最终孩子冻死在寒夜里。<br />校方已经对外宣称这是一起意外事故，甚至出言称学生死得很安详、舒坦。<br />一个14岁的孩子，不管犯了什么错误，也不至于是死罪。而且不管什么死法，对于一个14岁正在上学的孩子也没有安详、舒坦的说法。对于他的家人，更谈不上安详与舒坦。这些说辞完全就是推卸责任。<br />希望媒体可以持续报道，警方可以大力调查，给孩子和他的家人一个准确说法，不要让这种事情再次发生。]]></description>
	<pubDate>Wed, 23 Dec 2009 13:24:52 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Students-freeze-to-death</guid>

</item>
<item>
	<title>电影Avatar （阿凡达）</title>
	<link>http://xinlogs.com/Avatar</link>
	<description><![CDATA[<p>从看到预告片，就期待着上映了。希望北京可以早点看到<br /><br /><img class="insertimage" src="attachment.php?fid=13" border="0" width="500" height="187" /><br /><br /><img class="insertimage" src="attachment.php?fid=12" border="0" width="150" height="200" /><br /><span><span class="pl"><span style="color: #666666">编剧</span></span>: <a href="http://www.douban.com/movie/search/James%20Cameron"><span style="color: #336699">James Cameron</span></a></span><br /><span><span class="pl"><span style="color: #666666">导演</span></span>: <a href="http://www.douban.com/movie/search/James%20Cameron"><span style="color: #336699">James Cameron</span></a></span><br /><span><span class="pl"><span style="color: #666666">主演</span></span>: <a href="http://www.douban.com/movie/search/Sam%20Worthington"><span style="color: #336699">Sam Worthington</span></a> / <a href="http://www.douban.com/movie/search/Sigourney%20Weaver"><span style="color: #336699">Sigourney Weaver</span></a> / <a href="http://www.douban.com/movie/search/Michelle%20Rodriguez"><span style="color: #336699">Michelle Rodriguez</span></a> / <a href="http://www.douban.com/movie/search/Zoe%20Saldana"><span style="color: #336699">Zoe Saldana</span></a> / <a href="http://www.douban.com/movie/search/Giovanni%20Ribisi"><span style="color: #336699">Giovanni Ribisi</span></a> / <a href="http://www.douban.com/movie/search/Joel%20Moore"><span style="color: #336699">Joel Moore</span></a></span><br /></p><div class="obmo"><span class="pl"><span style="color: #666666">制片国家/地区:</span></span> 美国 / 英国<br /><span class="pl"><span style="color: #666666">官方网站:</span></span> <a rel="nofollow" href="http://www.avatarmovie.com/" target="_blank"><span style="color: #336699">http://www.avatarmovie.com/</span></a><br /><span class="pl"><span style="color: #666666">上映日期:</span></span> 2009-12-16 &gt;<a href="http://www.douban.com/subject/1652587/releaseinfo" target="_blank"><span style="color: #336699">更多</span></a><br /><span class="pl"><span style="color: #666666">语言:</span></span> 英语<br /><span class="pl"><span style="color: #666666">又名: </span></span>天神下凡 / 化身 / 异次元战神 / 神之化身<br /></div><div class="obmo"><span class="pl"><span style="color: #666666">imdb链接: </span><a href="http://www.imdb.com/title/tt0499549/" target="_blank"><span style="color: #336699">tt0499549</span></a></span><br /><br /><h2>剧情简介 &middot; &middot; &middot; &middot; &middot; &middot; </h2><div class="indent"><span style="display: none" class="short">一位战斗中负伤而下身瘫痪的前海军战士杰克&bull;萨利（萨姆&bull;沃辛顿 Sam Worthington 饰）决定替死去的同胞哥哥来到潘多拉星操纵格蕾丝博士（西格妮&bull;韦弗 Sigourney Weaver 饰）用人类基因与当地纳维部族基因结合创造出的 &ldquo;阿凡达&rdquo; 混血生物。杰克的目的是打入纳维部落，外交说服他们自愿离开世代居住的家园，从而SecFor公司可砍伐殆尽该地区的原始森林，开采地下昂贵的蓝色&ldquo;不可得&rdquo;矿。在探索潘多拉星的过程中，杰克遇到了纳维部落的公主娜蒂瑞（佐伊&bull;索尔达娜 Zoe Saldana 饰），向她学习了纳维人的生存技能与对待自然的态度。与此同时，SecFor公司的经理和军方代表上校迈尔斯（史蒂芬&bull;朗 Stephen Lang 饰）逐渐丧失耐心，决定诉诸武力驱赶纳维人&hellip;&hellip;<br />本片采用3D技术拍摄，共耗资5亿美元制作发行，是电影史上最为昂贵的作品。... <a href="javascript:void(0)" class="j a_show_full"><span style="color: #666699">(展开全部)</span></a></span> <span style="display: inline" class="all hidden">一位战斗中负伤而下身瘫痪的前海军战士杰克&bull;萨利（萨姆&bull;沃辛顿 Sam Worthington 饰）决定替死去的同胞哥哥来到潘多拉星操纵格蕾丝博士（西格妮&bull;韦弗 Sigourney Weaver 饰）用人类基因与当地纳维部族基因结合创造出的 &ldquo;阿凡达&rdquo; 混血生物。杰克的目的是打入纳维部落，外交说服他们自愿离开世代居住的家园，从而SecFor公司可砍伐殆尽该地区的原始森林，开采地下昂贵的蓝色&ldquo;不可得&rdquo;矿。在探索潘多拉星的过程中，杰克遇到了纳维部落的公主娜蒂瑞（佐伊&bull;索尔达娜 Zoe Saldana 饰），向她学习了纳维人的生存技能与对待自然的态度。与此同时，SecFor公司的经理和军方代表上校迈尔斯（史蒂芬&bull;朗 Stephen Lang 饰）逐渐丧失耐心，决定诉诸武力驱赶纳维人&hellip;&hellip;<br />本片采用3D技术拍摄，共耗资5亿美元制作发行，是电影史上最为昂贵的作品。<br /><br />《阿凡达》由好莱坞著名导演詹姆斯&middot;卡梅隆历时4年、二十世纪福斯公司耗资2亿打造。影片将于今年12月18日以2D和3D形式在全球上映。另据知情人士透露，本片已初定于明年1月2日在中国内地上映。</span></div></div>]]></description>
	<pubDate>Wed, 23 Dec 2009 01:25:58 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/Avatar</guid>

</item>
<item>
	<title>国服3.13 德鲁伊带小号快速升级（1-70全程带）</title>
	<link>http://xinlogs.com/wow-1-70-Express-Upgrade</link>
	<description><![CDATA[<p>魔兽世界已经快开85了，而国内还坚持在70级。没有玩的乐趣了，就研究研究带小号速度升级吧。</p><p><span style="font-size: large"><strong>带小号的职业选择</strong></span></p><p>一般带小号的职业，需要可以AOE，有强力的dps，最好自己还可以扛打。所以就是法师、术士、骑士、德鲁伊这几个职业里选择。</p><p>FS是AOE的王者，原来一直也是带小号的首选。目前来看也不错。但是破碎现在的效率不如以前了，STSM法师带着对操作要求太高，容易累。</p><p>SS可以AOE，但是没有FS的控制技能，怪多了，扛不住。</p><p>QS对于小副本，AOE来说很强力，尤其是学生和STSM，效率很高。但是对于ZUL这样的本，因为QS的短腿，不推荐。</p><p><strong>德鲁伊</strong>如果装备合适，目前我认为才是带小号的最佳人选。从1-70，全部有适合的副本和技巧让小德来带小号升级。下面说说我的经验</p><p>因为德鲁伊是T里面dps最高的，FS AOE靠dps，但是没有我们能抗，还要喝水。QS AOE靠反弹，没有我们能打。而且小德的移动速度快，就意味着拉同样路线的怪，我们时间少，效率高。所以对于血色、ZUL这些副本，小德效率最高。STSM不适合小德，不是不能刷，是麻烦，我们不会解疾病。</p><p>所以我带小号的路线是1-10级，小德辅助小号独立升级。10-20带影牙，20-35血色，35-45祖尔法拉克，45-65黑石塔上，65-70监狱。</p><p><span style="font-size: large"><strong>1-10级 快速升级经验</strong></span></p><p>1-10级其实有个很好的办法升级，只是大家很少注意到。</p><p>首先是70级的小德，不要和小号组队，然后洗平衡天赋最好，治疗天赋也凑合。穿上最高的法伤装备，然后给小号上荆棘术。</p><p>小号带着这个10分钟的荆棘术buff，去打怪，基本弹怪1次-3次伤害，怪就死了。完全可以自己AOE了，什么技能也不用，就跑过去普通攻击一下怪，然后继续开一下个怪，怪打你1-3下，自己就死了。这样1-10级，比去任何地方都快。</p><p><strong>注意</strong> 必须自己先打怪1下，如果是怪先打你被经技术弹死了，就没有经验了。</p><p><span style="font-size: large"><strong>10-20级 快速升级经验</strong></span></p><p>10-20级，就要去影牙副本了。大号先进入副本，因为小号级别低的时候，一进入就引怪。小号就放在副本门口就可以，大号进入副本aoe。注意最后的boss一定要拉出来杀，不然小号分不到经验。</p><p>影牙副本是一个塔的建筑结构，所以小号放在副本，大号在小地图观察，只要可以看到小号的位置，就可以杀一次怪，我一般是分3次杀。第一次拉广场上的，第2次拉到狼boss那里，就是杀了boss出先4个蓝胖子的地方。第3次拉到最后boss门前面。</p><p><span style="font-size: large"><strong>20-35级 快速升级经验</strong></span></p><p>20-35级是快速升级的开始，小德因为移动速度和dps的优势，可以在这里3门同时刷。刷2门，肯定爆本。</p><p>先刷教堂，然后出本刷军械库，最后刷次图书馆。图书馆经验不多，就是为了不爆本，凑点时间。小号愿意，也可以放弃图书馆，让他们捡些布呀什么的。</p><p>这里建议小德穿最强的DPS装备，如果网络好，不怕掉线，可以拿 烈焰之怒 武器。（俗名：掉线之怒）。武器FM推荐 作战专家</p><p><span style="font-size: large"><strong>35-45 快速升级经验</strong></span></p><p>35-45 选择祖尔法拉克最好，小德可以一波流全部拉完。一次的经验在2.8w-3.5w。这里需要一些装备和技巧。</p><p>首先最好有4件军装，这样移动速度提高15%。我尝试过，4件军装，比你骑60%速度的马还快。网上有zul的一波流视频，是个骑马拉全副本的，我觉得不现实，至少我经常拉几波，就给打下马了。所以我推荐直接穿4件军装，旅行形态拉。</p><p>再有一点就是要带上部落徽记，因为有个蜥蜴怪，可以给你一个晕的状态，让你没有任何躲闪而且不能攻击。这样基本一次就快死了。所以一定要及时用徽章解这个状态。只要保持攻击，就可以满血。我一般带英雄卡片和部落徽记。</p><p><span style="font-size: large"><strong>45-65 快速升级经验</strong></span></p><p>45-65 这里只有小德带最效率，就是去黑上升级。卡召唤师。一般卡2个召唤师，速度相当与STSM。一般卡7个召唤师的小德，带45级的小号，1个小时3级半。这里一定要舍得吃药和加buff。具体如何卡黑上，我以后会写文章介绍。目前我可以卡5-7个，成功率85%吧</p><p><span style="font-size: large"><strong>65-70 快速升级经验</strong></span></p><p>65-70就找术士拉小号去监狱，然后小德带监狱，65-70大约200分钟吧。要求小德穿DPS装备和少量回血装备。</p><p><span style="font-size: large"><strong>天赋推荐</strong></span></p><p>野德天赋。0 46 15配点。雕文用重欧 狂暴恢复<span style="font-size: 12px; color: #ffd800; font-family: Arial"><br /><br /><a href="http://www.warcraftchina.com/info/talents/druid.html?00000000000000000000000000005032321303200103531203030100020350300200000000000000000">http://www.warcraftchina.com/info/talents/druid.html?00000000000000000000000000005032321303200103531203030100020350300200000000000000000</a><br /></span></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/26">我冲高督的心得</a></p><p><a href="http://xinlogs.com/post/60">德鲁伊黑上带刷详细图文攻略 1.0版本</a></p><p><a href="http://xinlogs.com/s10-Conquest-Cap">S10赛季竞技场点数计算器</a></p><p><a href="http://xinlogs.com/druid-ubrs-quickmacro-code">野D带黑上，后台挂机按键精灵代码</a></p><p><a href="http://xinlogs.com/JJC">S9赛季征服点上限计算器</a></p></div>]]></description>
	<pubDate>Tue, 22 Dec 2009 08:26:02 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/wow-1-70-Express-Upgrade</guid>

</item>
<item>
	<title>CentOS 5.3架设VPN和619错误排除</title>
	<link>http://xinlogs.com/centos_VPN_Howto</link>
	<description><![CDATA[我买这个VPS的主机，一个目的是用来做Blog空间，另外一个就是用来跑vpn。<br />先按照<a href="http://rashost.com/blog/centos5-pptpd-vpn">http://rashost.com/blog/centos5-pptpd-vpn</a>这里的文章安装vpn服务。<br /><h2>内核支持</h2><p>pptpd VPN需要内核支持mppe，我们的VPS自带的内核已经把mppe编译进去了，没有把mppe另外当作内核的模块。</p><h2>软件安装</h2><p>要安装pptpd VPN，ppp和iptables这两个软件是必须安装的，安装命令：</p><pre>yum install -y ppp iptables</pre><p>然后到 <a href="http://www.poptop.org/" title="http://www.poptop.org/ ">http://www.poptop.org/ </a>下载pptpd的rpm包并安装，下载的时候要注意下面几点：</p><ol><li>好像只有1.3.3版本有rpm包，其他版本只有源代码 </li><li>没有el5或者centos5的rpm包，用rh4的rpm包可以安装在centos 5上 </li><li>64位的系统要下载64位的rpm包，32位的系统要下载32位的rpm包，别搞错了 </li></ol><p>64位系统安装命令：</p><p><span style="font-family: Courier New">rpm -ivh pptpd-1.3.3-1.rhel4.x86_64.rpm</span></p><p>32位系统安装命令：</p><pre>rpm -ivh pptpd-1.3.3-1.rhel4.i386.rpm</pre><p>编辑配置文件 /etc/ppp/options.pptpd 内容如下：</p><pre>name pptpd refuse-pap refuse-chap refuse-mschap require-mschap-v2 require-mppe-128 proxyarp lock nobsdcomp novj novjccomp nologfd ms-dns 208.67.222.222 ms-dns 208.67.220.220 </pre><p>编辑配置文件 /etc/pptpd.conf 内容如下：</p><pre>option /etc/ppp/options.pptpd logwtmp localip 192.168.92.1 remoteip 192.168.92.11-15</pre><p>编辑配置文件 /etc/ppp/chap-secrets,配置用户名为johndoe，密码为password，内容如下：</p><pre>johndoe pptpd password *</pre><p>修改配置文件/etc/sysctl.conf中的相应内容如下：</p><pre>net.ipv4.ip_forward = 1</pre><p>&lsquo;配置iptables:</p><pre>iptables -t nat -A POSTROUTING -o eth0 -s 192.168.92.0/24 -j MASQUERADE /etc/init.d/iptables save /etc/init.d/iptables restart</pre><p>设置iptables和pptpd开机自动启动：</p><pre>chkconfig pptpd on chkconfig iptables on</pre><p>然后运行reboot重新启动即可<br /><span style="font-size: x-large"><br />错误排除<br /></span><span style="font-size: x-small"><span style="font-size: medium">完成以上配置，通过Windows拨号到VPN，一定提示619错误。<br />引发619错误的原因有很多，比如密码不正确等，都报这个错误。<br />我们可以通过/var/log/messages查看下日志，找到问题原因</span><span style="font-size: medium"><br /></span><br />Dec 20 06:45:12 204-74-212-217 pptpd[18317]: CTRL: Client 221.223.48.186 control connection started<br />Dec 20 06:45:12 204-74-212-217 pptpd[18317]: CTRL: Starting call (launching pppd, opening GRE)<br />Dec 20 06:45:12 204-74-212-217 pppd[18318]: Plugin /usr/lib/pptpd/pptpd-logwtmp.so is for pppd version 2.4.3, this is 2.4.4<br /><span style="color: #ff0000">Dec 20 06:45:12 204-74-212-217 pptpd[18317]: GRE: read(fd=6,buffer=804e5a0,len=8196) from PTY failed: status = -1 error = Input/output error, usually caused by unexpected termination of pppd, check option syntax and pppd logs<br /></span>Dec 20 06:45:12 204-74-212-217 pptpd[18317]: CTRL: PTY read or GRE write failed (pty,gre)=(6,7)<br />Dec 20 06:45:12 204-74-212-217 pptpd[18317]: CTRL: Client 221.223.48.186 control connection finished<br /><br /><span style="font-size: medium">注意到红色部分了吧，就是这个错误。建议我们查看配置语法。<br />后来有找了一些文档查看，和一条一条屏蔽配置语法<br />发现是logwtmp这个配置选项出现问题。最后编辑/etc/pptpd.conf文件<br />注释掉logwtmp选项，重启pptpd服务，就可以正常登陆了。</span><br /><br /></span></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/ssh-login-protection-by-denyhosts">通过denyhosts保护ssh登陆</a></p><p><a href="http://xinlogs.com/post/10">怎么mount一个xen的img映像。转载</a></p><p><a href="http://xinlogs.com/linux-ddos-defender">Linux防御DDOS攻击</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/post/17">如何快速统计服务器访问量</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 02:54:28 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/centos_VPN_Howto</guid>

</item>
<item>
	<title>www.netcraft.com可以检测网站运行的操作系统和Web Server</title>
	<link>http://xinlogs.com/post/48</link>
	<description><![CDATA[<span>&nbsp; <div id="entrycns!4986F8F322CC617B!218" class="bvEntry"><div id="msgcns!4986F8F322CC617B!218" class="bvMsg"><p><a href="http://www.netcraft.com/">http://www.netcraft.com</a></p>
<p>可以通过</p>
<p><strong>What's that site running?...</strong> 查询一个网站的服务器使用的什么操作系统,Web服务器用的什么软件..</p>
<p>感觉很不错</p>
</div>
<div class="footerLinks">2007/4/12 10:13&nbsp;</div>
</div>
</span><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/monitor-network-connections-of-linux">linux网络连接数量监控</a></p><p><a href="http://xinlogs.com/post/17">如何快速统计服务器访问量</a></p><p><a href="http://xinlogs.com/tomcat-memory-check">监控tomcat内存占用</a></p><p><a href="http://xinlogs.com/monit-to-monitor-services">monit监控linux服务</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:57:28 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/48</guid>

</item>
<item>
	<title>windows下的拷贝利器teracopy</title>
	<link>http://xinlogs.com/post/47</link>
	<description><![CDATA[<div id="msgcns!4986F8F322CC617B!710" class="bvMsg"><div>周四晚上的时候，300G的硬盘在Ghost的时候，分区表损坏，导致数据全丢失了。</div><div>这两天在不停的拷贝数据，导文件。</div><div>发现windows自带的资源管理器拷贝文件的速度和稳定性都不是很好。</div><div>于是找到了一款很不错的小软件tearcopy</div><div><strong>网站</strong></div><div><a href="http://www.codesector.com/teracopy.php">http://www.codesector.com/teracopy.php</a></div><div>文件很小，大约1.5M</div><div>拷贝速度很快，我从usb设备拷贝，速度大约23M每秒。</div><div>建议拷贝多个文件或者大文件，都安装这个小软件。</div><div>下面是具体说明，我就不翻译，大家自己看看吧。很牛，还支持win7</div><p>TeraCopy is a compact program designed to copy and move files at the maximum possible speed, providing the user a lot of features: </p><ul><li><strong>Copy files faster.</strong> TeraCopy uses dynamically adjusted buffers to reduce seek times. Asynchronous copy speeds up file transfer between two physical hard drives. </li><li><strong>Pause and resume file transfers.</strong> Pause copy process at any time to free up system resources and continue with a single click. </li><li><strong>Error recovery.</strong> In case of copy error, TeraCopy will try several times and in the worse case just skips the file, not terminating the entire transfer. </li><li><strong>Interactive file list.</strong> TeraCopy shows failed file transfers and lets you fix the problem and recopy only problem files. </li><li><strong>Shell integration.</strong> TeraCopy can completely replace Explorer copy and move functions, allowing you work with files as usual. </li><li><strong>Full Unicode support.</strong> </li><li><strong>Windows 7 x64 support.</strong> </li></ul></div><div class="footerLinks">2009/8/2 22:20</div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:56:26 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/47</guid>

</item>
<item>
	<title>vista 不能自动发现无线网络的问题解决方法</title>
	<link>http://xinlogs.com/post/46</link>
	<description><![CDATA[<div id="msgcns!4986F8F322CC617B!242" class="bvMsg"><p>vista 查询无线网路需要设置成和无线路由器匹配的无线标准。否则会不能自己发现无线设备。</p><p>具体办法如下，从intel.com找来的</p><p><strong>在 Windows Vista* 上设置互联网安全无线连接参考</strong></p><p><strong><a href="http://support.intel.com/support/cn/wireless/wlan/sb/CS-025389.htm">http://support.intel.com/support/cn/wireless/wlan/sb/CS-025389.htm</a></strong></p><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><strong>在 Windows Vista* 上配置无线网卡设置</strong></td></tr></tbody></table>出自<a href="http://www.intel.com/support/cn/wireless/wlan/sb/CS-025393.htm">http://www.intel.com/support/cn/wireless/wlan/sb/CS-025393.htm</a> <table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="http://www.intel.com/sites/templates/pix/circuit388.gif" border="0" width="388" height="5" /></td></tr><tr><td height="10">&nbsp;</td></tr></tbody></table><table border="0" cellspacing="10" cellpadding="0"><tbody><tr><td><p>Windows Vista* 提供多种访问高级网卡设置的方法。</p><ol><li>开始 &raquo; 控制面板 &raquo; 系统与维护 &raquo; 系统 &raquo; 设备管理器 &raquo; 展开右窗格中的网络适配器 &raquo; 高亮显示并右键单击无线网卡 &raquo; 属性 &raquo;&ldquo;高级&rdquo;选项卡 </li><li>右键单击桌面上的&ldquo;我的电脑&rdquo;图标 &raquo; 单击&ldquo;管理&rdquo;&raquo; 高亮显示&ldquo;设备管理器&rdquo;&raquo; 展开右窗格中的网络适配器&rdquo;&raquo; 高亮显示并右键单击无线网卡 &raquo; 属性 &raquo;&ldquo;高级&rdquo;选项卡 </li><li>开始 &raquo; 控制面板 &raquo; 网络与互联网 &raquo; 网络与共享中心 &raquo; 管理无线网络 &raquo; 适配器属性 &raquo; 配置 &raquo;&ldquo;高级&rdquo;选项卡 </li><li>开始 &raquo; 网络 &raquo; 网络与共享中心 &raquo; 管理无线网络 &raquo; 适配器属性 &raquo; 配置 &raquo;&ldquo;高级&rdquo;选项卡 </li><li>右键单击&ldquo;系统托盘&rdquo;图标（屏幕右下角的 2 个计算机显示器图像）&raquo; 网络与共享中心 &raquo; 管理无线网络 &raquo; 适配器属性 &raquo; 配置 &raquo;&ldquo;高级&rdquo;选项卡<br /><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1mnvDQEwCXXvFAWFU15DLRtpM5_5gXS7whRSnsNjzWbYm4ESp9u6ldEWtaHvY-VTsHh6xussXsnTorLSwJbseHsDG562jrtIjIDwHM7SY8v1ebjt69KwR8JIQAJMhkXdGzkCXyDMWbIqX3JFkJ6a0Nzw/advancedtabwindow[2].jpg"><img style="display: inline; border-width: 0px" src="https://s9rh2g.blu.livefilestore.com/y1mDvYfLVUPBUcmyVEGzMCPnPWqqVKEQkG64sPzcnAJx7kY3N5-pT-MZRmc4xsorOIFmYZsT3DdU0pGzaSG2wEIwpoptV2lDmNQkH5vSrDK5oyOxkOC8IhobN_i1DFJDIxWT7GAsbjlOurYvUPfo8bwBg/advancedtabwindow_thumb.jpg" border="0" alt="advancedtabwindow" title="advancedtabwindow" width="220" height="244" /></a> </li></ol></td></tr></tbody></table><strong>802.11n 信道宽度：</strong>缺省值是自动（20 或 40 MHz，根据网卡连接的是无线接入点（AP）还是路由器而定）。 用户也可以将其更改为&ldquo;仅 20 MHz&rdquo;。 注： 仅英特尔&reg; 无线 WiFi 链接 4965AGN 提供此功能。<br /><strong><br />802.11n 模式：</strong> 启用缺省值。 如果选择&ldquo;禁用&rdquo;将仅使用数据传输速率很低的 802.11b/g。 如果用户知道周围没有 802.11n 接入点或路由器，则可以禁用此模式。 注： 仅英特尔&reg; 无线 WiFi 链接 4965AGN 提供此功能。<br /><strong><br />Ad Hoc 信道 802.11 b/g：</strong> 缺省信道是 11。可以在使用这些频率的国家配置信道 1-11。 在其它地区可配置 1-13 或 1-14。请根据适配器 SKU 进行选择。<br /><strong><br />Ad Hoc 缺省无线模式：</strong> 缺省值是 802.11b/g。也可选择 802.11a。 Ad Hoc 网络（对等网络）是用户在不使用接入点或路由器的情况下为直接相互连接各个网络而创建的临时无线网络。<br /><strong><br />Ad Hoc 电源管理：</strong>缺省值是&ldquo;禁用&rdquo;。 仅使用电池电源时，用户还可以选择&ldquo;最大节能&rdquo;。 如果用户位于&ldquo;嘈杂的&rdquo;射频环境中，要求适配器始终保持在唤醒状态，则可使用&ldquo;噪音环境&rdquo;。 只有连接电源插座时才能使用这种设置。<br /><strong><br />Ad Hoc QoS 模式：</strong> 缺省值是禁用 WMM；在接入点或路由器提供支持并且计算机应用程序可实现该功能时用户才能启用它。 WMM*（Wi-Fi 多媒体）是根据服务质量标准 IEEE* 802.11e* 创建的一种方法，它按优先顺序排列各种传输类型以提高总体质量： 声音、视频、音频和数据。<br /><strong><br />混合模式保护：</strong> 缺省值是 CTS-to-self Enabled。 备用值是 CTS/RTS Enabled。 用于在 802.11b/802.11g 混合环境中避免发生数据冲突。 CTS-to-Self 可用于在客户机相距距离较近并可相互临听的环境中提高传输量。 RTS/CTS 在客户机不能进行相互临听的区域里使用。<br /><strong><br />漫游积极程度：</strong> 缺省值是&ldquo;中等&rdquo;： 不漫游和漫游之间的平衡设置。 您也可以选择&ldquo;最低&rdquo;、&ldquo;中下&rdquo;、&ldquo;中上&rdquo;和&ldquo;最高&rdquo;。 此设置允许您定义无线客户机漫游的积极程度，以提高连接接入点或路由器的能力。 最低： 您的无线客户机不会漫游到其它接入点或路由器。 只有当链接质量严重下降时，才会漫游到其它接入点。<br /><strong><br />提高传输量：</strong>缺省值是&ldquo;禁用&rdquo;。 启用该值时可通过启用包突发功能提高传输量。 在相对安静的家庭或小型办公室设置中，可能最不需要启用这种功能。<br /><strong><br />传输功率：</strong> 缺省值是&ldquo;最高&rdquo;。 降低传输功率后会降低无线电覆盖范围。 您也可以选择&ldquo;最低&rdquo;、&ldquo;中下&rdquo;、&ldquo;中等&rdquo;和&ldquo;中上&rdquo;。<br /><strong><br />无线模式：</strong> 对于英特尔无线 WiFi 链接 4965AGN，缺省值是 802.11a/b/g。 是使用缺省值还是其它值取决于系统配备的适配器。 选择接入无线网络所使用的波段。 无线模式（调制类型）决定了网卡范围内可发现的接入点或路由器。 <p></p><p><strong>操作系统：</strong><br /><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td style="font-size: 75%">Windows Vista Starter，32 位版本、Windows Vista Home Basic，32 位版本、Windows Vista Home Premium，32 位版本、Windows Vista Business，32 位版本、Windows Vista Enterprise，32 位版本、Windows Vista Ultimate，32 位版本、Windows Vista Home Basic，64 位版本、Windows Vista Home Premium，64 位版本、Windows Vista Business，64 位版本、Windows Vista Enterprise，64 位版本、Windows Vista Ultimate，64 位版本</td></tr></tbody></table></p><p><strong>适用于：</strong> <table border="0" cellspacing="15" cellpadding="0"><tbody><tr><td bgcolor="#ff9900"><table border="0" cellspacing="1" cellpadding="5"><tbody><tr><td width="300" valign="top" style="font-size: 75%" bgcolor="#ffffff"><a href="http://www.intel.com/support/cn/wireless/wlan/pro3945abg/index.htm">英特尔&reg; PRO/无线 3945ABG 网卡</a><br /><a href="http://www.intel.com/support/cn/wireless/wlan/pro2100/index.htm">英特尔&reg; PRO/无线 2100 网卡</a><br /><a href="http://www.intel.com/support/cn/wireless/wlan/pro2200bg/index.htm">英特尔&reg; PRO/无线 2200BG 网卡</a></td><td width="300" valign="top" style="font-size: 75%" bgcolor="#ffffff"><a href="http://www.intel.com/support/cn/wireless/wlan/pro2915abg/index.htm">英特尔&reg; PRO/无线 2915ABG 网卡</a><br /><a href="http://www.intel.com/support/cn/wireless/wlan/4965agn/index.htm">英特尔&reg; 无线 WiFi 链接 4965AGN</a></td></tr></tbody></table></td></tr></tbody></table></p></div><div class="footerLinks">2007/12/14 10:43&nbsp;</div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:55:56 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/46</guid>

</item>
<item>
	<title>一款匿名浏览器--XeroBank Browser</title>
	<link>http://xinlogs.com/post/45</link>
	<description><![CDATA[<p>XeroBank Browser 用来上网，可以很好的隐藏你的ip地址。</p><p>利用Tor(The Onion Router)可以自动通过多层代理跳转，来隐藏你的IP</p><p>因为是通过代理的，所以速度肯定要慢一些。但可以访问一些国内封锁的IP地址</p>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:55:10 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/45</guid>

</item>
<item>
	<title>Vista 太慢了，决定放弃使用她的念头了</title>
	<link>http://xinlogs.com/post/44</link>
	<description><![CDATA[<div id="msgcns!4986F8F322CC617B!226" class="bvMsg"><p>居然1G内存</p><p>酷睿双核处理器</p><p>使用起来还是会很慢</p><p>不知道是我没有优化，或者配置的不对？</p><p>还是本来就不快？</p><p>总之放弃了，还是用winxp了，以后成熟些再说</p></div><div class="footerLinks">2007/4/27 10:23</div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:54:38 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/44</guid>

</item>
<item>
	<title>解决explorer cpu占用率高的一些办法</title>
	<link>http://xinlogs.com/post/43</link>
	<description><![CDATA[<div id="msgcns!4986F8F322CC617B!222" class="bvMsg"><p><strong>1 将zipfldr.dll注销掉</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp; regsvr32 c:&#92;windows&#92;system32&#92;zipfldr.dll /u</p><p><strong>2 关闭avi预览</strong></p><p><strong>&nbsp;&nbsp;&nbsp;</strong>regsvr32 shmedia.dll /u</p><p>经过上面两步，应该可以减少explorer的cup占用率了。以后如果需要用上面的功能，再按照下面步骤打开</p><p><strong>恢复上面功能</strong></p><p><strong>&nbsp;&nbsp;</strong>regsvr32 c:&#92;windows&#92;system32&#92;zipfldr.dll </p><p><strong>&nbsp;&nbsp;&nbsp;</strong>regsvr32 shmedia.dll</p></div><div class="footerLinks">2007/4/19 10:17&nbsp;</div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:54:03 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/43</guid>

</item>
<item>
	<title>从百度空间转移到spaces live</title>
	<link>http://xinlogs.com/post/42</link>
	<description><![CDATA[<div id="msgcns!4986F8F322CC617B!651" class="bvMsg"><p>本来打算购买一个在美国的VPS，来自己架设个blog程序用的，但是老婆说我太糟蹋钱了，不让玩。只好选择live spaces的25G免费空间了。</p><p>为了这次转移，我写了一个小程序帮忙。</p><p>现在已经把原来<a href="http://hi.baidu.com/babodx">http://hi.baidu.com/babodx</a>的博客内容全部搬到了<a href="http://babodx.spaces.live.com/">http://babodx.spaces.live.com</a></p><p>而且还申请了一个域名玩，可以直接通过<a href="http://www.xinlogs.com/">www.xinlogs.com</a>访问</p><p>这次域名是在<a href="http://www.namecheap.com/">www.namecheap.com</a>直接用美元买的，据说这样比较保险。国内的域名服务商信誉很差。</p><p><strong>转移步骤</strong></p><p>我的想法是先用一个程序把百度空间上，我的博客全部保存到本地。然后在用个程序把保存下来的内容发送到spaces live上，就完成了转移。</p><h1><strong>一、将百度空间的博客保存到本地</strong></h1><p>首先用程序抓取百度空间的博客内容</p><p>这个程序并不完全是我自己写的，我参考了很多人的文章和程序。参考如下</p><h4><a href="http://www.agileprogrammer.com/dotnetguy/articles/BlogImporterInRuby.aspx">Blog Importer in Ruby</a></h4><h4><a href="http://crafterm.net/blog/articles/2006/09/22/blog-content-migration-from-movabletype-to-typo-using-xml-rpc">Blog content migration from MovableType to Typo using XML-RPC</a></h4><p><a href="http://cxc200026.blog.163.com/blog/static/342686720092895235567/">lsblog的改进版本</a></p><p>根据前人的经验，我写了一个程序，根据用户名抓取百度空间的博客，然后保存为用户名.xml文件</p><p>文件格式如下</p><p><a href="http://babodx.spaces.live.com/default.aspx?_c01_BlogPart=blogentry&amp;_c=BlogPart&amp;handle=cns!4986F8F322CC617B!651#">-</a> &lt;baidu_space total=&quot;<strong>70</strong>&quot; id=&quot;<strong>babodx</strong>&quot; pagecnt=&quot;<strong>7</strong>&quot;&gt; </p><p><a href="http://babodx.spaces.live.com/default.aspx?_c01_BlogPart=blogentry&amp;_c=BlogPart&amp;handle=cns!4986F8F322CC617B!651#">-</a> &lt;page blogcnt=&quot;<strong>10</strong>&quot; index=&quot;<strong>0</strong>&quot;&gt; </p><p><a href="http://babodx.spaces.live.com/default.aspx?_c01_BlogPart=blogentry&amp;_c=BlogPart&amp;handle=cns!4986F8F322CC617B!651#">-</a> &lt;item href=&quot;<strong>http://hi.baidu.com/babodx/blog/item/fb1ebcb14ea2075d08230218.html</strong>&quot;&gt; </p><p>&lt;date&gt;2009-07-12 00:23&lt;/date&gt; </p><p>&lt;title&gt;ubuntu server 9.04 终端乱码问题&lt;/title&gt; </p><p>&lt;category&gt;Linux&lt;/category&gt; </p><p>&lt;body&gt;&lt;p&gt;安装了ubuntu server 9.04，安装的时候选择了中文环境。&lt;/p&gt; &lt;p&gt;因为server是没有桌面的，发现终端里面显示提示信息，出错信息都变成乱码了。&lt;/p&gt; &lt;p&gt;解决办法&lt;/p&gt; &lt;p&gt;修改/etc/default/locale文件&lt;/p&gt; &lt;p&gt;将zh_CN修改为en_US&lt;/p&gt;&lt;/body&gt; </p><p>&lt;/item&gt; </p><p>用ｉｔｅｍ标签来包含每个博客，用date,title,category,body分别代表发表时间、标题、分类、内容。 </p><p>RUBY代码主要参考了lsblog的改进版。 </p><p><a href="http://cid-4986f8f322cc617b.skydrive.live.com/self.aspx/.Public/saveblog.rb">savelog.rb</a>下载 </p><p>只要提供用户名，就可以将全部博客保存为ｘｍｌ文件 </p><p><strong>二、将本地保存的xml文件，上传到spaces live空间</strong> </p><p>这里遇到很多麻烦，以至最终这部分没有能用程序实现。 </p><p>我的想法是用ruby调用metaweblog api接口来发送blog到spaces live空间 </p><p>可以参考 </p><p><a href="http://msdn.microsoft.com/en-us/library/bb259702.aspx">Windows Live Spaces MetaWeblog API</a> </p><p>后来发送简单的文本已经可以实现了。但是问题出在对ｂｏｄｙ的处理，从百度空间抓过来的ｂｏｄｙ是ｈｔｍｌ代码，里面包含了文章和图片的引用。 </p><p>如果直接用ＭｅｔａＷｅｂｌｏｇ　ＡＰＩ发送，这些ｈｔｍｌ就直接显示在ｂｌｏｇ上面了，而不是应该有的格式。 </p><p>我查看了一些文档，也没有找到解决办法，因而只要放弃了。 </p><p>后来是手动通过live writer把本地的blog.xml发送到live spaces空间的。那个累呀。。。。 </p><p><strong>待解决问题</strong> </p><p><strong>一是如何让程序自动发送html格式的blog内容到live spaces空间。</strong> </p><p><strong>二是如何处理博客里面的图片，原来图片都是放在百度空间的，如果在live spaces引用，会出现错误。</strong> </p><p><strong>ruby可以直接从百度抓图片，问题还是如何上传到live spaces</strong> </p></div><div class="footerLinks">2009/7/17 16:00&nbsp;</div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:53:09 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/42</guid>

</item>
<item>
	<title>rails配合fckeditor实现文本编辑工具条</title>
	<link>http://xinlogs.com/post/41</link>
	<description><![CDATA[<div id="msgcns!4986F8F322CC617B!225" class="bvMsg"><p>主要参考了<br />
<a href="http://blog.caronsoftware.com/articles/2006/08/07/fckeditor-plugin-for-rails">http://blog.caronsoftware.com/articles/2006/08/07/fckeditor-plugin-for-rails</a><br />
<a href="http://www.blogjava.net/rocky/archive/2006/11/04/rails-fckeditor-integration.html">http://www.blogjava.net/rocky/archive/2006/11/04/rails-fckeditor-integration.html</a></p>
<p><strong>安装</strong></p>
<p>下载<a href="http://rubyforge.org/projects/fckeditorp/">http://rubyforge.org/projects/fckeditorp/</a>项目的 FCKEditor Plugin for Rails，将下载的文件加压缩后，保存到fckeditor文件夹中</p>
<p>将fckeditor文件夹拷贝到自己项目的vendor/plugins目录下</p>
<p>运行rack fckeditor:install</p>
<p>然后在需要用到这个插件的页面，输入&lt;%= javascript_include_tag "fckeditor/fckeditor" %&gt;或者将这句话添加到app/view/layouts/下的对应文件中</p>
<p><strong>使用</strong></p>
<p>需要使用这个工具条的地方，输入</p>
<p>&lt;%=fckeditor_textarea("post", "body", :toolbarSet =&gt; 'Simple', :width =&gt; '100%', :height =&gt; '500px' )%&gt;</p>
<p>注意fckeditor_textarea的一个参数post必须是action传过来的一个实体类，如果action没有传过来，就会提示出错</p>
<p>比如我这里用到了post,我的action如下</p>
<p>def new<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @post = Post.new<br />
&nbsp;&nbsp;&nbsp; end</p>
<p>第二个参数，body对应表单里的字段</p>
<p>第三个参数toolbarSet=&gt;"Simple"为工具条风格，这个风格可以在public/javascripts/fckcustom.js文件里面定义（修改后，要关闭浏览器再开才起作用）</p>
<p>第四、五个参数，代表文本区域的大小</p>
<p><strong>图片上传</strong></p>
<p>默认安装后，图片上传不能用，需要修改vendor/plugins/fckeditor/app/controllers/fckeditor_controller.rb文件的upload_file action如下</p>
<p>def upload_file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @new_file = params[:NewFile]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @url = upload_directory_path<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; begin<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ftype = @new_file.content_type.strip<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ! MIME_TYPES.include?(ftype)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @errorNumber = 202<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; puts "#{ftype} is invalid MIME type"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; raise "#{ftype} is invalid MIME type"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; path = current_directory_path + "/" + @new_file.original_filename<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File.open(path,"wb",0664) do |fp|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileUtils.copy_stream(@new_file, fp)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @errorNumber = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rescue =&gt; e<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @errorNumber = 110 if @errorNumber.nil?<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end<br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Fix provided by Nicola Piccinini -- <a href="http://superfluo.org/">http://superfluo.org</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; render :text =&gt; %Q'&lt;script&gt;window.parent.OnUploadCompleted(<a href="mailto:#{@errorNumber}, &quot;#{UPLOADED+&quot;/&quot;+params[:Type]+&quot;/&quot;+@new_file.original_filename} &quot;);&lt;/script&gt; ">#{@errorNumber},\"#{UPLOADED+"/"+params[:Type]+"/"+@new_file.original_filename}\");&lt;/script&gt;'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp; end</p>
<p>关于工具条具体某个工具怎么显示，提供那些功能，可以在public/javascripts/fckeditor/fckconfig.js文件里面定义</p>
</div>
<div class="footerLinks">2007/4/27 10:21</div><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/ruby_import_dbf_to_mysql">ruby将DBF文件导入MYSQL库</a></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/post/40">rails实现图片验证码</a></p><p><a href="http://xinlogs.com/post/36">学习Ruby中......</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:52:26 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/41</guid>

</item>
<item>
	<title>rails实现图片验证码</title>
	<link>http://xinlogs.com/post/40</link>
	<description><![CDATA[<p>写在了babo.javaeye.com了</p>
<p><a href="http://babo.javaeye.com/blog/72298">http://babo.javaeye.com/blog/72298</a></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/ruby_import_dbf_to_mysql">ruby将DBF文件导入MYSQL库</a></p><p><a href="http://xinlogs.com/post/41">rails配合fckeditor实现文本编辑工具条</a></p><p><a href="http://xinlogs.com/post/36">学习Ruby中......</a></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:51:52 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/40</guid>

</item>
<item>
	<title>rails下使用sqlite3</title>
	<link>http://xinlogs.com/post/39</link>
	<description><![CDATA[<div id="msgcns!4986F8F322CC617B!223" class="bvMsg"><p>参考<a href="http://wiki.rubyonrails.org/rails/pages/HowtoUseSQLite">http://wiki.rubyonrails.org/rails/pages/HowtoUseSQLite</a></p><p><strong>安装SQLite</strong></p><p>SQLite 是一个轻量级的sql风格数据库.可以执行大部分sql92标准</p><p>SQLite全部安装只有244kb,包括命令行客户端和DLL文件</p><p>SQLite不用安装服务进程，就像Access数据库一样使用方便</p><p>安装只需要2个文件</p><ol><li>SQLite <span>DLL</span> </li><li>SQLite command-line client for creating tables </li></ol><p><span style="font-family: 新宋体"><span style="font-family: Arial">添加</span>sqlite3.exe</span> 和<span style="font-family: 新宋体">sqlite3</span><span style="font-family: Courier New">.dll</span> 到系统的path下，我放在了c:&#92;windows&#92;system32下了</p><p><strong>安装sqlite3-ruby.gem</strong></p><p>gem install sqlite3-ruby</p><p>Attempting local installation of 'sqlite3'<br />Local gem file not found: sqlite3*.gem<br />Attempting remote installation of 'sqlite3'<br />Select which gem to install for your platform (i386-mswin32)<br />1. sqlite3-ruby 1.1.0 (mswin32)<br />2. sqlite3-ruby 1.1.0 (ruby)<br />3. sqlite3-ruby 1.0.1 (ruby)<br />...<br />&gt;<br /><br />选择 1 安装sqlite3-ruby 1.1.0(mswin32) </p><p>现在好像2才是sqlite3-ruby 1.1.0(mswin32),总之选择(mswin32)就对了</p><p><strong>安装图像管理工具（也可以不用，直接用命令行也很方便）</strong></p><p><a href="http://sqlitebrowser.sourceforge.net/">http://sqlitebrowser.sourceforge.net/</a></p><p><strong>创建数据库</strong></p><p>进入项目所在目录，比如我的项目是testsql</p><p>d:&#92;work&#92;testsql&gt;sqlite db&#92;test.db</p><p>上面命令就在db目录下，创建了一个test.db数据库</p><p><strong>配置database.yml文件，访问test.db数据库</strong></p><p>development:<br />&nbsp;&nbsp; adapter: sqlite3<br />&nbsp;&nbsp; database: db/test.db</p><p>&nbsp;&nbsp; #username: root<br />&nbsp;&nbsp; #password: <br />&nbsp;&nbsp; #host: localhost</p><p>后面如何操作，就和使用mysql数据库一样了。</p><p>建立数据表可以用db:migrate来完成</p></div><div class="footerLinks">2007/4/19 10:19&nbsp;</div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:51:20 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/39</guid>

</item>
<item>
	<title>rails下上传文件并且解决乱码问题</title>
	<link>http://xinlogs.com/post/38</link>
	<description><![CDATA[<div id="msgcns!4986F8F322CC617B!220" class="bvMsg"><p>这个问题是我在<a href="http://www.javaeye.com/">www.javaeye.com</a>论坛上提出的，并且由mathsfan给出了解决办法</p><p>首先创建一个项目，叫<strong>test</strong></p><p>在app目录下的controllers目录下，找到<strong>test_controller.rb</strong>文件</p><p>添加一个upload的action</p><p>def upload</p><p>end</p><p>然后在view目录下的test目录下，创建一个<strong>upload.rhtml</strong>文件</p><p>&lt;%=form_tag(&#123;:action=&gt;'save'&#125;,:multipart=&gt;true)%&gt;<br />&lt;br/&gt;<br />upload your file:&lt;%=file_field(&quot;file&quot;,&quot;file&quot;)%&gt;<br />&lt;br/&gt;<br />&lt;%=submit_tag(&quot;upload&quot;)%&gt;<br />&lt;%=end_form_tag%&gt;<br /></p><p>现在访问<a href="http://localhost:3000/test/upload">http://localhost:3000/test/upload</a>，应该可以看到一个上传的界面了。不过还没有处理上传后的方法呢，所以还不能实现上传。因为上面的表单是提交给save这个action 的，现在还没有写呢。在写save之前，先要完成一些相关的方法</p><p>在<strong>application.rb</strong>文件里，加入</p><p>def uploadFile(file) #处理上传后的文件保存<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if !file.original_filename.empty? <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #生成一个随机的文件名 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @filename=getFileName(file.original_filename) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #向dir目录写入文件 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File.open(&quot;#&#123;RAILS_ROOT&#125;/public/images/#&#123;@filename&#125;&quot;, &quot;wb&quot;) do &#124;f&#124; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; f.write(file.read) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #返回文件名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return @filename <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end <br />end <br /><br />def getFileName(filename) #获取文件名<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if !filename.nil? <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return filename <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end <br />end </p><p>现在在<strong>test_controller.rb</strong>里写出save的action</p><p>def save <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unless request.get? <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if filename=uploadFile(params[:file]['file']) #调用<strong>application.rb</strong>里写的uploadFile对文件保存<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; render :text=&gt;filename <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end <br />end </p><p>文件可以正确上传到public/images下 <br />但是中文文件名变为了乱码,但是render :text=&gt;filename返回的名字,并不是乱码. </p><p><strong>解决办法</strong></p><p>在ApplicationController加上： <br />before_filter:set_charset <br />def set_charset <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @headers[&quot;Content-Type&quot;]=&quot;text/html;charset=gb2312&quot; <br />end <br />我试验了一下，用utf8也可以正常处理,比如按照如下写法 <br />def set_charset <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @headers[&quot;Content-Type&quot;]=&quot;text/html;charset=utf8&quot; <br />end </p></div><div class="footerLinks">2007/4/18 10:16&nbsp;</div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:50:41 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/38</guid>

</item>
<item>
	<title>Rails下request.raw_post的一些问题</title>
	<link>http://xinlogs.com/post/37</link>
	<description><![CDATA[<div id="msgcns!4986F8F322CC617B!219" class="bvMsg"><p>我在学习Agile Web Development with Rails</p><p>在第18章 Observers的例子中</p><p>&lt;%=text_field_tag :search%&gt;&lt;div id=&quot;results&quot;&gt;&lt;/div&gt;<br />&lt;%=observe_field(:search,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :frequency =&gt; 0.5,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :update =&gt; :results,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :url =&gt; &#123;:action =&gt; :search&#125;)%&gt;</p><p>将text_field_tag里面的内容，每间隔0.5就提交给search这个action,然后将结果显示在&lt;div id=&quot;results&quot;&gt;&lt;/div&gt;层</p><p>在search方法里面可以通过request.raw_post获取提交的数据</p><p>def search<br />&nbsp;&nbsp;&nbsp;&nbsp; render:text=&gt;request.raw_post&nbsp;&nbsp;&nbsp;<br />end</p><p>问题是上面这样返回的内容，总是在提交的内容后多一个=号</p><p>比如在文本框输入a</p><p>div层显示的就是a=</p><p>后来只能通过把最后2位抹去，来达到正常效果</p><p>render:text=&gt;request.raw_post.to(request.raw_post.length-2)</p></div><div class="footerLinks">2007/4/17 10:14&nbsp;</div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:50:07 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/37</guid>

</item>
<item>
	<title>学习Ruby中......</title>
	<link>http://xinlogs.com/post/36</link>
	<description><![CDATA[<h4 class="beTitle">学习Ruby中......</h4>
<div id="msgcns!4986F8F322CC617B!212" class="bvMsg"><p>终于拿到了Programming Ruby 中文第2版.开始认真学习Ruby</p>
<p>不过感觉翻译的不是很好</p>
<p>而且有网友已经整理了勘误表</p>
<p><a href="http://blogs.sun.com/yongsun/entry/programming_ruby_ç¬¬äºç_ä¸­æç_åè¯¯">http://blogs.sun.com/yongsun/entry/programming_ruby_%E7%AC%AC%E4%BA%8C%E7%89%88_%E4%B8%AD%E6%96%87%E7%89%88_%E5%8B%98%E8%AF%AF</a></p>
<p>我在阅读的时候,也发现了一些翻译的不是很明白的地方</p>
<p><span style="color:#ff0000;">16页 第2章 2.3</span></p>
<p><span style="color:#3366ff;">Ruby的数组(arrays)和散列表(hashes)是<span style="color:#ff0000;">被索引的收集</span>.(indexed collections)</span></p>
<p><span style="color:#3366ff;">原文:Ruby's arrays and hashes are indexed collections</span></p>
<p><span style="color:#000000;">我感觉这句话的意思应该是说:Ruby的数组和哈希表是有(被)索引的集合</span></p>
<p>在后面的哈希表里面,也有讲解</p>
<p>Hashes (some times known as associative arrays, maps,or dictionaries) are similar to<br />
arrays in that they are indexed collections of object references.</p>
<p>哈希表(有时也称关系数组,映射或者词典) 和数组的相似之处是他们都是有(被)索引的对象引用的集合</p>
<p></p>
<p></p>
<p><span style="color:#ff0000;">45页 第4章 4.1 倒数第8行</span></p>
<p><span style="color:#3366ff;">使用这些方法,你可以用数组来实现栈(stack),<span style="color:#ff0000;">收集(set),</span>队列(queue),双向队列(dequeue)和先进先出队列(fifo)</span></p>
<p><span style="color:#3366ff;">原文:Using these,you can treat arrays as stacks,sets,queues,dequeues,and fifos</span></p>
<p><span style="color:#3366ff;"><span style="color:#000000;">我感觉这里的set应该是集合,就是说可以用数组实现集合<br />
</span></span></p>
</div>
<div class="footerLinks">2007/4/3 10:07&nbsp;</div><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/post/41">rails配合fckeditor实现文本编辑工具条</a></p><p><a href="http://xinlogs.com/post/40">rails实现图片验证码</a></p><p><a href="http://xinlogs.com/ruby_import_dbf_to_mysql">ruby将DBF文件导入MYSQL库</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:49:38 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/36</guid>

</item>
<item>
	<title>5v5打到1600+了，庆祝一下！</title>
	<link>http://xinlogs.com/post/35</link>
	<description><![CDATA[<p>今天5v5我们上1600了。庆祝下。</p><p></p><div><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1mdls_ukvabgnxXwuPxYkKNE2D5CBvzJqfNKNrxzGiDCrsDKdug5TwkN4R0ahloBM0WgmYCfgt7bZ_l45GBqLjGS8HhElp1Fo-RYvuPLDCfL3jtsKuTSQr_uBIJl9b6K8Et1iiE-spuWKtm9BlGJIIJQ/a916a023bde9d453ac34de69[3].jpg"><img style="display: inline; border-width: 0px" src="https://s9rh2g.blu.livefilestore.com/y1maCQtN5j51APLHSJV_s53OH0X0qSkb6RW5F5kOS88fc_8fgoDKaVrvVB6H2aVlbcIYtPrLdXa-pwSUSxeO9sftlST6zaBXQ3qyr0smnKdKIKmbd5uaj8dJqvrln5cMHLhRgDBt-H8VGpB1rHJORSing/a916a023bde9d453ac34de69_thumb[1].jpg" border="0" alt="a916a023bde9d453ac34de69" title="a916a023bde9d453ac34de69" width="644" height="404" /></a> </div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:48:56 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/35</guid>

</item>
<item>
	<title>有想恶补三角函数的冲动！</title>
	<link>http://xinlogs.com/post/34</link>
	<description><![CDATA[<p>最近在咕哝魔兽世界的坐标系统，发现这个游戏的坐标系统如下图所示</p><p></p><div><p><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1m202XWEWJrczUpXVTU-FLXjk_zXdj7kH13xtPJFE8IjYU2KP1GjiHjWy4mzjo2LPzPwOfoRgaGxvSczvlSuB42hlyCPstYteHroS827iJNVnYHpA_p4VDrTQA3P0npChOKSZMA9Ip61d9EOTdsNMbgQ/b41e98ec8bf43e3363d09fd9.png"><img style="display: inline; border-width: 0px" src="https://s9rh2g.blu.livefilestore.com/y1mulQ9oOAei5EE3ZXNVZ633iuoXFtxvD9q90AchB0ouZX5DBlMCAl-lOKTy6ce9kIg9vCk4QmC21WTYW_TYERq1gdzVSjRJy_9QqGte3Ze8G1ubeH5p48lv4XSrGCIp_nbxZanmzAexD6fESnpC_Hs0g/b41e98ec8bf43e3363d09fd9_thumb.png" border="0" alt="b41e98ec8bf43e3363d09fd9" title="b41e98ec8bf43e3363d09fd9" width="244" height="236" /></a> </p><p>游戏的平面坐标为X,Y,用2&pi;代表360度的方向。Z为高度，我们可以不用考虑。</p><p>现在如果我们知道A点坐标X=2,Y=2 ，B点坐标X=4,Y=3</p><p>那要想从A点出发到B点，我们的方向应该是多少呢？</p><p>(目前我就知道Y轴正方向的话，角度为0 。X轴正方向 为&pi;/4=90度)</p><p>该怎么写这个三角函数得到这个角的的数值呢？</p><p></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:48:29 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/34</guid>

</item>
<item>
	<title>魔兽世界内存分析，基于wow 2.4.2</title>
	<link>http://xinlogs.com/post/33</link>
	<description><![CDATA[<p>今天基于wow 2.4.2分析了下魔兽世界的内存，并做了如下软件。</p><p></p><div><p><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1mNTYOPFHS4LHxnTYhISWJpFa6WtmxhMa--CVTdaUHjO5uchM7Ls06zF0HfJ57j3YZ_h-aai5U5aaEE2W5e-IzGiGz27hJXMHCbcUjsqxnZ5y7LD_E3bq8P2UwAquaKfHZklGV3D8ZmRKSTJPTYeUZFg/d7cf3df35d9e90d80b46e04e[2].gif"><img style="display: inline; border-width: 0px" src="https://s9rh2g.blu.livefilestore.com/y1mAup-oXkXHMmd-34Pn_REeHzGOnNdBo_esFlt-wjsGTT4ald5KOw8yim3-B1jJgeoZ0wudmxZBsZm2XN_-cj1EfpjWBO2vUvW2dGwF6wXG2sViPcSUsD2p2wlpeUMAlFcxbu1LmuvUDJf0s30G_bvtw/d7cf3df35d9e90d80b46e04e_thumb.gif" border="0" alt="d7cf3df35d9e90d80b46e04e" title="d7cf3df35d9e90d80b46e04e" width="240" height="240" /></a> </p><p>全部采用C#编写，实现如下功能</p><p>加速3.5%.--（这个服务器有限制，超过4%就掉线）。这个加速是修改人物速度出来的，和那些变速齿轮不一样。这样修改后，别人看你的速度也是正常的，就好像你穿了加速的鞋子一样。</p><p>无阻力爬山--只要不是90度的山，多陡都能爬上去。</p><p>超级跳--可以让跳跃的高度自己设置</p><p>Z+--直接传送到任意高度</p><p>目前就分析出来了这些，其实这些小功能只能自己在副本娱乐下。估计出了副本。。大街上没有人敢用。呵呵</p><p>主要锻炼下自己对C#实现内存读写，还有就是分析内存的基地址和最终目的地址。</p><p></p><p></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:47:45 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/33</guid>

</item>
<item>
	<title>TBC 2.3如何挂战场</title>
	<link>http://xinlogs.com/post/32</link>
	<description><![CDATA[<p>目前TBC 2.3了，荣誉又开始有用处了，可以购买S1装备。但是如何挂战场呢？毕竟不是每个人都能不上班，每天玩10个小时。。。</p><p>我目前的办法是使用国外开发的一款练级外挂glider，再配合一个自己些的程序和修改过的一个插件来实现的。</p><p>glider可以控制人物按照设定的线路跑动和打怪。</p><p>我用c#些一个程序，来监控着角色，如果死亡了，就停止wowglider，等待复活。如果复活了，就开glider。战斗结束了，就点npc排队。</p><p>然后用我写的插件回答GM问题。。。。</p><p>总之还算可以吧。</p><p>用了大约1-2个晚上也业余时间解决的。c#确实使用起来很简单，至少之前我没有用过c#。但写个简单的网络程序，负责控制其它程序，实现起来很容易。基本都是采用TcpClient类，就可以了</p><p><a href="http://www.pvpbot.com/">www.pvpbot.com</a>也是个选择，但是收费比较贵。其实可以考虑用c#写个简单的web服务器，通过dns欺骗，来对pvpbot的bgtool做本地验证。</p><p>关于pvpbot的验证，确实不怎么好。至少我用了不到1个小时抓包，分析和测试。已经可以本地验证了，不过懒得写个简单web服务器实现验证了。（以前没有写过，还要查资料。。）</p><p>关于网络验证，glider做的就比较好。我觉得至少要对时间和硬件编号和用户名同时加密发送到服务器。然后再服务器验证后，对那个时间和是否验证通过等信息再加密，大乱顺序后发送回来。这样就算抓包，因为每次发送的时间不同，每次抓到的信息也不同。如果不知道算法，很难实现本地验证。</p><p>不过c#的代码保护太差，反编译后和看源代码差不多。。。。。。这个很难解决。。</p>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:47:10 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/32</guid>

</item>
<item>
	<title>修改了一个大战场团排插件 TeamQueue 1.35</title>
	<link>http://xinlogs.com/post/31</link>
	<description><![CDATA[<p>为了让插件排队速度更快.</p><p>只要和大战场军官对话,就自动进入到&quot;首先可用&quot;界面等待队长排队了.</p><p>插件下载</p><p><a href="http://bbs.game.mop.com/viewthread.php?tid=1544817&amp;extra=page%3D1">http://bbs.game.mop.com/viewthread.php?tid=1544817&amp;extra=page%3D1</a></p>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:46:26 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/31</guid>

</item>
<item>
	<title>一个内存所搜的好用具--Cheat Engine</title>
	<link>http://xinlogs.com/post/30</link>
	<description><![CDATA[<p>这个工具可以用来查找内存里面的数据。</p><p>是目前最好的修改游戏软件了，支持查找基地址。不过要想查找出基地址，还是需要一定的汇编能力的。</p><p>反正我用这个，还没有查找出WOW 2.1.2的基地址。</p><p>不过国外有个人，用这个工具找到了WOW<span style="font-size: x-small">1.12.1</span>的了</p><p>可以在google查到这篇文章<span style="font-size: small; color: #000000">&nbsp;&nbsp;</span><a href="http://www.edgeofnowhere.cc/viewtopic.php?t=332444&amp;start=0&amp;postdays=0&amp;postorder=asc&amp;highlight="><strong><span style="font-size: small; color: #000000">Defeating DMA: Offsets and Pointers for WoW</span></strong></a></p><p>本来打算用这个工具找出基地址，然后重新写挂战场的外挂呢。。。。革命尚未成功，仍需努力呀</p><p>暴风前夕这个版本里，我开始玩小D了，目前已经60，正在冲荣誉。。。用的还是以前我写的挂机程序，稍微修改了下，比较稳定。</p>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:46:00 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/30</guid>

</item>
<item>
	<title>我的高督法师的装备恢复了</title>
	<link>http://xinlogs.com/post/29</link>
	<description><![CDATA[<p>今天恢复了高督法师的装备，虽然损失了3500G，但是装备还是给恢复回来了</p><p>现在装备没有FM了，只有440法伤。。。。以前523</p><p>知足了。</p><p>希望大家都用密保卡，省的丢号</p>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:45:33 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/29</guid>

</item>
<item>
	<title>刷MLD公主,得到了无尽黑暗之忍</title>
	<link>http://xinlogs.com/post/28</link>
	<description><![CDATA[<p>虽然号被盗了,但是老天却把幸运给了我.</p><p>让我刷出了<span style="color: #800080"><strong>[无尽黑暗之刃]</strong></span></p><p>有了这个匕首,可以一次刷ZG 9堆鳄鱼了,简直是FS AOE的极品武器</p>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:45:09 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/28</guid>

</item>
<item>
	<title>我的高督被盗了......</title>
	<link>http://xinlogs.com/post/27</link>
	<description><![CDATA[<p>07年3月29日,我的高督法式被盗了,同一个账号下还有60的萨满.</p><p>因为是朋友玩的时候被盗的，我到是没有什么感觉。</p><p>反正也冲到高督了，该玩的也玩了。</p><p>ZG鳄鱼,MLD公主也刷了。</p><p>现在也是该离开的时候了</p>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:44:46 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/27</guid>

</item>
<item>
	<title>我冲高督的心得</title>
	<link>http://xinlogs.com/post/26</link>
	<description><![CDATA[<p>我在2006年6月就开始冲高督了,然是玩的号是梦之盗帅. 亡灵盗贼(哈哈) </p>
<p>开始也是一个人到处混,涨得很慢.一周也就10w荣誉,后来通过傻鸟介绍,认识了一个固定队伍. </p>
<p>固定队伍就是不一样,都是有人带队而且有LM的固定队伍可以一起刷荣誉.在遇到不认识的队伍的时候,才会打. </p>
<p>这里要说一下,有很多人认为刷子不好,可是在我们这里,如果你不刷,真打的荣誉也就够你升到10级勇士的.刷也是很辛苦的,首先加入固定队伍的人,作队长才可以晚上挂机,但是队长每周至少有72小时在线带队.如果不做队长,就要负责拿旗子.拿一天旗子,晚上可以挂一下.基本队里没有不干活的. </p>
<p>我加入后不久就做了队长....其实队长很累...因为同时刷的有2-3个队伍,你要负责记住对不同队伍的输赢.只有这样,才能稳定的刷下去. </p>
<p>基本这样带队,晚上可以挂着,一周可以有70-100w荣誉.因为每个星期只有2-3人可以到14级高阶督军,所以基本都是让已经到13级督军的朋友拿1-3名,然后按照目前的军衔来分配小队里其他人的排名.这样就为了大家都能用最短时间毕业. </p>
<p>就这样我跟这个队伍混到了11级,认识了很多朋友,轻舞,心之全泪,天地有雪,正义与邪恶等.... </p>
<p>11级的时候已经8月初了,因为一直游戏,感觉对不起老婆(陪老婆时间太少).我最终选择了离开. </p>
<p>一直到1.12跨服战场开放,我才回来. </p>
<p>这次回来还是打算冲高督,但是跨服后60级战场基本都是真打了,我没有了固定队伍,就一个人很难冲上去.而50-59的这个阶段还是在刷.于是我选择了放弃梦之盗帅这个角色,用我的50法师,梦之亡魂刷 </p>
<p>跨服战场的开放,让一个人排队刷战场成为可能. </p>
<p>开始的时候,我用BFA插件配合我自己用VC写的一个小程序刷战场,基本是每个星期哪里双倍荣誉,我就刷哪里.就一个人排队.这样效率很高, </p>
<p>第1周,拿了36W荣誉(没有24小时刷),从侦察兵一下升了4级.而且ALX毕业了 </p>
<p>第2周也差不多,升到了6级.因为ALX毕业了,一旦荣誉到30W,我就去挂大战场.在这个星期我大战场也毕业了 </p>
<p>第3周,荣誉到30W我就去挂战歌,这个星期我升到了7级(开始可以买勇士装备了) </p>
<p>第4周.我顺利的升级到了8级 </p>
<p>第5周,倒霉的星期.9C开始封BFA,并开通了举报系统.我被停封了3小时.不过还是升到了9级.但我开始不太敢挂了 </p>
<p>第6周,BFA是不敢用了.我开始开发自己的插件了. </p>
<p>原来配合BFA的小程序,用VC写的,模拟的都是键盘,这样可以把界面隐藏到后台,这要发送按键消息,就能正常刷战场. </p>
<p>现在BFA不能用了,为了不让其他人举报,我从写了那个小程序,通过对屏幕上颜色的判断来获取人物状态和是否进入战场,来采取不同的行为.我可以在3个主城的战场军官那里挂.这样可以很大程度的避免被玩家举报.就这样,我顺利的到了10级(终于勇士了) </p>
<p>第7周,我再次被玩家举报,因为我荣誉高,其他玩家总会想办法让我停下来.不过正好我在屏幕前看着,回答了GM的问话,逃过了这次.这个星期顺利到11级(买下了全部的中将坐骑) </p>
<p>第8周,因为要准备冲14级高督,目前这样挂着,荣誉肯定不够,而且还怕被玩家举报,而我每天要上班,不可能一直人都看着.我又开始想办法了.我开始学习LUA语言,以寻求解决的办法.要是没有这段时间的努力,我不可能后面冲到高督.我居然写了一个可以自动回答GM问题的插件,而且在不知道如何回答的时候,就随面应付一句,然后下线(这样就安全多了.哈哈).所有玩家和我的对话还有GM的问题也多被记录下来.我每天下班,只要看一眼就可以了.这个星期因为一直写回答问题的插件,荣誉少了点,最终11级96% </p>
<p>第9周,新的问题来了,家里的网络开始不稳定了,总是掉线.而我对这个问题没有任何办法....最后这个星期我之排名第7升级到了12级53% </p>
<p>第10周,我再次改写了我的程序,让程序判断是否掉线了,一旦掉线,就发出提示声音.这样就可以在最短时间发现掉线了.这个星期顺利到了13级 </p>
<p>第11周.因为插件已经开始正常工作了,而且完美的回答了几次问题.让我可以放心的24小时挂了.这个星期我冲了135w荣誉 </p>
<p>第12周,稳定的挂了一个排名第一,同时战歌毕业了 </p>
<p>第13周,排名第2,13级94% </p>
<p>第14周,排名第一,终于14级毕业了 </p>
<p>这次刷高督,一直停留在59级.直到高督毕业,才升的60级.一共用了14周时间.哈哈 </p>
<p>期间学习了VC和LUA语言,感觉收获比较大.不过就算我这样一直用程序刷,感觉还是比较累的.要是真打,我肯定不能到14级. </p>
<p><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1mvbch0449aPxQgNXp0C7_LZ-1eressfNMRrATd8WJHGG0zEQ3OidEifY7JAhqLSFeOF-T1d9M4cYHkajDhdmSdvfzkCHlpQedd8p-h7cBndCgwRTH_SHongbt5CohtaCnD7siKQJw61iZ8CE4u7VaNA/ad3b603d12dc6bed3c6d9774[2].jpg"><img style="display:inline;border-width:0px;" src="https://s9rh2g.blu.livefilestore.com/y1mWawAipECIGBe6yUSQExL14pamqPJZWJZddFpTr8QPBjjrdJC0seNFAVLSxglhBHGL1EAqDtBcncrpLgCldSONRPzwnIKN-MuO6hBegi2BGoJW-7llmINj9-hJXPcIpOTv_tbAVm3vRe_TaqYPk9Tpw/ad3b603d12dc6bed3c6d9774_thumb.jpg" border="0" alt="ad3b603d12dc6bed3c6d9774" title="ad3b603d12dc6bed3c6d9774" width="244" height="191" /></a> </p>
<p>现在工作比较忙,很少玩了.所以写下这篇文章留作纪念 </p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/wow-1-70-Express-Upgrade">国服3.13 德鲁伊带小号快速升级（1-70全程带）</a></p><p><a href="http://xinlogs.com/s10-Conquest-Cap">S10赛季竞技场点数计算器</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/JJC">S9赛季征服点上限计算器</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:44:16 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/26</guid>

</item>
<item>
	<title>如何向万网的Mysql数据库导入数据</title>
	<link>http://xinlogs.com/post/25</link>
	<description><![CDATA[<p>昨天单位由一个网站，要放到万网的虚拟主机去。</p>
<p>网站是jsp写的，程序好导。直接ftp过去就可以了。</p>
<p>可是mysql的数据库怎么导呢？</p>
<p>我先用</p>
<p><span style="color:#0000ff;">mysqldump database_name&gt;database_name.sql</span></p>
<p>然后把这个database_name.sql下载下来。</p>
<p>再给虚拟主机空间上传一个phpmyadmin来做数据库管理用。这样就可以使用phpmyadmin导入数据了。</p>
<p>如果网站数据小，这样就ok了。可是我的database_name.sql有60M</p>
<p>万网空间上的phpmyadmin只能最大支持2M</p>
<p>于是只能另外想办法。我先导入表格结构吧。</p>
<p><span style="color:#0000ff;">mysqldump –d database_name&gt;database_name.sql</span></p>
<p><span style="color:#000000;">在phpmyadmin里，选择好数据库后，用导入功能，将database_name.sql导入</span></p>
<p><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1mHVIAi8jg7Mb5x8SUNU1jDjnYg_r7MMguFdxshoKmT0aUmojEXfXwjcFNvHU8eHb_8KPXG0p-eP8OYEy2XTumOdz3f7jLb3uv04BdOp61JfglcvJTYmfmb7tf8sOD7vNHxIRiyuMFyXHgxbiHKreVXQ/phpmyadmin_importdatabase[3].png"><img style="display:inline;border-width:0px;" src="https://s9rh2g.blu.livefilestore.com/y1mdGOU4j4UtUCi2kkdluGx-8ZVQPNAeRtME59G0m9UTAV6US6TRcXcPt8JTebpGrQYcTOoFsPV4IYVMG9y--GVWprGZPyqa_vHyXC_9QbHYa3pBdhkj8qLUuIrsqFrAmNgcFHG2PFiwlMKSOJvkoM5zg/phpmyadmin_importdatabase_thumb[1].png" border="0" alt="phpmyadmin_importdatabase" title="phpmyadmin_importdatabase" width="644" height="290" /></a> </p>
<p>现在有了表结构了，但是每个表都没有数据。我们再继续导入数据。</p>
<p>我的表里面，除了一个news表格特别大，大约51M，其他都在2M一下。所以我每个表格生成一个txt文件，然后导入到万网的数据库。</p>
<p>本地进入mysql&gt;提示符后，用以下命令将数据的表格数据导出。</p>
<p><span style="color:#0000ff;">select * from admin into outfile “/tmp/admin.txt” fields terminated by “|” lines terminated by “@”;</span></p>
<p>上面命令<span style="color:#000000;">将本地数据库的admin表，导出到/tmp/目录下的admin.txt文件。</span></p>
<p><span style="color:#000000;">我们有几个表格，就用这个命令导出几个txt文件。</span></p>
<p><span style="color:#000000;">然后将txt文件用gzip压缩，因为phpmyadmin支持gzip压缩格式的。</span></p>
<p><span style="color:#0000ff;">cd /tmp/</span></p>
<p><span style="color:#0000ff;">gzip admin.txt</span></p>
<p><span style="color:#000000;">最后将压缩的admin.txt.gz下载到本地，用浏览器上传给phpmyadmin导入</span></p>
<p><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1msg_69s8DFbL3bTmdN8Snhq-nEsT4WmJW2yYTF7X1DopxMZhFDybwoKfjEHq_3KF7hUNr-48fxSiyUSre_3SoKwRGBHhIJaRA5rZFEU_NmQmyNrfSfKMHWOfX1gmPiwdAvZ9oplBEi48SCjHwwdzlWw/importtable_data[3].png"><img style="display:inline;border-width:0px;" src="https://s9rh2g.blu.livefilestore.com/y1m-uZ-E5BCedsSygMfvzdP_3ZE8yGt4SefY5j-HYLKmle2OliBI0yLTJHrzg4ve2Pm1pQkywE6zggpTlPJjkPbxAY1WDZqUPDQ2HX33b9hkJwUeKRw-kE4tYNIDLZljhtCHE_2t4mr61cHbS56GNfipw/importtable_data_thumb[1].png" border="0" alt="importtable_data" title="importtable_data" width="644" height="357" /></a> </p>
<p><strong><span style="color:#ff0000;">解决ｎｅｗｓ表格过大问题</span></strong></p>
<p></p>
<p></p>
<p><span style="color:#000000;">我的ｎｅｗｓ表格有５１Ｍ，就算gzip压缩后，还有7M左右，还是不能用phpmyadmin导入。</span></p>
<p><span style="color:#000000;">我们可以将news表格的数据切分为多个txt文件，然后保证每个文件gzip后，在2M以内就可以。</span></p>
<p><span style="color:#000000;">这个切分就要根据具体表格来判断了。</span></p>
<p><span style="color:#000000;">我先查询了news表格一共有多少条记录</span></p>
<p><span style="color:#0000ff;">select count(*) from news;</span></p>
<p><span style="color:#000000;">返回1477条，表格是51M。压缩后的表格是7M。</span></p>
<p><span style="color:#000000;">7M/2M=3.5 </span></p>
<p><span style="color:#000000;">1477/3.5=422条。</span></p>
<p><span style="color:#000000;">根据上面的计算，只要按照422条一个文件来分割就可以了。为了保险，因为每条记录的大小并不是一样的平均分配，我按照每个文件200条记录来切分。</span></p>
<p><span style="color:#0000ff;">select * from news where newId&gt;0 limit 200 into outfile “/tmp/news0.txt” fields terminated by “|” lines terminated by “@”;</span></p>
<p><span style="color:#000000;">然后用</span></p>
<p><span style="color:#0000ff;">select max(newId) from news where newId&gt;0 limit 200;</span></p>
<p><span style="color:#000000;">查看下200条记录后，是到了那条记录，下次分割就从那条开始</span></p>
<p><span style="color:#000000;">这样分割出来的8个文件，一次压缩后，上传到phpmyadmin导入。就完成了全部表格的导入工作。</span></p>
<p><strong>总结</strong></p>
<p>其实如果数据本身不复杂，直接用navicat也可以远程连接导入的。但是navicat不支持定义 lines terminated。我的news表格里面存在的都是html代码，经常出现换行符，所以只能选择用phpmyadmin了。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/bbsxp6-to-phpwind8">bbsxp 6.0数据导入phpwind 8.7方法</a></p><p><a href="http://xinlogs.com/vps-dropbox-install">一款Linux下同步备份文件的好软件DROPBOX</a></p><p><a href="http://xinlogs.com/ruby_import_dbf_to_mysql">ruby将DBF文件导入MYSQL库</a></p><p><a href="http://xinlogs.com/bo-blog-to-emlog">微博从bo-blog迁移到了emlog。</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:42:37 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/25</guid>

</item>
<item>
	<title>Mysql设置my.cnf来记录下全部sql请求</title>
	<link>http://xinlogs.com/post/24</link>
	<description><![CDATA[<p>要想记录下提交到mysql数据库的全部sql语句，可以通过修改my.cnf来实现</p>
<p>修改/etc/my.cnf文件</p>
<p>找到</p>
<p>[mysqld]段</p>
<p>加入</p>
<p>log=queryLog<br />
log-slow-queries=showquerylog</p>
<p>然后就可以到/var/lib/mysql/目录下找到queryLog和showquerylog日志文件了</p>
<p>里面记录这每个提交到数据库执行的sql语句。</p>
<p>我的系统CentOS 4.4 rpm方式安装的mysql 5.0.57,如果其它系统或者其它安装方式，可能文件路径会有些不同。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p><p><a href="http://xinlogs.com/post/23">如何建立两个表间的外键</a></p><p><a href="http://xinlogs.com/post/22">一个在windows下很好用的MySQL工具Navicat</a></p><p><a href="http://xinlogs.com/update-115disk-urls">批量更换115网盘链接</a></p><p><a href="http://xinlogs.com/HeidiSQL">HeidiSQL一款开源的MySQL图形管理软件</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:42:08 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/24</guid>

</item>
<item>
	<title>如何建立两个表间的外键</title>
	<link>http://xinlogs.com/post/23</link>
	<description><![CDATA[<p>建立Mysql两个表间的外键,需要满足三个条件</p>
<p>1.两个表必须是InnoDB表类型</p>
<p>2.使用在外键关系的域必须为索引型(Index)</p>
<p>3.使用在外键关系的域必须与数据类型相似</p>
<p>下面举例说明</p>
<p>我们创建一个班级表和一个学生表,并建立一个外键</p>
<p>创建班级表</p>
<p>CREATE TABLE class (id INT NOT NULL AUTO_INCREMENT, classname VARCHAR(50) NOT NULL, PRIMARY KEY(id)) ENGINE=INNODB;</p>
<p>插入班级数据</p>
<p>INSERT INTO class VALUES (1,"一班"),(2,"二班"),(3,"三班");</p>
<p>创建学生表</p>
<p>CREATE TABLE students (id INT(4) NOT NULL, name VARCHAR(50) NOT NULL, FK_class INT(4) NOT NULL, INDEX (FK_class), FOREIGN KEY (FK_class) REFERENCES class (id), PRIMARY KEY(id)) ENGINE=INNODB;</p>
<p>验证外键约束性,我们向students表插入一个学生数据,并让FK_class的值为一个在class表里面不存在的值.</p>
<p>mysql&gt; INSERT INTO students VALUES (1,"zhang",5);</p>
<p>马上就会看到Mysql报错<br />
ERROR 1452 : Cannot add or update a child row: a foreign key constraint fails (`test/students`, CONSTRAINT `students_ibfk_1` FOREIGN KEY (`FK_class`) REFERENCES `class` (`id`))</p>
<p>以上证明外键可以正常工作了</p>
<p>在Mysql下测试了以下,不建立index,并且不指定innodb格式.</p>
<p>版本</p>
<p>+----------------------+<br />
| version()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
+----------------------+<br />
| 5.0.24a-community-nt |<br />
+----------------------+</p>
<p>建立class表</p>
<p>CREATE TABLE class (id INT NOT NULL AUTO_INCREMENT, classname VARCHAR(50) NOT NULL, PRIMARY KEY(id));</p>
<p>建立students表</p>
<p>CREATE TABLE students (id INT(4) NOT NULL, name VARCHAR(50) NOT NULL, FK_class INT(4) NOT NULL, FOREIGN KEY (FK_class) REFERENCES class (id), PRIMARY KEY(id));</p>
<p>通过Navicat查看,上面语句建立的两个表,也会默认用INNODB存储,而且也在students表建立了index和外键.一切正常.</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/113">mysqldump解决中文乱码问题</a></p><p><a href="http://xinlogs.com/post/24">Mysql设置my.cnf来记录下全部sql请求</a></p><p><a href="http://xinlogs.com/HeidiSQL">HeidiSQL一款开源的MySQL图形管理软件</a></p><p><a href="http://xinlogs.com/post/22">一个在windows下很好用的MySQL工具Navicat</a></p><p><a href="http://xinlogs.com/disable-mysql-query-log">开启或者关闭MYSQL的query log(查询日志)</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:41:40 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/23</guid>

</item>
<item>
	<title>一个在windows下很好用的MySQL工具Navicat</title>
	<link>http://xinlogs.com/post/22</link>
	<description><![CDATA[<p>为了解决中文乱码，我的Mysql都设置了使用utf8编码</p>
<p>这样一来，使用SQLyog Enterprise查看表里面内容，就都不能正常显示了。可能SQLyog需要设置？反正我没有搞出来。</p>
<p>不过后来我换用了Navicat 7以后，感觉很好。所有中文内容都可以正确显示</p>
<p>比mysql front也要强很多。以后我就用这个了</p>
<p><img src="http://www.navicat.com/images/stories/product/mysql/product/win/win_big.jpg" border="0" width="440" height="370" /></p>
<p>而且支持Linux,windows,mac三个平台。下面是介绍</p>
<p><span>PremiumSoft Navicat™ is a powerful MySQL database administration and development tool that is not only sophisticated enough for professional developers, but also easy to learn for new users. With an user-friendly GUI, Navicat™ lets you quickly and easily create, organize, access and share information in a secure and convenient way. </span></p>
<p><span>PremiumSoft Navicat supports multiple MySQL server connections which can be connected locally or remotely. Your remote MySQL server can be running on Linux, Unix, Mac OS X or Windows platform.<br />
</span></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/Linux-source-install-multiple-versions-of-MySQL">Linux源码安装MySQL多版本共存</a></p><p><a href="http://xinlogs.com/mysql-error-index-is-slower">Mysql错误索引比没索引还慢</a></p><p><a href="http://xinlogs.com/post/23">如何建立两个表间的外键</a></p><p><a href="http://xinlogs.com/ruby_import_dbf_to_mysql">ruby将DBF文件导入MYSQL库</a></p><p><a href="http://xinlogs.com/post/113">mysqldump解决中文乱码问题</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:41:12 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/22</guid>

</item>
<item>
	<title>ubuntu8.04 玩魔兽世界 2.4.3(8606)</title>
	<link>http://xinlogs.com/wow-on-ubuntu-linux</link>
	<description><![CDATA[最近一直在用ubuntu 8.04当桌面系统。已经很少用windows了。随着采用ubuntu也就一直没有玩魔兽世界了。<br />今天将Windows下的WOW目录直接拷贝到了ubuntu下面。我的wine是用sudo apt-get install默认安装的，没有特殊设置。<br />将wow目录拷贝到了用户目录的 .wine/drive_c/Program Files目录下。然后直接双击wow.exe运行。<br />这个时候会提示如下画面的错误。<br /><div><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1m8N_TzSZWRIZodiHLM3Sy1M7XUE75HVH4hSLgeEQU_0uQeiD5pbm2oizz1pk96NcCWKc9q8dC9f7XtZqyxbBcX7LxYv1RInSkwNYXBR20MNuLXTG1evOgTvHjImcAxjBZ5E0_8L1CWNgzxoNCxkQOYw/bc198d3efd5ca5e1838b1322[2].jpg"><img style="display: inline; border-width: 0px" src="https://s9rh2g.blu.livefilestore.com/y1mymKT363o3S7JlRnK7jIkk0wMUF3FTSH6H_BAzz-nkfx_M1rtrVYokOSqP2LVpUom9MUQlNCnaqvOXfvvRAzOfnaSdOAVjAyEQr51ToAL-tqyYnYs3VZVGaPrYfIn80ja2JZp_0rST9pyeXXH1x2big/bc198d3efd5ca5e1838b1322_thumb.jpg" border="0" alt="bc198d3efd5ca5e1838b1322" title="bc198d3efd5ca5e1838b1322" width="244" height="154" /></a> </div><br />这个不要紧，我们在启动的时候加入-opengl 参数就可以解决。<br />下面这个是成功启动的命令和截图<br />wine .wine/drive_c/Program\ Files/World\ of\ Warcraft/Wow.exe -opengl -nosound<br /><br /><div><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1mAmPLwGTjOrjGM3yYNoqELPQu_VkHb3RlUV90UNx-QLxLA1vAKPL0Lz_XRlVykGRDs3zlhsMhO7CGcsjZT59QKSr6sZig_s7Flue4Rci8GLJMUutglJssMl5FlSUTtosiNSXDH4yFRQm9e264yBf3Hg/af87c31f5d64fd78f724e42f[2].jpg"><img style="display: inline; border-width: 0px" src="https://s9rh2g.blu.livefilestore.com/y1mQo3Gi98CNHQ0JwnB8iiHHERW-NnzASmJh9RW4SLFEfP16Xs4Dj3aHRgJSxfU1nX7hG4uXMmO2nbIbNsa9QEUsIl015liWuf7s0oM9hnPa3wpf9B6TyHypyM-WFxgs8Ck1bJGWvdY667F9COY92cY4Q/af87c31f5d64fd78f724e42f_thumb.jpg" border="0" alt="af87c31f5d64fd78f724e42f" title="af87c31f5d64fd78f724e42f" width="244" height="154" /></a> </div><br />已经成功启动了，感觉还不错。这个是在我IBM R61的笔记本上运行结果。<br />下面进入游戏看看速度<br /><div><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1m0tFuWr-5n8FWSjjtHQxlxOm7u8iJ-gd2eWEuNlCxkHs51D94QoTnEYmXarvTLf4eIOZ-a55BmAyevVg3vgf7yDahhtgDMR2IkBumUIachMaqcYA5evfxIp2lvTzp4b2PjnhbFn7gktszR0PZ4NpiLg/19f06d600edac8c48cb10d2b[2].jpg"><img style="display: inline; border-width: 0px" src="https://s9rh2g.blu.livefilestore.com/y1moRpS9S5GrUbPWgENT9yv3ryDKqp8bQp9-oenJ0ZPmQVTvG3bOX59AKiSSDtD1jDWVFak6nVe5mfJurip9HyCApsBPef72YUdF4Abif7rhjsT4UNiFU0YPrGpwV_O_tAHe48_duf4b44vj6cph8Wchw/19f06d600edac8c48cb10d2b_thumb.jpg" border="0" alt="19f06d600edac8c48cb10d2b" title="19f06d600edac8c48cb10d2b" width="244" height="154" /></a> </div><br />开始的时候，我的运行速度不行。只有可怜的35帧每秒。<br />在我关闭了所有特效后，速度到了惊人的100帧每秒。。。这个速度完全可以正常游戏了。<br />在看看我桌面右侧的状态cpu 53%占用 内存709.88MB 感觉还可以吧。<br /><br />虽然已经AFK了，但是ubuntu能玩魔兽世界，还是让我很开心的。 <div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p><p><a href="http://xinlogs.com/install-ApacheBench-on-CentOS-without-Apache">centos 单独安装apachebench</a></p><p><a href="http://xinlogs.com/wow-1-70-Express-Upgrade">国服3.13 德鲁伊带小号快速升级（1-70全程带）</a></p><p><a href="http://xinlogs.com/post/10">怎么mount一个xen的img映像。转载</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:39:22 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/wow-on-ubuntu-linux</guid>

</item>
<item>
	<title>ubuntu下arp攻击防御和反击！</title>
	<link>http://xinlogs.com/post/20</link>
	<description><![CDATA[今天在单位，发现有人在用聚生网管和p2p终结者<br />
在windows下面，可以安装arp防火墙，还可以通过安装同类软件，进行检测。可是我已经转到ubuntu上了，总不能一旦被攻击，就回windows吧。于是上网找了一些关于linux下防止arp攻击的方法。<br />
<strong>第一种方法</strong><br />
用静态arp.<br />
这种方法就是通过在 /etc/ethers 建立ip和mac地址对应记录。然后用arp -f来读取记录。这样将网关的mac地址和ip都建立在静态arp文件里。就不容易被arp欺骗了。<br />
还可以配合关闭arp解析，用ifconfig eth0 -arp<br />
<strong><br />
第二中方法</strong><br />
采用arping <br />
babo@babo-laptop:~$ arping <br />
Usage: arping [-fqbDUAV] [-c count] [-w timeout] [-I device] [-s source] destination<br />
-f : quit on first reply<br />
-q : be quiet<br />
-b : keep broadcasting, don't go unicast<br />
-D : duplicate address detection mode<br />
-U : Unsolicited ARP mode, update your neighbours<br />
-A : ARP answer mode, update your neighbours<br />
-V : print version and exit<br />
-c count : how many packets to send<br />
-w timeout : how long to wait for a reply<br />
-I device : which ethernet device to use (eth0)<br />
-s source : source ip address<br />
destination : ask for what ip address<br />
<br />
用法举例：比如我的ip 192.168.1.101 网关:192.168.1.1<br />
就用arping -U -I eth0 -s 192.168.1.101 192.168.1.1<br />
显示结果如下<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.999ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 9.571ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.245ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.227ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.390ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 4.526ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.294ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.245ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.239ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.266ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.259ms<br />
Unicast reply from 192.168.1.1 [00:21:29:94:62:47] 1.267ms<br />
Sent 12 probes (1 broadcast(s))<br />
Received 12 response(s)<br />
<br />
<strong>终极解决办法</strong><br />
采用arpoison来解决是最好的办法了，这个办法还是参考了《linux下arp攻击的解决方案［原］》的办法。<br />
arpoison需要libnet的库才能正确编译，所以要下载libnet和arpoison两个软件。<br />
<br />
<strong>arpoison主页</strong><br />
<a href="http://www.packetfactory.net/libnet">http://www.arpoison.net/</a><br />
<br />
<strong>libnet主页</strong><br />
<a href="http://www.packetfactory.net/libnet">http://www.packetfactory.net/libnet</a><br />
<br />
<strong>安装</strong><br />
现安装libnet,因为是源代码编译，需要gcc等我就不说了。去查看具体ubuntu源代码安装需要的软件包吧<br />
tar zxvf libnet.tar.gz<br />
cd libnet/<br />
sudo ./configure<br />
sudo make<br />
sudo make install<br />
编译过程中，会提示也些警告，没有关系。反正安装后，有/usr/lib/libnet.a就可以了<br />
<br />
然后安装arpoison<br />
tar zxvf arpoison-0.6.tar.gz <br />
cd arpoison/<br />
sudo gcc arpoison.c /usr/lib/libnet.a -o arpoison<br />
sudo mv arpoison /usr/sbin<br />
<span style="color:#00aa00;"><em><strong><br />
</strong></em></span>用法举例：<br />
babo@babo-laptop:~$ sudo arpoison<br />
Usage: -i &lt;device&gt; -d &lt;dest IP&gt; -s &lt;src IP&gt; -t &lt;target MAC&gt; -r &lt;src MAC&gt; [-a] [-w time between packets] [-n number to send]<br />
<br />
说明<br />
-i 指定发送arp包的网卡接口eth0<br />
-d 192.168.1.1 指定目的ip为192.168.1.1<br />
-s 192.168.1.101 指定源ip为192.168.1.101<br />
-t ff:ff:ff:ff:ff:ff 指定目的mac地址为ff:ff:ff:ff:ff:ff(arp广播地址)<br />
-r 00:1c:bf:03:9f:c7 指定源mac地址为00:1c:bf:03:9f:c7<br />
<br />
比如我想防止arp攻击<br />
sudo arpoison -i eth0 -d 192.168.1.1 -s 192.168.1.101 -t ff:ff:ff:ff:ff:ff -r 00:1c:bf:03:9f:c7<br />
<br />
比如我想攻击192.168.1.50的机器不让他上网<br />
sudo arpoison -i eth0 -d 192.168.1.50 -s 192.168.1.1 -t ff:ff:ff:ff:ff:ff -r 00:1c:bf:03:9f:c7<br />
<br />
<strong>一些猜想</strong><br />
如果在本机开始NAT服务<br />
然后通过arp欺骗把对方的网关地址欺骗到自己这里，因为自己这里开了NAT，对方应该也可以上网吧。然后在本地开wireshark抓包，对方就不知不觉的被监视了。这些想法没有测试，不知道这样欺骗的办法，NAT是否可以。<div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/monit-to-monitor-services">monit监控linux服务</a></p><p><a href="http://xinlogs.com/post/17">如何快速统计服务器访问量</a></p><p><a href="http://xinlogs.com/OpenVPN-Install">CentOS 5.3下OpenVPN安装和Win7下OpenVPN GUI安装</a></p><p><a href="http://xinlogs.com/post/15">试用ubuntu 8.04和LVM动态增加分区</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:38:51 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/20</guid>

</item>
<item>
	<title>ubuntu 8.04升级到8.10</title>
	<link>http://xinlogs.com/post/19</link>
	<description><![CDATA[<p><strong>升级</strong></p>
<p>昨天开始作的升级。<br />
早上到单位，就开始<br />
Alt+F2<br />
在弹出的命令行窗口输入update-manager -d<br />
然后就进入了漫长的等待，单位网络那个垃圾。。。。。告诉我42天。。。。。<br />
一直到下班，下载了900多个文件，一共要下载1300多<br />
晚上到家继续update-manager -d 发现居然可以接着下载，还以为要重新来呢。家里好点，告诉我3个小时<br />
后来就睡觉了。<br />
今天早上起来，发现已经下载完成了，开始到安装更新这一步了，弹出个窗口等我确认。<br />
我点上开始，就洗漱去了。一直到要上班也没有安装完成。（TMD，居然忘记今天星期五，不能开车。还是老婆提醒我，才想起来。）这次我可不敢关机了，怕升级一半，下次进不来系统。直接把本本和上盖子放包里了，下楼打车上班。<br />
在出租车里，完成了全部更新。关机。<br />
<strong><br />
启动</strong><br />
到了单位，发现系统总卡在进度条进不去。<br />
按Alt+F1然后 Alt+F8查看下文字模式的启动信息，发现一直卡在*Configuring network interfaces...<br />
这个第一次启动，没有办法（希望有好办法的，告诉下。）我就一直死等呀。。。感觉过了20分钟？？？<br />
进入系统了，3D显卡驱动不行。运行uname -a查看，内核还在用8.04的2.6.24-21.<br />
先修改网络吧<br />
sudo gedit /etc/network/interfaces<br />
将里面的<br />
auto eth0<br />
iface eth0 inet dhcp<br />
auto lo<br />
auto wlan0<br />
都注释掉，变成下面样子<br />
#auto lo<br />
iface lo inet loopback<br />
#iface eth0 inet dhcp<br />
address 10.11.10.164<br />
netmask 255.255.255.0<br />
gateway 10.11.10.254<br />
#nameserver 202.106.0.20<br />
#auto eth0<br />
iface wlan0 inet dhcp<br />
wpa-psk 7640768b3d6b31f834b63abc8d2d667ae10f8bc3c41a8e4e87ec2c104d963a1e<br />
wpa-driver wext<br />
wpa-key-mgmt WPA-PSK<br />
wpa-proto WPA<br />
wpa-ssid babohome<br />
#auto wlan0<br />
接着修改/etc/NetworkManager/nm-system-settings.conf文件<br />
sudo gedit /etc/NetworkManager/nm-system-settings.conf<br />
将文件里的[ifupdown] manager=false改成[ifupdown] manager=true<br />
这样基本启动速度的问题就正常</p>
<p><strong>内核<br />
</strong>再来说内核<br />
内核需要手动编辑下grub的启动配置文件了。其实2.6.27-7内核已经安装了，就是没有给我们加入的menu.lst文件里面。修改menu.lst<br />
sudo gedit /boot/grub/menu.lst<br />
我的修改如下，这个应该每个人的不太一样。大家可以拷贝以前自己的文件进行修改<br />
title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ubuntu 8.04.1, kernel 2.6.27-7-generic<br />
root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (hd0,1)<br />
kernel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /boot/vmlinuz-2.6.27-7-generic root=UUID=614a1c10-6ed3-45c9-b24d-f7b3e39725b2 ro quiet splash locale=zh_CN<br />
initrd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /boot/initrd.img-2.6.27-7-generic<br />
quiet<br />
title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ubuntu 8.04.1, kernel 2.6.27-7-generic (recovery mode)<br />
root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (hd0,1)<br />
kernel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /boot/vmlinuz-2.6.27-7-generic root=UUID=614a1c10-6ed3-45c9-b24d-f7b3e39725b2 ro single<br />
initrd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /boot/initrd.img-2.6.27-7-generic<br />
这个修改后，先不要重新启动。因为我们还没有卸载显卡驱动，要不重启后，卸载驱动还要继续重启。 </p>
<p><strong>卸载现有的显卡驱动</strong><br />
我原来显卡驱动是用envyng -t来安装的，现在还用这个工具卸载<br />
在终端envyng -t<br />
然后选卸载驱动，安后等卸载完成后，重启就ok了 </p>
<p><strong>安装显卡驱动<br />
注意，如果内核还是2.6.24-21，新的驱动安装不上。<br />
</strong>这次我没有用envyng -t来安装，而是用系统-&gt;系统管理-&gt;硬件驱动来安装的<br />
推荐我的是nvidia 177.80的驱动<br />
等待安装完成后。 Ctrl+Alt+Backspace 重新启动X server<br />
一切ok<br />
<strong>一些问题</strong><br />
在启动过程中，发现samba deamon启动fail还没有看是什么原因。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/post/15">试用ubuntu 8.04和LVM动态增加分区</a></p><p><a href="http://xinlogs.com/post/9">ubuntu server 9.04 终端乱码问题</a></p><p><a href="http://xinlogs.com/post/18">ubuntu 8.10下同步wm6.1手机</a></p><p><a href="http://xinlogs.com/post/8">ubuntu 9.04 server 安装VMware Tools解决share folders问题</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:38:14 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/19</guid>

</item>
<item>
	<title>ubuntu 8.10下同步wm6.1手机</title>
	<link>http://xinlogs.com/post/18</link>
	<description><![CDATA[参考了<br />
<pre><span><span><span style="font-size:medium;"><span style="color:#ff00ff;"><span style="font-size:small;"><a href="http://www.synce.org/moin/SynceWithUbuntu" target="_blank">http://www.synce.org/moin/SynceWithUbuntu</a> http://hi.baidu.com/john_zhy/blog/item/50e39f317240141febc4af5a.html<span style="color:#000000;">我的本本 IBM R61
系统 ubuntu 8.10从 8.04升级上来的。
手机 eten X800 wm6.1英文系统

原来一直不能在ubuntu下面同步手机资料，昨天参考了上面两个帖子，最后成功了。</span></span></span></span></span></span><span style="font-size:medium;">1、首先添加源</span> <span style="font-size:medium;"><span style="color:#00ff00;">sudo gedit&nbsp;&nbsp; /etc/apt/sources.list</span></span><span style="font-size:medium;"> 在末尾添加

deb <a href="http://ppa.launchpad.net/synce/ubuntu" target="_blank">http://ppa.launchpad.net/synce/ubuntu</a> hardy main

deb-src <a href="http://ppa.launchpad.net/synce/ubuntu" target="_blank">http://ppa.launchpad.net/synce/ubuntu</a> hardy main

保存，关闭<span style="color:#00ff00;">sudo apt-get update</span></span> <span style="color:#ff0000;">我没有更新源，但是也成功。可能是8.10的缘故</span> <span style="font-size:medium;">2、更新usb驱动（仅内核在2.6.24-19之前的，如果比这个新请跳过本步骤）<span style="color:#00ff00;">sudo rmmod rndis_host cdc_ether usbnet
sudo rm /lib/modules/`uname -r`/kernel/drivers/net/usb/{rndis_host,cdc_ether,usbnet}.ko
sudo apt-get install usb-rndis-source cdbs
sudo module-assistant auto-install usb-rndis
sudo apt-get install synce-hal librra0-tools librapi2-tools<span style="color:#000000;">因为我的内核是2.6.27-7的，所以跳过了这步。但是我安装了后面的软件包</span></span></span><span><span><span style="font-size:medium;"><span style="color:#00ff00;">sudo apt-get install synce-hal librra0-tools librapi2-tools</span></span></span></span> <span style="font-size:medium;">3、安装<span style="font-size:large;">SynCE-GNOME</span> <span style="color:#00ff00;">sudo apt-get install python-setuptools</span> 下载<a href="http://downloads.sourceforge.net/synce/synce-gnome-0.11.tar.gz" target="_blank"><span style="color:#0000ff;">synce-gnome-0.11.tar.gz</span></a> 解压，在终端进入其目录，运行<span style="color:#00ff00;">python setup.py build
sudo python setup.py install</span> 安装<strong>notification-daemon</strong>（如果没有安装过的话，用新得立软件包管理器搜索一下就可以了）
这个步骤完全做了一次，</span><span><span style="font-size:medium;"><strong>notification-daemon系统已经安装过了</strong></span></span><span style="font-size:medium;">4、连接好手机，运行<span style="color:#00ff00;">/sbin/ifconfig -a | grep 80:00:60:0f:e8:00&nbsp;&nbsp; | cut -d " " -f 1</span> 记下他输出的东西<span style="color:#00ff00;">sudo gedit&nbsp;&nbsp; /etc/network/interfaces</span> 在末尾添加<span style="color:#00ff00;">iface <span style="color:#ff00ff;">&lt;rndis0&gt;</span> inet dhcp</span> <span style="color:#ff00ff;">ps:"&lt;&gt;"里面的是我在上面那步里输出的，你应该更换成你自己的，不带“&lt;&gt;“</span> 保存并关闭，然后运行<span style="color:#00ff00;">sudo /etc/init.d/networking restart<span style="color:#000000;">这次也是按照作的，我的网卡是多出来一个eth1(这个根据自己系统决定)。所以我在interfaces文件后面加入了
iface eth1 inet dhcp</span></span></span><span style="font-size:medium;">5、安装OpenSync<span style="color:#00ff00;">sudo apt-get install multisync-tools opensync-plugin-evolution opensync-plugin-synce</span> 6、现在该安装的都安装好了，就可以开始同步了<span style="color:#00ff00;">synce-sync-engine</span> 如果出现如下错误

File "/usr/bin/sync-engine", line 84, in &lt;module&gt;

 configObj = Config.Config(progopts)

&nbsp;&nbsp; File "/usr/lib/python2.5/site-packages/SyncEngine/config.py", line 292, in __init__

 oldconf = os.path.join(self.path,"config.xml")

AttributeError: Config instance has no attribute 'path'

请下载<a href="http://synce.svn.sf.net/svnroot/synce/releases/0.11.1/sync-engine/config/config.xml" target="_blank"><span style="color:#0000ff;">config.xml</span></a>，保存为~/.synce/config.xml（提示："~"为自己的家目录)

创建同步项目<span style="color:#00ff00;">synce-create-partnership "Linux desktop" "Contacts,Calendar"</span> ps：还有别的，可自行选择Contacts， Calendar， Tasks， Files 等

创建OpenSync group<span style="color:#00ff00;">msynctool --addgroup synce-sync

msynctool --addmember synce-sync synce-opensync-plugin

msynctool --addmember synce-sync evo2-sync</span> 然后同步<span style="color:#00ff00;">synce-sync-engine

msynctool --sync synce-sync</span> 他会同步到evolution里面

我上面的照着做，全部成功了。<span style="color:#ff0000;">我的一些问题<span style="color:#000000;">据说安装了synce-gnomevfs后，可以在Nautilus里面看手机里的内容，但是我没有成功
目前只能通过synce-pls、synce-pcp等命令，来操作手机里面文件。</span></span></span></pre><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/15">试用ubuntu 8.04和LVM动态增加分区</a></p><p><a href="http://xinlogs.com/post/9">ubuntu server 9.04 终端乱码问题</a></p><p><a href="http://xinlogs.com/post/8">ubuntu 9.04 server 安装VMware Tools解决share folders问题</a></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p><p><a href="http://xinlogs.com/post/19">ubuntu 8.04升级到8.10</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:37:43 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/18</guid>

</item>
<item>
	<title>如何快速统计服务器访问量</title>
	<link>http://xinlogs.com/post/17</link>
	<description><![CDATA[<p>最近看了javaeye上面<strong>robbin</strong>的一篇文章，学习到了很多知识。</p>
<p><a href="http://robbin.javaeye.com/blog/97287"><span style="color:#7d0000;">如何快速统计RoR网站的访问量</span></a></p>
<p>我的服务器是Apache+tomcat的配置，上面跑了几个网站。都是基于apache 虚拟主机配置的。</p>
<p>apache配置如下</p>
<p>Include conf/vhost_*.conf<br />
然后每个虚拟主机对应一个配置文件</p>
<p>例如下面的(一些信息用???代替了，都是域名和姓名等个人信息)</p>
<p>&lt;VirtualHost *:80&gt;<br />
&nbsp;&nbsp;&nbsp; ServerAdmin ???<a href="mailto:???@???.cn">@???.cn</a><br />
&nbsp;&nbsp;&nbsp; DocumentRoot /home/???/www<br />
&nbsp;&nbsp;&nbsp; ServerName <a href="http://www./???.org">www.???.org</a></p>
<p>&nbsp;&nbsp;&nbsp; DirectoryIndex index.jsp index.htm</p>
<p>&nbsp;&nbsp;&nbsp; ErrorLog logs/abc-error_log<br />
&nbsp;&nbsp;&nbsp; CustomLog "| /usr/sbin/rotatelogs /var/log/httpd/abc-access_%Y%m%d.log 86400" common<br />
&nbsp;&nbsp;&nbsp; &lt;Location "/*.jsp"&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JkUriSet worker ajp13:localhost:8009<br />
&nbsp;&nbsp;&nbsp; &lt;/Location&gt;<br />
&lt;/VirtualHost&gt;</p>
<p>这样配置后，就会在/var/log/httpd下面按照虚拟主机名字和日期，每天生成一个访问日志文件</p>
<p><strong>统计每日动态请求处理总数</strong></p>
<p><strong>cat /var/log/httpd/abc-access_20081116.log |grep "200 "|wc -l</strong></p>
<p><strong>统计URL的访问频度</strong></p>
<p><strong>cat /var/log/httpd/abc-access_20081116.log |grep "200 "|awk '{print $7}'|sort|uniq -c</strong></p>
<p><strong>统计时间访问频度</strong></p>
<p><strong>cat /var/log/httpd/abc-access_20081116.log |grep "200 "|awk '{print $4}'|awk -F : '{print $2}'|sort|uniq -c</strong></p>
<p><strong>以上这些是基于CentOS+apache+tomcat实现的<br />
<br />
<br />
</strong></p>
<p>[root@ict ~]# cat /var/log/httpd/esdinchina-access_20081117.log |grep "200 "|awk '{print $4}'|awk -F : '{print $2}'|sort|uniq -c</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/monit-to-monitor-services">monit监控linux服务</a></p><p><a href="http://xinlogs.com/OpenVPN-Install">CentOS 5.3下OpenVPN安装和Win7下OpenVPN GUI安装</a></p><p><a href="http://xinlogs.com/post/48">www.netcraft.com可以检测网站运行的操作系统和Web Server</a></p><p><a href="http://xinlogs.com/install-ApacheBench-on-CentOS-without-Apache">centos 单独安装apachebench</a></p><p><a href="http://xinlogs.com/monitor-network-connections-of-linux">linux网络连接数量监控</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:37:09 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/17</guid>

</item>
<item>
	<title>一个很好的开源企业内部IM解决方案</title>
	<link>http://xinlogs.com/post/16</link>
	<description><![CDATA[<p>今天发现了<a href="http://www.igniterealtime.org/">http://www.igniterealtime.org/</a>这个项目首页</p>
<p>这个项目可以在企业内部架设一台服务器，来完成内部IM功能。客户端可以想QQ或者MSN一样登陆。并且通过服务器上设置GATEWAY功能，还能与MSN等主流软件通讯。</p>
<p>具体功能还没有测试，不过打算有时间的时候架设下进行试用。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/debian-administration-site">一个关于debian系统管理的站点</a></p><p><a href="http://xinlogs.com/centos-install-ruby-rubygems">centos 源码安装ruby和rubygems</a></p><p><a href="http://xinlogs.com/Tomcat-reboot-problems">解决Linux下Tomcat不能重启和停止问题</a></p><p><a href="http://xinlogs.com/centos-linux-sshclient-unreadable-code">Centos Linux 远程终端ssh乱码问题</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:36:38 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/16</guid>

</item>
<item>
	<title>试用ubuntu 8.04和LVM动态增加分区</title>
	<link>http://xinlogs.com/post/15</link>
	<description><![CDATA[<p>我在虚拟机VMware里面安装了ubuntu 8.04.</p>
<p>安装的时候，只是选择了openssh这个服务。安装后感觉系统很干净</p>
<p><strong>磁盘占用</strong></p>
<p>/dev/mapper/ubuntu-root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5.6G 321M 5.3G&nbsp;&nbsp; 6% /</p>
<p>系统就用了不到400M</p>
<p><strong>内存</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; used&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; free&nbsp;&nbsp;&nbsp;&nbsp; shared&nbsp;&nbsp;&nbsp; buffers&nbsp;&nbsp;&nbsp;&nbsp; cached<br />
Mem:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 249&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 209&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 16</p>
<p>减掉buffers和cached的内容，还有我ssh远程连接的占用。实际系统启动后内存也就需要17M</p>
<p><strong>LVM</strong></p>
<p>安装系统的时候，我就选择了整个磁盘启用LVM，采用ubuntu默认分区的方式。</p>
<p>ubuntu默认分了2个区/sda1和/sda5。sda1用来做/boot，sda5用来做LVM。文件系统都是默认的ext3。</p>
<p>然后在LVM里面默认建立了2个LV( Logical volume)，一个/dev/ubuntu/root用来做/ ，一个/dev/ubuntu/swap_1用来做swap交换分区。我又手动修改了文件系统，采用reiserfs。</p>
<p><strong>动态添加/分区大小</strong></p>
<p>我先添加了一个硬盘，系统识别为sdb</p>
<p>对这个盘<strong>创建分区</strong>（LVM可以不用分区的，但是需要动态添加到/分区，所以需要有文件系统，不能添加后格式化/分区吧）</p>
<p>sudo fdisk /dev/sdb</p>
<p>n --&gt;创建分区</p>
<p>t --&gt;修改分区类型为8e</p>
<p>w --&gt;保存结果</p>
<p>现在系统可以识别/dev/sdb1这个设备了。</p>
<p><strong>创建PV(Physical volume)</strong></p>
<p>sudo pvcreate /dev/sdb1</p>
<p><strong>创建VG(Volume group)</strong></p>
<p>sudo vgextend ubuntu /dev/sdb1</p>
<p><strong>扩展LV(Logical volume)</strong></p>
<p>sudo lvextend -L +2G /dev/ubuntu/root<br />
这样就给/dev/ubuntu/root这个设备大小增加了2G。可以通过sudo lvdisply查看</p>
<p>但是这个时候df -h还是没有变化的，需要调整文件系统。</p>
<p>sudo resize_reiserfs -s +2G /dev/ubuntu/root<br />
这样就完成了全部动态扩展分区。而且是服务器一直在线状态，不用关机。</p>
<p>调整Swap</p>
<p>还是和上面一样的情景，只要VG里面还有剩余空间就可以用来扩展swap用。</p>
<p>sudo swapoff -a<br />
关闭正在用的swap分区</p>
<p>然后</p>
<p>sudo lvextend -L +200M /dev/ubuntu/swap_1</p>
<p>给/dev/ubuntu/swap_1扩展了200M容量</p>
<p>sudo mkswap /dev/ubuntu/swap_1</p>
<p>建立swap的文件系统</p>
<p>最后</p>
<p>sudo swapon -a</p>
<p>启用新的swap系统。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/18">ubuntu 8.10下同步wm6.1手机</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/post/19">ubuntu 8.04升级到8.10</a></p><p><a href="http://xinlogs.com/post/7">ubuntu server 9.04显示中文文件</a></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:35:46 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/15</guid>

</item>
<item>
	<title>CentOS 5.3 64bit安装在HP 380G5服务器</title>
	<link>http://xinlogs.com/post/14</link>
	<description><![CDATA[<p>今天安装了一台CentOS 5.3 64bit服务器。</p>
<p>服务器硬件HP 380G5，4U高</p>
<p>CPU 4核处理器 2颗</p>
<p>内存 4G 硬盘 147G*3</p>
<p>安装很顺利，采用server模式，去掉了不用的软件，加入虚拟化。</p>
<p>安装后启动，占用内存在230M左右，感觉比CentOS 4.7高了很多呀。。。我在一台HP 140的1U服务器安装的CentOS 4.7 启动后，只占用29M内存。</p>
<p>内存占用问题，还需要看看具体是什么原因。</p>
<p>测试下性能，我比较喜欢用unixbench测试。</p>
<p><a href="http://www.hermit.org/Linux/Benchmarking/">http://www.hermit.org/Linux/Benchmarking/</a></p>
<p>我这次下载的5.0版本，因为5.1以后支持2D,3D我没有装X11，运行不了。</p>
<p>结果5.0也是运行了一半就出问题了。奇怪呀。</p>
<p>我的一台CentOS 4.4 装在一个双核 Intel(R) Xeon(TM) CPU 2.66GHz<br />
，1G内存的机器上。用4.1.0-wht测试，得分只有145.不过是跑着java、tomcat、apache、mysql和vmserver的时候测试的。内存使用400M左右的时候。</p>
<p>我看到网上很多128M的VPS居然也可以得到160多分，真是奇怪呀。</p>
<p>而我这台双4核处理器xeon e7320,4G内存，装CentOS的机器，也只有下面的数据</p>
<p>[root@moodle unixbench-4.1.0-wht-2]# ./Run<br />
make all<br />
make[1]: Entering directory `/root/unixbench-4.1.0-wht-2'<br />
Checking distribution of files<br />
./pgms exists<br />
./src exists<br />
./testdir exists<br />
./tmp exists<br />
./results exists<br />
make[1]: Leaving directory `/root/unixbench-4.1.0-wht-2'</p>
<p>&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; # #&nbsp;&nbsp;&nbsp; # # #&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #####&nbsp;&nbsp; ###### #&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp; ####&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; #<br />
&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; # ##&nbsp;&nbsp; # #&nbsp;&nbsp; # #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; # #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ##&nbsp;&nbsp; # #&nbsp;&nbsp;&nbsp; # #&nbsp;&nbsp;&nbsp; #<br />
&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; # # # # #&nbsp;&nbsp;&nbsp; ##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #####&nbsp;&nbsp; #####&nbsp;&nbsp; # # # #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ######<br />
&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; # # # # #&nbsp;&nbsp;&nbsp; ##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; # #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # # # #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; #<br />
&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; # #&nbsp;&nbsp; ## #&nbsp;&nbsp; # #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; # #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp; ## #&nbsp;&nbsp;&nbsp; # #&nbsp;&nbsp;&nbsp; #<br />
&nbsp;&nbsp;&nbsp; ####&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; # # #&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #####&nbsp;&nbsp; ###### #&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp; ####&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; #</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Based on the Byte Magazine Unix Benchmark<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 44&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 11<br />
&nbsp;&nbsp; v&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1<br />
&nbsp;&nbsp;&nbsp; v v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 44444&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v4.1 revisions mostly by David C. Niemi,<br />
&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp; o&nbsp;&nbsp; 111 - WHT.2 Reston, VA, USA &lt;<a href="mailto:niemi@tux.org">niemi@tux.org</a>&gt;</p>
<p>WHT Variant by Andy A. Lee &lt;<a href="mailto:andylee@dslextreme.com">andylee@dslextreme.com</a>&gt;<br />
See: <a href="http://www.webhostingtalk.com/showthread.php?s=&amp;threadid=308055">http://www.webhostingtalk.com/showthread.php?s=&amp;threadid=308055</a></p>
<p><br />
Dhrystone 2 using register variables 1 2</p>
<p>Double-Precision Whetstone 1 2</p>
<p>Execl Throughput 1</p>
<p>Filesystem Throughput 1024 bufsize 2000 maxblocks 1</p>
<p>Filesystem Throughput 256 bufsize 500 maxblocks 1</p>
<p>Filesystem Throughput 4096 bufsize 8000 maxblocks 1</p>
<p>Pipe Throughput 1 2</p>
<p>Pipe-based Context Switching 1 2</p>
<p>Process Creation 1</p>
<p>System Call Overhead 1 2</p>
<p>Shell Scripts (8 concurrent) 1</p>
<p>==============================================================<br />
BYTE UNIX Benchmarks (Version 4.1-wht.2)<br />
System -- Linux moodle.ict 2.6.18-128.el5xen #1 SMP Wed Jan 21 11:12:42 EST 2009 x86_64 x86_64 x86_64 GNU/Linux<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 271677672&nbsp;&nbsp; 3293760 254360848&nbsp;&nbsp; 2% /</p>
<p>Start Benchmark Run: Tue Jun 30 06:43:06 CST 2009<br />
06:43:06 up 7:53, 1 user, load average: 0.19, 0.76, 0.81</p>
<p>End Benchmark Run: Tue Jun 30 06:53:17 CST 2009<br />
06:53:17 up 8:03, 1 user, load average: 15.43, 6.42, 3.16</p>
<p><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INDEX VALUES<br />
TEST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BASELINE&nbsp;&nbsp;&nbsp;&nbsp; RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INDEX</p>
<p>Dhrystone 2 using register variables&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 376783.7 19031818.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 505.1<br />
Double-Precision Whetstone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 83.1&nbsp;&nbsp;&nbsp;&nbsp; 1448.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 174.3<br />
Execl Throughput&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 188.3&nbsp;&nbsp;&nbsp;&nbsp; 1593.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 84.6<br />
File Copy 1024 bufsize 2000 maxblocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2672.0&nbsp;&nbsp; 118911.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 445.0<br />
File Copy 256 bufsize 500 maxblocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1077.0&nbsp;&nbsp;&nbsp; 42442.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 394.1<br />
File Read 4096 bufsize 8000 maxblocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 15382.0&nbsp;&nbsp; 946428.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 615.3<br />
Pipe-based Context Switching&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 15448.6&nbsp;&nbsp; 253316.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 164.0<br />
Pipe Throughput&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 111814.6 1223105.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 109.4<br />
Process Creation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 569.3&nbsp;&nbsp;&nbsp;&nbsp; 3279.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 57.6<br />
Shell Scripts (8 concurrent)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 44.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 508.7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 113.5<br />
System Call Overhead&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 114433.5&nbsp;&nbsp; 907496.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 79.3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =========<br />
&nbsp;&nbsp;&nbsp;&nbsp; FINAL SCORE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 182.5</p>
<p>总分 182.5 真不知都那些VPS测试出 400分的，是什么情况。</p>
<p>难道是可以针对unixbench优化？</p>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:35:15 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/14</guid>

</item>
<item>
	<title>CentOS 5.3 安装虚拟化后的内存识别问题.</title>
	<link>http://xinlogs.com/post/13</link>
	<description><![CDATA[<p>昨天单位到了2台SUN x4450.</p>
<p>硬件配置相当强力.</p>
<p>CPU 4颗6核的 Intel(R) Xeon(R) CPU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X7460 @ 2.66GHz<br />
系统可以识别出24颗处理器</p>
<p>[root@localhost ~]# cat /proc/cpuinfo |grep processor|wc -l<br />
24</p>
<p>内存64G </p>
<p>在内存问题上,我郁闷了一阵子.我用dmesg、free、top查看，都是32G</p>
<p>开始以为CentOS 5.3的64位内核就能支持到32G呢。又尝试在启动参数里加mem=64G</p>
<p>又上论坛询问、查看官方文档，都说CentOS 5.3 64bit应该没有内存限制的。</p>
<p>后来我发现了，原来问题出在安装的虚拟化上面</p>
<p>用xm top可以正确识别内存。而且安装的系统，只是当作xm 里面的一个dom0来运行的。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/5">ubuntu 9.04安装xen</a></p><p><a href="http://xinlogs.com/post/2">CentOS虚拟化服务的配置</a></p><p><a href="http://xinlogs.com/cloudstack-on-vmware">cloudstack on vmware</a></p><p><a href="http://xinlogs.com/post/11">CentOS里的Xen配置pygrub</a></p><p><a href="http://xinlogs.com/post/3">获取XEN guestOS的images文件</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:33:40 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/13</guid>

</item>
<item>
	<title>CentOS 5.3下成功安装了Xen虚拟化服务。</title>
	<link>http://xinlogs.com/post/12</link>
	<description><![CDATA[<p>今天参照下面文档成功安装了虚拟化服务。</p>
<p><a href="http://www.howtoforge.com/paravirtualization-with-xen-on-centos-5.3-x86_64-p2">http://www.howtoforge.com/paravirtualization-with-xen-on-centos-5.3-x86_64-p2</a></p>
<p>并且在虚拟化服务里，安装了一台vm01的虚拟Centos。</p>
<p>不过时间比较长，通过网络安装，用了4个小时。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/10">怎么mount一个xen的img映像。转载</a></p><p><a href="http://xinlogs.com/debian-xen-install">debian6.0.5(squeeze)安装配置xen-4.0虚拟化</a></p><p><a href="http://xinlogs.com/post/8">ubuntu 9.04 server 安装VMware Tools解决share folders问题</a></p><p><a href="http://xinlogs.com/post/2">CentOS虚拟化服务的配置</a></p><p><a href="http://xinlogs.com/post/11">CentOS里的Xen配置pygrub</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:33:04 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/12</guid>

</item>
<item>
	<title>CentOS里的Xen配置pygrub</title>
	<link>http://xinlogs.com/post/11</link>
	<description><![CDATA[<p>如果用virt-install生成一台虚拟服务器</p>
<p>在查看配置的时候，会发现已经没有了kernel=这个配置来制定启动内核。而是用了</p>
<p>bootloader = '/usr/bin/pygrub'</p>
<p>关于这个，可以参考</p>
<p><a href="http://wiki.xensource.com/xenwiki/PyGrub">http://wiki.xensource.com/xenwiki/PyGrub</a></p>
<p>CentOS 5.3的虚拟化，好像没有了XenU的内核，而是改用了这种新的方式。</p>
<p>反正我用kernel启动失败了。后来用这个方式已经可以正常使用虚拟服务器了。</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/vps-dropbox-install">一款Linux下同步备份文件的好软件DROPBOX</a></p><p><a href="http://xinlogs.com/linux-ddos-defender">Linux防御DDOS攻击</a></p><p><a href="http://xinlogs.com/monit-to-monitor-services">monit监控linux服务</a></p><p><a href="http://xinlogs.com/Centos-install-mudos">CENTOS下安装MUDOS跑侠客行</a></p><p><a href="http://xinlogs.com/post/13">CentOS 5.3 安装虚拟化后的内存识别问题.</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:32:31 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/11</guid>

</item>
<item>
	<title>怎么mount一个xen的img映像。转载</title>
	<link>http://xinlogs.com/post/10</link>
	<description><![CDATA[<div><div>1. First you need to find out the partitions and the startsector of partitions:</div>
<pre>[root@xen rruban]# file rheltest.img rheltest.img: x86 boot sector, GRand Unified Bootloader (0.94); partition 1: ID=0x83, active, starthead 1, startsector 63, 208782 sectors; partition 2: ID=0x8e, starthead 0, startsector 208845, 3871665 sectors, code offset 0x48</pre><div>There are 3 partitions inside the image file. The startsector of each partition is also listed. Boot partition will have start sector 63.</div>
<div>2. Now you need to get the sector size:</div>
<pre>[root@xen]fdisk -lu rheltest.img</pre><pre> Disk rheltest.img: 0 MB, 0 bytes <p>255 heads, 63 sectors/track, 0 cylinders, total 0 sectors </p>
<p>Units = sectors of 1 * 512 = 512 bytes </p>
<p>Device Boot Start End Blocks Id System </p>
<p>rheltest.img1 * 63 208844 104391 83 Linux </p>
<p>rheltest.img2 208845 4080509 1935832+ 8e Linux LVM </p>
</pre><div>The above shows the sector byte size is 512 byte.</div>
<div>3. To calculating the offset: offset = start_sector x sector_byte_size.</div>
<div>The startsector is 63 for the first partition, therefore the first partition offset is: 63x512=32256</div>
<div>4. Finally, to mount the xen image, use:</div>
<pre>mount -o loop,offset=32256 test.img /foldername</pre></div><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a></p><p><a href="http://xinlogs.com/ssh-login-protection-by-denyhosts">通过denyhosts保护ssh登陆</a></p><p><a href="http://xinlogs.com/post/8">ubuntu 9.04 server 安装VMware Tools解决share folders问题</a></p><p><a href="http://xinlogs.com/post/108">CentOS下的Tomcat停止脚本</a></p><p><a href="http://xinlogs.com/post/12">CentOS 5.3下成功安装了Xen虚拟化服务。</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:29:40 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/10</guid>

</item>
<item>
	<title>ubuntu server 9.04 终端乱码问题</title>
	<link>http://xinlogs.com/post/9</link>
	<description><![CDATA[<p>安装了ubuntu server 9.04，安装的时候选择了中文环境。</p>
<p>因为server是没有桌面的，发现终端里面显示提示信息，出错信息都变成乱码了。</p>
<p>解决办法</p>
<p>修改/etc/default/locale文件</p>
<p>将zh_CN修改为en_US</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/113">mysqldump解决中文乱码问题</a></p><p><a href="http://xinlogs.com/post/18">ubuntu 8.10下同步wm6.1手机</a></p><p><a href="http://xinlogs.com/centos-linux-sshclient-unreadable-code">Centos Linux 远程终端ssh乱码问题</a></p><p><a href="http://xinlogs.com/post/19">ubuntu 8.04升级到8.10</a></p><p><a href="http://xinlogs.com/post/15">试用ubuntu 8.04和LVM动态增加分区</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:29:06 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/9</guid>

</item>
<item>
	<title>ubuntu 9.04 server 安装VMware Tools解决share folders问题</title>
	<link>http://xinlogs.com/post/8</link>
	<description><![CDATA[<pre>我的主系统是Winxp在vmware 6.5.2 build-156735下安装的ubuntu server 9.04</pre><pre>因为安装vmware tools后，可以使用vmware 提供的share folders让winxp的主系统可以将某个目录映射到虚拟的ubuntu系统里。</pre><pre>我就开始在vmware里面安装vmware tools工具。下面是过程，包括不能用vmhgfs的解决办法</pre><pre><strong>安装VMware tools</strong></pre><pre><strong>安装前，先安装需要的软件包</strong></pre><pre>apt-get install autoconf automake binutils make cpp gcc linux-headers-$(uname -r)</pre><pre>安装后，在vmware上面选择VM-》Install Vmware Tools</pre><pre>然后切换到ubuntu server 9.04里，运行mount命令，将Vmware tools的光盘挂载</pre><pre><span style="color:#0000ff;">sudo mount /dev/cdrom /mnt</span></pre><p>拷贝安装VMware Tools需要的安装文件到/tmp目录 </p>
<p><span style="color:#0000ff;">sudo cp /mnt/VMwareTools-7.8.5-156735.tar.gz /tmp</span> </p>
<p><span style="color:#000000;">卸载/mnt目录，因为安装的时候，需要在/mnt目录下创建hgfs目录，如果这时候挂载着CDROM，就会导致创建hgfs目录失败。</span> </p>
<p><span style="color:#0000ff;">sudo /mnt</span> </p>
<p><span style="color:#000000;">解压安装文件并修改会出现问题的page.c文件</span> </p>
<p><span style="color:#0000ff;">cd /tmp</span> </p>
<p><span style="color:#0000ff;">tar zxvf VMwareTools-7.8.5-156735.tar.gz </span></p>
<p><span style="color:#0000ff;">cd /tmp/vmware-tools-distrib/lib/modules/source</span> </p>
<p><span style="color:#0000ff;">sudo cp ./vmhgfs.tar /tmp/</span> </p>
<p><span style="color:#0000ff;">tar xvf vmhgfs.tar </span></p>
<p><span style="color:#0000ff;">cd vmhgfs-only/ </span></p>
<p><span style="color:#0000ff;">sudo vi page.c</span> </p>
<p><span style="color:#000000;">修改page.c里面867行的一个错误函数，</span> </p>
<p><span style="color:#0000ff;">page = __grab_cache_page(mapping, index); </span></p>
<p>将这个函数修改为 </p>
<p><span style="color:#0000ff;">page = grab_cache_page_write_begin(mapping, index,flags);</span> </p>
<p><span style="color:#000000;">这个函数是在/usr/src/linux-headers-2.6.28-11-server/include/linux$下的，pagemap.h里面定义的，内容如下</span> </p>
<p>struct page *grab_cache_page_write_begin(struct address_space *mapping,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pgoff_t index, unsigned flags); </p>
<p>修改后，保存。然后重新打包成vmhgfs.tar文件，放置到/tmp/vmware-tools-distrib/lib/modules/source目录下。</p>
<p>完成上面工作后，就可以</p>
<p><span style="color:#0000ff;">cd /tmp/vmware-tools-distrib</span></p>
<p><span style="color:#0000ff;">sudo ./vmware-install.pl</span></p>
<p>安装提示安装就可以了。 </p>
<p>当看到如下提示，代表已经正确编译了vmhgfs模块了。应该可以顺利使用share folders功能。 </p>
<p><span style="color:#ff0000;">The vmhgfs module loads perfectly into the running kernel.</span> </p>
<p>也可以运行</p>
<p>lsmod |grep vmhgfs</p>
<p>如果有如下显示，表示安装成功</p>
<p><span style="color:#ff0000;">vmhgfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 53728&nbsp; 1</span> </p>
<p><span style="color:#000000;">这样就可以用vmware提供的share folders功能和ubuntu server 9.04共享文件了。</span></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/7">ubuntu server 9.04显示中文文件</a></p><p><a href="http://xinlogs.com/post/2">CentOS虚拟化服务的配置</a></p><p><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a></p><p><a href="http://xinlogs.com/post/5">ubuntu 9.04安装xen</a></p><p><a href="http://xinlogs.com/post/12">CentOS 5.3下成功安装了Xen虚拟化服务。</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:28:32 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/8</guid>

</item>
<item>
	<title>ubuntu server 9.04显示中文文件</title>
	<link>http://xinlogs.com/post/7</link>
	<description><![CDATA[<p>前面提到了用VMware的share folder功能，可以将主机系统的一个目录，自动共享到ubuntu /mnt/hgfs目录下。</p>
<p>但是winxp的中文目录，到了ubuntu server下面就显示乱码了。</p>
<p><strong>解决办法</strong></p>
<p><strong>安装相关软件包</strong></p>
<p>sudo apt-get install language-pack-zh</p>
<p><strong>配置中文环境</strong></p>
<p><span style="color:#000000;">修改/etc/environment</span></p>
<p><span style="color:#0000ff;">sudo vim /etc/environment</span> </p>
<p>将LANG和LANGUAGE内容修改为下面的 </p>
<p>LANG=zh_CN.UTF8<br />
LANGUAGE="zh_CN:zh:en_US:en </p>
<p>修改/etc/default/locale</p>
<p><span style="color:#0000ff;">sudo vim /etc/default/locale</span> </p>
<p><span style="color:#000000;">修改内容如下</span> </p>
<p>LANG="zh_CN.UTF-8"<br />
LANGUAGE="zh_CN:zh" </p>
<p>保存后，重启系统。 </p>
<p>现在用putty登陆，还是发现看中文乱码。我们还要继续设置putty才可以。 </p>
<p><strong>设置putty使用utf-8</strong> </p>
<p><strong>putty的Windows-&gt;Translation-&gt;Received data assumed to be in which character set:选择UTF-8</strong> </p>
<p><strong><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1mWRbBMOFguZAny8H1GKBC_uzPWPPhdcLzq9OECJ38H5dJe9d5gGsPjd-8_q7re-Qmfp6YY0JYKbybB3YWYFfkRtbsT0RZXkvmtAeLrhQWz7WMmXMdAy_2V9y3lmTZKxBOaPRwaWFHeWLeM8lzNby83w/putty-utf8[3].png"><img style="display:inline;border-width:0px;" src="https://s9rh2g.blu.livefilestore.com/y1mIjCg_VDQFiMJ_0l8GLyDkT8iuUjyQ2cWdVSOPxrVwWVSpz_DIegVewOXVg2CIIu0FRQ9RWlL46LDAGLSKH5f8n5qPUqhYPGt60PKJl_qJLuGhzfOH5on-YknIp61wLpF1hVbrsYSu85nRTSdSoIo4w/putty-utf8_thumb[1].png" border="0" alt="putty-utf8" title="putty-utf8" width="504" height="484" /></a> </strong></p>
<p>这样设置后，就可以正确在putty里显示中文了。</p>
<p><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1mqTedVMTFMeh-h44ArM5Qps42rO7YK7ykRdHUqbUUK8N1-ORuBgf7ts5l9MZZ82Baky4JJ91bLRL0yUZxdL9qXq5IRARC9Stg_5OGPRqZvQ14uG08FvRlXrZyVJ3xffAcC1t-xECVwAFvjmKdFwIw3A/putty-cn[5].png"><img style="display:inline;border-width:0px;" src="https://s9rh2g.blu.livefilestore.com/y1mc4esQx1p0TUjMGPRrl88sRUBrRRw1IpxGDF85myHnT1h8wQPtaM3hXr2b-C9A7xymj1RKNAS7vO8cOcs0zXCLiyiRZBJDoORntHbQp6luby_HpQH12CT2IS3gzRH0ahadylTWgEkEx2qEmpTUNzRrA/putty-cn_thumb[3].png" border="0" alt="putty-cn" title="putty-cn" width="272" height="82" /></a> </p>
<p>以上这些就可以正常在putty里显示中文了。但是如果你用键盘鼠标从本地登陆ubuntu server，会发现，ubuntu server还是乱码。</p>
<p>这个问题我查了一些文档，还是没有解决。有的说是console下的字体问题。但是/usr/share/consolefonts里的字体好像没有支持中文的。</p>
<p>还有说console fonts最多支持256这个字符。。。</p>
<p>反正最终这个问题没有解决掉。现在在linux自己的控制台里，显示还是乱码</p>
<p><a rel="WLPP" href="https://s9rh2g.blu.livefilestore.com/y1mu51nXtG1k-bM1TQaDF-Z8JKp8NdJo1lT8im3rMfkoqkmic6rM8K53O97mJFYh9klGcrhQP46eKYCQAqvVUrCRNQ7uugdjJqvR7dWIUAQBzPlGzNkPZa8et0ZV7eUeGeCtyGSUCMbSzBSfcHE-YJIvA/linux[2].png"><img style="display:inline;border-width:0px;" src="https://s9rh2g.blu.livefilestore.com/y1mG8aPcM-j85Jqg3w5riEsN_nFtnAaQIQTM6kbURygJDNSxAAmbNSTvT4uug1ctQWOhXsll7znsrRykaiVaHum1cMfna5q_uW85FehMP0cpgeZRGFfrLLmw3zbzCxqH4DpMEmoEmIeZpGTKCtUP-HV_w/linux_thumb.png" border="0" alt="linux" title="linux" width="204" height="36" /></a> </p>
<p>建议大家如果不是特别需要，其实服务器没有必要采用中文编码的。可以正常显示中文就好了。<strong>建议默认还是用en_US:UTF-8的好。</strong></p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/9">ubuntu server 9.04 终端乱码问题</a></p><p><a href="http://xinlogs.com/post/15">试用ubuntu 8.04和LVM动态增加分区</a></p><p><a href="http://xinlogs.com/post/8">ubuntu 9.04 server 安装VMware Tools解决share folders问题</a></p><p><a href="http://xinlogs.com/wow-on-ubuntu-linux">ubuntu8.04 玩魔兽世界 2.4.3(8606)</a></p><p><a href="http://xinlogs.com/post/18">ubuntu 8.10下同步wm6.1手机</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:27:47 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/7</guid>

</item>
<item>
	<title>第一次安装LFS</title>
	<link>http://xinlogs.com/post/6</link>
	<description><![CDATA[在经过了大约40小时左右，我的LFS终于顺利启动了。从内核到系统每一个软件都是自己从源代码编译的，感觉很爽。<br />
<br />
本次安装采用LiveCD 6.3作为宿主系统，在VMware上的一个8G scsi盘上安装。<br />
<br />
首先碰到的问题就是GCC编译出现问题。后来发现是因为我用的liveCD是64位的问题。<br />
<br />
换了liveCD 32位的。问题解决<br />
<br />
第二个问题就是glibc总编译不过去，后来发现是我的Linux-2.6.22.5 API Headers从网上下的版本不对<br />
<br />
我一直是看着LFS BOOK 6.2的中文手册安装的，而用的LiveCD和软件包都是6.3<br />
<br />
6.3里面的这个Linux-2.6.22.5 API Headers需要从Linux-2.6.22.5.tar.bz2里面获取<br />
<br />
建议还是看liveCD启动后/usr/share/LFS-BOOK-6.3目录下的文档，这个文档和liveCD带的软件包配套的。<br />
<br />
或者参考中文的<br />
<br />
手把手教你如何建立自己的Linux系统 第二版 作者：孙海勇 <br />
<br />
其他就没有碰到什么大问题了。也就是忘记安装个软件包、或者关机重启后，如何从liveCD恢复到工作状态。<br />
<br />
通过这次安装，让我觉得LFS真的是学习Linux的捷径。而且发现了一个牛人的博客，就是上面的孙海勇&nbsp;&nbsp;网名 冲天飞豹&nbsp;&nbsp;http://youbest.cublog.cn/<br />
<br />
博客里面有大量关于构建linux系统的技术文章，而且都是原创。<br />
<br />
而且这次通过安装LFS，也找到了Linux 如何在控制台显示UTF-8中文的办法。原来是要给内核打补丁才可以。<br />
<a href="/attachment/1261355091_2484f260.png" target="_blank"><img src="/attachment/1261355091_2484f260.png" alt="点击在新窗口中浏览此图片" title="点击在新窗口中浏览此图片" border="0" /></a><br />
 <br />
<br />
具体的办法可以看<br />
<br />
内核补丁：字符终端下显示UTF-8字符 <br />
<br />
总结<br />
<br />
安装是顺利完成了，后面要学习的内容还有很多。比如安装时候的每一个包都包含的什么内容、每一条配置的用途。这些安装手册配置容易，如果没有手册自己弄起来就难了。所以后面的时间，就是自己看文档，消化这些知识了。至少顺利迈出第一步！<br />]]></description>
	<pubDate>Mon, 21 Dec 2009 00:23:23 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/6</guid>

</item>
<item>
	<title>ubuntu 9.04安装xen</title>
	<link>http://xinlogs.com/post/5</link>
	<description><![CDATA[<p>主要参考下面两旁文章，先贴过来，以后再整理。</p>
<p><a href="http://oceanobservatories.org/spaces/display/CIDev/Xen+on+Ubuntu+9.04+(Jaunty)" title="http://oceanobservatories.org/spaces/display/CIDev/Xen+on+Ubuntu+9.04+(Jaunty)">http://oceanobservatories.org/spaces/display/CIDev/Xen+on+Ubuntu+9.04+(Jaunty)</a></p>
<p><a href="http://linux.com/community/blogs/Xen-Create-a-Jaunty-DomU-using-xen-create-image.html" title="http://linux.com/community/blogs/Xen-Create-a-Jaunty-DomU-using-xen-create-image.html">http://linux.com/community/blogs/Xen-Create-a-Jaunty-DomU-using-xen-create-image.html</a></p>
<p><strong>安装xen</strong></p>
<p>Xen on Ubuntu 9.04 (Jaunty) </p>
<p>Added by <a href="http://oceanobservatories.org/spaces/display/~thim">Thomas Im</a> , last edited by <a href="http://oceanobservatories.org/spaces/display/~thim">Thomas Im</a> on Jun 11, 2009&nbsp; (<a href="http://oceanobservatories.org/spaces/pages/diffpages.action?pageId=18353165&amp;originalId=18353171">view change</a>) </p>
<p>Labels:&nbsp; </p>
<p>(None) </p>
<p>Following applies to Ubuntu 9.04 Jaunty 64-bit installation.&nbsp; Notes taken from rebuild of 'amoeba' development system. </p>
<p>Installation</p>
<pre>sudo apt-get install ubuntu-xen-server # Jaunty Xen package does not include the dom0 Xen kernel so these must be installed separately&nbsp;&nbsp;wget http://security.debian.org/debian-security/pool/updates/main/l/linux-2.6/linux-modules-2.6.26-2-xen-amd64_2.6.26-15lenny3_amd64.deb wget http://security.debian.org/debian-security/pool/updates/main/l/linux-2.6/linux-image-2.6.26-2-xen-amd64_2.6.26-15lenny3_amd64.deb&nbsp;&nbsp;sudo dpkg -i linux-modules-2.6.26-2-xen-amd64_2.6.26-15lenny3_amd64.deb linux-image-2.6.26-2-xen-amd64_2.6.26-15lenny3_amd64.deb&nbsp;&nbsp;sudo apt-get install python2.5 shutdown -r now&nbsp;&nbsp; sudo vim /etc/network/interfaces .. auto eth0 iface eth0 inet static&nbsp;&nbsp; address xxx.xxx.xxx.xxx&nbsp;&nbsp; gateway xxx.xxx.xxx.xxx&nbsp;&nbsp; netmask 255.255.255.0&nbsp;&nbsp; sudo vim /etc/resolv.conf ... domain ucsd.edu search ucsd.edu&nbsp;&nbsp;nameserver xxx.xxx.xxx.xxx nameserver xxx.xxx.xxx.xxx&nbsp;&nbsp; sudo /etc/init.d/networking restart&nbsp; </pre><p>Create Jaunty DomU (Guest) </p>
<p>[http://linux.com/community/blogs/Xen-Create-a-Jaunty-DomU-using-xen-create-image.html] </p>
<p><img src="http://oceanobservatories.org/spaces/images/icons/emoticons/information.gif" border="0" width="16" height="16" align="absMiddle" /><br />
<strong><strong>References:</strong></strong> </p>
<p><a href="https://help.ubuntu.com/community/Xen">https://help.ubuntu.com/community/Xen</a><br />
<a href="http://www.infohit.net/blog/adate/053109/archive/1.html">http://www.infohit.net/blog/adate/053109/archive/1.html</a><br />
<a href="http://www.chrisk.de/blog/2008/12/how-to-run-xen-in-ubuntu-intrepid-without-compiling-a-kernel-by-yourself/">http://www.chrisk.de/blog/2008/12/how-to-run-xen-in-ubuntu-intrepid-without-compiling-a-kernel-by-yourself/</a> </p>
<h3></h3>
<p></p>
<p><strong>安装guest系统</strong></p>
<p>These are instructions for creating an Ubuntu Jaunty DomU on Debian Lenny Dom0 using Xen 3.2.1 that comes with Lenny.&nbsp; I'm installing into an LVM rather than using a file image.&nbsp; See <a href="http://www.howtoforge.com/xen-live-migration-of-an-lvm-based-virtual-machine-with-iscsi-on-debian-lenny">this HowtoForge article for background of my particular setup</a>.&nbsp; This tutorial assumes you're working from a similar setup with an iscsi target and LVM-based VMs. </p>
<p>The reason I'm posting this is because I had such a hard time finding some combination of tools that worked correctly to do this.&nbsp; I tried a few options but had little success: </p>
<ul><li>debootstrap - Didn't seem to work with Jaunty at all.&nbsp; It would just crash </li>
<li>vm-install - Doesn't support LVM-based VMs by default, but there is a procedure for converting the qcow image to an LVM</li>
</ul>
What I found is that I could find no way of creating the LVM-based VM in Lenny.&nbsp; I actually had to create a sid instance first and then install my open-iscsi and xen-utils into the sid VM, then use SID to populate the VM.&nbsp; <br />
<u><strong>Perform the following actions in your SID vm or workstation</strong></u><br />
Note:&nbsp; You'll need your /etc/xen-tools/xen-tools.conf setup like the instructions in the HowtoForge article (things like gateway, netmask, broadcast, passwd, fs type, install-method, etc).<br />
Whenever I would try to build the vm with the default partitions, it would always fail.&nbsp; For some reason the resulting vm would have an fstab that shows something like sda1 and sda2 instead of xvda1 and xvda2.&nbsp; I had to create my own partition scheme before anything would work right.&nbsp; Here's mine: <p>$ <strong>sudo cat /etc/xen-tools/partitions.d/with-data</strong><br />
[root]<br />
size=4G<br />
type=ext3<br />
mountpoint=/<br />
options=sync,errors=remount-ro<br />
[swap]<br />
size=512M<br />
type=swap<br />
[data]<br />
size=4G<br />
type=ext3<br />
mountpoint=/data<br />
options=nodev </p>
<p>You will need to create a symlink for jaunty so that the option is recognized at the command-line.&nbsp; </p>
<p><strong>$ cd /usr/lib/xen-tools</strong> </p>
<p><strong>$ sudo ln -s edgy.d jaunty.d&nbsp; </strong></p>
<p>Now, finally, you can create the image.&nbsp; This step may take some time </p>
<p><strong>$ xen-create-image --hostname=myserver --dhcp --lvm=vg_xen --dist=jaunty --mirror=http://archive.ubuntu.com/ubuntu --size=4Gb --memory=512Mb --swap=512MB --arch=i386 --partitions=with-data</strong> </p>
<p>Since you're building the LVM on a different machine than it will eventually run on, you'll need to&nbsp; copy the resulting xen config to the correct server: </p>
<p><strong>$ scp /etc/xen/myserver.cfg root@realhost:/etc/xen/</strong> </p>
<p>That should be all you need to get this working. </p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/3">获取XEN guestOS的images文件</a></p><p><a href="http://xinlogs.com/post/12">CentOS 5.3下成功安装了Xen虚拟化服务。</a></p><p><a href="http://xinlogs.com/post/10">怎么mount一个xen的img映像。转载</a></p><p><a href="http://xinlogs.com/post/11">CentOS里的Xen配置pygrub</a></p><p><a href="http://xinlogs.com/debian-xen-install">debian6.0.5(squeeze)安装配置xen-4.0虚拟化</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:22:45 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/5</guid>

</item>
<item>
	<title>安装和使用xen-shell</title>
	<link>http://xinlogs.com/post/4</link>
	<description><![CDATA[<p>转自：<a href="http://www.xen-tools.org/software/xen-shell/install.html" title="http://www.xen-tools.org/software/xen-shell/install.html">http://www.xen-tools.org/software/xen-shell/install.html</a> </p>
<p>Installing &amp; using the Xen-Shell </p>
<p>This shell makes several assumptions in the way that it operates: </p>
<ul><li>That you have a Xen 3.x host running. </li>
<li>Then Xen host has several guests running. </li>
<li>That you don't wish to give your users shell access on the host. </li>
</ul>
<p>If these assumptions are not valid for your environment then you might find that you have problems. </p>
<dl><dt>Installation </dt><dd><p>Download either <a href="http://www.xen-tools.org/releases.html">a release</a>, or a current version of <a href="http://www.xen-tools.org/cvs.html">the CVS repository</a> and install it by executing:</p>
<pre>make install </pre></dd><dt>Configuring Users </dt><dd><p>Each user is expected to login directly to the xen-shell, and not have any other access to the host system. To do this change their login shell by running:</p>
<pre>chsh -s /usr/local/bin/xen-login-shell <strong>username</strong> </pre><p>This will ensure when they connect to the system they will login to the shell, and run it within GNU Screen. </p>
<p><strong>Note:</strong> CVS and Debian binary packages use <span style="font-family:Courier New;">/usr/bin</span> instead of <span style="font-family:Courier New;">/usr/local/</span>. </p>
<p>Once you've changed the shell for the user you must update your Xen configuration files so that they include the username(s) of the users who can control them. </p>
<p>To allow the user "bob" and the user "steve" to control the Xen guest "builder.my.flat" you would add the following to <span style="font-family:Courier New;">/etc/xen/builder.my.flat.cfg</span>:</p>
<pre># All instances must have a name name = 'builder.my.flat'&nbsp;&nbsp;&nbsp;&nbsp; # These users may control this instance. xen_shell = 'bob, steve' </pre></dd><dt>Bandwidth Accounting </dt><dd><p>The shell allows the user to view the bandwidth they have transferred over a given period, using the <span style="font-family:Courier New;">bandwidth</span> command. </p>
<p>For this to work the <span style="font-family:Courier New;">vnstat</span> tool must be installed and configured upon dom0. It is assumed that each Xen guest will have their network interface named the same as the guest name. </p>
<p>For example a Xen guest called 'skx' will have a network interface 'skx' upon dom0. If you're using the standard Xen configuration setup you can achieve this by changing your <span style="font-family:Courier New;">skx.cfg</span> file to read:</p>
<pre>vif = [ 'vifname=skx,ip=1.2.3.4' ] </pre><p><strong>Note</strong>: if you have more than one IP address allocated to a guest you will have to create a more complicated setup. </p>
<p></p>
</dd><dt>Security </dt><dd><p>Since the xen administrator command <span style="font-family:Courier New;">xm</span> requires root privileges to run you will need to configure <span style="font-family:Courier New;">sudo</span> to allow the users who are running your shell to execute that command, without being prompted for a password, as root. </p>
<p>Add something similar to the following to your <span style="font-family:Courier New;">/etc/sudoers</span> file:</p>
<pre>User_Alias&nbsp;&nbsp; XENUSERS = steve,bob,fred,foo Cmnd_Alias&nbsp;&nbsp; XEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= /usr/sbin/xm Cmnd_Alias&nbsp;&nbsp; XENIMG&nbsp;&nbsp; = /usr/bin/xen-create-image XENUSERS&nbsp;&nbsp;&nbsp;&nbsp; ALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= NOPASSWD: XEN,XENIMG </pre><p><strong>Note:</strong> you only need to grant the ability to run <span style="font-family:Courier New;">xen-create-image</span> if you wish to enable reimaging support in the shell. </p>
<p></p>
</dd><dt>DNS Updates </dt><dd><p>When the shell starts it will look for the file <span style="font-family:Courier New;">ips.txt</span> in the home directory of the user who connects. If that file doesn't exist then the <span style="font-family:Courier New;">rdns</span> command will be disabled. </p>
<p>If you wish to allow users to control their reverse DNS create that file and give it contents such as these:</p>
<pre>192.168.1.1 foo.my.domain 192.168.1.2 bar.my.domain </pre><p>This file will be updated by the user when they invoke the <span style="font-family:Courier New;">rdns</span> command. It is up to you to read the files and create the corresponding zonefiles / DNS updates. The shell will only manipulate the file - not push DNS updates itself. </p>
<p></p>
</dd><dt>Reimaging Support </dt><dd><p>If a user connects to the shell and has the executable file <span style="font-family:Courier New;">image.sh</span> in their home directory the <span style="font-family:Courier New;">reimage</span> command will be enabled. </p>
<p>When the user invokes the command the <span style="font-family:Courier New;">image.sh</span> script is executed after prompting for confirmation, and performing a last-chance count-down. </p>
<p>It is up to you to create and configure this script to do the right thing. A sample file for user <span style="font-family:Courier New;">bob</span> could look like this:</p>
<pre>#!/bin/sh /usr/bin/xen-create-image --hostname=bob \&nbsp;&nbsp;--ip=192.168.1.1&nbsp;&nbsp;\&nbsp;&nbsp;--ip=192.168.1.2 \&nbsp;&nbsp;--size=9.5G \&nbsp;&nbsp;--swap=512M&nbsp;&nbsp;--mem=256M \&nbsp;&nbsp;--force </pre><p>This will require a correctly configured instance of <a href="http://www.xen-tools.org/software/xen-tools/">xen-tools</a> and the <span style="font-family:Courier New;">sudoer</span> file to contain the ability for the user to run <span style="font-family:Courier New;">xen-create-image</span>.</p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
</dd></dl><p>Any remaining questions? <a href="http://www.xen-tools.org/contact/">contact the author</a>.</p><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/10">怎么mount一个xen的img映像。转载</a></p><p><a href="http://xinlogs.com/debian-xen-install">debian6.0.5(squeeze)安装配置xen-4.0虚拟化</a></p><p><a href="http://xinlogs.com/cloudstack-on-vmware">cloudstack on vmware</a></p><p><a href="http://xinlogs.com/post/8">ubuntu 9.04 server 安装VMware Tools解决share folders问题</a></p><p><a href="http://xinlogs.com/post/2">CentOS虚拟化服务的配置</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:21:56 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/4</guid>

</item>
<item>
	<title>获取XEN guestOS的images文件</title>
	<link>http://xinlogs.com/post/3</link>
	<description><![CDATA[<h4 class="beTitle"><p>我们可以从<a href="http://stacklet.com/" title="http://stacklet.com/">http://stacklet.com/</a>其实就是原来<a href="http://jailtime.org/" title="http://jailtime.org/">http://jailtime.org/</a>站点找我们需要的xen image文件</p>
</h4>
<div id="msgcns!4986F8F322CC617B!699" class="bvMsg"><p>在2009年的时候，jailtime.org发布了一个新闻</p>
<h6>May 4th, 2009</h6>
<p>The jailtime project has been relaunched with a new name and site: <a href="http://stacklet.com/">Stacklet</a> </p>
<p>As part of the relaunch all of the distributions currently on jailtime have been upgraded to their latest versions. Also, all of the code for creating the images is now publically available – see <a href="http://stacklet.com/">http://stacklet.com/</a> for further details.... </p>
<p>Jailtime will remain online but downloads will probably be turned off eventually as the transition to stacklet proceeds. </p>
<p>所以现在就访问<a href="http://stacklet.com/" title="http://stacklet.com/">http://stacklet.com/</a>就可以了。 </p>
<p>包括如下系统 </p>
<li><ul><li><a href="http://stacklet.com/downloads/images/list/CentOS">CentOS</a> <ul><li><a href="http://stacklet.com/downloads/images/centos/5.3">5.3</a> </li>
<li><a href="http://stacklet.com/downloads/images/centos/5.3.64bit">5.3 (64-bit)</a></li>
</ul>
</li>
<li><a href="http://stacklet.com/downloads/images/list/Debian">Debian</a> <ul><li><a href="http://stacklet.com/downloads/images/debian/5.0">5.0 (Lenny)</a> </li>
<li><a href="http://stacklet.com/downloads/images/debian/5.0.64bit">5.0 (Lenny, 64-bit)</a></li>
</ul>
</li>
<li><a href="http://stacklet.com/downloads/images/list/Fedora">Fedora</a> <ul><li><a href="http://stacklet.com/downloads/images/fedora/10">10</a> </li>
<li><a href="http://stacklet.com/downloads/images/fedora/10.64bit">10 (64-bit)</a></li>
</ul>
</li>
<li><a href="http://stacklet.com/downloads/images/list/Gentoo">Gentoo</a> <ul><li><a href="http://stacklet.com/downloads/images/gentoo/2008-0">2008.0</a> </li>
<li><a href="http://stacklet.com/downloads/images/gentoo/2008-0.64bit">2008.0 (64-bit)</a></li>
</ul>
</li>
<li><a href="http://stacklet.com/downloads/images/list/Mandriva">Mandriva</a> <ul><li><a href="http://stacklet.com/downloads/images/mandriva/2009.0">2009.0</a> </li>
<li><a href="http://stacklet.com/downloads/images/mandriva/2009.0.64bit">2009.0 (64-bit)</a></li>
</ul>
</li>
<li><a href="http://stacklet.com/downloads/images/list/Slackware">Slackware</a> <ul><li><a href="http://stacklet.com/node/13">12.2</a></li>
</ul>
</li>
<li><a href="http://stacklet.com/downloads/images/list/Ubuntu">Ubuntu</a> <ul><li><a href="http://stacklet.com/downloads/images/ubuntu/9.04">9.04 (Jaunty)</a> </li>
<li><a href="http://stacklet.com/downloads/images/ubuntu/9.04.64bit">9.04 (Jaunty, 64-bit)</a></li>
</ul>
</li>
</ul>
</li>
<li><p></p>
<p><strong>下面是一个站点提供的img文件的简单说明</strong></p>
<p><strong>All files on this site are provided without guarantee or warranty. Use at your own risk.</strong> </p>
<p>Each download is a bzipped tarball containing an image and cfg files: </p>
<ul><li><p>a xen guest filesystem</p>
</li>
<li><p>sample xen configuration files to be used with <strong>xm create</strong></p>
</li>
</ul>
<p>The naming convention of the download tarball is: </p>
<p><strong>&lt;distribution&gt;.&lt;distro-version&gt;.&lt;created-date&gt;.img.tar.bz2</strong>. </p>
<p>For example centos.5-3.x86.20090423.img.tar.bz2 contains </p>
<ul><li><p>centos.5-3.x86.img</p>
</li>
<li><p>centos.5-3.x86.xen3.cfg</p>
</li>
<li><p>centos.5-3.x86.xen3.pygrub.cfg（这个文件比较重要，如果用的是CentOS 5.3的虚拟化，就需要这个文件才可以启动guestOS。因为CentOS 5.3没有提供Xen-U的内核。）</p>
</li>
</ul>
<p>All of the packages installed in the image will be the latest versions available as of the created date, which is in yyyy-mm-dd format. </p>
<h3>Prerequisites</h3>
<ol><li><p>Working installation of Xen version 3</p>
</li>
<li><p>The xen daemon (xend) must be running</p>
</li>
<li><p>Enough filesystem space to accomodate the uncompressed tarball (generally 1GB)</p>
</li>
<li><p>Enough unallocated RAM to run the xen guest (generally 128MB)</p>
</li>
</ol>
<h3>Default Configuration and Networking</h3>
<p>Each filesystem is configured to use dhcp. The *.xen.cfg also is also configured for dhcp. It is recommended that you first test the filesystem using dhcp if possible before attempting other networking parameters. Each download page has additional notes on networking that is appropriate for a particular distribution. </p>
<p>The root login is root/password. It is highly recommened that you change the root password immediately. </p>
<h3>Installation</h3>
<p>You will need to uncompress the tarball to a local directory and edit the *.xen.cfg file to point to the uncompressed image and swap file. </p>
<p>If all is well you will see the guest’s boot messages scrolling by. </p>
<p><strong>一些HOWTO文档</strong> </p>
<h3><strong>HOWTO: Filesystems</strong></h3>
<p>In the following howto’s, &lt;image file&gt; should be replaced with a reference to a specific .img file. </p>
<p></p>
<h4><strong>How do I mount an image without booting it?</strong></h4>
<ul><li><p>mkdir -p /mnt/loop</p>
</li>
<li><p>mount -o loop &lt;image file&gt; /mnt/loop/</p>
</li>
</ul>
<p></p>
<h4><strong>How do I resize an image file?</strong></h4>
<p>First, make sure that the image file is not already mounted and is not already running as a xen guest. The following commands increase an image file to 2.5GB. Backup the image before attempting this. </p>
<ul><li><p>dd if=/dev/zero of=&lt;image file&gt; bs=1M conv=notrunc count=1 seek=2500 </p>
</li>
<li><p>losetup /dev/loop0 &lt;image file&gt;</p>
</li>
<li><p>e2fsck -f /dev/loop0</p>
</li>
<li><p>resize2fs /dev/loop0</p>
</li>
<li><p>e2fsck -f /dev/loop0</p>
</li>
<li><p>losetup -d /dev/loop0</p>
</li>
</ul>
<p>You may then boot or mount the image to confirm the increased size. The e2fsck checks in this howto are not strictly necessary. </p>
<p></p>
<h4><strong>How do I move the contents of an img file to a regular partition?</strong></h4>
<p>Mount the img file using the above howto. Assuming the destination partition is mounted at /mnt/dest, execute the following: </p>
<ul><li><p>cp -a /mnt/loop/* /mnt/dest/</p>
</li>
</ul>
<p>You will then be able to boot the filesystem using the partition instead of the image file, which should provide better performance. You will need to update the *.xen.cfg file to reference the partition instead of the img file (the <strong>disk</strong> parameter will need to change, see the <a href="http://www.cl.cam.ac.uk/Research/SRG/netos/xen/readmes/user/user.html">Xen Manual</a>). Also, remember to unmount partitions or img files before booting a xen guest from them! </p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
</li>
</div><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/8">ubuntu 9.04 server 安装VMware Tools解决share folders问题</a></p><p><a href="http://xinlogs.com/post/4">安装和使用xen-shell</a></p><p><a href="http://xinlogs.com/post/13">CentOS 5.3 安装虚拟化后的内存识别问题.</a></p><p><a href="http://xinlogs.com/post/12">CentOS 5.3下成功安装了Xen虚拟化服务。</a></p><p><a href="http://xinlogs.com/post/11">CentOS里的Xen配置pygrub</a></p></div>]]></description>
	<pubDate>Mon, 21 Dec 2009 00:19:35 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/3</guid>

</item>
<item>
	<title>CentOS虚拟化服务的配置</title>
	<link>http://xinlogs.com/post/2</link>
	<description><![CDATA[单位到了一台sun的x4450服务器，打算开学前部署好虚拟化服务，给每位带学生实训的老师一台虚拟的windows 2003 Server. 大约需要20台虚拟服务器<br />
<br />
服务器介绍<br />
<a href="/attachment/1261167436_6473a6f9.jpg" target="_blank"><img src="/attachment/1261167436_6473a6f9.jpg" alt="点击在新窗口中浏览此图片" title="点击在新窗口中浏览此图片" border="0" /></a><br />
 <br />
<br />
硬件配置：<br />
<br />
CPU: 4颗 Intel(R) Xeon(R) CPU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X7460&nbsp;&nbsp;@ 2.66GHz&nbsp;&nbsp; (每颗6核心，供24核心)<br />
<br />
内存: 64G<br />
<br />
硬盘: 8块 Vendor: HITACHI&nbsp;&nbsp; Model: H101414SCSUN146G&nbsp;&nbsp;Rev: SA25 <br />
<br />
虚拟方案<br />
<br />
用CentOS 5.3 64bit 作为DOM0，来管理整个虚拟化服务。然后采用hvm方式虚拟20台Windows server 2003。<br />
<br />
虚拟服务器配置：<br />
<br />
CPU：1颗<br />
<br />
内存：1G<br />
<br />
硬盘：30G<br />
<br />
整体结构如下<br />
<a href="/attachment/1261167488_27328f92.jpg" target="_blank"><img src="/attachment/1261167488_27328f92.jpg" alt="点击在新窗口中浏览此图片" title="点击在新窗口中浏览此图片" border="0" /></a><br />
 <br />
<br />
在SunFire X4450的硬件上，安装Xen虚拟化服务。所有硬件由Xen内核管理，我们的CentOS 5.3 64bit操作系统跑在Xen内核上面，负责管理以后创建的DOM1到DOMN的多个虚拟服务器。<br />
<br />
虚拟化服务的安装<br />
<br />
这个就不具体写了，可以参考我前面的blog或者<br />
<br />
http://www.howtoforge.com/paravirtualization-with-xen-on-centos-5.3-x86_64-p2<br />
<br />
如果不安装图形界面，在用virt-install安装windows操作系统的时候，需要VNC服务。这样可以远程通过VNC客户端连接来安装，因为ssh的方式没有图形界面。<br />
<br />
如果安装了图形界面的CentOS，就很容易了。直接用图形界面的虚拟机管理程序安装即可。<br />
<br />
GUESTOS的配置<br />
<br />
由于每台虚拟服务器安装后，并没有开启远程服务，所以我们还是需要通过VNC连接登入虚拟服务器。在配置好IP和远程服务后，就可以使用远程桌面登陆了。<br />
<br />
在每台虚拟服务器的配置文件里，加入如下语句<br />
<br />
vnc = 2<br />
vncunused = 2<br />
vnclisten = "10.10.15.151"<br />
vncpasswd = "password" <br />
<br />
注意：password为登陆vnc的密码，根据实际情况设置。vnclisten设置的是主机CentOS的IP <br />
<br />
突破8台虚拟服务器的限制 <br />
<br />
默认安装后，CentOS的max_loop最大值是8，这样我们默认只能启动8个虚拟服务器（不过半虚拟的linux好像不受这个影响） <br />
<br />
我们需要修改这个参数 <br />
<br />
rmmod loop <br />
<br />
echo "options loop max_loop=64"&gt;/etc/modprobe.d/loop <br />
<br />
modprobe loop <br />
<br />
这样就可以了。<br />
<br />
配置网络<br />
<br />
我的服务器是有4块网卡 eth0、eth1、eth2、eth3<br />
<br />
我打算eth0 采用10.10.15.151 ip地址，其他网卡不设置IP地址并且将/etc/sysconfig/network-scripts/下对应的脚本文件修改如下<br />
<br />
ONBOOT=no <br />
<br />
这样可以让系统启动后，就eth0可以用来访问。其他网卡都没有对应ip地址 <br />
<br />
其他网卡的作用是留给虚拟服务器用的。我们通过修改xen的配置文件，让eth0到eth1绑定到xenbr0到xenbr3上面。然后20台服务器，10台通过xenbr1访问网络，10台通过xenbr2访问 <br />
<br />
在rc.local文件里，添加 <br />
<br />
/etc/xen/scripts/new-bridge start <br />
<br />
new-bridge是我们自己写的脚本文件，为了创建xenbr0到xenbr3。xen系统默认就创建一个xenbr0<br />
<br />
new-bridge文件内容如下<br />
<br />
vi /etc/xen/scripts/new-bridge <br />
<br />
#######################################################################<br />
#!/bin/sh<br />
# Exit if anything goes wrong.<br />
set -e <br />
<br />
# First arg is the operation.<br />
OP=$1<br />
shift <br />
<br />
script=/etc/xen/scripts/network-bridge.xen <br />
<br />
case ${OP} in<br />
start)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script start vifnum=0 bridge=xenbr0 netdev=eth0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script start vifnum=1 bridge=xenbr1 netdev=eth1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script start vifnum=2 bridge=xenbr2 netdev=eth2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script start vifnum=3 bridge=xenbr3 netdev=eth3<br />
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script start vifnum=2 bridge=xenbri netdev=dummy0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;; <br />
<br />
stop)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script stop vifnum=0 bridge=xenbr0 netdev=eth0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script stop vifnum=1 bridge=xenbr1 netdev=eth1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script stop vifnum=2 bridge=xenbr2 netdev=eth2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script stop vifnum=3 bridge=xenbr3 netdev=eth3<br />
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script stop vifnum=2 bridge=xenbri netdev=dummy0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;; <br />
<br />
status)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script status vifnum=0 bridge=xenbr0 netdev=eth0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script status vifnum=1 bridge=xenbr1 netdev=eth1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script status vifnum=2 bridge=xenbr2 netdev=eth2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script status vifnum=3 bridge=xenbr3 netdev=eth3<br />
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script status vifnum=2 bridge=xenbri netdev=dummy0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;; <br />
<br />
*)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo 'Unknown command: ' ${OP}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo 'Valid commands are: start, stop, status'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit 1<br />
esac<br />
######################################################################## <br />
<br />
安装xen-shell，让用户自己管理自己的虚拟服务器<br />
<br />
具体安装步骤就不写了，参考我前面的文章吧<br />
<br />
安装和使用xen-shell<br />
或者<br />
http://www.xen-tools.org/software/xen-shell/install.html<br />
<br />
注意<br />
<br />
安装这个，需要screen这个软件，可以通过yum install screen安装<br />
<br />
再有就是需要/etc/xen/下面的虚拟机配置文件有对应的权限<br />
<br />
安装后，用root用户，直接输入xen-shell看看能不能进入，如果报错，根据提示修改。<br />
<br />
全部安装完成后，让我们看看20台虚拟服务器跑起来的效果<br />
<a href="/attachment/1261167559_428417c1.png" target="_blank"><img src="/attachment/1261167559_428417c1.png" alt="点击在新窗口中浏览此图片" title="点击在新窗口中浏览此图片" border="0" /></a><br />
 <br />
<a href="/attachment/1261167687_28697aa8.png" target="_blank"><img src="/attachment/1261167687_28697aa8.png" alt="点击在新窗口中浏览此图片" title="点击在新窗口中浏览此图片" border="0" /></a><br />
 <br />
<br />
再来看看网络的使用情况<br />
<a href="/attachment/1261167687_3856f34f.png" target="_blank"><img src="/attachment/1261167687_3856f34f.png" alt="点击在新窗口中浏览此图片" title="点击在新窗口中浏览此图片" border="0" /></a><br />
 <br />
<br />
通过上面的brctl show可以清楚的看到，虚拟服务器的网卡，都放到了xenbr1和xenbr2下面了。<br />
<br />
再来看看vnc登陆的界面，注意VNC登陆后，不能直接用键盘的Ctrl+Alt+Del登陆，我们可以通过右键点窗口来选择Send Ctrl+Alt+Del来实现发送这三个按键消息。<br />
<a href="/attachment/1261167687_4292768c.png" target="_blank"><img src="/attachment/1261167687_4292768c.png" alt="点击在新窗口中浏览此图片" title="点击在新窗口中浏览此图片" border="0" /></a><br />
 <br />
<br />
配置好虚拟服务器的IP和远程桌面后，我们就可以采用远程桌面连接了。<br />
<br />
 <br />
<br />
用户自己管理自己的服务器<br />
<br />
其实有了远程桌面，用户就可以通过这个登陆服务器，重启和修改配置了。但是如果关机以后，就没有办法开机了。<br />
<br />
我们安装xen-shell就能实现用户自己通过用户名和密码登陆命令行格式的界面来启动服务器。<br />
<br />
首先我们要给我们每台虚拟服务器建立一个CentOS系统上的用户，让后按照Xen-shell的要求配置，这个不具体介绍了，参考<br />
<br />
安装和使用xen-shell<br />
或者<br />
http://www.xen-tools.org/software/xen-shell/install.html<br />
<br />
以后用户就可以通过putty登陆到自己的虚拟服务器管理命令行了。<br />
<br />
 <br />
<br />
xen-shell可以让用户自己启动、重启、关闭虚拟服务器，还可以查看虚拟服务器的状态、运行时间等。<br />
<br />
如果在用户对应目录下编写好image.sh文件，还可以让用户自己rebuild操作系统。<br />
<br />
有了这个，基本管理员告诉用户他的xen-shell用户，虚拟服务器的ip就ok了。其他的用户自己都可以管理了。<br />
<br />
其他问题<br />
<br />
如何让guestos随主系统自动启动，这个可以参考xen文档。<br />
<br />
如何克隆guestos系统，这个可以参考virt-clone<br />
<br />
如何安装多个linxu guest系统，这个可以参考获取XEN guestOS的images文件<br />
<br />
整个安装断断续续弄了大约2周，目前总算ok了。<br /><div id="related_log" style="font-size:12px"><p><b>相关日志：</b></p><p><a href="http://xinlogs.com/post/10">怎么mount一个xen的img映像。转载</a></p><p><a href="http://xinlogs.com/post/3">获取XEN guestOS的images文件</a></p><p><a href="http://xinlogs.com/post/11">CentOS里的Xen配置pygrub</a></p><p><a href="http://xinlogs.com/post/12">CentOS 5.3下成功安装了Xen虚拟化服务。</a></p><p><a href="http://xinlogs.com/post/5">ubuntu 9.04安装xen</a></p></div>]]></description>
	<pubDate>Fri, 18 Dec 2009 20:14:30 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/2</guid>

</item>
<item>
	<title>我的网站开通了，www.xinlogs.com.</title>
	<link>http://xinlogs.com/post/1</link>
	<description><![CDATA[<p>以前一直在断断续续的写Blog，开始放在百度的空间。网址http://hi.baidu.com/babodx<br />后来在09年7月，觉得<a href="http://hi.baidu.com/babodx">http://hi.baidu.com/babodx</a>空间的功能太少了，就搬家到了<a href="http://babodx.spaces.live.com/">http://babodx.spaces.live.com</a>并且注册了xinlogs.com域名。<br />后来就一直关注VPS空间，觉得这个很好，相当于自己有了一台虚拟的服务器，完全可以自己在上面配置各种服务。<br />于是在2009年12月18日，我终于决定购买了rashost.com的1款128M内存的VPS，位置在美国的洛杉矶机房。<br />价格还算便宜1个月68元。<br />rashost的有点就是不限制流量，而且CPU采用intel至强的。速度也不错<br />我选择了CentOS 5.3系统<br /><br /><strong>CPU信息</strong>model name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Intel(R) Xeon(R) CPU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X3220&nbsp;&nbsp;@ 2.40GHz<br /><strong>内存信息<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; used&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; free&nbsp;&nbsp;&nbsp;&nbsp; shared&nbsp;&nbsp;&nbsp;&nbsp;buffers&nbsp;&nbsp;&nbsp;&nbsp; cached<br />Mem:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 128&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;119&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 67<br />-/+ buffers/cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 86<br />Swap:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255<br /></strong></p><br />我的网站采用Nginx+PHP+MySQL+Bo-Blog架设，参考了<a href="http://www.s135.com/">www.s135.com</a>上的优化方法。<br/><br/>后面剩下的工作就是如何将以前blog的文章搬家够来了。。。估计够折腾一阵子的。]]></description>
	<pubDate>Fri, 18 Dec 2009 20:06:36 +0000</pubDate>
	<author>babo</author>
	<guid>http://xinlogs.com/post/1</guid>

</item></channel>
</rss>
