--- 
categories: []
comments: true
layout: post
title: CentOS下的Tomcat停止脚本
---
我在CentOS 5.3 64bit上安装的Tomcat有个小问题，就是不能通过service tomcat stop停止或者server tomcat restart重启。
我看了下/etc/init.d/tomcat的文件，和以前没有什么不一样，但就是不能正常停止。
后来我自己修改了/etc/init.d/tomcat文件，改为直接kill进程。目前已经可以正常通过service关闭或者重启tomcat了。
下面是我/etc/init.d/tomcat文件内容，贴出来留着以后查看。呵呵
<div class="codeText">
<span class="copyCodeText" onclick="copyIdText('code_5403');" style="cursor:pointer;">复制内容到剪贴板</span> <div id="code_5403">
<ol class="dp-cpp" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
<li class="alt"><span><span class="preprocessor">#!/bin/bash </span><span>  </span></span></li>
    <li>
<span class="preprocessor"># </span><span>  </span>
</li>
    <li class="alt">
<span class="preprocessor"># Startup script for the tomcat </span><span>  </span>
</li>
    <li>
<span class="preprocessor"># </span><span>  </span>
</li>
    <li class="alt">
<span class="preprocessor"># chkconfig: 345 80 15 </span><span>  </span>
</li>
    <li>
<span class="preprocessor"># description: Tomcat is a Servlet+JSP Engine. </span><span>  </span>
</li>
    <li class="alt"><span>  </span></li>
    <li>
<span class="preprocessor"># Source function library. </span><span>  </span>
</li>
    <li class="alt"><span>. /etc/rc.d/init.d/functions   </span></li>
    <li><span>  </span></li>
    <li class="alt"><span>  </span></li>
    <li><span>export JAVA_HOME=/usr/local/jdk1.6.0_16   </span></li>
    <li class="alt"><span>export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar   </span></li>
    <li><span>export PATH=$PATH:$JAVA_HOME/bin   </span></li>
    <li class="alt"><span>  </span></li>
    <li><span>export CATALINA_BASE=/usr/local/tomcat   </span></li>
    <li class="alt"><span>export CATALINA_HOME=/usr/local/tomcat   </span></li>
    <li><span>export CATALINA_TMPDIR=/usr/local/tomcat/temp   </span></li>
    <li class="alt"><span>export JRE_HOME=/usr/local/jdk1.6.0_16   </span></li>
    <li><span>  </span></li>
    <li class="alt"><span>  </span></li>
    <li><span>  </span></li>
    <li class="alt"><span>start(){   </span></li>
    <li>
<span class="keyword">if</span><span> [ -z $(/sbin/pidof java) ]; then   </span>
</li>
    <li class="alt">
<span>echo </span><span class="string">"Starting tomcat"</span><span>  </span>
</li>
    <li><span>/usr/local/tomcat/bin/startup.sh   </span></li>
    <li class="alt"><span>touch /var/lock/subsys/tomcat   </span></li>
    <li>
<span class="keyword">else</span><span>  </span>
</li>
    <li class="alt">
<span>echo </span><span class="string">"tomcat allready running"</span><span>  </span>
</li>
    <li><span>fi   </span></li>
    <li class="alt"><span>}   </span></li>
    <li><span>  </span></li>
    <li class="alt"><span>stop(){   </span></li>
    <li>
<span class="keyword">if</span><span> [ ! -z $(/sbin/pidof java) ]; then   </span>
</li>
    <li class="alt">
<span>echo </span><span class="string">"Shutting down tomcat"</span><span>  </span>
</li>
    <li>
<span>ps aux|grep tomcat|grep startup|awk </span><span class="string">'{print $2}'</span><span>|xargs kill -9   </span>
</li>
    <li class="alt">
<span class="preprocessor">#/usr/local/tomcat/bin/shutdown.sh </span><span>  </span>
</li>
    <li>
<span>until [ -z $(/sbin/pidof java) ]; </span><span class="keyword">do</span><span> :; done   </span>
</li>
    <li class="alt"><span>rm -f /var/lock/subsys/tomcat   </span></li>
    <li>
<span class="keyword">else</span><span>  </span>
</li>
    <li class="alt">
<span>echo </span><span class="string">"tomcat not running"</span><span>  </span>
</li>
    <li><span>fi   </span></li>
    <li class="alt"><span>}   </span></li>
    <li><span>  </span></li>
    <li class="alt">
<span class="keyword">case</span><span> </span><span class="string">"$1"</span><span> in   </span>
</li>
    <li><span>start)   </span></li>
    <li class="alt"><span>start   </span></li>
    <li><span>;;   </span></li>
    <li class="alt"><span>stop)   </span></li>
    <li><span>stop   </span></li>
    <li class="alt"><span>;;   </span></li>
    <li><span>restart)   </span></li>
    <li class="alt"><span>stop   </span></li>
    <li><span>start   </span></li>
    <li class="alt"><span>;;   </span></li>
    <li><span>status)   </span></li>
    <li class="alt"><span>/usr/local/tomcat/bin/catalina.sh version   </span></li>
    <li><span>;;   </span></li>
    <li class="alt"><span>*)   </span></li>
    <li>
<span>echo </span><span class="string">"Usage: $0 {start|stop|restart|status}"</span><span>  </span>
</li>
    <li class="alt"><span>esac   </span></li>
    <li><span>  </span></li>
    <li class="alt"><span>exit 0   </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css">
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>
 <div id="related_log" style="font-size:12px">
<b>相关日志：</b><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a><a href="http://xinlogs.com/monit-to-monitor-services">monit监控linux服务</a><a href="http://xinlogs.com/centos-linux-sshclient-unreadable-code">Centos Linux 远程终端ssh乱码问题</a><a href="http://xinlogs.com/post/16">一个很好的开源企业内部IM解决方案</a><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a>
</div>
