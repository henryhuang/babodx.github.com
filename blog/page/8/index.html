
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>鑫的方向</title>
  <meta name="author" content="babodx">

  
  <meta name="description" content="原来一直用tar、sync等软件实现备份。需要些脚本还要找一台其他服务器进行同步。现在有了DROPBOX这个网站提供的服务，一切都变容易了。 DROPBOX网站：
http://www.dropbox.com/
DROP功能：
偷懒直接把官方介绍帖过来了。主要就是免费提供2G的同步空间， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://babodx.github.com/blog/page/8/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="鑫的方向" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">鑫的方向</a></h1>
  
    <h2>简单就是不简单！</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:babodx.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/service">运维服务</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/05/vps-dropbox-install/">一款Linux下同步备份文件的好软件DROPBOX</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-05T00:00:00+08:00" pubdate data-updated="true">Apr 5<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>原来一直用tar、sync等软件实现备份。需要些脚本还要找一台其他服务器进行同步。现在有了DROPBOX这个网站提供的服务，一切都变容易了。</p>

<p><strong>DROPBOX网站：</strong>
<a href="www.dropbox.com">http://www.dropbox.com/</a>
<strong>DROP功能：</strong>
偷懒直接把官方介绍帖过来了。主要就是免费提供2G的同步空间，可以自动同步文件并保留文件的历史版本</p>

<h1>Dropbox Features</h1>


<h2 id="sync">File Sync</h2>


<p>Dropbox allows you to sync your files online and across your computers automatically.</p>

<ul class="blue-bullets">
<li>2GB of online storage for free, with up to 100GB available to paying customers.</li>
    <li>Sync files of any size or type.</li>
    <li>Sync Windows, Mac and Linux computers.</li>
    <li>Automatically syncs when new files or changes are detected.</li>
    <li>Work on files in your Dropbox even if you&#8217;re offline. Your changes sync once your computer has an Internet connection again.</li>
    <li>Dropbox transfers will correctly resume where they left off if the connection drops.</li>
    <li>Efficient sync - only the pieces of a file that changed (not the whole file) are synced. This saves you time.</li>
    <li>Doesn&#8217;t hog your Internet connection. You can manually set bandwidth limits. </li>
</ul>


<h2 id="sharing">File Sharing</h2>


<p>Sharing files is simple and can be done with only a few clicks.</p>

<ul class="blue-bullets">
<li>Shared folders allow several people to collaborate on a set of files.</li>
    <li>You can see other people&#8217;s changes instantly.</li>
    <li>A &#8220;Public&#8221; folder that lets you link directly to files in your Dropbox.</li>
    <li>Control who is able to access shared folders (including ability to kick people out and remove the shared files from their computers).</li>
    <li>Automatically create shareable online photo galleries from folders of photos in your Dropbox.</li>
</ul>


<h2 id="backup">Online Backup</h2>


<p>Dropbox backs up your files online without you having to think about it.</p>

<ul class="blue-bullets">
<li>Automatic backup of your files.</li>
    <li>Undelete files and folders.</li>
    <li>Restore previous versions of your files.</li>
    <li>30 days of undo history, with unlimited undo available as a paid option.</li>
</ul>


<h2 id="web">Web Access</h2>


<p>A copy of your files are stored on Dropbox&#8217;s secure servers. This lets you access them from any computer or mobile device.</p>

<ul class="blue-bullets">
<li>Manipulate files as you would on your desktop - add, edit, delete, rename etc.</li>
    <li>Search your entire Dropbox for files.</li>
    <li>A &#8220;Recent Events&#8221; feed that shows you a summary of activity in your Dropbox.</li>
    <li>Create shared folders and invite people to them.</li>
    <li>Recover previous versions of any file or undelete deleted files.</li>
    <li>View photo galleries created automatically from photos in your Dropbox.</li>
</ul>


<h2 id="security">Security & Privacy</h2>


<p>Dropbox takes the security and privacy of your files very seriously.</p>

<ul class="blue-bullets">
<li>Shared folders are viewable only by people you invite.</li>
    <li>All transmission of file data and metadata occurs over an encrypted channel (SSL).</li>
    <li>All files stored on Dropbox servers are encrypted (AES-256) and are inaccessible without your account password.</li>
    <li>Dropbox website and client software have been hardened against attacks from hackers.</li>
    <li>Dropbox employees are not able to view any user&#8217;s files.</li>
    <li>Online access to your files requires your username and password.</li>
    <li>Public files are only viewable by people who have a link to the file(s). Public folders are not browsable or searchable.</li>
</ul>


<h2 id="mobile">Mobile Device Access</h2>


<p>The free <a href="http://www.xinlogs.com/iphoneapp">Dropbox iPhone app</a> lets you:</p>

<ul class="blue-bullets">
<li>Access your Dropbox on the go.</li>
    <li>View your files on your iPhone or iPod Touch.</li>
    <li>Download files for offline viewing.</li>
    <li>Take photos and videos and sync them to your Dropbox.</li>
    <li>Share links to files in your Dropbox.</li>
    <li>View interactive photo galleries.</li>
    <li>Sync downloaded files so they&#8217;re up-to-date.</li>
</ul>


<p> </p>

<p>A mobile-optimized version of the website is available for owners of Blackberry phones and other Internet-capable mobile devices.
 
<strong>Linux下安装</strong></p>

<p>如果你的Linux服务器安装了Xserver和桌面，完全可以安装官方的指南来安装。但是因为一般的VPS都内存小得可怜，不会奢侈到安装桌面，所以下面主要介绍在没有安装桌面系统的命令行Linux下安装步骤。
关于安装方法的内容转帖自<a href="http://lazyhack.net/install-dropbox-in-vps/">http://lazyhack.net/install-dropbox-in-vps/</a>
<strong>1、登陆进VPS或者是服务器，进入用户目录</strong></p>

<div class="codeText">
<div id="code_6795">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
<li class="alt">
<span><span>cd </span></span>     <link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css">
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</li>
</ol>
</div>
</div>


<p><strong>2、下载dropbox的客户端，要For linux那个而非For Nautilus的</strong>
这里我是在<a href="http://lazyhack.net/install-dropbox-in-vps/">http://lazyhack.net/install-dropbox-in-vps/</a>文档中找到的地址，官方网站找了半天都是Nautilus的版本
32位下载地址 <a href="http://www.dropbox.com/download?plat=lnx.x86">http://www.dropbox.com/download?plat=lnx.x86</a>
64位下载地址 <a href="http://www.dropbox.com/download?plat=lnx.x86_64">http://www.dropbox.com/download?plat=lnx.x86_64</a>
我这里用的32位系统，所以下载32位客户端</p>

<div class="codeText">
<div id="code_2958">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
<li class="alt">
<span><span>wget http://www.dropbox.com/download?</span><span class="attribute">plat</span><span>=</span><span class="attribute-value">lnx</span><span>.x86 </span></span>     <link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css">
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</li>
</ol>
</div>
</div>


<p><strong>3、解压</strong></p>

<div class="codeText">
<div id="code_2090">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
<li class="alt"><span><span>tar zxvf dropbox-lnx.x86-0.7.110.tar.gz </span></span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css">
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>


<p><strong>4、下载dbmakefilelib.py并运行</strong></p>

<div class="codeText">
<div id="code_3236">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
<li class="alt"><span><span>wget http://dl.dropbox.com/u/637552/Dropbox/dbmakefilelib.py </span></span></li>
    <li><span>python dbmakefilelib.py </span></li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css">
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>


<p>如果出现以下信息，说明它运行正常
dropboxd ran for 15 seconds without quitting - success?
看到它的提示了吗，<a target="_blank" href="http://www.vpser.net/go/dropbox">Dropbox</a>已经启动了，让你运行15秒后再退出，这个过程就是dropbox生成机器信息并保存到db文件的，其实对于国外的<a title="查看 vps 的全部文章" target="_blank" href="http://lazyhack.net/tag/vps/">vps</a>来说几秒时间就够了，我们ctrl－c将其退出，完成接下来的步骤<br>
 
<strong>5、进入</strong><a target="_blank" href="http://www.vpser.net/go/dropbox"><strong>Dropbox</strong></a><strong>的dot目录导出机器信息</strong></p>

<div class="codeText">
<div id="code_7591">
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
<li class="alt"><span><span>cd .~/.dropbox </span></span></li>
    <li><span>$ sqlite3 dropbox.db </span></li>
    <li class="alt"> </li>
    <li><span>SQLite version 3.6.22 </span></li>
    <li class="alt"><span>Enter &#8220;.help&#8221; for instructions </span></li>
    <li><span>Enter SQL statements terminated with a &#8220;;&#8221; </span></li>
    <li class="alt">
<span>sqlite</span><span class="tag">></span><span> .dump config </span>
</li>
</ol>
</div>
<link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css">
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</div>


<p>我们会在导出的信息中看到如下的一串字符</p>

<div>
<div>
<pre>INSERT INTO "config" VALUES(4,'host_id','VmQ0NWFlMTdmYmQ3OGYzMzgyOTM0NWMzN2Q1MGFkOTIzCnAxCi4=
');</pre> </div>
</div>


<p>这个host_id就是机器的唯一标识，我们需要用它来跟自己的账户进行匹配，不过在这之前还有个工作需要做，因为上面的那长串字符很明显可以看出 是用base64编码后的结果，我们得先把它解码再说，注意这里<a target="_blank" href="http://www.vpser.net/go/dropbox">Dropbox</a>耍了个小花招，这串字符串前面的那个”V“，是无用的，我们在解码后的把它 忽略掉<br>
 
<strong>6、将base64字符串解码</strong>
 </p>

<p><strong> </strong></p>

<div class="codeText"><strong> <span><span>$ echo </span><span class="attribute">mQ0NWFlMTdmYmQ3OGYzMzgyOTM0NWMzN2Q1MGFkOTIzCnAxCi4</span><span>= ｜ base64 -d </span></span>
<div>
<ol class="dp-xml" style="border-bottom:0px;border-left:0px;list-style-type:none;margin-left:5px;border-top:0px;border-right:0px;">
<li><span>Vd45ae17fbd78f33829345c37d50ad923 </span></li>
    <li>
<span>p1 </span>     <link rel="stylesheet" type="text/css" href="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/insertcode.css">
<script language="javascript" src="http://www.xinlogs.com/editor/fckeditor/editor/plugins/insertcode/excute.js" type="text/javascript"></script>
</li>
</ol>
</div>
</strong></div>


<p><strong> <pre>我的结果是Vd45ae17fbd78f33829345c37d50ad923，忽略掉”V“，就是d45ae17fbd78f33829345c37d50ad923</pre> </strong>
 
 
 
 
<strong>7、将账户信息与机器信息绑定</strong><br>
这步很简单，只需要访问以下网址，并登陆<br>
HOSTID替换成你刚才解码出来的那串字符就行了</p>

<pre><code>https://www.dropbox.com/cli_link?host_id=HOSTID</code></pre>


<p> <strong>8、建立dropbox的同步目录</strong><br>
dropbox的同步目录默认的是~/Dropbox</p>

<pre><code>$ mkdir ~/Dropbox</code></pre>


<p> <strong>9、运行，开始你的同步</strong>
<code>$ ~/.dropbox-dist/dropboxd &amp;</code>
到这里dropbox就可以正常运行并同步了，文章标题说的是备份网站数据，那么我们就来使我们的网站数据能够同步到dropbox服务器上<br>
其实很简单，就是建立符号连接而已，windows之前是没有这个功能的<br>
比如要备份/var/www这个目录</p>

<pre><code>cd ~/Dropbox
$ ln -s /var/www web_backup</code></pre>


<p> 这就可以了,或者要备份/e<a title="tc" target="_blank" href="http://wiki.lazyhack.net/tc">tc</a>目录</p>

<pre><code>$ cd ~/Dropbox
$ ln -s /etc etc_backup</code></pre>


<p> ok.发挥你的想象尽情的使用吧。<br>
 
<strong>推广</strong>
如果你看过这篇文章后，打算也使用dropbox。那么你可以使用我下面的链接注册
<a href="https://www.dropbox.com/referrals/NTU4NDMyNzI5">https://www.dropbox.com/referrals/NTU4NDMyNzI5</a>
采用这个链接注册，你会增加250M空间。注册后是2G，然后会给你再发封邮件告诉你已经提升到2.25G。而我也会增加250M空间。<div id="related_log" style="font-size:12px">
<b>相关日志：</b><a href="http://xinlogs.com/post/20">ubuntu下arp攻击防御和反击！</a><a href="http://xinlogs.com/post/16">一个很好的开源企业内部IM解决方案</a><a href="http://xinlogs.com/post/108">CentOS下的Tomcat停止脚本</a><a href="http://xinlogs.com/Tomcat-reboot-problems">解决Linux下Tomcat不能重启和停止问题</a><a href="http://xinlogs.com/php-eaccelerator-vs-fastcgi-cache">php eaccelerator vs fastcgi_cache性能比较</a>
</div></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/05/disable-mysql-query-log/">开启或者关闭MYSQL的query Log(查询日志)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-05T00:00:00+08:00" pubdate data-updated="true">Apr 5<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>最近在整理服务器的时候，发现mysql的查询日志文件占用了很多空间。这个查询日志文件部分内容如下，随着查询增加，会越来越大</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Tcp port: 3306 Unix socket: /tmp/mysql.sock
</span><span class='line'>Time Id Command Argument
</span><span class='line'>100404 8:36:49 1 Connect zzz@localhost on
</span><span class='line'>1 Init DB zzz
</span><span class='line'>1 Query SET NAMES 'utf8'
</span><span class='line'>1 Query SELECT * FROM `boblog_counter` LIMIT 0,1
</span><span class='line'>1 Query SELECT `blogid`,`pubtime`,`edittime`,`blogalias` FROM `boblog_blogs` WHERE `property`&lt;2 ORDER BY `pubtime`DESC LIMIT 0, 1500
</span><span class='line'>1 Quit
</span><span class='line'>100404 8:38:01 2 Connect admin@localhost on
</span><span class='line'>2 Init DB zzz
</span><span class='line'>2 Query SET NAMES 'utf8'
</span><span class='line'>2 Query SET sql_mode=''
</span><span class='line'>2 Query SELECT * FROM `cmseasy_settings` WHERE `tag`='table-fieldset' ORDER BY 1 DESC limit 1
</span><span class='line'>2 Init DB zzz
</span><span class='line'>2 Query SET NAMES 'utf8'
</span><span class='line'>2 Query SET sql_mode=''
</span><span class='line'>2 Query SELECT * FROM `cmseasy_user` WHERE userid&gt;0 ORDER BY 1 DESC limit 1
</span><span class='line'>2 Init DB zzz
</span><span class='line'>2 Query SET NAMES 'utf8'
</span><span class='line'>2 Query SET sql_mode=''
</span><span class='line'>2 Query SELECT count(typeid) as rec_sum FROM `cmseasy_type`
</span><span class='line'>2 Query SELECT * FROM `cmseasy_type` ORDER BY `order`,1 limit 1000
</span><span class='line'>2 Init DB zzz
</span><span class='line'>2 Query SET NAMES 'utf8'
</span><span class='line'>2 Query SET sql_mode=''
</span><span class='line'>2 Query SELECT count(1) as rec_sum FROM `cmseasy_friendlink` WHERE state&gt;0 and linktype=1
</span><span class='line'>2 Query SELECT * FROM `cmseasy_friendlink` WHERE state&gt;0 and linktype=1 ORDER BY listorder asc,id limit 20
</span><span class='line'>2 Init DB zzz
</span><span class='line'>2 Query SET NAMES 'utf8'
</span><span class='line'>2 Query SET sql_mode=''
</span><span class='line'>2 Query SELECT count(1) as rec_sum FROM `cmseasy_friendlink` WHERE state&gt;0 and linktype=1
</span><span class='line'>2 Query SELECT * FROM `cmseasy_friendlink` WHERE state&gt;0 and linktype=1 ORDER BY listorder asc,id limit 20
</span><span class='line'>2 Init DB zzz
</span><span class='line'>2 Query SET NAMES 'utf8'
</span><span class='line'>2 Query SET sql_mode=''
</span><span class='line'>2 Query SELECT * FROM `cmseasy_templatetag` WHERE name='å~E¬å~O¸ç®~@ä»~K' ORDER BY 1 DESC limit 1
</span><span class='line'>2 Init DB zzz
</span><span class='line'>2 Query SET NAMES 'utf8'
</span><span class='line'>2 Query SET sql_mode=''
</span><span class='line'>2 Query Describe cmseasy_archive
</span><span class='line'>2 Query SELECT count(1) as rec_sum FROM `cmseasy_archive` WHERE typeid in (2) and checked=1 and (state IS NULL or state&lt;&gt;'-1')
</span><span class='line'>2 Query SELECT * FROM `cmseasy_archive` WHERE typeid in (2) and checked=1 and (state IS NULL or state&lt;&gt;'-1') ORDER BY aid desc limit 4
</span></code></pre></td></tr></table></div></figure>


<p>其实记录的都是mysql执行的一些select语句，对于正常运行的服务器，我觉得基本没有必要保留这些日志。</p>

<p>关键是怎么关闭，这个日志的开启与否，可以通过mysql里提交如下命令查看</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>show variables like 'log';</span></code></pre></td></tr></table></div></figure>


<p>如果现实 log 的值是 ON就代码开启，如果是OFF就代表关闭</p>

<p>我们可以通过my.cnf配置文件进行配置</p>

<p>在my.cnf文件里，加入general-log = 0就关闭了这个查询日志。如果是general-log = 1就开启了这个查询日志。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/05/alipay-godaddy/">支付宝支付godaddy的郁闷经历</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-05T00:00:00+08:00" pubdate data-updated="true">Apr 5<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>最近帮朋友弄了个网站并注册了域名。</p>

<p>注册域名的时候，选择域名注册商，我原来用的namecheap.com 后来网上看很多人推荐name.com和godaddy.com。</p>

<p>因为godaddy.com支持支付宝，我就选择了godaddy来注册。</p>

<p>其实上面提到的三家都不错，godaddy域名价格最便宜。按照网站提示注册，购买域名，然后支付宝付款。</p>

<p>郁闷就开始。。。。</p>

<p>支付宝显示付款成功，但是godaddy购买的域名还在购物车中，并没有购买成功。</p>

<p><img src="http://farm9.staticflickr.com/8099/8513704243_1d8fb87879_z.jpg" alt="付款成功截图" /></p>

<p>我开始发邮件询问godaddy是什么情况。。。下面是我接到的回复。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>
</span><span class='line'>    Thank you for contacting customer support. Unfortunately, products purchased with Alipay may not be available for up to 13 hours while Alipay confirms that the funds have been received. A receipt does not display until the products are available in the account. If this time frame has passed since your initial purchase, please let us know so we may troubleshoot further.   
</span><span class='line'>      
</span><span class='line'>    I apologize if I have misunderstood your question. If you find this information does not help you, please reply to this email with a revised description of the issue you  are having.   
</span><span class='line'>      
</span><span class='line'>    If we can assist you further in this matter please let us know.   
</span><span class='line'>      
</span><span class='line'>    Sincerely,   
</span><span class='line'>    Jesse P   
</span><span class='line'>    Online Support Team  
</span></code></pre></td></tr></table></div></figure>


<p>告诉我支付宝支付需要13个小时的确认时间？？？</p>

<p>我继续发信说明我注册域名是为了立即使用，13小时太长了，我去name.com注册了。他们回信却告诉我，可以退款，但退款周期是5-7个工作日。。。</p>

<p>以前用paypal支付过，都是支付后，域名马上可以使用。这次的支付宝支付太郁闷了。</p>

<p>不过godaddy确实大公司，不用担心他们不退款。我2010-03-31 09:24:44支付成功的，他们在2010-04-02 10:46:22已经将钱打回我支付宝了。</p>

<p>为了以后购买域名不郁闷，我当天下午就去申请里双币信用卡。以后都用paypal支付了。在这里提醒下大家，如果要用支付宝支付godaddy来购买域名，请耐心等待确认支付，而且这个期间不要修改购物车内容，不然会信息支付和购物车不符合而造成购买失败。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/03/17/HTC-Hero-Openvpn/">HTC Hero G3 Openvpn设置</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-17T00:00:00+08:00" pubdate data-updated="true">Mar 17<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>现在YouTube和google博客等站点都被屏蔽，为了打破限制，只能用vpn来穿越了。</p>

<p>原来一直用pptpd类型vpn，这种类型速度快，但是要求防火墙或者网关支持。对内外支持不好（反正我在单位和家里歌华宽带都不支持）</p>

<p>后来改用openvpn类型的vpn了，发现虽然openvpn配置麻烦，需要安装客户端。但却是对内网支持良好，穿透能力强。</p>

<p>openvpn可以支持多系统（服务器我肯定用linux，这里多系统主要指客户端）</p>

<p>Windows系统可以采用openvpn gui，这个在我博客以前文章提到了，今天要说的是我的手机，htc hero这次也可以让手机连接openvpn服务器上youtube等站点了。</p>

<p><strong>手机型号及系统</strong></p>

<p>我的手机是HTC hero g3</p>

<p>采用的ROM是Flyzup制作的基于android 1.5修改的。</p>

<p>Rom可以到Flyzup网站下载
<a href="http://www.innovative-space.com/2010/02/21/flzyup-custom-rom-v1-6-final-release/">http://www.innovative-space.com/2010/02/21/flzyup-custom-rom-v1-6-final-release/</a></p>

<p>其实只要手机用的Rom可以支持openvpn，存在tun.so文件就可以</p>

<p><strong>安装相关软件</strong></p>

<p>首先需要需要安装openvpn，这个软件我们可以到下面地址下载已经编译好的版本。因为是static编译的，所以不需要任何动态库支持直接解压就可以使用。
<a href="http://github.com/downloads/fries/android-external-openvpn/openvpn-static-2.1.1.bz2">http://github.com/downloads/fries/android-external-openvpn/openvpn-static-2.1.1.bz2</a></p>

<p>将解压后得到的openvpn-static-2.1.1文件改名为openvpn 并拷贝到手机的/system/xbin/目录下</p>

<p>我是采用手机上安装的Better Terminal Emulator Pro来操作的，也可以用adb连接上usb操作。</p>

<p>有了openvpn后，我们还要创建两个软连接才可以让后面的openvpn顺利建立连接</p>

<p>用Better Terminal Emulator Pro进入终端模式，输入如下命令</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir /system/xbin/bb
</span><span class='line'>ln -s /system/xbin/ifconfig /system/xbin/bb/ifconfig
</span><span class='line'>ln -s /system/xbin/route /system/xbin/bb/route</span></code></pre></td></tr></table></div></figure>


<p>上面创建两个命令的软连接，是因为后面安装的TunnelDroid软件，总是调用/system/xbin/bb目录下的命令，如果没有命令，就会出错。</p>

<p>用google的电子市场，查找TunnelDroid软件，安装TunnelDroid软件。</p>

<p><strong>配置TunnelDroid</strong></p>

<p>其实和配置Windows下的客户端一样，也需要一个配置文件和3个密钥文件</p>

<p>我们在sd卡的跟目录创建openvpn目录</p>

<p>在openvpn目录放入client.ovpn配置文件和ca.crt、client-1.crt和client-1.key密钥文件</p>

<p>这样启动TunnelDroid后，就会出现client.ovpn的选项，直接选择连接就可以。上面的配置文件和密钥，我都是从配置好的Windows机器拷贝过来的。</p>

<p>目前我测试的android手机、windowsxp、windows7和Linux全部都可以连接openvpn服务器。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/03/15/OpenVPN-Install/">CentOS 5.3下OpenVPN安装和Win7下OpenVPN GUI安装</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-15T00:00:00+08:00" pubdate data-updated="true">Mar 15<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>本来我是在美国的VPS服务器上安装的pptp vpn，这个vpn可以用windows自带的拨号连接，配置也很方便。刚配置好的时候很好用，可以开youtube也可以访问一些被封闭的站点。但是后来家里的歌华有线好像调整了一些路由配置，导致我在家里就不能连接vpn了。单位也不能连接。我用老婆家里的adsl尝试连接正常，用联通3G连接也正常。。。。这个既然是网络的问题，估计个人也解决不了了</p>

<p>最近单位也开始搞起来封锁了，开心、verycd等都被封。。。又不能用pptpd vpn了。。。看来该想想其他办法了。代理尝试了，不管用，看来不是基于域名的限制。
于是就开始尝试采用openvpn了。</p>

<p>参考了</p>

<p><a href="http://www.throx.net/2008/04/13/openvpn-and-centos-5-installation-and-configuration-guide/">http://www.throx.net/2008/04/13/openvpn-and-centos-5-installation-and-configuration-guide/</a></p>

<p><a href="http://www.xiaohui.com/dev/server/20070514-install-openvpn.htm">http://www.xiaohui.com/dev/server/20070514-install-openvpn.htm</a></p>

<p><strong>2010年10月14日更新</strong></p>

<p>加入官方CentOS下,iptables规则修改.保证顺利nat上网</p>

<p><strong>整体方案</strong></p>

<p>采用位于美国的CentOS 5.3 Linux服务器搭建openvpn服务器，并通过iptables的nat功能使openvpn服务器当做客户端网关。</p>

<p>客户端安装OpenVPN GUI程序连接服务器</p>

<p><strong>服务器</strong></p>

<p>服务器采用位于美国的vps,系统CentOS 5.3</p>

<p>安装openvpn作为vpn服务器软件</p>

<p><strong>OpenVPN服务器安装</strong></p>

<p>kernel 需要<strong>支持 tun 设备</strong>, 需要加载 iptables 模块.</p>

<p>检查 tun 是否安装:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>modinfo tun
</span><span class='line'>     
</span><span class='line'>或者
</span><span class='line'>     
</span><span class='line'>find / -name tun.o -print
</span></code></pre></td></tr></table></div></figure>


<p>安装需要的相关软件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> yum install rpm-build
</span><span class='line'> yum install autoconf.noarch
</span><span class='line'> yum install zlib-devel
</span><span class='line'> yum install pam-devel
</span><span class='line'> yum install openssl-devel</span></code></pre></td></tr></table></div></figure>


<p>安装环境准备好后，我们下载需要安装的软件。一共需要下载两个软件openvpn 2.0.9和lzo-1.08-4</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget http://openvpn.net/release/openvpn-2.0.9.tar.gz
</span><span class='line'>wget http://openvpn.net/release/lzo-1.08-4.rf.src.rpm</span></code></pre></td></tr></table></div></figure>


<p>安装lzo</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rpmbuild --rebuild lzo-1.08-4.rf.src.rpm
</span><span class='line'>rpm -Uvh /usr/src/redhat/RPMS/i386/lzo-*.rpm
</span><span class='line'>
</span><span class='line'>安装openvpn
</span></code></pre></td></tr></table></div></figure>


<p>rpmbuild -tb openvpn-2.0.9.tar.gz
rpm -Uvh /usr/src/redhat/RPMS/i386/openvpn-2.0.9-1.i386.rpm</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>安装后，复制配置文件
</span></code></pre></td></tr></table></div></figure>


<p>cp -r /usr/share/doc/openvpn-2.0.9/easy-rsa/ /etc/openvpn/
cp /usr/share/doc/openvpn-2.0.9/sample-config-files/server.conf /etc/openvpn/</p>

<p>配置生成CA脚本需要的配置文件vars</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vi /etc/openvpn/easy-rsa/vars</span></code></pre></td></tr></table></div></figure>


<p>打开vars后，找到文件最后的如下内容</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export KEY_COUNTRY=KG
</span><span class='line'>export KEY_PROVINCE=NA
</span><span class='line'>export KEY_CITY=BISHKEK
</span><span class='line'>export KEY_ORG="OpenVPN-TEST"
</span><span class='line'>export KEY_EMAIL="me@myhost.mydomain"</span></code></pre></td></tr></table></div></figure>


<p>根据自己信息修改上面内容,下面是具体含义</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export KEY_COUNTRY=KG 设置国家
</span><span class='line'>export KEY_PROVINCE=NA 设置省份
</span><span class='line'>export KEY_CITY=BISHKEK 设置城市
</span><span class='line'>export KEY_ORG="OpenVPN-TEST" 设置组织
</span><span class='line'>export KEY_EMAIL="me@myhost.mydomain" 设置邮件</span></code></pre></td></tr></table></div></figure>


<p>设置好后，执行如下命令</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /etc/openvpn/easy-rsa/
</span><span class='line'>. ./vars
</span><span class='line'>./clean-all</span></code></pre></td></tr></table></div></figure>


<p>注意上面的. ./vars两个点之间有一个空格</p>

<p>建立CA证书</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./build-ca</span></code></pre></td></tr></table></div></figure>


<p>生成后，ls keys 可以看到ca.crt ca.key文件</p>

<p>建立服务器密钥</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./build-key-server xinlogs</span></code></pre></td></tr></table></div></figure>


<p>注意这里的xinlogs是我给密钥起的名字，可以根据个人情况修改</p>

<p>生成Diffie-Hellman文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./build-dh</span></code></pre></td></tr></table></div></figure>


<p>以上文件都正确生成后，拷贝文件到正确目录</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /etc/openvpn/easy-rsa/
</span><span class='line'>cp keys/ca.crt ../
</span><span class='line'>cp keys/dh1024.pem ../
</span><span class='line'>cp keys/xinlogs.key ../
</span><span class='line'>cp keys/xinlogs.crt ../</span></code></pre></td></tr></table></div></figure>


<p>生成客户端密钥</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./build-key client-1</span></code></pre></td></tr></table></div></figure>


<p>这里client-1是客户端密钥的文件名，如果需要创建多个客户端密钥，就修改client-1名字多次生成即可。</p>

<p>修改/etc/openvpn/server.conf配置</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>
</span><span class='line'>    local 204.74.212.217
</span><span class='line'>    #修改local后面ip为服务器地址
</span><span class='line'>     
</span><span class='line'>    dev tap
</span><span class='line'>    ;dev tun
</span><span class='line'>    #默认是dev tun修改为dev tap,tap是可以路由模式 tun 是以太网隧道模式。具体区别我也不太清楚
</span><span class='line'>     
</span><span class='line'>    ca ca.crt
</span><span class='line'>    cert xinlogs.crt
</span><span class='line'>    key xinlogs.key
</span><span class='line'>    #cert后面修改为生成的服务器crt文件xinlogs.crt
</span><span class='line'>    #key后面修改为生成的服务器key文件xinlogs.key
</span><span class='line'>    dh dh1024.pem
</span><span class='line'>    #dh后面修改问生成的dh1024.pem
</span><span class='line'>    server 10.8.0.0 255.255.255.0
</span><span class='line'>    #server后面基本就用默认的10.8.0.0 255.255.255.0即可
</span><span class='line'>    ifconfig-pool-persist ipp.txt
</span><span class='line'>    #这个默认的ipp.txt就可以
</span><span class='line'>    push "route 10.8.0.0 255.255.255.0"
</span><span class='line'>    #添加客户端路由
</span><span class='line'>    push "redirect-gateway"
</span><span class='line'>    #修改客户端默认路由
</span><span class='line'>    push "dhcp-option DNS 8.8.8.8"
</span><span class='line'>    #修改客户端默认dns
</span><span class='line'>    client-to-client
</span><span class='line'>    #允许连接到vpn的客户端可以互相访问
</span><span class='line'>    duplicate-cn
</span><span class='line'>    keepalive 10 120
</span><span class='line'>    comp-lzo
</span><span class='line'>    #启用lzo压缩
</span><span class='line'>    user nobody
</span><span class='line'>    group nobody
</span><span class='line'>    persist-key
</span><span class='line'>    persist-tun
</span><span class='line'>    status /var/log/openvpn-status.log
</span><span class='line'>    log /var/log/openvpn.log
</span><span class='line'>    log-append /var/log/openvpn.log
</span><span class='line'>    verb 3
</span></code></pre></td></tr></table></div></figure>


<p><strong>启动停止openvpn</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>service openvpn start
</span><span class='line'>#启动openvpn服务
</span><span class='line'> 
</span><span class='line'>service openvpn stop
</span><span class='line'>#停止openvpn服务</span></code></pre></td></tr></table></div></figure>


<p><strong>配置iptables</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eth0 -j SNAT --to-source 214.174.212.217
</span><span class='line'>#上面命令最后的214.174.212.217是服务器的公网地址，需要根据自己情况修改
</span><span class='line'>service iptables save</span></code></pre></td></tr></table></div></figure>


<p>确认net.ipv4.ip_forward = 1后，服务器就全部配置完成。</p>

<p>如果是用的CentOS官方版本,不是VPS.那因为它自带的iptables规则限制,还需要在/etc/sysconfig/iptables加入下面语句才可以顺利nat上网</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-A RH-Firewall-1-INPUT -i tap+ -j ACCEPT  </span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat /etc/sysctl.conf |grep forward
</span><span class='line'># Controls IP packet forwarding
</span><span class='line'>net.ipv4.ip_forward = 1
</span><span class='line'> 
</span><span class='line'>#如果不是1，请用vi修改/etc/sysctl.conf文件</span></code></pre></td></tr></table></div></figure>


<p><strong>Win7下Openvpn GUI安装</strong></p>

<p>从 http://openvpn.se下载安装文件</p>

<p>Latest stable release: 1.0.3 with OpenVPN 2.0.9 (2006-10-17)</p>

<p>我们直接下载http://openvpn.se/files/install_packages/openvpn-2.0.9-gui-1.0.3-install.exe</p>

<p>注意：下载后，别着急双击安装。先右键属性，设置兼容模式为windosxp sp3 并用管理员身份运行。</p>

<p><img src="http://farm9.staticflickr.com/8378/8514766422_351fae319a.jpg" alt="openvpn gui 属性截图" /></p>

<p>然后再运行安装。</p>

<p><strong>客户端配置</strong></p>

<p>安装后，将服务器/etc/openvpn/easy-rsa/keys/目录下的ca.crt、client-1.crt和client-1.key三个文件拷贝到C:Program FilesOpenVPNconfig目录下</p>

<p>再将C:Program FilesOpenVPNsample-config目录下的client.ovpn文件拷贝到C:Program FilesOpenVPNconfig目录下。</p>

<p>在开始->所有程序里找到openvpn，进入里面右键点击OpenVPN GUI属性，同样修改兼容模式为windows xp sp3 以管理员运行</p>

<p>修改后，运行openvpn gui程序</p>

<p>正确运行后，电脑的右下角会出现openvpn的图标，右键点击选择Edit Config来修改客户端配置文件</p>

<p>下面是我全部客户端配置文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>
</span><span class='line'>    ##############################################
</span><span class='line'>    # Sample client-side OpenVPN 2.0 config file #
</span><span class='line'>    # for connecting to multi-client server. #
</span><span class='line'>    # #
</span><span class='line'>    # This configuration can be used by multiple #
</span><span class='line'>    # clients, however each client should have #
</span><span class='line'>    # its own cert and key files. #
</span><span class='line'>    # #
</span><span class='line'>    # On Windows, you might want to rename this #
</span><span class='line'>    # file so it has a .ovpn extension #
</span><span class='line'>    ##############################################
</span><span class='line'>     
</span><span class='line'>    # Specify that we are a client and that we
</span><span class='line'>    # will be pulling certain config file directives
</span><span class='line'>    # from the server.
</span><span class='line'>    client
</span><span class='line'>     
</span><span class='line'>    # Use the same setting as you are using on
</span><span class='line'>    # the server.
</span><span class='line'>    # On most systems, the VPN will not function
</span><span class='line'>    # unless you partially or fully disable
</span><span class='line'>    # the firewall for the TUN/TAP interface.
</span><span class='line'>    dev tap
</span><span class='line'>    ;dev tun
</span><span class='line'>     
</span><span class='line'>    # Windows needs the TAP-Win32 adapter name
</span><span class='line'>    # from the Network Connections panel
</span><span class='line'>    # if you have more than one. On XP SP2,
</span><span class='line'>    # you may need to disable the firewall
</span><span class='line'>    # for the TAP adapter.
</span><span class='line'>    ;dev-node MyTap
</span><span class='line'>     
</span><span class='line'>    # Are we connecting to a TCP or
</span><span class='line'>    # UDP server? Use the same setting as
</span><span class='line'>    # on the server.
</span><span class='line'>    ;proto tcp
</span><span class='line'>    proto udp
</span><span class='line'>     
</span><span class='line'>    # The hostname/IP and port of the server.
</span><span class='line'>    # You can have multiple remote entries
</span><span class='line'>    # to load balance between the servers.
</span><span class='line'>    remote 214.174.212.217 1194
</span><span class='line'>    ;remote my-server-2 1194
</span><span class='line'>     
</span><span class='line'>    # Choose a random host from the remote
</span><span class='line'>    # list for load-balancing. Otherwise
</span><span class='line'>    # try hosts in the order specified.
</span><span class='line'>    ;remote-random
</span><span class='line'>     
</span><span class='line'>    # Keep trying indefinitely to resolve the
</span><span class='line'>    # host name of the OpenVPN server. Very useful
</span><span class='line'>    # on machines which are not permanently connected
</span><span class='line'>    # to the internet such as laptops.
</span><span class='line'>    resolv-retry infinite
</span><span class='line'>     
</span><span class='line'>    # Most clients don't need to bind to
</span><span class='line'>    # a specific local port number.
</span><span class='line'>    nobind
</span><span class='line'>     
</span><span class='line'>    # Downgrade privileges after initialization (non-Windows only)
</span><span class='line'>    ;user nobody
</span><span class='line'>    ;group nobody
</span><span class='line'>     
</span><span class='line'>    # Try to preserve some state across restarts.
</span><span class='line'>    persist-key
</span><span class='line'>    persist-tun
</span><span class='line'>     
</span><span class='line'>    # If you are connecting through an
</span><span class='line'>    # HTTP proxy to reach the actual OpenVPN
</span><span class='line'>    # server, put the proxy server/IP and
</span><span class='line'>    # port number here. See the man page
</span><span class='line'>    # if your proxy server requires
</span><span class='line'>    # authentication.
</span><span class='line'>    ;http-proxy-retry # retry on connection failures
</span><span class='line'>    ;http-proxy [proxy server] [proxy port #]
</span><span class='line'>     
</span><span class='line'>    # Wireless networks often produce a lot
</span><span class='line'>    # of duplicate packets. Set this flag
</span><span class='line'>    # to silence duplicate packet warnings.
</span><span class='line'>    ;mute-replay-warnings
</span><span class='line'>     
</span><span class='line'>    # SSL/TLS parms.
</span><span class='line'>    # See the server config file for more
</span><span class='line'>    # description. It's best to use
</span><span class='line'>    # a separate .crt/.key file pair
</span><span class='line'>    # for each client. A single ca
</span><span class='line'>    # file can be used for all clients.
</span><span class='line'>    ca ca.crt
</span><span class='line'>    cert client-1.crt
</span><span class='line'>    key client-1.key
</span><span class='line'>     
</span><span class='line'>    # Verify server certificate by checking
</span><span class='line'>    # that the certicate has the nsCertType
</span><span class='line'>    # field set to "server". This is an
</span><span class='line'>    # important precaution to protect against
</span><span class='line'>    # a potential attack discussed here:
</span><span class='line'>    # http://openvpn.net/howto.html#mitm
</span><span class='line'>    #
</span><span class='line'>    # To use this feature, you will need to generate
</span><span class='line'>    # your server certificates with the nsCertType
</span><span class='line'>    # field set to "server". The build-key-server
</span><span class='line'>    # script in the easy-rsa folder will do this.
</span><span class='line'>    ;ns-cert-type server
</span><span class='line'>     
</span><span class='line'>    # If a tls-auth key is used on the server
</span><span class='line'>    # then every client must also have the key.
</span><span class='line'>    ;tls-auth ta.key 1
</span><span class='line'>     
</span><span class='line'>    # Select a cryptographic cipher.
</span><span class='line'>    # If the cipher option is used on the server
</span><span class='line'>    # then you must also specify it here.
</span><span class='line'>    ;cipher x
</span><span class='line'>     
</span><span class='line'>    # Enable compression on the VPN link.
</span><span class='line'>    # Don't enable this unless it is also
</span><span class='line'>    # enabled in the server config file.
</span><span class='line'>    comp-lzo
</span><span class='line'>     
</span><span class='line'>    # Set log file verbosity.
</span><span class='line'>    verb 3
</span><span class='line'>     
</span><span class='line'>    # Silence repeating messages
</span><span class='line'>    ;mute 20
</span><span class='line'>     
</span><span class='line'>    route-method exe
</span><span class='line'>    route-delay 2
</span></code></pre></td></tr></table></div></figure>


<p>其实主要修改的就是如下地方
复制内容到剪贴板</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>client
</span><span class='line'>#说明这个是客户端配置文件
</span><span class='line'> 
</span><span class='line'>dev tap
</span><span class='line'>;dev tun
</span><span class='line'>#这个和服务器一样就可以
</span><span class='line'> 
</span><span class='line'>remote 214.174.212.217 1194
</span><span class='line'>#这个ip要修改为服务器的公网ip地址
</span><span class='line'> 
</span><span class='line'>resolv-retry infinite
</span><span class='line'>nobind
</span><span class='line'>persist-key
</span><span class='line'>persist-tun
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>ca ca.crt
</span><span class='line'>cert client-1.crt
</span><span class='line'>key client-1.key
</span><span class='line'>#上面三行一定要根据自己生成的密钥配合
</span><span class='line'> 
</span><span class='line'>comp-lzo
</span><span class='line'>#启用lzo压缩
</span><span class='line'> 
</span><span class='line'># Set log file verbosity.
</span><span class='line'>verb 3
</span><span class='line'> 
</span><span class='line'>route-method exe
</span><span class='line'>route-delay 2 
</span><span class='line'>
</span><span class='line'>#最后这两行win7如果不加上，就不能启动修改路由，导致拨vpn成功，但是不能通过远程服务器做网关上网</span></code></pre></td></tr></table></div></figure>


<p>这些配置完成后，右键点openvpn gui在桌面右下角图标选择Connect连接</p>

<p>我正确连接后的日志如下</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>
</span><span class='line'>    Mon Mar 15 13:03:14 2010 OpenVPN 2.0.9 Win32-MinGW [SSL] [LZO] built on Oct 1 2006
</span><span class='line'>    Mon Mar 15 13:03:14 2010 IMPORTANT: OpenVPN's default port number is now 1194, based on an official port number assignment by IANA. OpenVPN 2.0-beta16 and earlier used 5000 as the default port.
</span><span class='line'>    Mon Mar 15 13:03:14 2010 WARNING: No server certificate verification method has been enabled. See http://openvpn.net/howto.html#mitm for more info.
</span><span class='line'>    Mon Mar 15 13:03:14 2010 LZO compression initialized
</span><span class='line'>    Mon Mar 15 13:03:14 2010 Control Channel MTU parms [ L:1574 D:138 EF:38 EB:0 ET:0 EL:0 ]
</span><span class='line'>    Mon Mar 15 13:03:14 2010 Data Channel MTU parms [ L:1574 D:1450 EF:42 EB:135 ET:32 EL:0 AF:3/1 ]
</span><span class='line'>    Mon Mar 15 13:03:14 2010 Local Options hash (VER=V4): 'd79ca330'
</span><span class='line'>    Mon Mar 15 13:03:14 2010 Expected Remote Options hash (VER=V4): 'f7df56b8'
</span><span class='line'>    Mon Mar 15 13:03:14 2010 UDPv4 link local: [undef]
</span><span class='line'>    Mon Mar 15 13:03:14 2010 UDPv4 link remote: 204.74.212.217:1194
</span><span class='line'>    Mon Mar 15 13:03:16 2010 TLS: Initial packet from 204.74.212.217:1194, sid=3d4cf00a 84deb309
</span><span class='line'>    Mon Mar 15 13:03:18 2010 VERIFY OK: depth=1, /C=US/ST=Beijing/L=BEIJING/O=xinlogs.com/CN=babodx/emailAddress=babodx@gmail.com
</span><span class='line'>    Mon Mar 15 13:03:18 2010 VERIFY OK: depth=0, /C=US/ST=Beijing/O=xinlogs.com/CN=babodx/emailAddress=babodx@gmail.com
</span><span class='line'>    Mon Mar 15 13:03:20 2010 Data Channel Encrypt: Cipher 'BF-CBC' initialized with 128 bit key
</span><span class='line'>    Mon Mar 15 13:03:20 2010 Data Channel Encrypt: Using 160 bit message hash 'SHA1' for HMAC authentication
</span><span class='line'>    Mon Mar 15 13:03:20 2010 Data Channel Decrypt: Cipher 'BF-CBC' initialized with 128 bit key
</span><span class='line'>    Mon Mar 15 13:03:20 2010 Data Channel Decrypt: Using 160 bit message hash 'SHA1' for HMAC authentication
</span><span class='line'>    Mon Mar 15 13:03:20 2010 Control Channel: TLSv1, cipher TLSv1/SSLv3 DHE-RSA-AES256-SHA, 1024 bit RSA
</span><span class='line'>    Mon Mar 15 13:03:20 2010 [babodx] Peer Connection Initiated with 214.174.212.217:1194
</span><span class='line'>    Mon Mar 15 13:03:21 2010 SENT CONTROL [babodx]: 'PUSH_REQUEST' (status=1)
</span><span class='line'>    Mon Mar 15 13:03:21 2010 PUSH: Received control message: 'PUSH_REPLY,route 10.8.0.0 255.255.255.0,redirect-gateway,dhcp-option DNS 8.8.8.8,route-gateway 10.8.0.1,ping 10,ping-restart 120,ifconfig 10.8.0.3 255.255.255.0'
</span><span class='line'>    Mon Mar 15 13:03:21 2010 OPTIONS IMPORT: timers and/or timeouts modified
</span><span class='line'>    Mon Mar 15 13:03:21 2010 OPTIONS IMPORT: --ifconfig/up options modified
</span><span class='line'>    Mon Mar 15 13:03:21 2010 OPTIONS IMPORT: route options modified
</span><span class='line'>    Mon Mar 15 13:03:21 2010 OPTIONS IMPORT: --ip-win32 and/or --dhcp-option options modified
</span><span class='line'>    Mon Mar 15 13:03:21 2010 TAP-WIN32 device [本地连接 3] opened: .Global{A958F4F2-14AF-49E6-9FBF-4FC25B8D8786}.tap
</span><span class='line'>    Mon Mar 15 13:03:21 2010 TAP-Win32 Driver Version 8.4
</span><span class='line'>    Mon Mar 15 13:03:21 2010 TAP-Win32 MTU=1500
</span><span class='line'>    Mon Mar 15 13:03:21 2010 Notified TAP-Win32 driver to set a DHCP IP/netmask of 10.8.0.3/255.255.255.0 on interface {A958F4F2-14AF-49E6-9FBF-4FC25B8D8786} [DHCP-serv: 10.8.0.0, lease-time: 31536000]
</span><span class='line'>    Mon Mar 15 13:03:21 2010 Successful ARP Flush on interface [29] {A958F4F2-14AF-49E6-9FBF-4FC25B8D8786}
</span><span class='line'>    Mon Mar 15 13:03:23 2010 TEST ROUTES: 2/2 succeeded len=1 ret=1 a=0 u/d=up
</span><span class='line'>    Mon Mar 15 13:03:23 2010 route ADD 214.174.212.217 MASK 255.255.255.255 192.168.2.1
</span><span class='line'>    操作完成!
</span><span class='line'>    Mon Mar 15 13:03:23 2010 route DELETE 0.0.0.0 MASK 0.0.0.0 192.168.2.1
</span><span class='line'>    操作完成!
</span><span class='line'>    Mon Mar 15 13:03:23 2010 route ADD 0.0.0.0 MASK 0.0.0.0 10.8.0.1
</span><span class='line'>    操作完成!
</span><span class='line'>    Mon Mar 15 13:03:23 2010 route ADD 10.8.0.0 MASK 255.255.255.0 10.8.0.1
</span><span class='line'>    操作完成!
</span><span class='line'>    Mon Mar 15 13:03:23 2010 Initialization Sequence Completed
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/03/12/HP-MSA1000-DL380G5-Centos5/">CentOS 5.4 基于HP Proliant DL380 G5服务器配置Modular Smart Array 1000存储</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-12T00:00:00+08:00" pubdate data-updated="true">Mar 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>原来单位的存储一直是分两个800G的区，挂在到Windows下。Windows的系统总要担心病毒，所以打算迁移到CentOS Linux下。</p>

<p>参考了<a href="http://blog.s135.com/post/415/">http://blog.s135.com/post/415/</a>这篇文章，但是他的文章里是单控制器，并且没有用到光纤。所以配置上有些不同</p>

<p><strong>硬件配置</strong></p>

<ul>
<li>一台HP MSA 1000存储设备（包含两个Modular Smart Array 1000控制器）</li>
<li>一台HP Storage SAN 4/8光纤交换机</li>
<li>一台HP Proliant DL380 G5 2U服务器</li>
<li>七块SCSI 300G硬盘</li>
<li>一块HP StorageWorks FC1142SR 4GB PCI-E 光纤卡</li>
</ul>


<p><img src="http://farm9.staticflickr.com/8085/8512593854_1e49c77451.jpg" alt="硬件图片MSA1000" /></p>

<p>从两个Modular Smart Array 1000的控制器后面连接光纤到光纤交换机。然后将光纤卡安装到服务器上，用光纤连接光纤卡到光纤交换机。</p>

<p><img src="http://farm9.staticflickr.com/8233/8511486023_2fd88da704.jpg" alt="hba" />
<img src="http://farm9.staticflickr.com/8532/8511486191_d0cc8c932f.jpg" alt="hba2" /></p>

<p><strong>软件配置</strong></p>

<p>先对各种硬件的fireware进行下更新。</p>

<p>从惠普网站下载update fireware光盘，下载的文件为firmware-8.60-0.zip，大小463M左右，然后解压刻成光盘</p>

<p>下载地址<a href="ftp://ftp.hp.com/pub/softlib2/software1/cd/p1040529012/v53483/firmware-8.60-0.zip">ftp://ftp.hp.com/pub/softlib2/software1/cd/p1040529012/v53483/firmware-8.60-0.zip</a></p>

<p>用光盘启动服务器，然后安装提示做就可以。它会更新网卡、服务器等设备的fireware。都是自动检测并更新的，很简单</p>

<p>确保各种fireware都更新后，下面需要用到smartstart光盘来对存储进行配置了</p>

<p>从惠普网站下载smartstart光盘，下载的文件smartstart-8.30-0-x86.zip，大小576M左右，也是解压刻录光盘</p>

<p>下载地址<a href="ftp://ftp.hp.com/pub/softlib2/software1/cd/p1040463476/v49882/smartstart-8.30-0-x86.zip">ftp://ftp.hp.com/pub/softlib2/software1/cd/p1040463476/v49882/smartstart-8.30-0-x86.zip</a></p>

<p>然后用光盘启动服务器，按照提示进入后，选择第2项配置存储卡，第一项是用来安装操作系统的，我发现没有Linux的操作系统。。。都是Windows系列。</p>

<p>可以发现服务器自己的raid卡 HP Smart Array E200和MSA 1000存储。</p>

<p>我是先将服务器的3块硬盘组成一个Raid 5，然后再配置MSA 1000的存储，也是将7块盘组成Raid 5。我看了下资料，说raid 6比raid5要损失8%-15%的性能，但是可以保证同时坏2块盘不丢失数据。不过我觉得raid5够用了。</p>

<p>因为是双控制器，我这里的fireware是4.48所以采用的是active/standby模式。如果打算用active/active模式，需要更新fireware到7.0版本</p>

<p>用smartstart光盘做好raid后，就可以给服务器安装系统了。</p>

<p><strong>安装CentOS 5.4 64bit</strong></p>

<p>安装CentOS 5.4 64bit版本前，先将连接到服务器的光纤拔掉，要不系统总是提示/dev/sda不可读取，这里的sda就是我们存储。
一切安装正常安装就可以。</p>

<p>正常安装后，连接好光纤，再启动服务器。</p>

<p>这个时候因为没有安装驱动，服务器在启动过程中会报很多end_request: error</p>

<p>而且我还发现如果不安装驱动，我们可以通过fdisk -l查找到存储设备，但是每次重启或者存储关机再开，存储的设备名都会变，有时候是/dev/sda有时候是/dev/sdb。所以很难在/etc/fstab里写入mount的配置。</p>

<p>安装HBA卡驱动</p>

<p>到HP网站下载驱动
<a href="http://h20000.www2.hp.com/bizsupport/TechSupport/SoftwareIndex.jsp?lang=en&amp;cc=us&amp;prodNameId=1809832&amp;prodTypeId=12169&amp;prodSeriesId=1809835&amp;swLang=8&amp;taskId=135&amp;swEnvOID=4004">http://h20000.www2.hp.com/bizsupport/TechSupport/SoftwareIndex.jsp?lang=en&amp;cc=us&amp;prodNameId=1809832&amp;prodTypeId=12169&amp;prodSeriesId=1809835&amp;swLang=8&amp;taskId=135&amp;swEnvOID=4004</a></p>

<p>也可以直接下载
<a href="ftp://ftp.hp.com/pub/softlib/software10/COL19426/co-74973-1/hp_qla2x00-2009-03-17.tar.gz">ftp://ftp.hp.com/pub/softlib/software10/COL19426/co-74973-1/hp_qla2x00-2009-03-17.tar.gz</a></p>

<p><a href="ftp://ftp.hp.com/pub/softlib/software11/COL28061/co-69719-3/hp-fc-enablement-2009-12-16.tar.gz">ftp://ftp.hp.com/pub/softlib/software11/COL28061/co-69719-3/hp-fc-enablement-2009-12-16.tar.gz</a></p>

<p>上面两个文件，一个是qla2x00的驱动，后面一个是Linux fibre channel enablement kits for QLogic HBAs and mezzanine cards</p>

<p>下载后解压安装</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Installation instructions
</span><span class='line'> 
</span><span class='line'>Download the appropriate driver kit for your distribution. The driver kit file will be in the format hp_qla2x00-yyyy-mm-dd.tar.gz.
</span><span class='line'>Copy the driver kit to the target system.
</span><span class='line'>Uncompress and untar the driver kit using the following command:
</span><span class='line'># tar zxvf hp_qla2x00-yyyy-mm-dd.tar.gz
</span><span class='line'>Change directory to the hp_qla2x00-yyyy-mm-dd directory.
</span><span class='line'>Execute the INSTALL command.
</span><span class='line'>The INSTALL command syntax will vary depending on your conﬁguration. If a previous driver kit is installed, you can invoke the INSTALL command without any arguments as the script will use the currently loaded conﬁguration:
</span><span class='line'># ./INSTALL
</span><span class='line'>To force the installation to failover mode, use the -f ﬂag:
</span><span class='line'># ./INSTALL -f
</span><span class='line'>To force the installation to single-path mode, use the -s ﬂag:
</span><span class='line'># ./INSTALL -s
</span><span class='line'>Use the -h option of the INSTALL script for a list of all supported arguments. The INSTALL script will install the appropriate driver RPM for your conﬁguration, as well as the appropriate ﬁbreutils RPM. Once the INSTALL script is ﬁnished, you will either have to reload the QLogic driver modules (qla2xxx, qla2300, qla2400, qla2xxx_conf) or reboot your server.
</span><span class='line'>The commands to reload the driver are:
</span><span class='line'># /opt/hp/src/hp_qla2x00src/unload.sh
</span><span class='line'># modprobe qla2xxx_conf
</span><span class='line'># modprobe qla2xxx
</span><span class='line'># modprobe qla2300
</span><span class='line'># modprobe qla2400
</span><span class='line'>The command to reboot the server is:
</span><span class='line'># reboot
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>CAUTION: If your boot device is a SAN attached device you will have to reboot your server.
</span><span class='line'>
</span><span class='line'>To verify which RPM versions are installed, use the rpm command with the -q option.
</span><span class='line'>For example:
</span><span class='line'># rpm -q hp_qla2x00src
</span><span class='line'># rpm –q fibreutils</span></code></pre></td></tr></table></div></figure>


<p>然后在继续安装HP Fibre Channel Enablement Kit</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Installing the HP Fibre Channel Enablement Kit
</span><span class='line'> 
</span><span class='line'>To install the HP Fibre Channel Enablement Kit, do the following:
</span><span class='line'>Download the hp-fc-enablement-yyyy-mm-dd.tar.gz file for your operating system and copy it to the target server
</span><span class='line'>Untar the enablement kit by executing the command to create the directory, hp-fc-enablement-yyyy-mm-dd.
</span><span class='line'># tar zxvf hp-fc-enablement-yyyy-mm-dd.tar.gz
</span><span class='line'>Browse to the directory hp-fc-enablement-yyyy-mm-dd.
</span><span class='line'>Do one of the following to execute the install.sh script.
</span><span class='line'>If you are not using Device Mapper multipathing execute the following command:
</span><span class='line'># ./install.sh -s
</span><span class='line'>If you are using Device Mapper multipathing execute the following command:
</span><span class='line'># ./install.sh -m
</span><span class='line'>The hp-fc-enablement and fibreutils RPMs should be installed once this install completes. To verify the installation, enter the following commands:
</span><span class='line'># rpm -q hp-fc-enablement
</span><span class='line'># rpm -q fibreutils
</span><span class='line'>
</span><span class='line'>NOTE: For use with the driver that comes with the kernel you will need fibreutils 3.x or greater.
</span></code></pre></td></tr></table></div></figure>


<p>全部完成后，我们需要查看下/etc/modprobe.conf
如果有下面图中标记的一些信息加入，说明上面的驱动安装正确。</p>

<p><img src="http://farm9.staticflickr.com/8378/8512177477_69fd3f3534_z.jpg" alt="msa1000配置图片" /></p>

<p>确实正确后，我们重启下服务器。</p>

<p>当再次进入系统后，我们的存储应该被识别为/dev/sda设备</p>

<p>用fdisk -l /dev/sda查看下，如果没有问题了，就可以使用fdisk /dev/sda进行分区</p>

<p>我是把全部1.6T分成一个区/dev/sda1</p>

<p>然后e2lable /dev/sda1 /data给卷标</p>

<p>在/etc/fstab文件里加入/dev/sda1的挂着位置</p>

<p>这样以后每次启动系统，就自动将存储挂着到系统的/data目录中了。如下图</p>

<p><img src="http://farm9.staticflickr.com/8112/8512182419_1370b691bf.jpg" alt="存储mount成功" /></p>

<p><strong>总结</strong></p>

<p>本来参考<a href="www.s135.com">http://www.s135.com</a>博主的文章配置的，后来发现因为用了光纤卡，不安装驱动会有问题。还有就是双控制器的active/active和active/standby模式需要通过刷新不同的fireware实现。总得来说这个存储配置起来不难，安装官方文档和网络上一些文档就可以。写这篇文档就是为了记录下自己的配置过程，省的以后再配置还要到处找文档查资料。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/03/12/HP-Computer-Ghost-Problem/">HP台式机器，ghost系统后，提示windows Could Not Start</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-12T00:00:00+08:00" pubdate data-updated="true">Mar 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今天单位一台HP dx7518的台式机器，ghost了一个winxp系统。但是只要一开机，就提示</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>windows could not start because of a computer disk hardware configuration problem    
</span><span class='line'>could not read from the selected boot disk check boot path and disk harware   
</span><span class='line'>please check the windows documentation about hardware disk configuation and your hardware refer once manuals for additional information   </span></code></pre></td></tr></table></div></figure>


<p>开始我以为是硬盘的设置问题，后来发现硬盘已经设置为IDE模式了。</p>

<p>后来网上查找，发现是和BIOS里的WDRT Support选项有关系。。。</p>

<p><strong>解决办法</strong></p>

<p>开机进入bios设置，选择Power management Setup 再选择WDRT Support 将后面值修改为disable</p>

<p>WDRT SUPPORT：watchdog resource table 一种加密狗。通过这种加密保护来拒绝安装非随机配备的操作系统。同样，全系的HP 家用、商用台式机、笔记本，进行GHOST安装后报错，也可以用此方法解决。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/02/12/HUAWEI-E1750-on-Win7/">win7下使用联通无线上网卡HUAWEI E1750</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-12T00:00:00+08:00" pubdate data-updated="true">Feb 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>老婆单位年底搞活动，抽奖中了一个联通的无线上网卡。型号HUAWEI E1750</p>

<p>本来打算给我笔记本用的，我系统是Windows 7。结果发现用不了，安装上以后，无线上网软件提示找不到设备。。。。。。</p>

<p><strong>解决办法</strong></p>

<p>让Windows 7自动找驱动，肯定是没戏了。用光盘自带软件的驱动也不灵。后来到HUAWEI网站查找最近驱动，最终下面网站找到了相关更新</p>

<p><code>http://www.huaweidevice.com/cn/downloadCenter.do?method=doListSoftwareid=1&amp;fla y=findsoftwareName=E1750</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>E1750 E1750-WINMACB300D00SP04C112( U TPS11[1].301.08.24.112_MAC11.3 01.06.07.112)(China Unicom) China Unicom  2009-12-23 </span></code></pre></td></tr></table></div></figure>


<p>以上是Win7下可以使用的驱动更新。大约28M</p>

<p>安装步骤是先安装Mobile_Card_Driver_3.09.exe驱动，然后正确识别设备后，运行UTPS11.301.08.24.112_MAC11.301.06.07.112.B433.exe更新设备的固件。最后再安装无线上网软件。</p>

<p>可是我安装文档的方法，在Win7下并没有成功，运行UTPS11.301.08.24.112_MAC11.301.06.07.112.B433.exe更新的时候，总是提示没有找到设备或者正在有软件占用设备或者没有管理员权限。。。。。</p>

<p>后来找了一台WinXP系统的机器，按照文档步骤一次成功。</p>

<p>然后再将更新过的E1750插到Win7上面，就可以自动识别设备了。识别成功后如下图。</p>

<p><img src="http://farm9.staticflickr.com/8251/8512574602_ee146a4011.jpg" alt="e1750驱动截图" /></p>

<p>这样继续安装无线上网软件就可以正确识别并上网了。下面是正确识别后的截图</p>

<p><img src="http://farm9.staticflickr.com/8105/8511465149_d5c86d6172.jpg" alt="e1750成功驱动" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/02/02/my-htc-hero-mobile/">我的新手机HTC Hero G3</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-02T00:00:00+08:00" pubdate data-updated="true">Feb 2<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>关注HTC hero G3很久了，大约从10月份开始吧。当时就和老婆说生日打算换个手机，后来生日当天去中关村看了看，但是没有购买，报价3000。关键是不知道怎么选购。回来后网上做功课，查询论坛和淘宝。最后决定在淘宝的一家北京实体店购买。在木樨园桥附近。2010年1月25日周一购买的。</p>

<p>购买的最终手机价格是2860元，又选购了8G TF卡，一块MOMAX电池+座充+车充+手机套。3370元。</p>

<p>购买后，由卖家给刷安逸1.2的ROM并给8G卡预装一些软件。</p>

<p>整体感觉比我原来用的windows手机eten x800速度快了不少。android系统也很漂亮。</p>

<p>我的联系人是先用Win7的windows mobile设备管理将原来windows手机的联系人导出到outlook，最后导出到excel并生成cvs文件。</p>

<p>然后导入到Gmail邮件的通讯录。这样通过hero G3的同步gmail联系人，就可以导入到新手机了。</p>

<p>感觉和gmail配合的相当好。短信也可以备份到gmail保存。</p>

<p><strong>刷机</strong></p>

<p>手机买来就开始装软件，尝试导航，使用感觉不错。不过在论坛学习，发现很多系统都比我这个新，就产生了刷机的想法。</p>

<p>开始先尝试刷radio。radio是负责手机通讯的模块，可以理解为电话用的驱动吧。</p>

<p>我原来的版本比较低，自己先尝试刷了63.18.55.06JU_6.35.09.26最新版本。</p>

<p><strong>刷radio办法</strong></p>

<p>机器买来的时候，又商家默认刷了啊兴的2.5 recovery。我就用了一个1G的卡，格式化为FAT32文件系统。将下载的radio更新文件拷贝到卡的根目录，并改名为update.zip</p>

<p>关闭手机，同时按Home+Power键进入recovery界面(就是小房子+开机键)。</p>

<p>等出现recovery界面，选择第2项，将sd卡上的update.zip刷入手机。</p>

<p>注意刷完后，一定要重启一次手机。</p>

<p>刷这个很简单，一会就完成了。感觉不错。呵呵</p>

<p>关于Rom的选择，我再论坛上找了很久，也发帖求助了很多高手。大家普遍认为安卓1.2就是稳定，但是速度很慢。</p>

<p>大家推荐我的主要是Flzyup的Rom和modaco的Rom</p>

<p>我怕Modaco的Rom中文支持不友好，就决定从Flzyup制作的Rom选择了。目前来说G3的Rom有基于android 1.5的，也有基于2.0</p>

<p>但是普遍认为2.0 Rom目前不成熟，毕竟官方没有出来呢。所以我就只选择基于android 1.5的Rom了。</p>

<p>F大（flzyup的亲切称呼）的Rom基于1.5系统的主要如下</p>

<ul>
<li><p><a href="http://www.innovative-space.com/2010/01/14/flzyup-custom-rom-v1-5-final/">FLZYUP Custom ROM v1.5 final(惊喜一)</a></p></li>
<li><p><a href="http://www.innovative-space.com/2010/01/10/flzyup-custom-rom-v1-4-paid-apps-new-icons/">FLZYUP Custom ROM v1.4 (Paid APPs+New ICONs)</a></p></li>
<li><p><a href="http://www.innovative-space.com/2009/12/23/flzyup_custom_rom_v1-3_final-large-me/">FLZYUP_Custom_ROM_v1.3_final大内存版本</a></p></li>
<li><p><a href="http://www.innovative-space.com/2009/12/07/flzyup-custom-rom-v1-3-release/">FLZYUP Custom ROM v1.3 final all fixed [特效包已发布]</a></p></li>
</ul>


<p>1.4版本是基于1.3的基础上优化完善的，1.5是基于全新内核制作的。</p>

<p>因为我看论坛上很多人反映F大1.5版本耗电，本来G3也就坚持2天，如果刚买手机经常玩，1天就够呛了。。。所以没敢使用这个费电的新版本。我保守的选择了1.4版本。</p>

<p><strong>准备刷机</strong></p>

<p>论坛坚持了2天，大家一直讨论刷那个版本好，可以参考<a href="http://www.androidin.net/bbs/thread-51055-1-1.html">http://www.androidin.net/bbs/thread-51055-1-1.html</a></p>

<p>最终决定刷F大的1.4版本。看到F大1.4是自动支持app2sd技术的，但是前提是你的卡必须有ext分区。我的8G卡目前就1个Fat32分区，于是考虑先分区。</p>

<p>但是Win7没有找到合适的分区软件，后来发现xda论坛发布的<strong>RA-hero-v1.5.2</strong> recovery可以支持在手机的recovery模式给卡分区。我就先刷了这个recovery</p>

<p><strong>刷recovery</strong></p>

<p>主要参考<a href="http://forum.xda-developers.com/showthread.php?t=561124">http://forum.xda-developers.com/showthread.php?t=561124</a></p>

<p>There are several ways to install a custom recovery, choose the one that suits you most (I probably forgot a few).</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>via adb 
</span><span class='line'>-&gt; Requires a custom recovery (with test-keys) like Cyanogen's v1.4 or my previous recovery
</span><span class='line'>
</span><span class='line'>Copy recovery-RA-hero-v1.5.2.img to the root of your sdcard
</span><span class='line'>Boot into your current custom recovery (boot while holding HOME)
</span><span class='line'>Connect your Hero via usb to your pc/mac/...
</span><span class='line'>adb shell
</span><span class='line'>$su (not required if you have root already)
</span><span class='line'>#mount -a
</span><span class='line'>#flash_image recovery /sdcard/recovery-RA-hero-v1.5.2.img
</span></code></pre></td></tr></table></div></figure>


<p>我采用的上面这个方法安装的。</p>

<p>不过首先要在机器上安装adb工具和手机驱动</p>

<p>驱动采用网上下载的AndroidDriverFiles驱动程序.rar</p>

<p>adb本来是包含在android sdk工具里面的，但是sdk太大了，好几百兆。。。。我就在网上找了一个adb_win.zip的分离包。572k，就2个文件。</p>

<p>先将adb_win.zip解压缩，得到adb.exe和AdbWinApi.dll文件。将2个文件复制到Windows目录下的System32目录。</p>

<p>这样在windows的命令行窗口输入adb命令，可以看到如下输出</p>

<p>Android Debug Bridge version 1.0.20下面还有很多使用说明，就不用管了。</p>

<p>现在准备好adb了，再把AndroidDriverFiles驱动程序.rar解压到一个目录，准备连接手机的时候使用。</p>

<p>以上都准备好后，关闭手机，按Home+Power键进入recovery模式，将USB线连上电脑。如果提示安装驱动，就手动到AndroidDriverFiles驱动程序解压后的目录找。</p>

<p>驱动识别完成后，就打开windows的命令行窗口（Win+R，输入cmd回车）</p>

<p>输入adb shell</p>

<p>然后su回车</p>

<p>mount -a回车</p>

<p>上面的su和mount -a 都可能返回错误，不用管它。</p>

<p>最后输入flash_image recovery /sdcard/recovery-RA-hero-v1.5.2.img 回车。</p>

<p>这样就把新的recovery刷入了。</p>

<p>重启进入recovery模式，如图</p>

<p><img src="http://farm9.staticflickr.com/8096/8512558972_02deaf66fe.jpg" alt="recovery截图" /></p>

<p>然后在Wipe里面执行如下3项</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Wipe
</span><span class='line'>
</span><span class='line'>Wipe data/factory reset :: Wipe /data and /cache
</span><span class='line'>Wipe Dalvik-cache :: Wipe Dalvik-cache both on /data and ext
</span><span class='line'>Wipe SD:ext partition : Wipe the ext partition on your sdcard</span></code></pre></td></tr></table></div></figure>


<p>再给sd卡分区。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Partition sdcard
</span><span class='line'>
</span><span class='line'>Partition SD :: Interactive SD partitioning</span></code></pre></td></tr></table></div></figure>


<p>这样就给sd卡分好去了，我的8G卡，默认是32M的swap分区 512M的ext分区。最后是一个大的Fat32分区。
这样就可以关机了。</p>

<p><strong>刷FLZYUP_Custom_ROM_v1.4-signed.zip系统</strong></p>

<p>上面的准备工作全完成了，再来刷系统。</p>

<p>将分好区的sd卡，放到电脑读卡器上，从电脑将FLZYUP_Custom_ROM_v1.4-signed.zip拷贝到根目录。因为win7只能识别出FAT32分区，所以肯定是拷贝到FAT32分区上。</p>

<p>然后返回手机开机进入recovery模式，选择</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Flash zip from sdcard :: Flash a zip update file from your sdcard</span></code></pre></td></tr></table></div></figure>


<p>按照提示往下刷就可以了。刷好后提示如下</p>

<p><img src="http://farm9.staticflickr.com/8511/8511451731_17da3c1a26.jpg" alt="rom_update截图" /></p>

<p>然后重启手机就可以了。</p>

<p><strong>注意</strong></p>

<p>刷完后，第一次重启很慢很慢，这个正常。我当时以为手机刷坏了，总停在HTC那屏上。。。还到论坛发帖求助呢。。</p>

<p>后来发现第一次重启后，看到绿色小人和听到声音大约1分20秒，然后就是那个HTC三个字母的屏幕，大约等了10分钟。。。就会进入下面屏幕</p>

<p><img src="http://farm9.staticflickr.com/8369/8511453551_4a0cd686ef.jpg" alt="android 1.4" /></p>

<p>按照提示设置好手机，就可以享受新系统了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/28/E63-nokia-fireware-update/">诺基亚E63刷机</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-28T00:00:00+08:00" pubdate data-updated="true">Jan 28<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>前几天老婆的E63手机总是死机，一直在跟我抱怨。。。本来想给她买个iphone，结果老婆说不喜欢，还是喜欢她红色的E63.</p>

<p>我想想手机买了1年多了，也没有更新过，不如刷个新系统看看吧。于是就开始搜索资料、准备软件。</p>

<p>具体刷机步骤参考
<a href="http://nokia.zol.com.cn/188/297_1876549.html">http://nokia.zol.com.cn/188/297_1876549.html</a></p>

<p><strong>诺基亚刷机方法</strong></p>

<p>主要是官方刷新，还是用第三方软件刷新</p>

<p>官方的在线刷新就是用官方公布的软件直接更新手机的系统。但是官方更新只限于行货手机，因为官方是根据你手机的CODE号码来为你更新手机系统的，如果你手机的CODE是外国的，那刷新后，就没有中文系统了。所以这个不适合大多数水货手机</p>

<p>我查看了一下，老婆手机的CODE是0569944: 马来西亚的。用官方的估计不行，于是就开始考虑第三方软件。</p>

<p>发现比较著名的就是凤凰刷机工具了。</p>

<p>其实简单的说“凤凰刷机”就是刷机软件的一种，而非官方的刷机软件而已，由于其在性能上有官方刷机软件很多不能完成的任务，因而收到的机友的广泛追捧。</p>

<p><strong>准备工作</strong></p>

<p>首先是下载凤凰刷机软件</p>

<p>参考这里<a href="http://nokia.zol.com.cn/1/18_299.html">http://nokia.zol.com.cn/1/18_299.html</a></p>

<p>我下载的就是<a href="http://nokia.zol.com.cn/1/18_299.html">凤凰刷机2009.34.7.40015最新XX版09.10.30发布</a></p>

<p>下载好凤凰刷机软件后，就是备份手机存储卡上的内容和联系人了。我是直接用读卡器把存储卡拷贝到电脑，然后用诺基亚PC套件导出的联系人。</p>

<p>这些都弄好了，就可以进入刷机步骤了。</p>

<p><strong>刷机步骤</strong></p>

<p>安装好凤凰刷机软件，并打开</p>

<p>选择Tools->Image file download</p>

<p><img src="http://farm9.staticflickr.com/8103/8512516328_851a5902d7.jpg" alt="选择下载img" /></p>

<p>然后在Product code内输入你想刷的系统的code码，我这里输入的0569941，新加坡的版本</p>

<p>输入完成后，点download等待下载，大小在60-80M。</p>

<p>下载完成后，点cancel就可以了。</p>

<p>系统下载好了，我们就该向手机内刷了。用USB的数据线连接手机。在手机上选择PC套件模式。</p>

<p>然后选择凤凰2009的菜单file&#8212;manage connection，跳出菜单NO CONECTION，再点“NEW”按键。</p>

<p><img src="http://farm9.staticflickr.com/8508/8511405473_51583b1644_z.jpg" alt="new按钮" /> </p>

<p>按NEW键之后会出现下图：</p>

<p><img src="http://farm9.staticflickr.com/8100/8511406351_68da4dfd26_z.jpg" alt="new截图" /></p>

<p>选择USB后，按下一步，直到完成。这样连接里会才会出现USB和NO CONNECTIONS两个选择，一个是USB连接，一个是没有连接，如果是USB连接，表示手机正常。选择USB，点击“APPLY”按钮,然后点击Cancel，连接完成</p>

<p><img src="http://farm9.staticflickr.com/8226/8512518914_dfa06ce9ed_z.jpg" alt="usb1截图" />
<img src="http://farm9.staticflickr.com/8506/8512513418_7c9ca6b164_z.jpg" alt="usb2截图" /></p>

<p>菜单File ,open Product，系统会自动调出诺基亚各个型号的RM菜单，你选择自己的机型即可，比如诺基亚E63为RM-437，找到后点OK。</p>

<p><img src="http://farm9.staticflickr.com/8368/8512513018_73ca2419cd_z.jpg" alt="ok截图" /></p>

<p><img src="http://farm9.staticflickr.com/8386/8512512776_a4c75f2239_z.jpg" alt="ok截图2" /></p>

<p>选择RM-437的画面，在出现的提示框里找RM-437，选中，然后点OK，选择normal.</p>

<p>凤凰2009软件菜单Flashing&#8212;&#8211;Fireware Update,出现下面画面</p>

<p><img src="http://farm9.staticflickr.com/8240/8511400983_580969c8e8_z.jpg" alt="update截图" /></p>

<p>这里有一个非常关键的地方需要注意,就是上图选择RM-437之后,要注意看Product CODE:显示的CODE是多少,如果是欧版的CODE(比如0582481),那就需要你选择以下亚太的CODE的系统,选择你刚才下载的比如<font color="#000000" size="2">0569941</font>的系统. 点击下图右边的小方块(小方块上有省略号的那个)</p>

<p>想刷400.21.013的朋友，如果下载了400的固件，但是在这里没有找到400的话，可以来这里看下</p>

<p>凤凰菜单栏进入：TOOLS-Options-product locetion（下图）</p>

<p><img src="http://farm9.staticflickr.com/8107/8512512350_980a17dfbe_z.jpg" alt="locetion图" /></p>

<p>红色线标注的栏目原来是空白的，这里需要设置下路径，点右边的“add”添加路径如图所示，然后点“apply”确认后退出。</p>

<p>哈哈，看下图出现了400.21.013了</p>

<p><img src="http://farm9.staticflickr.com/8368/8511400657_7362511b0f_z.jpg" alt="截图" /></p>

<p>点击&#8221;Refurbish&#8221;开始刷机，在进入这个程序之后，无论计算机屏幕右下角出现什么提示，均不要搭理它，直到提示成功。</p>

<p><img src="http://farm9.staticflickr.com/8371/8511400551_ca21a4f98f_z.jpg" alt="截图" /> </p>

<p>到这里就算完成了。哈哈</p>

<p>以上内容基本都是从下面两篇帖子上转过来的。如果有什么不明白，可以直接去看原帖。我只是记录下，省的以后刷机还要找资料。</p>

<ul>
<li>[原创][教程]诺基亚E63用凤凰2009成功刷机</li>
<li>0300 凤凰2009成功刷 E63最新固件 400.21.013
 </li>
</ul>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/9/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/7/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>公告:</h1>
  <p>博客从原来的emlog迁移到了octopress。正在学习当中，原来的文章基本转移过来了。</p>
  <p>
  最近把运维服务相关内容做了一个网站：<a href="http://yunwei.biz">董•运维</a>
  </p>
</section>
<section>
<h1>Categories</h1>
<ul id="categories">
  <li class='category'><a href='/blog/categories/css/'>CSS (2)</a></li>
<li class='category'><a href='/blog/categories/cloudstack/'>Cloudstack (1)</a></li>
<li class='category'><a href='/blog/categories/database/'>Database (10)</a></li>
<li class='category'><a href='/blog/categories/game/'>Game (15)</a></li>
<li class='category'><a href='/blog/categories/hardware/'>Hardware (9)</a></li>
<li class='category'><a href='/blog/categories/host/'>Host (4)</a></li>
<li class='category'><a href='/blog/categories/java/'>Java (3)</a></li>
<li class='category'><a href='/blog/categories/life/'>Life (3)</a></li>
<li class='category'><a href='/blog/categories/linux/'>Linux (52)</a></li>
<li class='category'><a href='/blog/categories/mac/'>Mac (6)</a></li>
<li class='category'><a href='/blog/categories/mobile/'>Mobile (8)</a></li>
<li class='category'><a href='/blog/categories/octopress/'>Octopress (2)</a></li>
<li class='category'><a href='/blog/categories/php/'>PHP (14)</a></li>
<li class='category'><a href='/blog/categories/plan/'>Plan (1)</a></li>
<li class='category'><a href='/blog/categories/rails/'>Rails (8)</a></li>
<li class='category'><a href='/blog/categories/ruby/'>Ruby (2)</a></li>
<li class='category'><a href='/blog/categories/software/'>Software (7)</a></li>
<li class='category'><a href='/blog/categories/vim/'>Vim (2)</a></li>
<li class='category'><a href='/blog/categories/virtualization/'>Virtualization (9)</a></li>
<li class='category'><a href='/blog/categories/website/'>Website (4)</a></li>
<li class='category'><a href='/blog/categories/windows/'>Windows (10)</a></li>
<li class='category'><a href='/blog/categories/git/'>git (1)</a></li>

</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/05/06/securecrt-for-mac-store-password/">mac下的secureCRT如何保存密码？</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/29/digitalocean-vps/">digitalocean-vps</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/25/nginxzhi-chi-thinkphpde-pathinfomo-shi/">nginx支持thinkphp的pathinfo模式</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/02/centos5-dot-5an-zhuang-railshuan-jing/">centos5.5安装rails环境</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/16/rails-best-practices-1/">rails-best-practices-1</a>
      </li>
    
  </ul>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - babodx -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
